{"controls":[{"id":"SV-54833","code":"control 'SV-54833' do\n  title 'The Windows Firewall with Advanced Security must be enabled when connected to a domain.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  This setting enables the firewall when connected to the domain.'\n  desc 'check', 'If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\DomainProfile\\\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value.  If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\DomainProfile\\\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)'\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> State, \"Firewall state\" to \"On (recommended)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile state on\".\nOr\n\"Netsh advfirewall set allprofiles state on\".'\n  impact 0.5\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-58965r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-17415'\n  tag rid: 'SV-54833r2_rule'\n  tag stig_id: 'WNFWA-000001'\n  tag gtitle: 'Windows Firewall Domain - Enable Firewall'\n  tag fix_id: 'F-63429r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001414']\n  tag nist: ['AC-4']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54833.rb"},"title":"The Windows Firewall with Advanced Security must be enabled when connected to a domain.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  This setting enables the firewall when connected to the domain.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  This setting enables the firewall when connected to the domain.","check":"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value.  If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> State, \"Firewall state\" to \"On (recommended)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile state on\".\nOr\n\"Netsh advfirewall set allprofiles state on\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-58965r1_chk","severity":"medium","gid":"V-17415","rid":"SV-54833r2_rule","stig_id":"WNFWA-000001","gtitle":"Windows Firewall Domain - Enable Firewall","fix_id":"F-63429r3_fix","documentable":null,"cci":["CCI-001414"],"nist":["AC-4"]}},{"id":"SV-54849","code":"control 'SV-54849' do\n  title 'The Windows Firewall with Advanced Security must be enabled when connected to a private network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  This setting enables the firewall when connected to a private network.'\n  desc 'check', 'If the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PrivateProfile\\\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value.  If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\StandardProfile\\\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)'\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> State, \"Firewall state\" to \"On (recommended)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile state on\".\nOr\n\"Netsh advfirewall set allprofiles state on\".'\n  impact 0.5\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-58991r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-17416'\n  tag rid: 'SV-54849r2_rule'\n  tag stig_id: 'WNFWA-000002'\n  tag gtitle: 'Windows Firewall Private - Enable Firewall'\n  tag fix_id: 'F-63481r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001414']\n  tag nist: ['AC-4']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54849.rb"},"title":"The Windows Firewall with Advanced Security must be enabled when connected to a private network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  This setting enables the firewall when connected to a private network.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  This setting enables the firewall when connected to a private network.","check":"If the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value.  If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> State, \"Firewall state\" to \"On (recommended)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile state on\".\nOr\n\"Netsh advfirewall set allprofiles state on\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-58991r1_chk","severity":"medium","gid":"V-17416","rid":"SV-54849r2_rule","stig_id":"WNFWA-000002","gtitle":"Windows Firewall Private - Enable Firewall","fix_id":"F-63481r1_fix","documentable":null,"cci":["CCI-001414"],"nist":["AC-4"]}},{"id":"SV-54855","code":"control 'SV-54855' do\n  title 'The Windows Firewall with Advanced Security must be enabled when connected to a public network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  This setting enables the firewall when connected to a public network.'\n  desc 'check', 'If the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PublicProfile\\\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value.  If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\PublicProfile\\\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)'\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> State, \"Firewall state\" to \"On (recommended)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile state on\".\nOr\n\"Netsh advfirewall set allprofiles state on\".'\n  impact 0.5\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-58993r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-17417'\n  tag rid: 'SV-54855r2_rule'\n  tag stig_id: 'WNFWA-000003'\n  tag gtitle: 'Windows Firewall Public - Enable Firewall'\n  tag fix_id: 'F-63483r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001414']\n  tag nist: ['AC-4']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54855.rb"},"title":"The Windows Firewall with Advanced Security must be enabled when connected to a public network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  This setting enables the firewall when connected to a public network.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  This setting enables the firewall when connected to a public network.","check":"If the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value.  If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\\n\nValue Name:  EnableFirewall\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> State, \"Firewall state\" to \"On (recommended)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile state on\".\nOr\n\"Netsh advfirewall set allprofiles state on\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-58993r1_chk","severity":"medium","gid":"V-17417","rid":"SV-54855r2_rule","stig_id":"WNFWA-000003","gtitle":"Windows Firewall Public - Enable Firewall","fix_id":"F-63483r1_fix","documentable":null,"cci":["CCI-001414"],"nist":["AC-4"]}},{"id":"SV-54859","code":"control 'SV-54859' do\n  title 'The Windows Firewall with Advanced Security must block unsolicited inbound connections when connected to a domain.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Unsolicited inbound connections may be malicious attempts to gain access to a system.  Unsolicited inbound connections, for which there is no rule allowing the connection, will be blocked in the domain.'\n  desc 'check', \"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\DomainProfile\\\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\DomainProfile\\\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> State, \"Inbound connections\" to \"Block (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command.'\n  impact 0.7\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61085r1_chk'\n  tag severity: 'high'\n  tag gid: 'V-17418'\n  tag rid: 'SV-54859r3_rule'\n  tag stig_id: 'WNFWA-000004'\n  tag gtitle: 'Windows Firewall Domain - Inbound'\n  tag fix_id: 'F-63485r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54859.rb"},"title":"The Windows Firewall with Advanced Security must block unsolicited inbound connections when connected to a domain.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Unsolicited inbound connections may be malicious attempts to gain access to a system.  Unsolicited inbound connections, for which there is no rule allowing the connection, will be blocked in the domain.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Unsolicited inbound connections may be malicious attempts to gain access to a system.  Unsolicited inbound connections, for which there is no rule allowing the connection, will be blocked in the domain.","check":"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> State, \"Inbound connections\" to \"Block (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command."},"impact":0.7,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61085r1_chk","severity":"high","gid":"V-17418","rid":"SV-54859r3_rule","stig_id":"WNFWA-000004","gtitle":"Windows Firewall Domain - Inbound","fix_id":"F-63485r1_fix","documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-54863","code":"control 'SV-54863' do\n  title 'The Windows Firewall with Advanced Security must allow outbound connections, unless a rule explicitly blocks the connection when connected to a domain.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Outbound connections are allowed in the domain, unless a rule explicitly blocks the connection.  This allows normal outbound communication, which could be restricted as necessary with additional rules.'\n  desc 'check', \"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\DomainProfile\\\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\DomainProfile\\\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> State, \"Outbound connections\" to \"Allow (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command.'\n  impact 0.5\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61087r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-17419'\n  tag rid: 'SV-54863r3_rule'\n  tag stig_id: 'WNFWA-000005'\n  tag gtitle: 'Windows Firewall Domain - Outbound'\n  tag fix_id: 'F-63487r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001094']\n  tag nist: ['SC-5 (1)']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54863.rb"},"title":"The Windows Firewall with Advanced Security must allow outbound connections, unless a rule explicitly blocks the connection when connected to a domain.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Outbound connections are allowed in the domain, unless a rule explicitly blocks the connection.  This allows normal outbound communication, which could be restricted as necessary with additional rules.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Outbound connections are allowed in the domain, unless a rule explicitly blocks the connection.  This allows normal outbound communication, which could be restricted as necessary with additional rules.","check":"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> State, \"Outbound connections\" to \"Allow (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61087r1_chk","severity":"medium","gid":"V-17419","rid":"SV-54863r3_rule","stig_id":"WNFWA-000005","gtitle":"Windows Firewall Domain - Outbound","fix_id":"F-63487r1_fix","documentable":null,"cci":["CCI-001094"],"nist":["SC-5 (1)"]}},{"id":"SV-54874","code":"control 'SV-54874' do\n  title 'The Windows Firewall with Advanced Security log size must be configured for domain connections.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  The firewall log file size for a domain connection will be set to ensure enough capacity is allocated for audit data.'\n  desc 'check', \"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\DomainProfile\\\\Logging\\\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\DomainProfile\\\\Logging\\\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> Logging (select Customize), \"Size limit (KB):\" to \"16,384\" or greater.\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh command may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile logging maxfilesize 16384\" or greater.'\n  impact 0.3\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61095r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-17425'\n  tag rid: 'SV-54874r3_rule'\n  tag stig_id: 'WNFWA-000009'\n  tag gtitle: 'Windows Firewall Domain - Log Size'\n  tag fix_id: 'F-63495r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000140']\n  tag nist: ['AU-5 b']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54874.rb"},"title":"The Windows Firewall with Advanced Security log size must be configured for domain connections.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  The firewall log file size for a domain connection will be set to ensure enough capacity is allocated for audit data.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  The firewall log file size for a domain connection will be set to ensure enough capacity is allocated for audit data.","check":"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> Logging (select Customize), \"Size limit (KB):\" to \"16,384\" or greater.\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh command may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile logging maxfilesize 16384\" or greater."},"impact":0.3,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61095r1_chk","severity":"low","gid":"V-17425","rid":"SV-54874r3_rule","stig_id":"WNFWA-000009","gtitle":"Windows Firewall Domain - Log Size","fix_id":"F-63495r3_fix","documentable":null,"cci":["CCI-000140"],"nist":["AU-5 b"]}},{"id":"SV-54877","code":"control 'SV-54877' do\n  title 'The Windows Firewall with Advanced Security must log dropped packets when connected to a domain.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of dropped packets for a domain connection will be enabled to maintain an audit trail of potential issues.'\n  desc 'check', \"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\DomainProfile\\\\Logging\\\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\DomainProfile\\\\Logging\\\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> Logging (select Customize), \"Log dropped packets\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile logging droppedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging droppedconnections enable\".'\n  impact 0.3\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61097r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-17426'\n  tag rid: 'SV-54877r3_rule'\n  tag stig_id: 'WNFWA-000010'\n  tag gtitle: 'Windows Firewall Domain - Log Dropped Packets'\n  tag fix_id: 'F-63497r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54877.rb"},"title":"The Windows Firewall with Advanced Security must log dropped packets when connected to a domain.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of dropped packets for a domain connection will be enabled to maintain an audit trail of potential issues.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of dropped packets for a domain connection will be enabled to maintain an audit trail of potential issues.","check":"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> Logging (select Customize), \"Log dropped packets\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile logging droppedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging droppedconnections enable\"."},"impact":0.3,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61097r1_chk","severity":"low","gid":"V-17426","rid":"SV-54877r3_rule","stig_id":"WNFWA-000010","gtitle":"Windows Firewall Domain - Log Dropped Packets","fix_id":"F-63497r1_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-54878","code":"control 'SV-54878' do\n  title 'The Windows Firewall with Advanced Security must log successful connections when connected to a domain.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of successful connections for a domain connection will be enabled to maintain an audit trail if issues are discovered.'\n  desc 'check', \"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\DomainProfile\\\\Logging\\\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\DomainProfile\\\\Logging\\\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> Logging (select Customize), \"Log successful connections\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile logging allowedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging allowedconnections enable\".'\n  impact 0.3\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61099r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-17427'\n  tag rid: 'SV-54878r3_rule'\n  tag stig_id: 'WNFWA-000011'\n  tag gtitle: 'Windows FW Domain - Log Successful Connections'\n  tag fix_id: 'F-63917r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001462']\n  tag nist: ['AU-14 (2)']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54878.rb"},"title":"The Windows Firewall with Advanced Security must log successful connections when connected to a domain.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of successful connections for a domain connection will be enabled to maintain an audit trail if issues are discovered.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of successful connections for a domain connection will be enabled to maintain an audit trail if issues are discovered.","check":"If the system is not a member of a domain, the Domain Profile requirements can be marked NA.\n\nIf the system is a member of a domain and the firewall's Domain Profile is not enabled (see V-17415), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Domain Profile Tab -> Logging (select Customize), \"Log successful connections\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set domainprofile logging allowedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging allowedconnections enable\"."},"impact":0.3,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61099r1_chk","severity":"low","gid":"V-17427","rid":"SV-54878r3_rule","stig_id":"WNFWA-000011","gtitle":"Windows FW Domain - Log Successful Connections","fix_id":"F-63917r1_fix","documentable":null,"cci":["CCI-001462"],"nist":["AU-14 (2)"]}},{"id":"SV-54879","code":"control 'SV-54879' do\n  title 'The Windows Firewall with Advanced Security must block unsolicited inbound connections when connected to a private network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Unsolicited inbound connections may be malicious attempts to gain access to a system.  Unsolicited inbound connections, for which there is no rule allowing the connection, will be blocked on a private network.'\n  desc 'check', \"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PrivateProfile\\\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\StandardProfile\\\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> State, \"Inbound connections\" to \"Block (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command.'\n  impact 0.7\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61101r1_chk'\n  tag severity: 'high'\n  tag gid: 'V-17428'\n  tag rid: 'SV-54879r3_rule'\n  tag stig_id: 'WNFWA-000012'\n  tag gtitle: 'Windows Firewall Private â€“ Inbound'\n  tag fix_id: 'F-63499r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54879.rb"},"title":"The Windows Firewall with Advanced Security must block unsolicited inbound connections when connected to a private network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Unsolicited inbound connections may be malicious attempts to gain access to a system.  Unsolicited inbound connections, for which there is no rule allowing the connection, will be blocked on a private network.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Unsolicited inbound connections may be malicious attempts to gain access to a system.  Unsolicited inbound connections, for which there is no rule allowing the connection, will be blocked on a private network.","check":"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> State, \"Inbound connections\" to \"Block (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command."},"impact":0.7,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61101r1_chk","severity":"high","gid":"V-17428","rid":"SV-54879r3_rule","stig_id":"WNFWA-000012","gtitle":"Windows Firewall Private â€“ Inbound","fix_id":"F-63499r1_fix","documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-54890","code":"control 'SV-54890' do\n  title 'The Windows Firewall with Advanced Security must allow outbound connections, unless a rule explicitly blocks the connection when connected to a private network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Outbound connections are allowed on a private network, unless a rule explicitly blocks the connection.  This allows normal outbound communication, which could be restricted as necessary with additional rules.'\n  desc 'check', \"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PrivateProfile\\\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\StandardProfile\\\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> State, \"Outbound connections\" to \"Allow (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command.'\n  impact 0.5\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61103r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-17429'\n  tag rid: 'SV-54890r3_rule'\n  tag stig_id: 'WNFWA-000013'\n  tag gtitle: 'Windows Firewall Private - Outbound'\n  tag fix_id: 'F-63501r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001094']\n  tag nist: ['SC-5 (1)']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54890.rb"},"title":"The Windows Firewall with Advanced Security must allow outbound connections, unless a rule explicitly blocks the connection when connected to a private network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Outbound connections are allowed on a private network, unless a rule explicitly blocks the connection.  This allows normal outbound communication, which could be restricted as necessary with additional rules.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Outbound connections are allowed on a private network, unless a rule explicitly blocks the connection.  This allows normal outbound communication, which could be restricted as necessary with additional rules.","check":"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> State, \"Outbound connections\" to \"Allow (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61103r1_chk","severity":"medium","gid":"V-17429","rid":"SV-54890r3_rule","stig_id":"WNFWA-000013","gtitle":"Windows Firewall Private - Outbound","fix_id":"F-63501r1_fix","documentable":null,"cci":["CCI-001094"],"nist":["SC-5 (1)"]}},{"id":"SV-54903","code":"control 'SV-54903' do\n  title 'The Windows Firewall with Advanced Security log size must be configured for private network connections.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  The firewall log file size for a private connection will be set  to ensure enough capacity is allocated for audit data.'\n  desc 'check', \"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PrivateProfile\\\\Logging\\\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\StandardProfile\\\\Logging\\\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> Logging (select Customize), \"Size limit (KB)\" to \"16,384\" or greater.\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh command may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile logging maxfilesize 16384\" or greater.'\n  impact 0.3\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61111r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-17435'\n  tag rid: 'SV-54903r3_rule'\n  tag stig_id: 'WNFWA-000017'\n  tag gtitle: 'Windows Firewall Private - Log Size'\n  tag fix_id: 'F-63509r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000140']\n  tag nist: ['AU-5 b']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54903.rb"},"title":"The Windows Firewall with Advanced Security log size must be configured for private network connections.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  The firewall log file size for a private connection will be set  to ensure enough capacity is allocated for audit data.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  The firewall log file size for a private connection will be set  to ensure enough capacity is allocated for audit data.","check":"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> Logging (select Customize), \"Size limit (KB)\" to \"16,384\" or greater.\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh command may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile logging maxfilesize 16384\" or greater."},"impact":0.3,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61111r1_chk","severity":"low","gid":"V-17435","rid":"SV-54903r3_rule","stig_id":"WNFWA-000017","gtitle":"Windows Firewall Private - Log Size","fix_id":"F-63509r3_fix","documentable":null,"cci":["CCI-000140"],"nist":["AU-5 b"]}},{"id":"SV-54904","code":"control 'SV-54904' do\n  title 'The Windows Firewall with Advanced Security must log dropped packets when connected to a private network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.   Logging of dropped packets for a private network connection will be enabled  to maintain an audit trail of potential issues.'\n  desc 'check', \"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PrivateProfile\\\\Logging\\\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\StandardProfile\\\\Logging\\\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> Logging (select Customize), \"Log dropped packets\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile logging droppedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging droppedconnections enable\".'\n  impact 0.3\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61113r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-17436'\n  tag rid: 'SV-54904r3_rule'\n  tag stig_id: 'WNFWA-000018'\n  tag gtitle: 'Windows Firewall Private - Log Dropped Packets'\n  tag fix_id: 'F-63511r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54904.rb"},"title":"The Windows Firewall with Advanced Security must log dropped packets when connected to a private network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.   Logging of dropped packets for a private network connection will be enabled  to maintain an audit trail of potential issues.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.   Logging of dropped packets for a private network connection will be enabled  to maintain an audit trail of potential issues.","check":"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> Logging (select Customize), \"Log dropped packets\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile logging droppedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging droppedconnections enable\"."},"impact":0.3,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61113r1_chk","severity":"low","gid":"V-17436","rid":"SV-54904r3_rule","stig_id":"WNFWA-000018","gtitle":"Windows Firewall Private - Log Dropped Packets","fix_id":"F-63511r1_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-54905","code":"control 'SV-54905' do\n  title 'The Windows Firewall with Advanced Security must log successful connections when connected to a private network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of successful connections for a private network connection will be enabled  to maintain an audit trail if issues are discovered.'\n  desc 'check', \"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PrivateProfile\\\\Logging\\\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\StandardProfile\\\\Logging\\\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> Logging (select Customize), \"Logged successful connections\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile logging allowedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging allowedconnections enable\".'\n  impact 0.3\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61115r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-17437'\n  tag rid: 'SV-54905r3_rule'\n  tag stig_id: 'WNFWA-000019'\n  tag gtitle: 'Windows FW Private - Log Successful Connections'\n  tag fix_id: 'F-63513r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001462']\n  tag nist: ['AU-14 (2)']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54905.rb"},"title":"The Windows Firewall with Advanced Security must log successful connections when connected to a private network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of successful connections for a private network connection will be enabled  to maintain an audit trail if issues are discovered.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of successful connections for a private network connection will be enabled  to maintain an audit trail if issues are discovered.","check":"If the firewall's Private Profile is not enabled (see V-17416), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> Logging (select Customize), \"Logged successful connections\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set privateprofile logging allowedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging allowedconnections enable\"."},"impact":0.3,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61115r1_chk","severity":"low","gid":"V-17437","rid":"SV-54905r3_rule","stig_id":"WNFWA-000019","gtitle":"Windows FW Private - Log Successful Connections","fix_id":"F-63513r1_fix","documentable":null,"cci":["CCI-001462"],"nist":["AU-14 (2)"]}},{"id":"SV-54906","code":"control 'SV-54906' do\n  title 'The Windows Firewall with Advanced Security must block unsolicited inbound connections when connected to a public network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Unsolicited inbound connections may be malicious attempts to gain access to a system.  Unsolicited inbound connections, for which there is no rule allowing the connection, will be blocked on a public network.'\n  desc 'check', \"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PublicProfile\\\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\PublicProfile\\\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> State, \"Inbound connections\" to \"Block (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command.'\n  impact 0.7\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61117r1_chk'\n  tag severity: 'high'\n  tag gid: 'V-17438'\n  tag rid: 'SV-54906r3_rule'\n  tag stig_id: 'WNFWA-000020'\n  tag gtitle: 'Windows Firewall Public â€“ Inbound'\n  tag fix_id: 'F-63515r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54906.rb"},"title":"The Windows Firewall with Advanced Security must block unsolicited inbound connections when connected to a public network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Unsolicited inbound connections may be malicious attempts to gain access to a system.  Unsolicited inbound connections, for which there is no rule allowing the connection, will be blocked on a public network.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Unsolicited inbound connections may be malicious attempts to gain access to a system.  Unsolicited inbound connections, for which there is no rule allowing the connection, will be blocked on a public network.","check":"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\\n\nValue Name:  DefaultInboundAction\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> State, \"Inbound connections\" to \"Block (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command."},"impact":0.7,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61117r1_chk","severity":"high","gid":"V-17438","rid":"SV-54906r3_rule","stig_id":"WNFWA-000020","gtitle":"Windows Firewall Public â€“ Inbound","fix_id":"F-63515r1_fix","documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-54908","code":"control 'SV-54908' do\n  title 'The Windows Firewall with Advanced Security must allow outbound connections, unless a rule explicitly blocks the connection when connected to a public network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Outbound connections are allowed on a public network, unless a rule explicitly blocks the connection.  This allows normal outbound communication, which could be restricted as necessary with additional rules.'\n  desc 'check', \"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PublicProfile\\\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\PublicProfile\\\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> State, \"Outbound connections\" to \"Allow (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command.'\n  impact 0.5\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61121r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-17439'\n  tag rid: 'SV-54908r3_rule'\n  tag stig_id: 'WNFWA-000021'\n  tag gtitle: 'Windows Firewall Public - Outbound'\n  tag fix_id: 'F-63517r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001094']\n  tag nist: ['SC-5 (1)']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54908.rb"},"title":"The Windows Firewall with Advanced Security must allow outbound connections, unless a rule explicitly blocks the connection when connected to a public network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Outbound connections are allowed on a public network, unless a rule explicitly blocks the connection.  This allows normal outbound communication, which could be restricted as necessary with additional rules.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Outbound connections are allowed on a public network, unless a rule explicitly blocks the connection.  This allows normal outbound communication, which could be restricted as necessary with additional rules.","check":"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\\n\nValue Name:  DefaultOutboundAction\n\nType:  REG_DWORD\nValue:  0x00000000 (0)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> State, \"Outbound connections\" to \"Allow (default)\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile firewallpolicy blockinbound,allowoutbound\".\nOr\n\"Netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound\".\nBoth inbound and outbound parameters must be specified to execute this command."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61121r1_chk","severity":"medium","gid":"V-17439","rid":"SV-54908r3_rule","stig_id":"WNFWA-000021","gtitle":"Windows Firewall Public - Outbound","fix_id":"F-63517r1_fix","documentable":null,"cci":["CCI-001094"],"nist":["SC-5 (1)"]}},{"id":"SV-54917","code":"control 'SV-54917' do\n  title 'The Windows Firewall with Advanced Security local firewall rules must not be merged with Group Policy settings when connected to a public network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Local firewall rules will not be merged with Group Policy settings on a public network to prevent Group Policy settings from being changed.'\n  desc 'check', \"If the system is not a member of a domain, this is NA.\n\nIf the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nVerify the registry value below.\n\nIf this registry value does not exist or is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PublicProfile\\\\\n\nValue Name:  AllowLocalPolicyMerge\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\"\n  desc 'fix', 'If the system is not a member of a domain, this is NA.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Settings (select Customize) -> Rule merging, \"Apply local firewall rules:\" to \"No\".'\n  impact 0.5\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61129r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-17442'\n  tag rid: 'SV-54917r3_rule'\n  tag stig_id: 'WNFWA-000024'\n  tag gtitle: 'Windows Firewall Public - Local Firewall Rules'\n  tag fix_id: 'F-63523r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001190']\n  tag nist: ['SC-24']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54917.rb"},"title":"The Windows Firewall with Advanced Security local firewall rules must not be merged with Group Policy settings when connected to a public network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Local firewall rules will not be merged with Group Policy settings on a public network to prevent Group Policy settings from being changed.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Local firewall rules will not be merged with Group Policy settings on a public network to prevent Group Policy settings from being changed.","check":"If the system is not a member of a domain, this is NA.\n\nIf the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nVerify the registry value below.\n\nIf this registry value does not exist or is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\\n\nValue Name:  AllowLocalPolicyMerge\n\nType:  REG_DWORD\nValue:  0x00000000 (0)","fix":"If the system is not a member of a domain, this is NA.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Settings (select Customize) -> Rule merging, \"Apply local firewall rules:\" to \"No\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61129r1_chk","severity":"medium","gid":"V-17442","rid":"SV-54917r3_rule","stig_id":"WNFWA-000024","gtitle":"Windows Firewall Public - Local Firewall Rules","fix_id":"F-63523r1_fix","documentable":null,"cci":["CCI-001190"],"nist":["SC-24"]}},{"id":"SV-54918","code":"control 'SV-54918' do\n  title 'The Windows Firewall with Advanced Security local connection rules must not be merged with Group Policy settings when connected to a public network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Local connection rules will not be merged with Group Policy settings on a public network to prevent Group Policy settings from being changed.'\n  desc 'check', \"If the system is not a member of a domain, this is NA.\n\nIf the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nVerify the registry value below.\n\nIf this registry value does not exist or is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PublicProfile\\\\\n\nValue Name:  AllowLocalIPsecPolicyMerge\n\nType:  REG_DWORD\nValue:  0x00000000 (0)\"\n  desc 'fix', 'If the system is not a member of a domain, this is NA.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Settings (select Customize) -> Rule merging, \"Apply local connection security rules:\" to \"No\".'\n  impact 0.5\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61133r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-17443'\n  tag rid: 'SV-54918r3_rule'\n  tag stig_id: 'WNFWA-000025'\n  tag gtitle: 'Windows Firewall Public - Local Connection Rules'\n  tag fix_id: 'F-63525r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001190']\n  tag nist: ['SC-24']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54918.rb"},"title":"The Windows Firewall with Advanced Security local connection rules must not be merged with Group Policy settings when connected to a public network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Local connection rules will not be merged with Group Policy settings on a public network to prevent Group Policy settings from being changed.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Local connection rules will not be merged with Group Policy settings on a public network to prevent Group Policy settings from being changed.","check":"If the system is not a member of a domain, this is NA.\n\nIf the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nVerify the registry value below.\n\nIf this registry value does not exist or is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\\n\nValue Name:  AllowLocalIPsecPolicyMerge\n\nType:  REG_DWORD\nValue:  0x00000000 (0)","fix":"If the system is not a member of a domain, this is NA.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Settings (select Customize) -> Rule merging, \"Apply local connection security rules:\" to \"No\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61133r1_chk","severity":"medium","gid":"V-17443","rid":"SV-54918r3_rule","stig_id":"WNFWA-000025","gtitle":"Windows Firewall Public - Local Connection Rules","fix_id":"F-63525r1_fix","documentable":null,"cci":["CCI-001190"],"nist":["SC-24"]}},{"id":"SV-54921","code":"control 'SV-54921' do\n  title 'The Windows Firewall with Advanced Security log size must be configured for public network connections.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  The firewall log file size for a public network connection will be set  to ensure enough capacity is allocated for audit data.'\n  desc 'check', \"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PublicProfile\\\\Logging\\\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\PublicProfile\\\\Logging\\\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Logging (select Customize), \"Size limit (KB)\" to \"16,384\" or greater.\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh command may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile logging maxfilesize 16384\" or greater.'\n  impact 0.3\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61137r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-17445'\n  tag rid: 'SV-54921r3_rule'\n  tag stig_id: 'WNFWA-000027'\n  tag gtitle: 'Windows Firewall Public - Log Size'\n  tag fix_id: 'F-63529r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000140']\n  tag nist: ['AU-5 b']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54921.rb"},"title":"The Windows Firewall with Advanced Security log size must be configured for public network connections.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  The firewall log file size for a public network connection will be set  to ensure enough capacity is allocated for audit data.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  The firewall log file size for a public network connection will be set  to ensure enough capacity is allocated for audit data.","check":"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging\\\n\nValue Name:  LogFileSize\n\nType:  REG_DWORD\nValue:  0x00004000 (16384) (or greater)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Logging (select Customize), \"Size limit (KB)\" to \"16,384\" or greater.\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh command may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile logging maxfilesize 16384\" or greater."},"impact":0.3,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61137r1_chk","severity":"low","gid":"V-17445","rid":"SV-54921r3_rule","stig_id":"WNFWA-000027","gtitle":"Windows Firewall Public - Log Size","fix_id":"F-63529r2_fix","documentable":null,"cci":["CCI-000140"],"nist":["AU-5 b"]}},{"id":"SV-54922","code":"control 'SV-54922' do\n  title 'The Windows Firewall with Advanced Security must log dropped packets when connected to a public network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of dropped packets for a public network connection will be enabled  to maintain an audit trail of potential issues.'\n  desc 'check', \"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PublicProfile\\\\Logging\\\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\PublicProfile\\\\Logging\\\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Logging (select Customize), \"Log dropped packets\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile logging droppedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging droppedconnections enable\".'\n  impact 0.3\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61141r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-17446'\n  tag rid: 'SV-54922r3_rule'\n  tag stig_id: 'WNFWA-000028'\n  tag gtitle: 'Windows Firewall Public - Log Dropped Packets'\n  tag fix_id: 'F-63531r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54922.rb"},"title":"The Windows Firewall with Advanced Security must log dropped packets when connected to a public network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of dropped packets for a public network connection will be enabled  to maintain an audit trail of potential issues.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of dropped packets for a public network connection will be enabled  to maintain an audit trail of potential issues.","check":"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging\\\n\nValue Name:  LogDroppedPackets\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Logging (select Customize), \"Log dropped packets\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile logging droppedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging droppedconnections enable\"."},"impact":0.3,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61141r1_chk","severity":"low","gid":"V-17446","rid":"SV-54922r3_rule","stig_id":"WNFWA-000028","gtitle":"Windows Firewall Public - Log Dropped Packets","fix_id":"F-63531r1_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-54923","code":"control 'SV-54923' do\n  title 'The Windows Firewall with Advanced Security must log successful connections when connected to a public network.'\n  desc 'A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of successful connections for a public network connection will be enabled to maintain an audit trail if issues are discovered.'\n  desc 'check', \"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\WindowsFirewall\\\\PublicProfile\\\\Logging\\\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\PublicProfile\\\\Logging\\\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\"\n  desc 'fix', 'The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Logging (select Customize), \"Logged successful connections\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile logging allowedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging allowedconnections enable\".'\n  impact 0.3\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-61143r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-17447'\n  tag rid: 'SV-54923r3_rule'\n  tag stig_id: 'WNFWA-000029'\n  tag gtitle: 'Windows FW Public - Log Successful Connections'\n  tag fix_id: 'F-63533r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001462']\n  tag nist: ['AU-14 (2)']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-54923.rb"},"title":"The Windows Firewall with Advanced Security must log successful connections when connected to a public network.","desc":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of successful connections for a public network connection will be enabled to maintain an audit trail if issues are discovered.","descriptions":{"default":"A firewall provides a line of defense against attack.  To be effective, it must be enabled and properly configured.  Logging of successful connections for a public network connection will be enabled to maintain an audit trail if issues are discovered.","check":"If the firewall's Public Profile is not enabled (see V-17417), this requirement is also a finding.\n\nIf the following policy-based registry value exists and is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)\n\nIf the policy-based registry value does not exist, verify the following registry value. If it is not configured as specified, this is a finding.\n\nRegistry Hive:  HKEY_LOCAL_MACHINE\nRegistry Path:  \\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging\\\n\nValue Name:  LogSuccessfulConnections\n\nType:  REG_DWORD\nValue:  0x00000001 (1)","fix":"The preferred method of configuring the firewall settings is with a policy, particularly in a domain environment.\n\nConfigure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Public Profile Tab -> Logging (select Customize), \"Logged successful connections\" to \"Yes\".\n\nIn addition to using policies, systems may also be configured using the firewall GUI or Netsh commands.  These methods may be more appropriate for standalone systems.\nThe configuration settings in the GUI are the same as those specified in the policy above.  Windows Firewall Properties will be a link in the center pane after opening Windows Firewall with Advanced Security.\n\nThe following Netsh commands may also be used to configure this setting:\n\"Netsh advfirewall set publicprofile logging allowedconnections enable\".\nOr\n\"Netsh advfirewall set allprofiles logging allowedconnections enable\"."},"impact":0.3,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-61143r1_chk","severity":"low","gid":"V-17447","rid":"SV-54923r3_rule","stig_id":"WNFWA-000029","gtitle":"Windows FW Public - Log Successful Connections","fix_id":"F-63533r1_fix","documentable":null,"cci":["CCI-001462"],"nist":["AU-14 (2)"]}},{"id":"SV-55086","code":"control 'SV-55086' do\n  title 'Inbound exceptions to the firewall on domain workstations must only allow authorized remote management hosts.'\n  desc 'Allowing inbound access to domain workstations from other systems may allow lateral movement across systems if credentials are compromised.  Limiting inbound connections only from authorized remote management systems will help limit this exposure.'\n  desc 'check', 'This requirement is NA for servers and non domain workstations.\n\nVerify firewall exceptions for inbound connections on domain workstations only allow authorized management systems and remote management hosts.\n\nReview inbound firewall exception rules in Windows Firewall with Advanced Security. Firewall rules can be complex and should be reviewed with the firewall administrator.\n\nOne method for restricting inbound connections is to only allow exceptions for a specific scope of remote IP addresses.\n\nIf allowed inbound exceptions are not limited to authorized management systems and remote management hosts, this is a finding.'\n  desc 'fix', 'Ensure firewall exceptions to inbound connections on domain workstations only allow authorized management systems and remote management hosts.\n\nFirewall rules can be complex and should be thoroughly tested before applying in a production environment.\n\nOne method for restricting inbound connections is to only allow exceptions for a specific scope of remote IP addresses. For any inbound rules that allow connections from other systems, configure the Scope for Remote IP addresses to those of authorized management systems and remote management hosts. This may be defined as an IP address, subnet, or range. Apply the rule to all firewall profiles.'\n  impact 0.5\n  ref 'DPMS Target Windows Firewall with Advanced Security'\n  tag check_id: 'C-48768r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-36440'\n  tag rid: 'SV-55086r1_rule'\n  tag stig_id: 'WNFWA-000100'\n  tag gtitle: 'Inbound Firewall Exception for Administration'\n  tag fix_id: 'F-47957r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000067']\n  tag nist: ['AC-17 (1)']\nend","source_location":{"line":1,"ref":"U_Windows_Firewall_STIG_V1R7/controls/SV-55086.rb"},"title":"Inbound exceptions to the firewall on domain workstations must only allow authorized remote management hosts.","desc":"Allowing inbound access to domain workstations from other systems may allow lateral movement across systems if credentials are compromised.  Limiting inbound connections only from authorized remote management systems will help limit this exposure.","descriptions":{"default":"Allowing inbound access to domain workstations from other systems may allow lateral movement across systems if credentials are compromised.  Limiting inbound connections only from authorized remote management systems will help limit this exposure.","check":"This requirement is NA for servers and non domain workstations.\n\nVerify firewall exceptions for inbound connections on domain workstations only allow authorized management systems and remote management hosts.\n\nReview inbound firewall exception rules in Windows Firewall with Advanced Security. Firewall rules can be complex and should be reviewed with the firewall administrator.\n\nOne method for restricting inbound connections is to only allow exceptions for a specific scope of remote IP addresses.\n\nIf allowed inbound exceptions are not limited to authorized management systems and remote management hosts, this is a finding.","fix":"Ensure firewall exceptions to inbound connections on domain workstations only allow authorized management systems and remote management hosts.\n\nFirewall rules can be complex and should be thoroughly tested before applying in a production environment.\n\nOne method for restricting inbound connections is to only allow exceptions for a specific scope of remote IP addresses. For any inbound rules that allow connections from other systems, configure the Scope for Remote IP addresses to those of authorized management systems and remote management hosts. This may be defined as an IP address, subnet, or range. Apply the rule to all firewall profiles."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows Firewall with Advanced Security"}],"tags":{"check_id":"C-48768r1_chk","severity":"medium","gid":"V-36440","rid":"SV-55086r1_rule","stig_id":"WNFWA-000100","gtitle":"Inbound Firewall Exception for Administration","fix_id":"F-47957r2_fix","documentable":null,"cci":["CCI-000067"],"nist":["AC-17 (1)"]}}],"groups":[{"id":"controls/SV-54833.rb","title":null,"controls":["SV-54833"]},{"id":"controls/SV-54849.rb","title":null,"controls":["SV-54849"]},{"id":"controls/SV-54855.rb","title":null,"controls":["SV-54855"]},{"id":"controls/SV-54859.rb","title":null,"controls":["SV-54859"]},{"id":"controls/SV-54863.rb","title":null,"controls":["SV-54863"]},{"id":"controls/SV-54874.rb","title":null,"controls":["SV-54874"]},{"id":"controls/SV-54877.rb","title":null,"controls":["SV-54877"]},{"id":"controls/SV-54878.rb","title":null,"controls":["SV-54878"]},{"id":"controls/SV-54879.rb","title":null,"controls":["SV-54879"]},{"id":"controls/SV-54890.rb","title":null,"controls":["SV-54890"]},{"id":"controls/SV-54903.rb","title":null,"controls":["SV-54903"]},{"id":"controls/SV-54904.rb","title":null,"controls":["SV-54904"]},{"id":"controls/SV-54905.rb","title":null,"controls":["SV-54905"]},{"id":"controls/SV-54906.rb","title":null,"controls":["SV-54906"]},{"id":"controls/SV-54908.rb","title":null,"controls":["SV-54908"]},{"id":"controls/SV-54917.rb","title":null,"controls":["SV-54917"]},{"id":"controls/SV-54918.rb","title":null,"controls":["SV-54918"]},{"id":"controls/SV-54921.rb","title":null,"controls":["SV-54921"]},{"id":"controls/SV-54922.rb","title":null,"controls":["SV-54922"]},{"id":"controls/SV-54923.rb","title":null,"controls":["SV-54923"]},{"id":"controls/SV-55086.rb","title":null,"controls":["SV-55086"]}],"name":"Windows_Firewall","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"bab18711fc282e159c09c4a6c477415bbd43ae0ca83abea5478bb33cefed3733","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
