{"controls":[{"id":"SV-239743","code":"control 'SV-239743' do\n  title 'vSphere Client must limit the amount of time that each TCP connection is kept alive.'\n  desc 'Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests. \n\nIn Virgo, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the request URI line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=\"9090\"]/@connectionTimeout' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nconnectionTimeout=\"20000\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nconnectionTimeout=\"20000\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42976r679454_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239743'\n  tag rid: 'SV-239743r879511_rule'\n  tag stig_id: 'VCFL-67-000001'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-42935r679455_fix'\n  tag satisfies: ['SRG-APP-000001-WSR-000001', 'SRG-APP-000435-WSR-000148']\n  tag 'documentable'\n  tag cci: ['CCI-000054', 'CCI-002385']\n  tag nist: ['AC-10', 'SC-5 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239743.rb"},"title":"vSphere Client must limit the amount of time that each TCP connection is kept alive.","desc":"Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests. \n\nIn Virgo, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the request URI line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.\n\n","descriptions":{"default":"Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests. \n\nIn Virgo, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the request URI line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.\n\n","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=\"9090\"]/@connectionTimeout' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nconnectionTimeout=\"20000\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nconnectionTimeout=\"20000\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42976r679454_chk","severity":"medium","gid":"V-239743","rid":"SV-239743r879511_rule","stig_id":"VCFL-67-000001","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-42935r679455_fix","satisfies":["SRG-APP-000001-WSR-000001","SRG-APP-000435-WSR-000148"],"documentable":null,"cci":["CCI-000054","CCI-002385"],"nist":["AC-10","SC-5 a"]}},{"id":"SV-239744","code":"control 'SV-239744' do\n  title 'vSphere Client must limit the number of concurrent connections permitted.'\n  desc 'Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash.\n\nMitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Virgo, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the \"maxThreads\" attribute.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@maxThreads' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nmaxThreads=\"800\" maxThreads=\"800\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nmaxThreads=\"800\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42977r679457_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239744'\n  tag rid: 'SV-239744r879511_rule'\n  tag stig_id: 'VCFL-67-000002'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-42936r679458_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239744.rb"},"title":"vSphere Client must limit the number of concurrent connections permitted.","desc":"Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash.\n\nMitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Virgo, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the \"maxThreads\" attribute.","descriptions":{"default":"Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash.\n\nMitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Virgo, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the \"maxThreads\" attribute.","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@maxThreads' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nmaxThreads=\"800\" maxThreads=\"800\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nmaxThreads=\"800\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42977r679457_chk","severity":"medium","gid":"V-239744","rid":"SV-239744r879511_rule","stig_id":"VCFL-67-000002","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-42936r679458_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-239745","code":"control 'SV-239745' do\n  title 'vSphere Client must limit the maximum size of a POST request.'\n  desc 'The \"maxPostSize\" value is the maximum size in bytes of the POST that will be handled by the container FORM URL parameter parsing. Limit its size to reduce exposure to a denial-of-service attack. \n\nIf \"maxPostSize\" is not set, the default value of 2097152 (2MB) is used. Security Token Service is configured in its shipping state to not set a value for \"maxPostSize\".'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@maxPostSize' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for \"maxPostSize\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42978r679460_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239745'\n  tag rid: 'SV-239745r879511_rule'\n  tag stig_id: 'VCFL-67-000003'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-42937r679461_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239745.rb"},"title":"vSphere Client must limit the maximum size of a POST request.","desc":"The \"maxPostSize\" value is the maximum size in bytes of the POST that will be handled by the container FORM URL parameter parsing. Limit its size to reduce exposure to a denial-of-service attack. \n\nIf \"maxPostSize\" is not set, the default value of 2097152 (2MB) is used. Security Token Service is configured in its shipping state to not set a value for \"maxPostSize\".","descriptions":{"default":"The \"maxPostSize\" value is the maximum size in bytes of the POST that will be handled by the container FORM URL parameter parsing. Limit its size to reduce exposure to a denial-of-service attack. \n\nIf \"maxPostSize\" is not set, the default value of 2097152 (2MB) is used. Security Token Service is configured in its shipping state to not set a value for \"maxPostSize\".","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@maxPostSize' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for \"maxPostSize\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42978r679460_chk","severity":"medium","gid":"V-239745","rid":"SV-239745r879511_rule","stig_id":"VCFL-67-000003","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-42937r679461_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-239746","code":"control 'SV-239746' do\n  title 'vSphere Client must protect cookies from XSS.'\n  desc 'Cookies are a common way to save session state over the HTTP(S) protocol. If an attacker can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. \n\nWhen a cookie is tagged with the \"HttpOnly\" flag, it tells the browser that this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --xpath '/Context/@useHttpOnly' /usr/lib/vmware-vsphere-client/server/configuration/context.xml\n\nExpected result:\n\nuseHttpOnly=\"true\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/context.xml.\n\nConfigure the <Context> node as follows:\n\n<Context useHttpOnly=\"true\">'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42979r679463_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239746'\n  tag rid: 'SV-239746r879511_rule'\n  tag stig_id: 'VCFL-67-000004'\n  tag gtitle: 'SRG-APP-000001-WSR-000002'\n  tag fix_id: 'F-42938r679464_fix'\n  tag satisfies: ['SRG-APP-000001-WSR-000002', 'SRG-APP-000223-WSR-000011', 'SRG-APP-000439-WSR-000154']\n  tag 'documentable'\n  tag cci: ['CCI-000054', 'CCI-001664', 'CCI-002418']\n  tag nist: ['AC-10', 'SC-23 (3)', 'SC-8']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239746.rb"},"title":"vSphere Client must protect cookies from XSS.","desc":"Cookies are a common way to save session state over the HTTP(S) protocol. If an attacker can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. \n\nWhen a cookie is tagged with the \"HttpOnly\" flag, it tells the browser that this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.\n\n","descriptions":{"default":"Cookies are a common way to save session state over the HTTP(S) protocol. If an attacker can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. \n\nWhen a cookie is tagged with the \"HttpOnly\" flag, it tells the browser that this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.\n\n","check":"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Context/@useHttpOnly' /usr/lib/vmware-vsphere-client/server/configuration/context.xml\n\nExpected result:\n\nuseHttpOnly=\"true\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/context.xml.\n\nConfigure the <Context> node as follows:\n\n<Context useHttpOnly=\"true\">"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42979r679463_chk","severity":"medium","gid":"V-239746","rid":"SV-239746r879511_rule","stig_id":"VCFL-67-000004","gtitle":"SRG-APP-000001-WSR-000002","fix_id":"F-42938r679464_fix","satisfies":["SRG-APP-000001-WSR-000002","SRG-APP-000223-WSR-000011","SRG-APP-000439-WSR-000154"],"documentable":null,"cci":["CCI-000054","CCI-001664","CCI-002418"],"nist":["AC-10","SC-23 (3)","SC-8"]}},{"id":"SV-239747","code":"control 'SV-239747' do\n  title 'vSphere Client must be configured with FIPS 140-2 compliant ciphers for HTTPS connections.'\n  desc \"Encryption of data in flight is an essential element of protecting information confidentiality. If a web server uses weak or outdated encryption algorithms, the server's communications can potentially be compromised.\n\nThe US Federal Information Processing Standards (FIPS) publication 140-2, Security Requirements for Cryptographic Modules (FIPS 140-2), approved ciphers provide the maximum level of encryption possible for a private web server.\n\nThe Tomcat connector listening on 9443 comes preconfigured with appropriate FIPS ciphers by default, but this must be verified.\n\n\"\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/SSLHostConfig/@ciphers' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nciphers=\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure that the SSLHostConfig contains the following value:\n\nciphers=\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA\"'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42980r679466_chk'\n  tag severity: 'high'\n  tag gid: 'V-239747'\n  tag rid: 'SV-239747r879519_rule'\n  tag stig_id: 'VCFL-67-000005'\n  tag gtitle: 'SRG-APP-000014-WSR-000006'\n  tag fix_id: 'F-42939r679467_fix'\n  tag satisfies: ['SRG-APP-000014-WSR-000006', 'SRG-APP-000179-WSR-000110', 'SRG-APP-000439-WSR-000188']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-002418']\n  tag nist: ['AC-17 (2)', 'SC-8']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239747.rb"},"title":"vSphere Client must be configured with FIPS 140-2 compliant ciphers for HTTPS connections.","desc":"Encryption of data in flight is an essential element of protecting information confidentiality. If a web server uses weak or outdated encryption algorithms, the server's communications can potentially be compromised.\n\nThe US Federal Information Processing Standards (FIPS) publication 140-2, Security Requirements for Cryptographic Modules (FIPS 140-2), approved ciphers provide the maximum level of encryption possible for a private web server.\n\nThe Tomcat connector listening on 9443 comes preconfigured with appropriate FIPS ciphers by default, but this must be verified.\n\n","descriptions":{"default":"Encryption of data in flight is an essential element of protecting information confidentiality. If a web server uses weak or outdated encryption algorithms, the server's communications can potentially be compromised.\n\nThe US Federal Information Processing Standards (FIPS) publication 140-2, Security Requirements for Cryptographic Modules (FIPS 140-2), approved ciphers provide the maximum level of encryption possible for a private web server.\n\nThe Tomcat connector listening on 9443 comes preconfigured with appropriate FIPS ciphers by default, but this must be verified.\n\n","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/SSLHostConfig/@ciphers' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nciphers=\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure that the SSLHostConfig contains the following value:\n\nciphers=\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA\""},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42980r679466_chk","severity":"high","gid":"V-239747","rid":"SV-239747r879519_rule","stig_id":"VCFL-67-000005","gtitle":"SRG-APP-000014-WSR-000006","fix_id":"F-42939r679467_fix","satisfies":["SRG-APP-000014-WSR-000006","SRG-APP-000179-WSR-000110","SRG-APP-000439-WSR-000188"],"documentable":null,"cci":["CCI-000068","CCI-002418"],"nist":["AC-17 (2)","SC-8"]}},{"id":"SV-239748","code":"control 'SV-239748' do\n  title 'vSphere Client must be configured to enable SSL/TLS.'\n  desc 'Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.\n\nHTTP connections in Virgo are managed through the Connector object. The vSphere Client endpoint has two connectors. One is behind a reverse proxy, which terminates TLS, and the other is serving SSL/TLS natively on 9443. The first will be addressed in a separate STIG, while this control addresses ensuring SSL/TLS is enabled on the 9443 connector.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/@SSLEnabled' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nSSLEnabled=\"true\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure that the <Connector> node with 'port=9443' contains the following value:\n\nSSLEnabled=\"true\")\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42981r679469_chk'\n  tag severity: 'high'\n  tag gid: 'V-239748'\n  tag rid: 'SV-239748r879520_rule'\n  tag stig_id: 'VCFL-67-000006'\n  tag gtitle: 'SRG-APP-000015-WSR-000014'\n  tag fix_id: 'F-42940r679470_fix'\n  tag satisfies: ['SRG-APP-000015-WSR-000014', 'SRG-APP-000172-WSR-000104', 'SRG-APP-000315-WSR-000004', 'SRG-APP-000439-WSR-000151', 'SRG-APP-000439-WSR-000152', 'SRG-APP-000439-WSR-000156', 'SRG-APP-000442-WSR-000182']\n  tag 'documentable'\n  tag cci: ['CCI-000197', 'CCI-000803', 'CCI-001453', 'CCI-002314', 'CCI-002418', 'CCI-002422']\n  tag nist: ['IA-5 (1) (c)', 'IA-7', 'AC-17 (2)', 'AC-17 (1)', 'SC-8', 'SC-8 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239748.rb"},"title":"vSphere Client must be configured to enable SSL/TLS.","desc":"Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.\n\nHTTP connections in Virgo are managed through the Connector object. The vSphere Client endpoint has two connectors. One is behind a reverse proxy, which terminates TLS, and the other is serving SSL/TLS natively on 9443. The first will be addressed in a separate STIG, while this control addresses ensuring SSL/TLS is enabled on the 9443 connector.\n\n","descriptions":{"default":"Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.\n\nHTTP connections in Virgo are managed through the Connector object. The vSphere Client endpoint has two connectors. One is behind a reverse proxy, which terminates TLS, and the other is serving SSL/TLS natively on 9443. The first will be addressed in a separate STIG, while this control addresses ensuring SSL/TLS is enabled on the 9443 connector.\n\n","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/@SSLEnabled' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nSSLEnabled=\"true\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure that the <Connector> node with 'port=9443' contains the following value:\n\nSSLEnabled=\"true\""},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42981r679469_chk","severity":"high","gid":"V-239748","rid":"SV-239748r879520_rule","stig_id":"VCFL-67-000006","gtitle":"SRG-APP-000015-WSR-000014","fix_id":"F-42940r679470_fix","satisfies":["SRG-APP-000015-WSR-000014","SRG-APP-000172-WSR-000104","SRG-APP-000315-WSR-000004","SRG-APP-000439-WSR-000151","SRG-APP-000439-WSR-000152","SRG-APP-000439-WSR-000156","SRG-APP-000442-WSR-000182"],"documentable":null,"cci":["CCI-000197","CCI-000803","CCI-001453","CCI-002314","CCI-002418","CCI-002422"],"nist":["IA-5 (1) (c)","IA-7","AC-17 (2)","AC-17 (1)","SC-8","SC-8 (2)"]}},{"id":"SV-239749","code":"control 'SV-239749' do\n  title 'vSphere Client must be configured to only communicate over TLS 1.2.'\n  desc 'Data exchanged between the user and the web server can range from static display data to credentials used to log in to the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.\n\nHTTP connections in Virgo are managed through the Connector object. The vSphere Client endpoint has two connectors. One is behind a reverse proxy that terminates TLS and the other is serving TLS natively on 9443. The first will be addressed in a separate STIG, while this control addresses ensuring TLS is enabled on the 9443 connector.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/SSLHostConfig/@protocols' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nprotocols=\"TLSv1.2\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure that the <SSLHostConfig> node contains the following value:\n\nprotocols=\"TLSv1.2\"'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42982r679472_chk'\n  tag severity: 'high'\n  tag gid: 'V-239749'\n  tag rid: 'SV-239749r879520_rule'\n  tag stig_id: 'VCFL-67-000007'\n  tag gtitle: 'SRG-APP-000015-WSR-000014'\n  tag fix_id: 'F-42941r679473_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001453']\n  tag nist: ['AC-17 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239749.rb"},"title":"vSphere Client must be configured to only communicate over TLS 1.2.","desc":"Data exchanged between the user and the web server can range from static display data to credentials used to log in to the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.\n\nHTTP connections in Virgo are managed through the Connector object. The vSphere Client endpoint has two connectors. One is behind a reverse proxy that terminates TLS and the other is serving TLS natively on 9443. The first will be addressed in a separate STIG, while this control addresses ensuring TLS is enabled on the 9443 connector.","descriptions":{"default":"Data exchanged between the user and the web server can range from static display data to credentials used to log in to the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.\n\nHTTP connections in Virgo are managed through the Connector object. The vSphere Client endpoint has two connectors. One is behind a reverse proxy that terminates TLS and the other is serving TLS natively on 9443. The first will be addressed in a separate STIG, while this control addresses ensuring TLS is enabled on the 9443 connector.","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/SSLHostConfig/@protocols' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nprotocols=\"TLSv1.2\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure that the <SSLHostConfig> node contains the following value:\n\nprotocols=\"TLSv1.2\""},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42982r679472_chk","severity":"high","gid":"V-239749","rid":"SV-239749r879520_rule","stig_id":"VCFL-67-000007","gtitle":"SRG-APP-000015-WSR-000014","fix_id":"F-42941r679473_fix","documentable":null,"cci":["CCI-001453"],"nist":["AC-17 (2)"]}},{"id":"SV-239750","code":"control 'SV-239750' do\n  title 'vSphere Client must be configured to use the HTTPS scheme.'\n  desc 'Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.\n\nHTTP connections in Virgo are managed through the Connector object. The vSphere Client endpoint has two connectors. One is behind a reverse proxy that terminates TLS and the other is serving TLS natively on 9443. The first will be addressed in a separate STIG, while this control addresses ensuring TLS is enabled on the 9443 connector.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/@scheme' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nscheme=\"https\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure that the <Connector> node with 'port=9443' contains the following value:\n\nscheme=\"https\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42983r679475_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239750'\n  tag rid: 'SV-239750r879520_rule'\n  tag stig_id: 'VCFL-67-000008'\n  tag gtitle: 'SRG-APP-000015-WSR-000014'\n  tag fix_id: 'F-42942r679476_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001453']\n  tag nist: ['AC-17 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239750.rb"},"title":"vSphere Client must be configured to use the HTTPS scheme.","desc":"Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.\n\nHTTP connections in Virgo are managed through the Connector object. The vSphere Client endpoint has two connectors. One is behind a reverse proxy that terminates TLS and the other is serving TLS natively on 9443. The first will be addressed in a separate STIG, while this control addresses ensuring TLS is enabled on the 9443 connector.","descriptions":{"default":"Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.\n\nHTTP connections in Virgo are managed through the Connector object. The vSphere Client endpoint has two connectors. One is behind a reverse proxy that terminates TLS and the other is serving TLS natively on 9443. The first will be addressed in a separate STIG, while this control addresses ensuring TLS is enabled on the 9443 connector.","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/@scheme' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nscheme=\"https\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure that the <Connector> node with 'port=9443' contains the following value:\n\nscheme=\"https\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42983r679475_chk","severity":"medium","gid":"V-239750","rid":"SV-239750r879520_rule","stig_id":"VCFL-67-000008","gtitle":"SRG-APP-000015-WSR-000014","fix_id":"F-42942r679476_fix","documentable":null,"cci":["CCI-001453"],"nist":["AC-17 (2)"]}},{"id":"SV-239751","code":"control 'SV-239751' do\n  title 'vSphere Client must record user access in a format that enables monitoring of remote access.'\n  desc %q(Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success.\n\nVirgo can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The AccessLogValve creates log files in the same format as those created by standard web servers. When AccessLogValve is properly configured, log files will contain all the forensic information necessary in the case of a security incident.\n\n)\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml | sed '2 s/xmlns=\".*\"//g' |  xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]'/@pattern -\n\nExpected result:\n\npattern=\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b %{#hashedSessionId#}s %I %D\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure the log pattern in the \"org.apache.catalina.valves.AccessLogValve\" node is set to the following:\n\npattern=\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b %{#hashedSessionId#}s %I %D\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42984r679478_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239751'\n  tag rid: 'SV-239751r879521_rule'\n  tag stig_id: 'VCFL-67-000009'\n  tag gtitle: 'SRG-APP-000016-WSR-000005'\n  tag fix_id: 'F-42943r679479_fix'\n  tag satisfies: ['SRG-APP-000016-WSR-000005', 'SRG-APP-000089-WSR-000047', 'SRG-APP-000092-WSR-000055', 'SRG-APP-000095-WSR-000056', 'SRG-APP-000096-WSR-000057', 'SRG-APP-000097-WSR-000058', 'SRG-APP-000098-WSR-000059', 'SRG-APP-000098-WSR-000060', 'SRG-APP-000099-WSR-000061', 'SRG-APP-000100-WSR-000064', 'SRG-APP-000374-WSR-000172', 'SRG-APP-000375-WSR-000171']\n  tag 'documentable'\n  tag cci: ['CCI-000067', 'CCI-000130', 'CCI-000131', 'CCI-000132', 'CCI-000133', 'CCI-000134', 'CCI-000169', 'CCI-001462', 'CCI-001464', 'CCI-001487', 'CCI-001889', 'CCI-001890']\n  tag nist: ['AC-17 (1)', 'AU-3 a', 'AU-3 b', 'AU-3 c', 'AU-3 d', 'AU-3 e', 'AU-12 a', 'AU-14 (2)', 'AU-14 (1)', 'AU-3 f', 'AU-8 b', 'AU-8 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239751.rb"},"title":"vSphere Client must record user access in a format that enables monitoring of remote access.","desc":"Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success.\n\nVirgo can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The AccessLogValve creates log files in the same format as those created by standard web servers. When AccessLogValve is properly configured, log files will contain all the forensic information necessary in the case of a security incident.\n\n","descriptions":{"default":"Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success.\n\nVirgo can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The AccessLogValve creates log files in the same format as those created by standard web servers. When AccessLogValve is properly configured, log files will contain all the forensic information necessary in the case of a security incident.\n\n","check":"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml | sed '2 s/xmlns=\".*\"//g' |  xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]'/@pattern -\n\nExpected result:\n\npattern=\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b %{#hashedSessionId#}s %I %D\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nEnsure the log pattern in the \"org.apache.catalina.valves.AccessLogValve\" node is set to the following:\n\npattern=\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b %{#hashedSessionId#}s %I %D\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42984r679478_chk","severity":"medium","gid":"V-239751","rid":"SV-239751r879521_rule","stig_id":"VCFL-67-000009","gtitle":"SRG-APP-000016-WSR-000005","fix_id":"F-42943r679479_fix","satisfies":["SRG-APP-000016-WSR-000005","SRG-APP-000089-WSR-000047","SRG-APP-000092-WSR-000055","SRG-APP-000095-WSR-000056","SRG-APP-000096-WSR-000057","SRG-APP-000097-WSR-000058","SRG-APP-000098-WSR-000059","SRG-APP-000098-WSR-000060","SRG-APP-000099-WSR-000061","SRG-APP-000100-WSR-000064","SRG-APP-000374-WSR-000172","SRG-APP-000375-WSR-000171"],"documentable":null,"cci":["CCI-000067","CCI-000130","CCI-000131","CCI-000132","CCI-000133","CCI-000134","CCI-000169","CCI-001462","CCI-001464","CCI-001487","CCI-001889","CCI-001890"],"nist":["AC-17 (1)","AU-3 a","AU-3 b","AU-3 c","AU-3 d","AU-3 e","AU-12 a","AU-14 (2)","AU-14 (1)","AU-3 f","AU-8 b","AU-8 b"]}},{"id":"SV-239752","code":"control 'SV-239752' do\n  title 'vSphere Client must generate log records during Java startup and shutdown.'\n  desc 'Logging must be started as soon as possible when a service starts and when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.\n\nOn the VCSA, the vmware-vmon service starts up the JVMs for various vCenter processes, including vSphere Client, and the individual json config files control the early jvm logging. Ensuring these json files are configured correctly enables early Java stdout and stderr logging.'\n  desc 'check', 'At the command prompt, execute the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-client.json\n\nExpected result:\n\n\"StreamRedirectFile\": \"%VMWARE_LOG_DIR%/vmware/vsphere-client/logs/vsphere-client-runtime.log\",\n\nIf there is no log file specified for the \"StreamRedirectFile\" setting, this is a finding.'\n  desc 'fix', 'Navigate to and open /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-client.json. \n\nBelow the last line of the \"PreStartCommandArg\" block, add the following line:\n\n\"StreamRedirectFile\": \"%VMWARE_LOG_DIR%/vmware/vsphere-client/logs/vsphere-client-runtime.log\",\n\nRestart the appliance for changes to take effect.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42985r679481_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239752'\n  tag rid: 'SV-239752r879559_rule'\n  tag stig_id: 'VCFL-67-000010'\n  tag gtitle: 'SRG-APP-000089-WSR-000047'\n  tag fix_id: 'F-42944r679482_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239752.rb"},"title":"vSphere Client must generate log records during Java startup and shutdown.","desc":"Logging must be started as soon as possible when a service starts and when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.\n\nOn the VCSA, the vmware-vmon service starts up the JVMs for various vCenter processes, including vSphere Client, and the individual json config files control the early jvm logging. Ensuring these json files are configured correctly enables early Java stdout and stderr logging.","descriptions":{"default":"Logging must be started as soon as possible when a service starts and when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.\n\nOn the VCSA, the vmware-vmon service starts up the JVMs for various vCenter processes, including vSphere Client, and the individual json config files control the early jvm logging. Ensuring these json files are configured correctly enables early Java stdout and stderr logging.","check":"At the command prompt, execute the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-client.json\n\nExpected result:\n\n\"StreamRedirectFile\": \"%VMWARE_LOG_DIR%/vmware/vsphere-client/logs/vsphere-client-runtime.log\",\n\nIf there is no log file specified for the \"StreamRedirectFile\" setting, this is a finding.","fix":"Navigate to and open /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-client.json. \n\nBelow the last line of the \"PreStartCommandArg\" block, add the following line:\n\n\"StreamRedirectFile\": \"%VMWARE_LOG_DIR%/vmware/vsphere-client/logs/vsphere-client-runtime.log\",\n\nRestart the appliance for changes to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42985r679481_chk","severity":"medium","gid":"V-239752","rid":"SV-239752r879559_rule","stig_id":"VCFL-67-000010","gtitle":"SRG-APP-000089-WSR-000047","fix_id":"F-42944r679482_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-239753","code":"control 'SV-239753' do\n  title 'vSphere Client application files must be verified for their integrity.'\n  desc 'Verifying that vSphere Client application code is unchanged from its shipping state is essential for file validation and non-repudiation of vSphere Client. There is no reason that the MD5 hash of the rpm original files should be changed after installation, excluding configuration files.'\n  desc 'check', 'At the command prompt, execute the following command:\n\n# rpm -V vsphere-client|grep \"^..5......\"|grep -E \"\\\\.war|\\\\.jar|\\\\.sh|\\\\.py\"\n\nIf there is any output, this is a finding.'\n  desc 'fix', 'Reinstall the VCSA or roll back to a snapshot. \n\nModifying the vSphere Client installation files manually is not supported by VMware.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42986r679484_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239753'\n  tag rid: 'SV-239753r879584_rule'\n  tag stig_id: 'VCFL-67-000012'\n  tag gtitle: 'SRG-APP-000131-WSR-000051'\n  tag fix_id: 'F-42945r679485_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001749']\n  tag nist: ['CM-5 (3)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239753.rb"},"title":"vSphere Client application files must be verified for their integrity.","desc":"Verifying that vSphere Client application code is unchanged from its shipping state is essential for file validation and non-repudiation of vSphere Client. There is no reason that the MD5 hash of the rpm original files should be changed after installation, excluding configuration files.","descriptions":{"default":"Verifying that vSphere Client application code is unchanged from its shipping state is essential for file validation and non-repudiation of vSphere Client. There is no reason that the MD5 hash of the rpm original files should be changed after installation, excluding configuration files.","check":"At the command prompt, execute the following command:\n\n# rpm -V vsphere-client|grep \"^..5......\"|grep -E \"\\.war|\\.jar|\\.sh|\\.py\"\n\nIf there is any output, this is a finding.","fix":"Reinstall the VCSA or roll back to a snapshot. \n\nModifying the vSphere Client installation files manually is not supported by VMware."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42986r679484_chk","severity":"medium","gid":"V-239753","rid":"SV-239753r879584_rule","stig_id":"VCFL-67-000012","gtitle":"SRG-APP-000131-WSR-000051","fix_id":"F-42945r679485_fix","documentable":null,"cci":["CCI-001749"],"nist":["CM-5 (3)"]}},{"id":"SV-239754","code":"control 'SV-239754' do\n  title 'vSphere Client must have Multipurpose Internet Mail Extensions (MIME) that invoke OS shell programs disabled.'\n  desc 'MIME mappings tell vSphere Client what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type.\n\nBy ensuring that various shell script MIME types are not included in web.xml, the server is protected against malicious users tricking the server into executing shell command files.'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)' /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', 'Open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml in a text editor. \n\nRemove any and all of the following nodes lines:\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42987r679487_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239754'\n  tag rid: 'SV-239754r879587_rule'\n  tag stig_id: 'VCFL-67-000013'\n  tag gtitle: 'SRG-APP-000141-WSR-000081'\n  tag fix_id: 'F-42946r679488_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239754.rb"},"title":"vSphere Client must have Multipurpose Internet Mail Extensions (MIME) that invoke OS shell programs disabled.","desc":"MIME mappings tell vSphere Client what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type.\n\nBy ensuring that various shell script MIME types are not included in web.xml, the server is protected against malicious users tricking the server into executing shell command files.","descriptions":{"default":"MIME mappings tell vSphere Client what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type.\n\nBy ensuring that various shell script MIME types are not included in web.xml, the server is protected against malicious users tricking the server into executing shell command files.","check":"At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)' /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nIf the command produces any output, this is a finding.","fix":"Open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml in a text editor. \n\nRemove any and all of the following nodes lines:\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42987r679487_chk","severity":"medium","gid":"V-239754","rid":"SV-239754r879587_rule","stig_id":"VCFL-67-000013","gtitle":"SRG-APP-000141-WSR-000081","fix_id":"F-42946r679488_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-239755","code":"control 'SV-239755' do\n  title 'vSphere Client must have mappings set for Java servlet pages.'\n  desc 'Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and identify which file types are not to be delivered to a client.\n\nBy not specifying which files can and cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc. \n\nAs Virgo is a Java-based web server, the main file extension used is *.jsp. This check ensures that the *.jsp and *.jspx file types has been properly mapped to servlets.'\n  desc 'check', %q(At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/servlet-mapping/servlet-name[text()=\"jsp\"]/parent::servlet-mapping' -\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nNavigate to and locate the mapping for the JSP servlet.It is the <servlet-mapping> node that contains <servlet-name>jsp</servlet-name>.\n\nConfigure the <servlet-mapping> node to look like the code snippet below:\n\n  <!-- The mappings for the JSP servlet -->\n  <servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n  </servlet-mapping>'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42988r679490_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239755'\n  tag rid: 'SV-239755r879587_rule'\n  tag stig_id: 'VCFL-67-000014'\n  tag gtitle: 'SRG-APP-000141-WSR-000083'\n  tag fix_id: 'F-42947r679491_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239755.rb"},"title":"vSphere Client must have mappings set for Java servlet pages.","desc":"Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and identify which file types are not to be delivered to a client.\n\nBy not specifying which files can and cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc. \n\nAs Virgo is a Java-based web server, the main file extension used is *.jsp. This check ensures that the *.jsp and *.jspx file types has been properly mapped to servlets.","descriptions":{"default":"Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and identify which file types are not to be delivered to a client.\n\nBy not specifying which files can and cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc. \n\nAs Virgo is a Java-based web server, the main file extension used is *.jsp. This check ensures that the *.jsp and *.jspx file types has been properly mapped to servlets.","check":"At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/servlet-mapping/servlet-name[text()=\"jsp\"]/parent::servlet-mapping' -\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nNavigate to and locate the mapping for the JSP servlet.It is the <servlet-mapping> node that contains <servlet-name>jsp</servlet-name>.\n\nConfigure the <servlet-mapping> node to look like the code snippet below:\n\n  <!-- The mappings for the JSP servlet -->\n  <servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n  </servlet-mapping>"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42988r679490_chk","severity":"medium","gid":"V-239755","rid":"SV-239755r879587_rule","stig_id":"VCFL-67-000014","gtitle":"SRG-APP-000141-WSR-000083","fix_id":"F-42947r679491_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-239756","code":"control 'SV-239756' do\n  title 'vSphere Client must not have the Web Distributed Authoring (WebDAV) servlet installed.'\n  desc 'WebDAV is an extension to the HTTP protocol that, when developed, was meant to allow users to create, change, and move documents on a server, typically a web server or web share. WebDAV is not widely used and has serious security concerns because it may allow clients to modify unauthorized files on the web server and must therefore be disabled.\n\nBecause the WebDAV service has been found to have an excessive number of vulnerabilities, this servlet must not be installed. vSphere Client does not configure WebDAV by default.'\n  desc 'check', \"At the command prompt, execute the following command: \n\n# grep -n -i 'webdav' /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', 'Navigate to and open all listed files.\n\nNavigate to and locate the mapping for the JSP servlet. It is the<servlet-mapping> node that contains <servlet-name>webdav</servlet-name>.\n\nRemove the WebDav servlet and any mapping associated with it.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42989r679493_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239756'\n  tag rid: 'SV-239756r879587_rule'\n  tag stig_id: 'VCFL-67-000015'\n  tag gtitle: 'SRG-APP-000141-WSR-000085'\n  tag fix_id: 'F-42948r679494_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239756.rb"},"title":"vSphere Client must not have the Web Distributed Authoring (WebDAV) servlet installed.","desc":"WebDAV is an extension to the HTTP protocol that, when developed, was meant to allow users to create, change, and move documents on a server, typically a web server or web share. WebDAV is not widely used and has serious security concerns because it may allow clients to modify unauthorized files on the web server and must therefore be disabled.\n\nBecause the WebDAV service has been found to have an excessive number of vulnerabilities, this servlet must not be installed. vSphere Client does not configure WebDAV by default.","descriptions":{"default":"WebDAV is an extension to the HTTP protocol that, when developed, was meant to allow users to create, change, and move documents on a server, typically a web server or web share. WebDAV is not widely used and has serious security concerns because it may allow clients to modify unauthorized files on the web server and must therefore be disabled.\n\nBecause the WebDAV service has been found to have an excessive number of vulnerabilities, this servlet must not be installed. vSphere Client does not configure WebDAV by default.","check":"At the command prompt, execute the following command: \n\n# grep -n -i 'webdav' /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nIf the command produces any output, this is a finding.","fix":"Navigate to and open all listed files.\n\nNavigate to and locate the mapping for the JSP servlet. It is the<servlet-mapping> node that contains <servlet-name>webdav</servlet-name>.\n\nRemove the WebDav servlet and any mapping associated with it."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42989r679493_chk","severity":"medium","gid":"V-239756","rid":"SV-239756r879587_rule","stig_id":"VCFL-67-000015","gtitle":"SRG-APP-000141-WSR-000085","fix_id":"F-42948r679494_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-239757","code":"control 'SV-239757' do\n  title 'vSphere Client must be configured with memory leak protection.'\n  desc %q(The Java Runtime environment can cause a memory leak or lock files under certain conditions. Without memory leak protection, vSphere Client can continue to consume system resources, which will lead to \"OutOfMemoryErrors\" when reloading web applications.\n\nMemory leaks occur when JRE code uses the context class loader to load a singleton, as this will cause a memory leak if a web application class loader happens to be the context class loader at the time. The \"JreMemoryLeakPreventionListener\" class is designed to initialize these singletons when Tomcat's common class loader is the context class loader. Proper use of JRE memory leak protection will ensure that the hosted application does not consume system resources and cause an unstable environment.)\n  desc 'check', 'At the command prompt, execute the following command: \n\n# grep JreMemoryLeakPreventionListener /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\n<Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\" />\n\nIf the output of the command does not match the expected result, this is a finding.'\n  desc 'fix', %q(Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nNavigate to the <Server> node.\n\nAdd '<Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>' to the <Server> node.)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42990r679496_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239757'\n  tag rid: 'SV-239757r879587_rule'\n  tag stig_id: 'VCFL-67-000016'\n  tag gtitle: 'SRG-APP-000141-WSR-000086'\n  tag fix_id: 'F-42949r679497_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239757.rb"},"title":"vSphere Client must be configured with memory leak protection.","desc":"The Java Runtime environment can cause a memory leak or lock files under certain conditions. Without memory leak protection, vSphere Client can continue to consume system resources, which will lead to \"OutOfMemoryErrors\" when reloading web applications.\n\nMemory leaks occur when JRE code uses the context class loader to load a singleton, as this will cause a memory leak if a web application class loader happens to be the context class loader at the time. The \"JreMemoryLeakPreventionListener\" class is designed to initialize these singletons when Tomcat's common class loader is the context class loader. Proper use of JRE memory leak protection will ensure that the hosted application does not consume system resources and cause an unstable environment.","descriptions":{"default":"The Java Runtime environment can cause a memory leak or lock files under certain conditions. Without memory leak protection, vSphere Client can continue to consume system resources, which will lead to \"OutOfMemoryErrors\" when reloading web applications.\n\nMemory leaks occur when JRE code uses the context class loader to load a singleton, as this will cause a memory leak if a web application class loader happens to be the context class loader at the time. The \"JreMemoryLeakPreventionListener\" class is designed to initialize these singletons when Tomcat's common class loader is the context class loader. Proper use of JRE memory leak protection will ensure that the hosted application does not consume system resources and cause an unstable environment.","check":"At the command prompt, execute the following command: \n\n# grep JreMemoryLeakPreventionListener /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\n<Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\" />\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nNavigate to the <Server> node.\n\nAdd '<Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>' to the <Server> node."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42990r679496_chk","severity":"medium","gid":"V-239757","rid":"SV-239757r879587_rule","stig_id":"VCFL-67-000016","gtitle":"SRG-APP-000141-WSR-000086","fix_id":"F-42949r679497_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-239758","code":"control 'SV-239758' do\n  title 'vSphere Client must not have any symbolic links in the web content directory tree.'\n  desc \"A web server is designed to deliver content and execute scripts or applications on the request of a client or user. Containing user requests to files in the directory tree of the hosted web application and limiting the execution of scripts and applications guarantees that the user is not accessing information protected outside the application's realm. By checking that no symbolic links exist in the document root, the web server is protected from users jumping outside the hosted application directory tree and gaining access to the other directories, including the system root.\"\n  desc 'check', 'At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-client/server/work/ -type l -ls\n\nIf the command produces any output, this is a finding.'\n  desc 'fix', 'At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\n# unlink <file_name>\n\nRepeat the commands for each file that was returned.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42991r679499_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239758'\n  tag rid: 'SV-239758r879587_rule'\n  tag stig_id: 'VCFL-67-000017'\n  tag gtitle: 'SRG-APP-000141-WSR-000087'\n  tag fix_id: 'F-42950r679500_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239758.rb"},"title":"vSphere Client must not have any symbolic links in the web content directory tree.","desc":"A web server is designed to deliver content and execute scripts or applications on the request of a client or user. Containing user requests to files in the directory tree of the hosted web application and limiting the execution of scripts and applications guarantees that the user is not accessing information protected outside the application's realm. By checking that no symbolic links exist in the document root, the web server is protected from users jumping outside the hosted application directory tree and gaining access to the other directories, including the system root.","descriptions":{"default":"A web server is designed to deliver content and execute scripts or applications on the request of a client or user. Containing user requests to files in the directory tree of the hosted web application and limiting the execution of scripts and applications guarantees that the user is not accessing information protected outside the application's realm. By checking that no symbolic links exist in the document root, the web server is protected from users jumping outside the hosted application directory tree and gaining access to the other directories, including the system root.","check":"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-client/server/work/ -type l -ls\n\nIf the command produces any output, this is a finding.","fix":"At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\n# unlink <file_name>\n\nRepeat the commands for each file that was returned."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42991r679499_chk","severity":"medium","gid":"V-239758","rid":"SV-239758r879587_rule","stig_id":"VCFL-67-000017","gtitle":"SRG-APP-000141-WSR-000087","fix_id":"F-42950r679500_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-239759","code":"control 'SV-239759' do\n  title 'vSphere Client must ensure appropriate permissions are set on the keystore.'\n  desc \"The web server's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients. By gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the SSL traffic between a client and the web server.\n\nvSphere Client pulls the machine certificate from the VECS keystore and stores it in keystore.jks so Tomcat can access it. The minimum permissions and ownership on the keystore are set by default but must be verified.\"\n  desc 'check', 'At the command prompt, execute the following command: \n\n# stat -c \"%n permissions are %a and is owned by %U:%G\" /etc/vmware/vsphere-client/keystore.jks\n\nExpected result:\n\n/etc/vmware/vsphere-client/keystore.jks permissions are 640 and is owned by vsphere-client:users\n\nIf the output of the command does not match the expected result, this is a finding.'\n  desc 'fix', 'At the command prompt, execute the following command: \n\n# chmod 640 /etc/vmware/vsphere-client/keystore.jks\n# chown vsphere-client:users /etc/vmware/vsphere-client/keystore.jks'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42992r679502_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239759'\n  tag rid: 'SV-239759r879613_rule'\n  tag stig_id: 'VCFL-67-000018'\n  tag gtitle: 'SRG-APP-000176-WSR-000096'\n  tag fix_id: 'F-42951r679503_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000186']\n  tag nist: ['IA-5 (2) (a) (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239759.rb"},"title":"vSphere Client must ensure appropriate permissions are set on the keystore.","desc":"The web server's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients. By gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the SSL traffic between a client and the web server.\n\nvSphere Client pulls the machine certificate from the VECS keystore and stores it in keystore.jks so Tomcat can access it. The minimum permissions and ownership on the keystore are set by default but must be verified.","descriptions":{"default":"The web server's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients. By gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the SSL traffic between a client and the web server.\n\nvSphere Client pulls the machine certificate from the VECS keystore and stores it in keystore.jks so Tomcat can access it. The minimum permissions and ownership on the keystore are set by default but must be verified.","check":"At the command prompt, execute the following command: \n\n# stat -c \"%n permissions are %a and is owned by %U:%G\" /etc/vmware/vsphere-client/keystore.jks\n\nExpected result:\n\n/etc/vmware/vsphere-client/keystore.jks permissions are 640 and is owned by vsphere-client:users\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following command: \n\n# chmod 640 /etc/vmware/vsphere-client/keystore.jks\n# chown vsphere-client:users /etc/vmware/vsphere-client/keystore.jks"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42992r679502_chk","severity":"medium","gid":"V-239759","rid":"SV-239759r879613_rule","stig_id":"VCFL-67-000018","gtitle":"SRG-APP-000176-WSR-000096","fix_id":"F-42951r679503_fix","documentable":null,"cci":["CCI-000186"],"nist":["IA-5 (2) (a) (1)"]}},{"id":"SV-239760","code":"control 'SV-239760' do\n  title 'vSphere Client directory tree must have permissions in an \"out-of-the-box\" state.'\n  desc 'As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled. vSphere Client files must be adequately protected with correct permissions as applied out of the box.\n\n'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-client/server -xdev -type f -a '(' -not -user vsphere-client -o '(' -not -group root -a -not -group users -not -group cis ')' ')' -exec ls -ld {} \\\\;\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', 'At the command prompt, execute the following command:\n\n#chown vsphere-client:root <file_name>\n\nRepeat the command for each file that was returned.\n\nNote: Replace <file_name> for the name of the file that was returned.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42993r679505_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239760'\n  tag rid: 'SV-239760r879631_rule'\n  tag stig_id: 'VCFL-67-000019'\n  tag gtitle: 'SRG-APP-000211-WSR-000030'\n  tag fix_id: 'F-42952r679506_fix'\n  tag satisfies: ['SRG-APP-000211-WSR-000030', 'SRG-APP-000380-WSR-000072']\n  tag 'documentable'\n  tag cci: ['CCI-001082', 'CCI-001813']\n  tag nist: ['SC-2', 'CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239760.rb"},"title":"vSphere Client directory tree must have permissions in an \"out-of-the-box\" state.","desc":"As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled. vSphere Client files must be adequately protected with correct permissions as applied out of the box.\n\n","descriptions":{"default":"As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled. vSphere Client files must be adequately protected with correct permissions as applied out of the box.\n\n","check":"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-client/server -xdev -type f -a '(' -not -user vsphere-client -o '(' -not -group root -a -not -group users -not -group cis ')' ')' -exec ls -ld {} \\;\n\nIf the command produces any output, this is a finding.","fix":"At the command prompt, execute the following command:\n\n#chown vsphere-client:root <file_name>\n\nRepeat the command for each file that was returned.\n\nNote: Replace <file_name> for the name of the file that was returned."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42993r679505_chk","severity":"medium","gid":"V-239760","rid":"SV-239760r879631_rule","stig_id":"VCFL-67-000019","gtitle":"SRG-APP-000211-WSR-000030","fix_id":"F-42952r679506_fix","satisfies":["SRG-APP-000211-WSR-000030","SRG-APP-000380-WSR-000072"],"documentable":null,"cci":["CCI-001082","CCI-001813"],"nist":["SC-2","CM-5 (1) (a)"]}},{"id":"SV-239761","code":"control 'SV-239761' do\n  title 'vSphere Client must limit the number of allowed connections.'\n  desc 'Limiting the number of established connections to Sphere Client is a basic denial-of-service protection. Servers where the limit is too high or unlimited can potentially run out of system resources and negatively affect system availability.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@acceptCount' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nacceptCount=\"300\" acceptCount=\"300\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nacceptCount=\"300\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42994r679508_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239761'\n  tag rid: 'SV-239761r879650_rule'\n  tag stig_id: 'VCFL-67-000020'\n  tag gtitle: 'SRG-APP-000246-WSR-000149'\n  tag fix_id: 'F-42953r679509_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001094']\n  tag nist: ['SC-5 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239761.rb"},"title":"vSphere Client must limit the number of allowed connections.","desc":"Limiting the number of established connections to Sphere Client is a basic denial-of-service protection. Servers where the limit is too high or unlimited can potentially run out of system resources and negatively affect system availability.","descriptions":{"default":"Limiting the number of established connections to Sphere Client is a basic denial-of-service protection. Servers where the limit is too high or unlimited can potentially run out of system resources and negatively affect system availability.","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@acceptCount' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nacceptCount=\"300\" acceptCount=\"300\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nacceptCount=\"300\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42994r679508_chk","severity":"medium","gid":"V-239761","rid":"SV-239761r879650_rule","stig_id":"VCFL-67-000020","gtitle":"SRG-APP-000246-WSR-000149","fix_id":"F-42953r679509_fix","documentable":null,"cci":["CCI-001094"],"nist":["SC-5 (1)"]}},{"id":"SV-239762","code":"control 'SV-239762' do\n  title 'vSphere Client must set \"URIEncoding\" to UTF-8.'\n  desc %q(Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application. \n\nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. vSphere Client must be configured to use a consistent character set via the \"URIEncoding\" attribute on the Connector nodes.)\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@URIEncoding' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nURIEncoding=\"UTF-8\" URIEncoding=\"UTF-8\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nURIEncoding=\"UTF-8\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42995r679511_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239762'\n  tag rid: 'SV-239762r879652_rule'\n  tag stig_id: 'VCFL-67-000021'\n  tag gtitle: 'SRG-APP-000251-WSR-000157'\n  tag fix_id: 'F-42954r679512_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001310']\n  tag nist: ['SI-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239762.rb"},"title":"vSphere Client must set \"URIEncoding\" to UTF-8.","desc":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application. \n\nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. vSphere Client must be configured to use a consistent character set via the \"URIEncoding\" attribute on the Connector nodes.","descriptions":{"default":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application. \n\nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. vSphere Client must be configured to use a consistent character set via the \"URIEncoding\" attribute on the Connector nodes.","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@URIEncoding' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nURIEncoding=\"UTF-8\" URIEncoding=\"UTF-8\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nURIEncoding=\"UTF-8\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42995r679511_chk","severity":"medium","gid":"V-239762","rid":"SV-239762r879652_rule","stig_id":"VCFL-67-000021","gtitle":"SRG-APP-000251-WSR-000157","fix_id":"F-42954r679512_fix","documentable":null,"cci":["CCI-001310"],"nist":["SI-10"]}},{"id":"SV-239763","code":"control 'SV-239763' do\n  title 'vSphere Client must set the \"welcome-file\" node to a default web page.'\n  desc %q(Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. \n\nBy having a default hosted application web page, the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version. Ensuring that every document directory has an \"index.jsp\" (or equivalent) file is one approach to mitigating the vulnerability.)\n  desc 'check', %q(At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nInspect the file and ensure that it contains the following section:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42996r679514_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239763'\n  tag rid: 'SV-239763r879655_rule'\n  tag stig_id: 'VCFL-67-000022'\n  tag gtitle: 'SRG-APP-000266-WSR-000142'\n  tag fix_id: 'F-42955r679515_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239763.rb"},"title":"vSphere Client must set the \"welcome-file\" node to a default web page.","desc":"Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. \n\nBy having a default hosted application web page, the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version. Ensuring that every document directory has an \"index.jsp\" (or equivalent) file is one approach to mitigating the vulnerability.","descriptions":{"default":"Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. \n\nBy having a default hosted application web page, the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version. Ensuring that every document directory has an \"index.jsp\" (or equivalent) file is one approach to mitigating the vulnerability.","check":"At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nInspect the file and ensure that it contains the following section:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42996r679514_chk","severity":"medium","gid":"V-239763","rid":"SV-239763r879655_rule","stig_id":"VCFL-67-000022","gtitle":"SRG-APP-000266-WSR-000142","fix_id":"F-42955r679515_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-239764","code":"control 'SV-239764' do\n  title 'vSphere Client must not show directory listings.'\n  desc \"Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring that directory listing is disabled is one approach to mitigating the vulnerability.\"\n  desc 'check', %q(At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"listings\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nSet the <param-value> to \"false\" in all <param-name>listing</param-name> nodes.\n\nNote: The setting should look like the following:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42997r679517_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239764'\n  tag rid: 'SV-239764r879655_rule'\n  tag stig_id: 'VCFL-67-000023'\n  tag gtitle: 'SRG-APP-000266-WSR-000142'\n  tag fix_id: 'F-42956r679518_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239764.rb"},"title":"vSphere Client must not show directory listings.","desc":"Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring that directory listing is disabled is one approach to mitigating the vulnerability.","descriptions":{"default":"Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring that directory listing is disabled is one approach to mitigating the vulnerability.","check":"At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"listings\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nSet the <param-value> to \"false\" in all <param-name>listing</param-name> nodes.\n\nNote: The setting should look like the following:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42997r679517_chk","severity":"medium","gid":"V-239764","rid":"SV-239764r879655_rule","stig_id":"VCFL-67-000023","gtitle":"SRG-APP-000266-WSR-000142","fix_id":"F-42956r679518_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-239765","code":"control 'SV-239765' do\n  title 'vSphere Client must be configured to show error pages with minimal information.'\n  desc 'Web servers will often display error messages to client users, displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage. \n\nThis information could be used by an attacker to blueprint what type of attacks might be successful. Therefore, vSphere Client must be configured to not show server version information in error messages.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@server' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nserver=\"Anonymous\" server=\"Anonymous\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nserver=\"Anonymous\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42998r679520_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239765'\n  tag rid: 'SV-239765r879655_rule'\n  tag stig_id: 'VCFL-67-000024'\n  tag gtitle: 'SRG-APP-000266-WSR-000159'\n  tag fix_id: 'F-42957r679521_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239765.rb"},"title":"vSphere Client must be configured to show error pages with minimal information.","desc":"Web servers will often display error messages to client users, displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage. \n\nThis information could be used by an attacker to blueprint what type of attacks might be successful. Therefore, vSphere Client must be configured to not show server version information in error messages.","descriptions":{"default":"Web servers will often display error messages to client users, displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage. \n\nThis information could be used by an attacker to blueprint what type of attacks might be successful. Therefore, vSphere Client must be configured to not show server version information in error messages.","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@server' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nserver=\"Anonymous\" server=\"Anonymous\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nConfigure each <Connector> node with the following:\n\nserver=\"Anonymous\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42998r679520_chk","severity":"medium","gid":"V-239765","rid":"SV-239765r879655_rule","stig_id":"VCFL-67-000024","gtitle":"SRG-APP-000266-WSR-000159","fix_id":"F-42957r679521_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-239766","code":"control 'SV-239766' do\n  title 'vSphere Client must not enable support for TRACE requests.'\n  desc '\"Trace\" is a technique for a user to request internal information about Tomcat. This is useful during product development but should not be enabled in production. \n\nAllowing an attacker to conduct a Trace operation against the Security Token Service will expose information that would be useful to perform a more targeted attack. vSphere Client provides the \"allowTrace\" parameter as a means to disable responding to Trace requests.'\n  desc 'check', 'At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nIf \"allowTrace\" is set to \"true\", this is a finding. \n\nIf no line is returned, this is NOT a finding.'\n  desc 'fix', %q(Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nNavigate to and locate:\n\n'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting.)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-42999r679523_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239766'\n  tag rid: 'SV-239766r879655_rule'\n  tag stig_id: 'VCFL-67-000025'\n  tag gtitle: 'SRG-APP-000266-WSR-000160'\n  tag fix_id: 'F-42958r679524_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239766.rb"},"title":"vSphere Client must not enable support for TRACE requests.","desc":"\"Trace\" is a technique for a user to request internal information about Tomcat. This is useful during product development but should not be enabled in production. \n\nAllowing an attacker to conduct a Trace operation against the Security Token Service will expose information that would be useful to perform a more targeted attack. vSphere Client provides the \"allowTrace\" parameter as a means to disable responding to Trace requests.","descriptions":{"default":"\"Trace\" is a technique for a user to request internal information about Tomcat. This is useful during product development but should not be enabled in production. \n\nAllowing an attacker to conduct a Trace operation against the Security Token Service will expose information that would be useful to perform a more targeted attack. vSphere Client provides the \"allowTrace\" parameter as a means to disable responding to Trace requests.","check":"At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nIf \"allowTrace\" is set to \"true\", this is a finding. \n\nIf no line is returned, this is NOT a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml.\n\nNavigate to and locate:\n\n'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-42999r679523_chk","severity":"medium","gid":"V-239766","rid":"SV-239766r879655_rule","stig_id":"VCFL-67-000025","gtitle":"SRG-APP-000266-WSR-000160","fix_id":"F-42958r679524_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-239767","code":"control 'SV-239767' do\n  title 'vSphere Client must have the debug option turned off.'\n  desc 'Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage, may be displayed. Since this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.\n\nvSphere Client can be configured to set the debugging level. By setting the debugging level to zero, no debugging information will be provided to a malicious user.'\n  desc 'check', %q(At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"debug\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the following:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-43000r679526_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239767'\n  tag rid: 'SV-239767r879655_rule'\n  tag stig_id: 'VCFL-67-000026'\n  tag gtitle: 'SRG-APP-000266-WSR-000160'\n  tag fix_id: 'F-42959r679527_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239767.rb"},"title":"vSphere Client must have the debug option turned off.","desc":"Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage, may be displayed. Since this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.\n\nvSphere Client can be configured to set the debugging level. By setting the debugging level to zero, no debugging information will be provided to a malicious user.","descriptions":{"default":"Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage, may be displayed. Since this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.\n\nvSphere Client can be configured to set the debugging level. By setting the debugging level to zero, no debugging information will be provided to a malicious user.","check":"At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"debug\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the following:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-43000r679526_chk","severity":"medium","gid":"V-239767","rid":"SV-239767r879655_rule","stig_id":"VCFL-67-000026","gtitle":"SRG-APP-000266-WSR-000160","fix_id":"F-42959r679527_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-239768","code":"control 'SV-239768' do\n  title 'Rsyslog must be configured to monitor and ship vSphere Client log files.'\n  desc 'The vSphere Client produces a handful of logs that must be offloaded from the originating system. This information can then be used for diagnostic, forensics, or other purposes relevant to ensuring the availability and integrity of the hosted application.'\n  desc 'check', 'At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-vsphere-client.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/access/localhost_access*\"\n      Tag=\"client-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/vsphere-client-runtime*\"\n      Tag=\"client-runtime\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open /etc/vmware-syslog/stig-vsphere-client.conf.\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/access/localhost_access*\"\n      Tag=\"client-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/vsphere-client-runtime*\"\n      Tag=\"client-runtime\"\n      Severity=\"info\"\n      Facility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-43001r679529_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239768'\n  tag rid: 'SV-239768r879731_rule'\n  tag stig_id: 'VCFL-67-000027'\n  tag gtitle: 'SRG-APP-000358-WSR-000163'\n  tag fix_id: 'F-42960r679530_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239768.rb"},"title":"Rsyslog must be configured to monitor and ship vSphere Client log files.","desc":"The vSphere Client produces a handful of logs that must be offloaded from the originating system. This information can then be used for diagnostic, forensics, or other purposes relevant to ensuring the availability and integrity of the hosted application.","descriptions":{"default":"The vSphere Client produces a handful of logs that must be offloaded from the originating system. This information can then be used for diagnostic, forensics, or other purposes relevant to ensuring the availability and integrity of the hosted application.","check":"At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-vsphere-client.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/access/localhost_access*\"\n      Tag=\"client-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/vsphere-client-runtime*\"\n      Tag=\"client-runtime\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open /etc/vmware-syslog/stig-vsphere-client.conf.\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/access/localhost_access*\"\n      Tag=\"client-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/vsphere-client-runtime*\"\n      Tag=\"client-runtime\"\n      Severity=\"info\"\n      Facility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-43001r679529_chk","severity":"medium","gid":"V-239768","rid":"SV-239768r879731_rule","stig_id":"VCFL-67-000027","gtitle":"SRG-APP-000358-WSR-000163","fix_id":"F-42960r679530_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}},{"id":"SV-239769","code":"control 'SV-239769' do\n  title 'vSphere Client must be configured with the appropriate ports.'\n  desc 'Web servers provide numerous processes, features, and functionalities that use TCP/IP ports. Some of these processes may be deemed unnecessary or too unsecure to run on a production system. vSphere Client comes configured with two connectors. One is behind the reverse proxy and listening on 9090, and the other is serving SSL natively on 9443. The ports that vSphere Client listens on must be verified as accurate to their shipping state.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@port' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nport=\"9090\" port=\"9443\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml in a text editor.\n\nOn the first <Connector>, with redirectPort=\"9443\", configure the port as follows:\n\nport=\"9090\"\n\nOn the second <Connector>, with SSLEnabled=\"true\", configure the port as follows:\n\nport=\"9443\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-43002r679532_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239769'\n  tag rid: 'SV-239769r879756_rule'\n  tag stig_id: 'VCFL-67-000028'\n  tag gtitle: 'SRG-APP-000383-WSR-000175'\n  tag fix_id: 'F-42961r679533_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001762']\n  tag nist: ['CM-7 (1) (b)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239769.rb"},"title":"vSphere Client must be configured with the appropriate ports.","desc":"Web servers provide numerous processes, features, and functionalities that use TCP/IP ports. Some of these processes may be deemed unnecessary or too unsecure to run on a production system. vSphere Client comes configured with two connectors. One is behind the reverse proxy and listening on 9090, and the other is serving SSL natively on 9443. The ports that vSphere Client listens on must be verified as accurate to their shipping state.","descriptions":{"default":"Web servers provide numerous processes, features, and functionalities that use TCP/IP ports. Some of these processes may be deemed unnecessary or too unsecure to run on a production system. vSphere Client comes configured with two connectors. One is behind the reverse proxy and listening on 9090, and the other is serving SSL natively on 9443. The ports that vSphere Client listens on must be verified as accurate to their shipping state.","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@port' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nport=\"9090\" port=\"9443\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml in a text editor.\n\nOn the first <Connector>, with redirectPort=\"9443\", configure the port as follows:\n\nport=\"9090\"\n\nOn the second <Connector>, with SSLEnabled=\"true\", configure the port as follows:\n\nport=\"9443\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-43002r679532_chk","severity":"medium","gid":"V-239769","rid":"SV-239769r879756_rule","stig_id":"VCFL-67-000028","gtitle":"SRG-APP-000383-WSR-000175","fix_id":"F-42961r679533_fix","documentable":null,"cci":["CCI-001762"],"nist":["CM-7 (1) (b)"]}},{"id":"SV-239770","code":"control 'SV-239770' do\n  title 'vSphere Client must disable the shutdown port.'\n  desc 'An attacker has at least two reasons to stop a web server. The first is to cause a denial of service, and the second is to put in place changes the attacker made to the web server configuration. If the Tomcat shutdown port feature is enabled, a shutdown signal can be sent to vSphere Client through this port. To ensure availability, the shutdown port must be disabled.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/@port' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nport=\"-1\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml in a text editor.\n\nEnsure that the server port is disabled as follows:\n\n<Server port=\"-1\">'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-43003r679535_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239770'\n  tag rid: 'SV-239770r879806_rule'\n  tag stig_id: 'VCFL-67-000029'\n  tag gtitle: 'SRG-APP-000435-WSR-000147'\n  tag fix_id: 'F-42962r679536_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002385']\n  tag nist: ['SC-5 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239770.rb"},"title":"vSphere Client must disable the shutdown port.","desc":"An attacker has at least two reasons to stop a web server. The first is to cause a denial of service, and the second is to put in place changes the attacker made to the web server configuration. If the Tomcat shutdown port feature is enabled, a shutdown signal can be sent to vSphere Client through this port. To ensure availability, the shutdown port must be disabled.","descriptions":{"default":"An attacker has at least two reasons to stop a web server. The first is to cause a denial of service, and the second is to put in place changes the attacker made to the web server configuration. If the Tomcat shutdown port feature is enabled, a shutdown signal can be sent to vSphere Client through this port. To ensure availability, the shutdown port must be disabled.","check":"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/@port' /usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nport=\"-1\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml in a text editor.\n\nEnsure that the server port is disabled as follows:\n\n<Server port=\"-1\">"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-43003r679535_chk","severity":"medium","gid":"V-239770","rid":"SV-239770r879806_rule","stig_id":"VCFL-67-000029","gtitle":"SRG-APP-000435-WSR-000147","fix_id":"F-42962r679536_fix","documentable":null,"cci":["CCI-002385"],"nist":["SC-5 a"]}},{"id":"SV-239771","code":"control 'SV-239771' do\n  title 'vSphere Client must set the secure flag for cookies.'\n  desc 'The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a cookie in clear text. By setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.'\n  desc 'check', %q(At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure it as follows:\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-43004r679538_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239771'\n  tag rid: 'SV-239771r879810_rule'\n  tag stig_id: 'VCFL-67-000030'\n  tag gtitle: 'SRG-APP-000439-WSR-000155'\n  tag fix_id: 'F-42963r679539_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002418']\n  tag nist: ['SC-8']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-239771.rb"},"title":"vSphere Client must set the secure flag for cookies.","desc":"The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a cookie in clear text. By setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.","descriptions":{"default":"The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a cookie in clear text. By setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.","check":"At the command prompt, execute the following command: \n\n# xmllint --format /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml.\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure it as follows:\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-43004r679538_chk","severity":"medium","gid":"V-239771","rid":"SV-239771r879810_rule","stig_id":"VCFL-67-000030","gtitle":"SRG-APP-000439-WSR-000155","fix_id":"F-42963r679539_fix","documentable":null,"cci":["CCI-002418"],"nist":["SC-8"]}},{"id":"SV-257288","code":"control 'SV-257288' do\n  title 'The version of Virgo-Client running on the system must be a supported version.'\n  desc 'Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.\n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).\n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).'\n  desc 'check', 'Virgo-Client 6.7 is no longer supported by the vendor. If the system is running Virgo-Client 6.7, this is a finding.'\n  desc 'fix', 'Upgrade to a supported version.'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 6.7 Virgo-Client'\n  tag check_id: 'C-60971r918897_chk'\n  tag severity: 'high'\n  tag gid: 'V-257288'\n  tag rid: 'SV-257288r919287_rule'\n  tag stig_id: 'VCFL-67-000999'\n  tag gtitle: 'SRG-APP-000456-WSR-000187'\n  tag fix_id: 'F-53958r798705_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002605']\n  tag nist: ['SI-2 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_Virgo-Client_STIG_V1R2/controls/SV-257288.rb"},"title":"The version of Virgo-Client running on the system must be a supported version.","desc":"Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.\n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).\n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).","descriptions":{"default":"Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.\n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).\n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).","check":"Virgo-Client 6.7 is no longer supported by the vendor. If the system is running Virgo-Client 6.7, this is a finding.","fix":"Upgrade to a supported version."},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 Virgo-Client"}],"tags":{"check_id":"C-60971r918897_chk","severity":"high","gid":"V-257288","rid":"SV-257288r919287_rule","stig_id":"VCFL-67-000999","gtitle":"SRG-APP-000456-WSR-000187","fix_id":"F-53958r798705_fix","documentable":null,"cci":["CCI-002605"],"nist":["SI-2 c"]}}],"groups":[{"id":"controls/SV-239743.rb","title":null,"controls":["SV-239743"]},{"id":"controls/SV-239744.rb","title":null,"controls":["SV-239744"]},{"id":"controls/SV-239745.rb","title":null,"controls":["SV-239745"]},{"id":"controls/SV-239746.rb","title":null,"controls":["SV-239746"]},{"id":"controls/SV-239747.rb","title":null,"controls":["SV-239747"]},{"id":"controls/SV-239748.rb","title":null,"controls":["SV-239748"]},{"id":"controls/SV-239749.rb","title":null,"controls":["SV-239749"]},{"id":"controls/SV-239750.rb","title":null,"controls":["SV-239750"]},{"id":"controls/SV-239751.rb","title":null,"controls":["SV-239751"]},{"id":"controls/SV-239752.rb","title":null,"controls":["SV-239752"]},{"id":"controls/SV-239753.rb","title":null,"controls":["SV-239753"]},{"id":"controls/SV-239754.rb","title":null,"controls":["SV-239754"]},{"id":"controls/SV-239755.rb","title":null,"controls":["SV-239755"]},{"id":"controls/SV-239756.rb","title":null,"controls":["SV-239756"]},{"id":"controls/SV-239757.rb","title":null,"controls":["SV-239757"]},{"id":"controls/SV-239758.rb","title":null,"controls":["SV-239758"]},{"id":"controls/SV-239759.rb","title":null,"controls":["SV-239759"]},{"id":"controls/SV-239760.rb","title":null,"controls":["SV-239760"]},{"id":"controls/SV-239761.rb","title":null,"controls":["SV-239761"]},{"id":"controls/SV-239762.rb","title":null,"controls":["SV-239762"]},{"id":"controls/SV-239763.rb","title":null,"controls":["SV-239763"]},{"id":"controls/SV-239764.rb","title":null,"controls":["SV-239764"]},{"id":"controls/SV-239765.rb","title":null,"controls":["SV-239765"]},{"id":"controls/SV-239766.rb","title":null,"controls":["SV-239766"]},{"id":"controls/SV-239767.rb","title":null,"controls":["SV-239767"]},{"id":"controls/SV-239768.rb","title":null,"controls":["SV-239768"]},{"id":"controls/SV-239769.rb","title":null,"controls":["SV-239769"]},{"id":"controls/SV-239770.rb","title":null,"controls":["SV-239770"]},{"id":"controls/SV-239771.rb","title":null,"controls":["SV-239771"]},{"id":"controls/SV-257288.rb","title":null,"controls":["SV-257288"]}],"name":"VMW_vSphere_6-7_Virgo-Client_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"3e13c8a137e23af70e2b48e82beeb71b5d422b03de56b28ffe3c81b0e8b939ca","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
