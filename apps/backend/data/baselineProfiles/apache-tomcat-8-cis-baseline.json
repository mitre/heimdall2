{
  "name": "CIS_Apache_Tomcat_8_Benchmark",
  "title": "InSpec Profile",
  "maintainer": "The MITRE Corporation",
  "copyright": "The MITRE Corporation",
  "copyright_email": "saf@groups.mitre.org",
  "license": "Apache-2.0",
  "summary": "An InSpec Compliance Profile",
  "version": "0.1.0",
  "inspec_version": ">= 4.0",
  "supports": [],
  "controls": [
    {
      "title": "2.1 Alter the Advertised server.info String (Scored)",
      "desc": "The server.info attribute contains the name of the application\nservice. This value is presented to Tomcat clients when clients connect to the\ntomcat server. Altering the server.info attribute may make it harder for\nattackers to determine which vulnerabilities affect the server platform.",
      "descriptions": {
        "default": "The server.info attribute contains the name of the application\nservice. This value is presented to Tomcat clients when clients connect to the\ntomcat server. Altering the server.info attribute may make it harder for\nattackers to determine which vulnerabilities affect the server platform."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://www.owasp.org/index.php/Securing_tomcat",
        "severity": "medium",
        "cis_id": "2.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to determine if the server.info\nvalue has been changed: Extract the ServerInfo.properties file and examine the\nserver.info attribute.\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n$ grep server.info org/apache/catalina/util/ServerInfo.properties\n",
        "fix": "Perform the following to alter the server platform string that\ngets displayed when clients\nconnect to the tomcat server. Extract the ServerInfo.properties file from the\ncatalina.jar file:\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties Navigate\nto the util directory that was created\ncd org/apache/catalina/util Open ServerInfo.properties in an editor Update the\nserver.info attribute in the ServerInfo.properties file.\n\nserver.info=<SomeWebServer> Update the catalina.jar with the modified\nServerInfo.properties file.\n$ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties\n",
        "Default Value": "The default value for the server.info attribute is\nApache Tomcat/.. For example, Apache\nTomcat/7.0.\n"
      },
      "code": "control \"M-2.1\" do\n  title \"2.1 Alter the Advertised server.info String (Scored)\"\n  desc  \"The server.info attribute contains the name of the application\nservice. This value is presented to Tomcat clients when clients connect to the\ntomcat server. Altering the server.info attribute may make it harder for\nattackers to determine which vulnerabilities affect the server platform. \"\n  impact 0.5\n  tag \"ref\": \"1. http://www.owasp.org/index.php/Securing_tomcat\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to determine if the server.info\nvalue has been changed: Extract the ServerInfo.properties file and examine the\nserver.info attribute.\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n$ grep server.info org/apache/catalina/util/ServerInfo.properties\n\"\n  tag \"fix\": \"Perform the following to alter the server platform string that\ngets displayed when clients\nconnect to the tomcat server. Extract the ServerInfo.properties file from the\ncatalina.jar file:\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties Navigate\nto the util directory that was created\ncd org/apache/catalina/util Open ServerInfo.properties in an editor Update the\nserver.info attribute in the ServerInfo.properties file.\n\nserver.info=<SomeWebServer> Update the catalina.jar with the modified\nServerInfo.properties file.\n$ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties\n\"\n  tag \"Default Value\": \"The default value for the server.info attribute is\nApache Tomcat/.. For example, Apache\\nTomcat/7.0.\\n\"\n\n  describe command(\"unzip -p #{TOMCAT_HOME}/lib/catalina.jar org/apache/catalina/util/ServerInfo.properties | grep server.info\") do\n    its('stdout.strip') { should eq \"#{TOMCAT_SERVER_INFO}\" }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-2.1.rb",
        "line": 23
      },
      "id": "M-2.1"
    },
    {
      "title": "10.16 Do not resolve hosts on logging valves (Scored)",
      "desc": "Setting enableLookups to true on Connector requires a DNS look-up\nbefore logging the information. This adds additional resources when logging.\nAllowing enableLookups adds additional overhead that is rarely needed.",
      "descriptions": {
        "default": "Setting enableLookups to true on Connector requires a DNS look-up\nbefore logging the information. This adds additional resources when logging.\nAllowing enableLookups adds additional overhead that is rarely needed."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://tomcat.apache.org/tomcat-8.0-doc/config/valve.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/config/http.html",
        "severity": "medium",
        "cis_id": "10.16",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Ensure Connector elements have the enableLookups attribute\nset to falser enableLookups does not exist.\n# grep enableLookups $CATALINA_HOME/conf/server.xml\n",
        "fix": "In Connector elements, set the enableLookups attribute to false\nor remove it.\n<Connector ... enableLookups='false' />\n",
        "Default Value": "By default, DNS lookups are disabled.\n"
      },
      "code": "control \"M-10.16\" do\n  title \"10.16 Do not resolve hosts on logging valves (Scored)\"\n  desc  \"Setting enableLookups to true on Connector requires a DNS look-up\nbefore logging the information. This adds additional resources when logging.\nAllowing enableLookups adds additional overhead that is rarely needed. \"\n  impact 0.5\n  tag \"ref\": \"1. https://tomcat.apache.org/tomcat-8.0-doc/config/valve.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/config/http.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.16\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Ensure Connector elements have the enableLookups attribute\nset to falser enableLookups does not exist.\n# grep enableLookups $CATALINA_HOME/conf/server.xml\n\"\n  tag \"fix\": \"In Connector elements, set the enableLookups attribute to false\nor remove it.\n<Connector ... enableLookups='false' />\n\"\n  tag \"Default Value\": \"By default, DNS lookups are disabled.\\n\"\n\n  begin\n    describe command(\"grep enableLookups #{TOMCAT_CONF_SERVER}\") do\n      its('stdout') { should eq '' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.16.rb",
        "line": 18
      },
      "id": "M-10.16"
    },
    {
      "title": "4.2 Restrict access to $CATALINA_BASE (Scored)",
      "desc": "$CATALINA_BASE is the environment variable that specifies the base\ndirectory which most relative paths are resolved. $CATALINA_BASE is usually\nused when there is multiple instances of Tomcat running. It is important to\nprotect access to this in order to protect the Tomcat-related binaries and\nlibraries from unauthorized modification. It is recommended that the ownership\nof $CATALINA_BASE be tomcat_admin:tomcat. It is also recommended that the\npermission on $CATALINA_BASE prevent read, write, and execute for the world\n(orwx) and prevent write access to the group (g-w). The security of processes\nand data that traverse or depend on Tomcat may become compromised if the\n$CATALINA_BASE is not secured.",
      "descriptions": {
        "default": "$CATALINA_BASE is the environment variable that specifies the base\ndirectory which most relative paths are resolved. $CATALINA_BASE is usually\nused when there is multiple instances of Tomcat running. It is important to\nprotect access to this in order to protect the Tomcat-related binaries and\nlibraries from unauthorized modification. It is recommended that the ownership\nof $CATALINA_BASE be tomcat_admin:tomcat. It is also recommended that the\npermission on $CATALINA_BASE prevent read, write, and execute for the world\n(orwx) and prevent write access to the group (g-w). The security of processes\nand data that traverse or depend on Tomcat may become compromised if the\n$CATALINA_BASE is not secured."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to ensure the permission on the\n$CATALINA_BASE directory prevent\nunauthorized modification.\n$ cd $CATALINA_BASE\n$ find . -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user tomcat_admin -o !\n-group\ntomcat \\) -ls\nThe above command should not emit any output.\n",
        "fix": "Perform the following to establish the recommended state: Set the\nownership of the $CATALINA_BASE to tomcat_admin:tomcat. Remove read, write, and\nexecute permissions for the world Remove write permissions for the group.\n# chown tomcat_admin.tomcat $CATALINA_BASE\n# chmod g-w,o-rwx $CATALINA_BASE"
      },
      "code": "control \"M-4.2\" do\n  title \"4.2 Restrict access to $CATALINA_BASE (Scored)\"\n  desc  \"$CATALINA_BASE is the environment variable that specifies the base\ndirectory which most relative paths are resolved. $CATALINA_BASE is usually\nused when there is multiple instances of Tomcat running. It is important to\nprotect access to this in order to protect the Tomcat-related binaries and\nlibraries from unauthorized modification. It is recommended that the ownership\nof $CATALINA_BASE be tomcat_admin:tomcat. It is also recommended that the\npermission on $CATALINA_BASE prevent read, write, and execute for the world\n(orwx) and prevent write access to the group (g-w). The security of processes\nand data that traverse or depend on Tomcat may become compromised if the\n$CATALINA_BASE is not secured. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to ensure the permission on the\n$CATALINA_BASE directory prevent\nunauthorized modification.\n$ cd $CATALINA_BASE\n$ find . -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user tomcat_admin -o !\n-group\ntomcat \\\\) -ls\nThe above command should not emit any output.\n\"\n  tag \"fix\": \"Perform the following to establish the recommended state: Set the\nownership of the $CATALINA_BASE to tomcat_admin:tomcat. Remove read, write, and\nexecute permissions for the world Remove write permissions for the group.\n# chown tomcat_admin.tomcat $CATALINA_BASE\n# chmod g-w,o-rwx $CATALINA_BASE\"\n\n  describe directory(\"#{TOMCAT_BASE}\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.2.rb",
        "line": 29
      },
      "id": "M-4.2"
    },
    {
      "title": "4.3 Restrict access to Tomcat configuration directory (Scored)",
      "desc": "The Tomcat $CATALINA_HOME/conf/ directory contains Tomcat\nconfiguration files. It is recommended that the ownership of this directory be\ntomcat_admin:tomcat. It is also recommended that the permissions on this\ndirectory prevent read, write, and execute for the world (o-rwx) and prevent\nwrite access to the group (g-w). Restricting access to these directories will\nprevent local users from maliciously or inadvertently altering Tomcat’s\nconfiguration.",
      "descriptions": {
        "default": "The Tomcat $CATALINA_HOME/conf/ directory contains Tomcat\nconfiguration files. It is recommended that the ownership of this directory be\ntomcat_admin:tomcat. It is also recommended that the permissions on this\ndirectory prevent read, write, and execute for the world (o-rwx) and prevent\nwrite access to the group (g-w). Restricting access to these directories will\nprevent local users from maliciously or inadvertently altering Tomcat’s\nconfiguration."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf are securely configured. Change to the location of the\n$CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf\n# find . -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user tomcat_admin -o ! -group\ntomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to Tomcat configuration\nfiles: Set the ownership of the $CATALINA_HOME/conf to tomcat_admin:tomcat.\nRemove read, write, and execute permissions for the world Remove write\npermissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf\n# chmod g-w,o-rwx $CATALINA_HOME/conf\n\n",
        "Default Value": "The default permissions of the top-level directories is\n770."
      },
      "code": "control \"M-4.3\" do\n  title \"4.3 Restrict access to Tomcat configuration directory (Scored)\"\n  desc  \"The Tomcat $CATALINA_HOME/conf/ directory contains Tomcat\nconfiguration files. It is recommended that the ownership of this directory be\ntomcat_admin:tomcat. It is also recommended that the permissions on this\ndirectory prevent read, write, and execute for the world (o-rwx) and prevent\nwrite access to the group (g-w). Restricting access to these directories will\nprevent local users from maliciously or inadvertently altering Tomcat’s\nconfiguration. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf are securely configured. Change to the location of the\n$CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf\n# find . -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user tomcat_admin -o ! -group\ntomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to Tomcat configuration\nfiles: Set the ownership of the $CATALINA_HOME/conf to tomcat_admin:tomcat.\nRemove read, write, and execute permissions for the world Remove write\npermissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf\n# chmod g-w,o-rwx $CATALINA_HOME/conf\n\n\"\n  tag \"Default Value\": \"The default permissions of the top-level directories is\n770.\"\n\n  describe directory(\"#{TOMCAT_HOME}/conf\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.3.rb",
        "line": 29
      },
      "id": "M-4.3"
    },
    {
      "title": "10.2 Restrict access to the web administration (Not Scored)",
      "desc": "Limit access to the web administration application to only those with\na required needed. Limiting access to the least privilege required will ensure\nonly those people with required need have access to a resource. The web\nadministration application should be limited to only administrators.",
      "descriptions": {
        "default": "Limit access to the web administration application to only those with\na required needed. Limiting access to the least privilege required will ensure\nonly those people with required need have access to a resource. The web\nadministration application should be limited to only administrators."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://tomcat.apache.org/tomcat-8.0-doc/config/valve.html",
        "severity": "medium",
        "cis_id": "10.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Review $CATALINA_HOME/conf/server.xml to ascertain that\nthe RemoteAddrValve option\nis uncommented and configured to only allow access to systems required to\nconnect.\n",
        "fix": "For the administration application, edit\n$CATALINA_HOME/conf/server.xml and\nuncomment the following:\n<Valve className='org.apache.catalina.valves.RemoteAddrValve'\nallow='127\\.0\\.0\\.1'/>\nNote: The RemoteAddrValve property expects a regular expression, therefore\nperiods and\nother regular expression meta-characters must be escaped.\n",
        "Default Value": "By default, this configuration is not present.\n"
      },
      "code": "control \"M-10.2\" do\n  title \"10.2 Restrict access to the web administration (Not Scored)\"\n  desc  \"Limit access to the web administration application to only those with\na required needed. Limiting access to the least privilege required will ensure\nonly those people with required need have access to a resource. The web\nadministration application should be limited to only administrators. \"\n  impact 0.5\n  tag \"ref\": \"1. https://tomcat.apache.org/tomcat-8.0-doc/config/valve.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Review $CATALINA_HOME/conf/server.xml to ascertain that\nthe RemoteAddrValve option\nis uncommented and configured to only allow access to systems required to\nconnect.\n\"\n  tag \"fix\": \"For the administration application, edit\n$CATALINA_HOME/conf/server.xml and\nuncomment the following:\n<Valve className='org.apache.catalina.valves.RemoteAddrValve'\nallow='127\\\\.0\\\\.0\\\\.1'/>\nNote: The RemoteAddrValve property expects a regular expression, therefore\nperiods and\nother regular expression meta-characters must be escaped.\n\"\n  tag \"Default Value\": \"By default, this configuration is not present.\\n\"\n\n  begin\n    describe xml(TOMCAT_CONF_SERVER) do\n      its('Server/Service/Engine/Host/Valve/attribute::className') { should include \"org.apache.catalina.valves.RemoteAddrValve\" }\n      its('Server/Service/Engine/Host/Valve/attribute::allow') { should_not be_empty }\n      its('Server/Service/Engine/Host/Valve/attribute::allow') { should_not cmp '' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.2.rb",
        "line": 29
      },
      "id": "M-10.2"
    },
    {
      "title": "6.1 Setup Client-cert Authentication (Scored)",
      "desc": "Client-cert authentication requires that each client connecting to the\nserver has a certificate used to authenticate. This is generally regarded as\nstrong authentication than a password as it requires the client to have the\ncert and not just know a password. Certificate based authentication is more\nsecure than password based authentication.",
      "descriptions": {
        "default": "Client-cert authentication requires that each client connecting to the\nserver has a certificate used to authenticate. This is generally regarded as\nstrong authentication than a password as it requires the client to have the\ncert and not just know a password. Certificate based authentication is more\nsecure than password based authentication."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://tomcat.apache.org/tomcat-8.0-doc/config/http.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html",
        "severity": "medium",
        "cis_id": "6.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Review the Connector configuration in server.xml and\nensure the clientAuth parameter is\nset to true.\n",
        "fix": "In the Connector element, set the clientAuth parameter to true.\n<-- Define a SSL Coyote HTTP/1.1 Connector on port 8443 -->\n<Connector\nport='8443' minProcessors='5' maxProcessors='75'\nenableLookups='true' disableUploadTimeout='true'\nacceptCount='100' debug='0' scheme='https' secure='true';\nclientAuth='true' sslProtocol='TLS'/>\n",
        "Default Value": "Not configured\n"
      },
      "code": "control \"M-6.1\" do\n  title \"6.1 Setup Client-cert Authentication (Scored)\"\n  desc  \"Client-cert authentication requires that each client connecting to the\nserver has a certificate used to authenticate. This is generally regarded as\nstrong authentication than a password as it requires the client to have the\ncert and not just know a password. Certificate based authentication is more\nsecure than password based authentication. \"\n  impact 0.5\n  tag \"ref\": \"1. https://tomcat.apache.org/tomcat-8.0-doc/config/http.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Review the Connector configuration in server.xml and\nensure the clientAuth parameter is\nset to true.\n\"\n  tag \"fix\": \"In the Connector element, set the clientAuth parameter to true.\n<-- Define a SSL Coyote HTTP/1.1 Connector on port 8443 -->\n<Connector\nport='8443' minProcessors='5' maxProcessors='75'\nenableLookups='true' disableUploadTimeout='true'\nacceptCount='100' debug='0' scheme='https' secure='true';\nclientAuth='true' sslProtocol='TLS'/>\n\"\n  tag \"Default Value\": \"Not configured\\n\"\n\n  begin\n    tomcat_server = tomcat_server_xml(\"#{TOMCAT_CONF_SERVER}\")\n\n    tomcat_server.params.each do |connector|\n      describe connector do\n        if connector[:secure] == 'true'\n          its([:clientauth]) { should cmp 'true' }\n        end\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-6.1.rb",
        "line": 41
      },
      "id": "M-6.1"
    },
    {
      "title": "6.4 Ensure secure is set to true only for SSL-enabled Connectors\n(Scored)",
      "desc": "The secure attribute is used to convey Connector security status to\napplications operating over the Connector. This is typically achieved by\ncalling request.isSecure(). Ensure the secure attribute is only set to true for\nConnectors operating with the SSLEnabled attribute set to true. Accurately\nreporting the security state of the Connector will help ensure that\napplications built on Tomcat are not unknowingly relying on security controls\nthat are not in place.",
      "descriptions": {
        "default": "The secure attribute is used to convey Connector security status to\napplications operating over the Connector. This is typically achieved by\ncalling request.isSecure(). Ensure the secure attribute is only set to true for\nConnectors operating with the SSLEnabled attribute set to true. Accurately\nreporting the security state of the Connector will help ensure that\napplications built on Tomcat are not unknowingly relying on security controls\nthat are not in place."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/http.html",
        "severity": "medium",
        "cis_id": "6.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review server.xml and ensure the secure attribute is set\nto true for those Connectors\nhaving SSLEnabled set to true. Also, ensure the secure attribute set to false\nfor those\nConnectors having SSLEnabled set to false.\n",
        "fix": "For each Connector defined in server.xml, set the secure\nattribute to true for those\nConnectors having SSLEnabled set to true. Set the secure attribute set to false\nfor those\nConnectors having SSLEnabled set to false.\n<Connector SSLEnabled='true'\n…\nsecure='true'\n…\n/>\n",
        "Default Value": "The secure attribute is set to false.\n"
      },
      "code": "control \"M-6.4\" do\n  title \"6.4 Ensure secure is set to true only for SSL-enabled Connectors\n(Scored)\"\n  desc  \"The secure attribute is used to convey Connector security status to\napplications operating over the Connector. This is typically achieved by\ncalling request.isSecure(). Ensure the secure attribute is only set to true for\nConnectors operating with the SSLEnabled attribute set to true. Accurately\nreporting the security state of the Connector will help ensure that\napplications built on Tomcat are not unknowingly relying on security controls\nthat are not in place. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/http.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review server.xml and ensure the secure attribute is set\nto true for those Connectors\nhaving SSLEnabled set to true. Also, ensure the secure attribute set to false\nfor those\nConnectors having SSLEnabled set to false.\n\"\n  tag \"fix\": \"For each Connector defined in server.xml, set the secure\nattribute to true for those\nConnectors having SSLEnabled set to true. Set the secure attribute set to false\nfor those\nConnectors having SSLEnabled set to false.\n<Connector SSLEnabled='true'\n…\nsecure='true'\n…\n/>\n\"\n  tag \"Default Value\": \"The secure attribute is set to false.\\n\"\n\n  begin\n    tomcat_server = tomcat_server_xml(\"#{TOMCAT_CONF_SERVER}\")\n\n    tomcat_server.params.each do |connector|\n      describe connector do\n        if connector[:sslenable] == \"true\"\n          its([:secure]) { should cmp 'true' }\n        end\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-6.4.rb",
        "line": 41
      },
      "id": "M-6.4"
    },
    {
      "title": "3.1 Set a nondeterministic Shutdown command value (Scored)",
      "desc": "Tomcat listens on TCP port 8005 to accept shutdown requests. By\nconnecting to this port and sending the SHUTDOWN command, all applications\nwithin Tomcat are halted. The shutdown port is not exposed to the network as it\nis bound to the loopback interface. It is recommended that a nondeterministic\nvalue be set for the shutdown attribute in $CATALINA_HOME/conf/server.xml.\nSetting the shutdown attribute to a nondeterministic value will prevent\nmalicious local users from shutting down Tomcat.",
      "descriptions": {
        "default": "Tomcat listens on TCP port 8005 to accept shutdown requests. By\nconnecting to this port and sending the SHUTDOWN command, all applications\nwithin Tomcat are halted. The shutdown port is not exposed to the network as it\nis bound to the loopback interface. It is recommended that a nondeterministic\nvalue be set for the shutdown attribute in $CATALINA_HOME/conf/server.xml.\nSetting the shutdown attribute to a nondeterministic value will prevent\nmalicious local users from shutting down Tomcat."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/config/server.html",
        "severity": "medium",
        "cis_id": "3.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the shutdown port is\nconfigured to use the default\nshutdown command: Ensure the shutdown attribute in\n$CATALINA_HOME/conf/server.xml is not set to\nSHUTDOWN.\n$ cd $CATALINA_HOME/conf\n$ grep ‘shutdown[[:space:]]*=[[:space:]]*”SHUTDOWN‟’ server.xml\n",
        "fix": "Perform the following to set a nondeterministic value for the\nshutdown attribute. Update the shutdown attribute in\n$CATALINA_HOME/conf/server.xml as follows:\n<Server port='8005' shutdown='NONDETERMINISTICVALUE'>\n\nNote: NONDETERMINISTICVALUE should be replaced with a sequence of random\ncharacters.\n",
        "Default Value": "The default value for the shutdown attribute is\nSHUTDOWN.\n"
      },
      "code": "control \"M-3.1\" do\n  title \"3.1 Set a nondeterministic Shutdown command value (Scored)\"\n  desc  \"Tomcat listens on TCP port 8005 to accept shutdown requests. By\nconnecting to this port and sending the SHUTDOWN command, all applications\nwithin Tomcat are halted. The shutdown port is not exposed to the network as it\nis bound to the loopback interface. It is recommended that a nondeterministic\nvalue be set for the shutdown attribute in $CATALINA_HOME/conf/server.xml.\nSetting the shutdown attribute to a nondeterministic value will prevent\nmalicious local users from shutting down Tomcat. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/config/server.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the shutdown port is\nconfigured to use the default\nshutdown command: Ensure the shutdown attribute in\n$CATALINA_HOME/conf/server.xml is not set to\nSHUTDOWN.\n$ cd $CATALINA_HOME/conf\n$ grep ‘shutdown[[:space:]]*=[[:space:]]*”SHUTDOWN‟’ server.xml\n\"\n  tag \"fix\": \"Perform the following to set a nondeterministic value for the\nshutdown attribute. Update the shutdown attribute in\n$CATALINA_HOME/conf/server.xml as follows:\n<Server port='8005' shutdown='NONDETERMINISTICVALUE'>\n\nNote: NONDETERMINISTICVALUE should be replaced with a sequence of random\ncharacters.\n\"\n  tag \"Default Value\": \"The default value for the shutdown attribute is\nSHUTDOWN.\\n\"\n\n  describe xml(\"#{TOMCAT_HOME}/conf/server.xml\") do\n    its('Server/@shutdown') { should_not cmp 'SHUTDOWN' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-3.1.rb",
        "line": 17
      },
      "id": "M-3.1"
    },
    {
      "title": "2.6 Turn off TRACE (Scored)",
      "desc": "The HTTP TRACE verb provides debugging and diagnostics information for\na given request. Diagnostic information, such as that found in the response to\na TRACE request, often contains sensitive information that may useful to an\nattacker. By preventing Tomcat from providing this information, the risk of\nleaking sensitive information to a potential attacker is reduced.",
      "descriptions": {
        "default": "The HTTP TRACE verb provides debugging and diagnostics information for\na given request. Diagnostic information, such as that found in the response to\na TRACE request, often contains sensitive information that may useful to an\nattacker. By preventing Tomcat from providing this information, the risk of\nleaking sensitive information to a potential attacker is reduced."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/config/http.html",
        "severity": "medium",
        "cis_id": "2.6",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the server platform,\nas advertised in the HTTP Server\nheader, has been changed: Locate all Connector elements in\n$CATALINA_HOME/conf/server.xml. Ensure each Connector does not have a\nallowTrace attribute or if the allowTrace\nattribute is not set true.\nNote: Perform the above for each application hosted within Tomcat. Per\napplication\ninstances of web.xml can be found at\n$CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml\n",
        "fix": "Perform the following to prevent Tomcat from accepting a TRACE\nrequest: Set the allowTrace attributes to each Connector specified in\n$CATALINA_HOME/conf/server.xml to false.\n<Connector ... allowTrace='false' />\nAlternatively, ensure the allowTrace attribute for each Connector specified in\n\n$CATALINA_HOME/conf/server.xml is absent.\n\n",
        "Default Value": "Tomcat does not allow the TRACE HTTP verb by default.\nTomcat will only allow TRACE if\nthe allowTrace attribute is present and set to\ntrue.\n"
      },
      "code": "control \"M-2.6\" do\n  title \"2.6 Turn off TRACE (Scored)\"\n  desc  \"The HTTP TRACE verb provides debugging and diagnostics information for\na given request. Diagnostic information, such as that found in the response to\na TRACE request, often contains sensitive information that may useful to an\nattacker. By preventing Tomcat from providing this information, the risk of\nleaking sensitive information to a potential attacker is reduced. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/config/http.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.6\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the server platform,\nas advertised in the HTTP Server\nheader, has been changed: Locate all Connector elements in\n$CATALINA_HOME/conf/server.xml. Ensure each Connector does not have a\nallowTrace attribute or if the allowTrace\nattribute is not set true.\nNote: Perform the above for each application hosted within Tomcat. Per\napplication\ninstances of web.xml can be found at\n$CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml\n\"\n  tag \"fix\": \"Perform the following to prevent Tomcat from accepting a TRACE\nrequest: Set the allowTrace attributes to each Connector specified in\n$CATALINA_HOME/conf/server.xml to false.\n<Connector ... allowTrace='false' />\nAlternatively, ensure the allowTrace attribute for each Connector specified in\n\n$CATALINA_HOME/conf/server.xml is absent.\n\n\"\n  tag \"Default Value\": \"Tomcat does not allow the TRACE HTTP verb by default.\nTomcat will only allow TRACE if\\nthe allowTrace attribute is present and set to\ntrue.\\n\"\n\n  allowTraceIter = 1\n  tomcat_conf = xml(\"#{TOMCAT_HOME}/conf/server.xml\")\n  if tomcat_conf['Server/Service/Connector/@allowTrace'].is_a?(Array) && tomcat_conf['Server/Service/Connector/@allowTrace'].any?\n    numConnectors = tomcat_conf['Server/Service/Connector'].count\n    until allowTraceIter > numConnectors do\n       describe.one do\n         describe tomcat_conf[\"Server/Service/Connector[#{allowTraceIter}]/@allowTrace\"] do\n           it { should cmp 'false' }\n         end\n         describe tomcat_conf[\"Server/Service/Connector[#{allowTraceIter}]/@allowTrace\"] do\n           it { should cmp [] }\n         end\n       end\n       allowTraceIter +=1\n    end\n  end\n\n  if !tomcat_conf['Server/Service/Connector/@allowTrace'].any?\n    describe tomcat_conf['Server/Service/Connector/@allowTrace'] do\n      it { should cmp [] }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-2.6.rb",
        "line": 17
      },
      "id": "M-2.6"
    },
    {
      "title": "7.1 Application specific logging (Scored)",
      "desc": "By default, java.util.logging does not provide the capabilities to\nconfigure per-web application settings, only per VM. In order to overcome this\nlimitation Tomcat implements JULI as a wrapper for java.util.logging. JULI\nprovides additional configuration functionality so you can set each web\napplication with different logging specifications. Establishing per application\nlogging profiles will help ensure that each application’s logging verbosity is\nset to an appropriate level in order to provide appropriate information when\nneeded for security review.",
      "descriptions": {
        "default": "By default, java.util.logging does not provide the capabilities to\nconfigure per-web application settings, only per VM. In order to overcome this\nlimitation Tomcat implements JULI as a wrapper for java.util.logging. JULI\nprovides additional configuration functionality so you can set each web\napplication with different logging specifications. Establishing per application\nlogging profiles will help ensure that each application’s logging verbosity is\nset to an appropriate level in order to provide appropriate information when\nneeded for security review."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Ensure a logging.properties file is locate at\n$CATALINA_BASE\\webapps\\<app_name>\\WEB-INF\\classes.\n",
        "fix": "Create a logging.properties file and place that into your\napplication WEB-INF\\classes\ndirectory. Note: By default, installing Tomcat places a logging.properties file\nin\n$CATALINA_HOME\\conf. This file can be used as base for an application specific\nlogging\nproperties file\n",
        "Default Value": "By default, per application logging is not configured."
      },
      "code": "control \"M-7.1\" do\n  title \"7.1 Application specific logging (Scored)\"\n  desc  \"By default, java.util.logging does not provide the capabilities to\nconfigure per-web application settings, only per VM. In order to overcome this\nlimitation Tomcat implements JULI as a wrapper for java.util.logging. JULI\nprovides additional configuration functionality so you can set each web\napplication with different logging specifications. Establishing per application\nlogging profiles will help ensure that each application’s logging verbosity is\nset to an appropriate level in order to provide appropriate information when\nneeded for security review. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Ensure a logging.properties file is locate at\n$CATALINA_BASE\\\\webapps\\\\<app_name>\\\\WEB-INF\\\\classes.\n\"\n  tag \"fix\": \"Create a logging.properties file and place that into your\napplication WEB-INF\\\\classes\ndirectory. Note: By default, installing Tomcat places a logging.properties file\nin\n$CATALINA_HOME\\\\conf. This file can be used as base for an application specific\nlogging\nproperties file\n\"\n  tag \"Default Value\": \"By default, per application logging is not configured.\"\n\n  begin\n    apps = command(\"ls #{TOMCAT_HOME}/webapps/\").stdout.split\n    ignore = ['docs', 'examples', 'host-manager', 'manager', 'ROOT']\n\n    ignore.each do |x|\n      if apps.include?(x)\n        apps.delete(x)\n      end\n    end\n\n    apps.each do |app|\n      describe command(\"ls #{TOMCAT_HOME}/webapps/#{app}/WEB-INF/classes/logging.properties\") do\n        its('stdout') { should_not eq \"\" }\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-7.1.rb",
        "line": 41
      },
      "id": "M-7.1"
    },
    {
      "title": "9.2 Disabling auto deployment of applications (Scored)",
      "desc": "Tomcat allows auto deployment of applications while Tomcat is running.\nIt is recommended that this capability be disabled. This could allow malicious\nor untested applications to be deployed and should be disabled.",
      "descriptions": {
        "default": "Tomcat allows auto deployment of applications while Tomcat is running.\nIt is recommended that this capability be disabled. This could allow malicious\nor untested applications to be deployed and should be disabled."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/deployerhowto.html#Deploying_on_a_running_Tomcat_server\n2. https://tomcat.apache.org/tomcat-8.0-doc/config/host.html",
        "severity": "medium",
        "cis_id": "9.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to ensure autoDeploy is set to\nfalse.\n# grep 'autoDeploy' $CATALINA_HOME/conf/server.xml\n",
        "fix": "In the $CATALINA_HOME/conf/server.xml file, change autoDeploy to\nfalse.\nautoDeploy='false'\n",
        "Default Value": "autoDeploy is set to true\n"
      },
      "code": "control \"M-9.2\" do\n  title \"9.2 Disabling auto deployment of applications (Scored)\"\n  desc  \"Tomcat allows auto deployment of applications while Tomcat is running.\nIt is recommended that this capability be disabled. This could allow malicious\nor untested applications to be deployed and should be disabled. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/deployerhowto.html#Deploying_on_a_running_Tomcat_server\n2. https://tomcat.apache.org/tomcat-8.0-doc/config/host.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"9.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to ensure autoDeploy is set to\nfalse.\n# grep 'autoDeploy' $CATALINA_HOME/conf/server.xml\n\"\n  tag \"fix\": \"In the $CATALINA_HOME/conf/server.xml file, change autoDeploy to\nfalse.\nautoDeploy='false'\n\"\n  tag \"Default Value\": \"autoDeploy is set to true\\n\"\n\n  begin\n    describe xml(TOMCAT_CONF_SERVER) do\n      its('Server/Service/Engine/Host/attribute::autoDeploy') { should cmp 'false' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-9.2.rb",
        "line": 35
      },
      "id": "M-9.2"
    },
    {
      "title": "10.12 Force SSL for all applications (Scored)",
      "desc": "Use the transport-guarantee attribute to ensure SSL protection when\naccessing all applications. This can be overridden to be disabled on a per\napplication basis in the application configuration. By default, when accessing\napplications SSL will be enforced to protect information sent over the network.\nBy using the transport-guarantee attribute within web.xml, SSL is enforced.\nNOTE: This requires SSL to be configured.",
      "descriptions": {
        "default": "Use the transport-guarantee attribute to ensure SSL protection when\naccessing all applications. This can be overridden to be disabled on a per\napplication basis in the application configuration. By default, when accessing\napplications SSL will be enforced to protect information sent over the network.\nBy using the transport-guarantee attribute within web.xml, SSL is enforced.\nNOTE: This requires SSL to be configured."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://www.owasp.org/index.php/Securing_tomcat",
        "severity": "medium",
        "cis_id": "10.12",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Ensure $CATALINA_HOME/conf/web.xml has the attribute set\nto CONFIDENTIAL.\n# grep transport-guarantee $CATALINA_HOME/conf/web.xml\n",
        "fix": "In $CATALINA_HOME/conf/web.xml, set the following:\n<user-data-constraint>\n<transport-guarantee>CONFIDENTIAL</transport-guarantee>\n<user-data-constraint>\n",
        "Default Value": "By default, this configuration is not present.\n"
      },
      "code": "control \"M-10.12\" do\n  title \"10.12 Force SSL for all applications (Scored)\"\n  desc  \"Use the transport-guarantee attribute to ensure SSL protection when\naccessing all applications. This can be overridden to be disabled on a per\napplication basis in the application configuration. By default, when accessing\napplications SSL will be enforced to protect information sent over the network.\nBy using the transport-guarantee attribute within web.xml, SSL is enforced.\nNOTE: This requires SSL to be configured. \"\n  impact 0.5\n  tag \"ref\": \"1. http://www.owasp.org/index.php/Securing_tomcat\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.12\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Ensure $CATALINA_HOME/conf/web.xml has the attribute set\nto CONFIDENTIAL.\n# grep transport-guarantee $CATALINA_HOME/conf/web.xml\n\"\n  tag \"fix\": \"In $CATALINA_HOME/conf/web.xml, set the following:\n<user-data-constraint>\n<transport-guarantee>CONFIDENTIAL</transport-guarantee>\n<user-data-constraint>\n\"\n  tag \"Default Value\": \"By default, this configuration is not present.\\n\"\n\n  begin\n    describe xml(TOMCAT_CONF_WEB) do\n      its('web-app/security-constraint/user-data-constraint/transport-guarantee') { should eq ['CONFIDENTIAL'] }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.12.rb",
        "line": 29
      },
      "id": "M-10.12"
    },
    {
      "title": "3.2 Disable the Shutdown port (Not Scored)",
      "desc": "Tomcat listens on TCP port 8005 to accept shutdown requests. By\nconnecting to this port and sending the SHUTDOWN command, all applications\nwithin Tomcat are halted. The shutdown port is not exposed to the network as it\nis bound to the loopback interface. If this functionality is not used, it is\nrecommended that the Shutdown port be disabled. Disabling the Shutdown port\nwill eliminate the risk of malicious local entities using the shutdown command\nto disable the Tomcat server.",
      "descriptions": {
        "default": "Tomcat listens on TCP port 8005 to accept shutdown requests. By\nconnecting to this port and sending the SHUTDOWN command, all applications\nwithin Tomcat are halted. The shutdown port is not exposed to the network as it\nis bound to the loopback interface. If this functionality is not used, it is\nrecommended that the Shutdown port be disabled. Disabling the Shutdown port\nwill eliminate the risk of malicious local entities using the shutdown command\nto disable the Tomcat server."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/config/server.html",
        "severity": "medium",
        "cis_id": "3.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to determine if the shutdown port\nhas been disabled: Ensure the port attribute in $CATALINA_HOME/conf/server.xml\nis set to -1.\n$ cd $CATALINA_HOME/conf/\n$ grep '<Server[[:space:]]\\+[^>]*port[[:space:]]*=[[:space:]]*'-1'' server.xml\n\n",
        "fix": "Perform the following to disable the Shutdown port. Set the port\nto -1 in the $CATALINA_HOME/conf/server.xml file:\n<Server port='-1' shutdown='SHUTDOWN'>\n",
        "Default Value": "The shutdown port is enabled on TCP port 8005, bound to\nthe loopback address.\n"
      },
      "code": "control \"M-3.2\" do\n  title \"3.2 Disable the Shutdown port (Not Scored)\"\n  desc  \"Tomcat listens on TCP port 8005 to accept shutdown requests. By\nconnecting to this port and sending the SHUTDOWN command, all applications\nwithin Tomcat are halted. The shutdown port is not exposed to the network as it\nis bound to the loopback interface. If this functionality is not used, it is\nrecommended that the Shutdown port be disabled. Disabling the Shutdown port\nwill eliminate the risk of malicious local entities using the shutdown command\nto disable the Tomcat server. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/config/server.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to determine if the shutdown port\nhas been disabled: Ensure the port attribute in $CATALINA_HOME/conf/server.xml\nis set to -1.\n$ cd $CATALINA_HOME/conf/\n$ grep '<Server[[:space:]]\\\\+[^>]*port[[:space:]]*=[[:space:]]*'-1'' server.xml\n\n\"\n  tag \"fix\": \"Perform the following to disable the Shutdown port. Set the port\nto -1 in the $CATALINA_HOME/conf/server.xml file:\n<Server port='-1' shutdown='SHUTDOWN'>\n\"\n  tag \"Default Value\": \"The shutdown port is enabled on TCP port 8005, bound to\nthe loopback address.\\n\"\n\n  describe xml(\"#{TOMCAT_HOME}/conf/server.xml\") do\n    its('Server/@port') { should cmp '-1' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-3.2.rb",
        "line": 17
      },
      "id": "M-3.2"
    },
    {
      "title": "7.7 Configure log file size limit (Scored)",
      "desc": "By default, the logging.properties file will have no defined limit for\nthe log file size. This is a potential denial of service attack as it would be\npossible to fill a drive or partition containing the log files. Establishing a\nmaximum log size that is smaller than the partition size will help mitigate the\nrisk of an attacker maliciously exhausting disk space.",
      "descriptions": {
        "default": "By default, the logging.properties file will have no defined limit for\nthe log file size. This is a potential denial of service attack as it would be\npossible to fill a drive or partition containing the log files. Establishing a\nmaximum log size that is smaller than the partition size will help mitigate the\nrisk of an attacker maliciously exhausting disk space."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://docs.oracle.com/javase/8/docs/api/java/util/logging/FileHandler.html",
        "severity": "medium",
        "cis_id": "7.7",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Validate the max file limit is not greater than the size\nof the partition where the log files are\nstored.\n",
        "fix": "Create the following entry in your logging.properties file. This\nfield is specified in bytes.\njava.util.logging.FileHandler.limit=10000\n",
        "Default Value": "No limit by default.\n"
      },
      "code": "control \"M-7.7\" do\n  title \"7.7 Configure log file size limit (Scored)\"\n  desc  \"By default, the logging.properties file will have no defined limit for\nthe log file size. This is a potential denial of service attack as it would be\npossible to fill a drive or partition containing the log files. Establishing a\nmaximum log size that is smaller than the partition size will help mitigate the\nrisk of an attacker maliciously exhausting disk space. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://docs.oracle.com/javase/8/docs/api/java/util/logging/FileHandler.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.7\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Validate the max file limit is not greater than the size\nof the partition where the log files are\nstored.\n\"\n  tag \"fix\": \"Create the following entry in your logging.properties file. This\nfield is specified in bytes.\njava.util.logging.FileHandler.limit=10000\n\"\n  tag \"Default Value\": \"No limit by default.\\n\"\n\n  begin\n    cat_prop = tomcat_properties_file.read_content(\"#{TOMCAT_HOME}/conf/catalina.properties\")\n    describe cat_prop['java.util.logging.FileHandler.limit'] do\n      it { should cmp '10000' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-7.7.rb",
        "line": 35
      },
      "id": "M-7.7"
    },
    {
      "title": "7.4 Ensure directory in context.xml is a secure location (Scored)",
      "desc": "The directory attribute tells Tomcat where to store logs. It is\nrecommended that the location pointed to by the directory attribute be secured.\nSecuring the log location will help ensure the integrity and confidentiality of\nweb application activity.",
      "descriptions": {
        "default": "The directory attribute tells Tomcat where to store logs. It is\nrecommended that the location pointed to by the directory attribute be secured.\nSecuring the log location will help ensure the integrity and confidentiality of\nweb application activity."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review the permissions of the directory specified by the\ndirectory setting to ensure the\npermissions are o-rwx and owned by tomcat_admin:tomcat:\n# grep directory context.xml\n# ls –ld <log location>\n",
        "fix": "Perform the following: Add the following statement into the\n$CATALINA_BASE\\webapps\\<app-name>\\METAINF\\context.xml file if it does not\nalready exist.\n<Valve className='org.apache.catalina.valves.AccessLogValve'\ndirectory='$CATALINA_HOME/logs/'\nprefix='access_log' fileDateFormat='yyyy-MM-dd.HH' suffix='.log' pattern='%t %H\n\ncookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r'\n/> Set the location pointed to by the directory attribute to be owned by\ntomcat_admin:tomcat with permissions of o-rwx.\n# chown tomcat_admin:tomcat $CATALINA_HOME/logs\n# chmod o-rwx $CATALINA_HOME/logs\n",
        "Default Value": "Does not exist by default"
      },
      "code": "control \"M-7.4\" do\n  title \"7.4 Ensure directory in context.xml is a secure location (Scored)\"\n  desc  \"The directory attribute tells Tomcat where to store logs. It is\nrecommended that the location pointed to by the directory attribute be secured.\nSecuring the log location will help ensure the integrity and confidentiality of\nweb application activity. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review the permissions of the directory specified by the\ndirectory setting to ensure the\npermissions are o-rwx and owned by tomcat_admin:tomcat:\n# grep directory context.xml\n# ls –ld <log location>\n\"\n  tag \"fix\": \"Perform the following: Add the following statement into the\n$CATALINA_BASE\\\\webapps\\\\<app-name>\\\\METAINF\\\\context.xml file if it does not\nalready exist.\n<Valve className='org.apache.catalina.valves.AccessLogValve'\ndirectory='$CATALINA_HOME/logs/'\nprefix='access_log' fileDateFormat='yyyy-MM-dd.HH' suffix='.log' pattern='%t %H\n\ncookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r'\n/> Set the location pointed to by the directory attribute to be owned by\ntomcat_admin:tomcat with permissions of o-rwx.\n# chown tomcat_admin:tomcat $CATALINA_HOME/logs\n# chmod o-rwx $CATALINA_HOME/logs\n\"\n  tag \"Default Value\": \"Does not exist by default\"\n\n  begin\n    context_xml = command(\"ls #{TOMCAT_HOME}/webapps/*/META-INF/context.xml\").stdout.split.each do |web_file|\n      describe xml(web_file) do\n        its('Context/Valve/attribute::className') { should include \"org.apache.catalina.valves.AccessLogValve\" }\n        its('Context/Valve/attribute::directory') { should cmp '$CATALINA_HOME/logs/' }\n        its('Context/Valve/attribute::prefix') { should cmp 'access_log' }\n        its('Context/Valve/attribute::fileDateFormat') { should cmp 'yyyy-MM-dd.HH' }\n        its('Context/Valve/attribute::suffix') { should cmp '.log' }\n        its('Context/Valve/attribute::pattern') { should cmp '%h %t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r' }\n      end\n    end\n    describe directory(\"#{TOMCAT_HOME}/logs\") do\n      its('group') { should cmp 'tomcat' }\n      its('owner') { should cmp 'tomcat_admin' }\n      its('mode') { should cmp '0770' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-7.4.rb",
        "line": 35
      },
      "id": "M-7.4"
    },
    {
      "title": "10.7 Turn off session façade recycling (Scored)",
      "desc": "The RECYCLE_FACADES can specify if a new façade will be created for\neach request. If a new façade is not created there is a potential for\ninformation leakage from other sessions. When RECYCLE_FACADES is set to false,\nTomcat will recycle the session façade between requests. This will allow for\ninformation leakage between requests.",
      "descriptions": {
        "default": "The RECYCLE_FACADES can specify if a new façade will be created for\neach request. If a new façade is not created there is a potential for\ninformation leakage from other sessions. When RECYCLE_FACADES is set to false,\nTomcat will recycle the session façade between requests. This will allow for\ninformation leakage between requests."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/systemprops.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/security-howto.html",
        "severity": "medium",
        "cis_id": "10.7",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Ensure the above parameter is added to the startup script\nwhich by default is located at\n$CATALINA_HOME/bin/catalina.sh.\n",
        "fix": "Start Tomcat with RECYCLE_FACADES set to true. Add the following\nto your startup script.\n-Dorg.apache.catalina.connector.RECYCLE_FACADES=true\n",
        "Default Value": "If not specified, the default value of false will be\nused.\n"
      },
      "code": "control \"M-10.7\" do\n  title \"10.7 Turn off session façade recycling (Scored)\"\n  desc  \"The RECYCLE_FACADES can specify if a new façade will be created for\neach request. If a new façade is not created there is a potential for\ninformation leakage from other sessions. When RECYCLE_FACADES is set to false,\nTomcat will recycle the session façade between requests. This will allow for\ninformation leakage between requests. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/systemprops.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/security-howto.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.7\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Ensure the above parameter is added to the startup script\nwhich by default is located at\n$CATALINA_HOME/bin/catalina.sh.\n\"\n  tag \"fix\": \"Start Tomcat with RECYCLE_FACADES set to true. Add the following\nto your startup script.\n-Dorg.apache.catalina.connector.RECYCLE_FACADES=true\n\"\n  tag \"Default Value\": \"If not specified, the default value of false will be\nused.\\n\"\n\n  begin\n    cat_prop = tomcat_properties_file.read_content(\"#{TOMCAT_HOME}/conf/catalina.properties\")\n\n    describe cat_prop['org.apache.catalina.connector.RECYCLE_FACADES'] do\n      it { should cmp 'true' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.7.rb",
        "line": 29
      },
      "id": "M-10.7"
    },
    {
      "title": "10.5 Rename the manager application (Scored)",
      "desc": "The manager application allows administrators to manage Tomcat\nremotely via a web interface. The manager application should be renamed to make\nit harder for attackers or automated scripts to locate. Obscurity can be\nhelpful when used with other security measures. By relocating the manager\napplications, an attacker will need to guess its location rather than simply\nnavigate to the standard location in order to carry out an attack.",
      "descriptions": {
        "default": "The manager application allows administrators to manage Tomcat\nremotely via a web interface. The manager application should be renamed to make\nit harder for attackers or automated scripts to locate. Obscurity can be\nhelpful when used with other security measures. By relocating the manager\napplications, an attacker will need to guess its location rather than simply\nnavigate to the standard location in order to carry out an attack."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://www.owasp.org/index.php/Securing_tomcat",
        "severity": "medium",
        "cis_id": "10.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Ensure $CATALINA_HOME/conf/Catalina/localhost/manager.xml,\n\n$CATALINA_HOME/webapps/host-manager/manager.xml,\n$CATALINA_HOME/webapps/manager and $CATALINA_HOME/webapps/manager do not\nexsist.\n",
        "fix": "Perform the following to rename the manager application: Rename\nthe manager application XML file:\n# mv $CATALINA_HOME/webapps/host-manager/manager.xml \\\n$CATALINA_HOME/webapps/host-manager/new-name.xml Update the docBase attribute\nwithin $CATALINA_HOME/webapps/host-manager/newname.xml to\n${catalina.home}/webapps/new-name Move $CATALINA_HOME/webapps/manager to\n$CATALINA_HOME/webapps/newname\n# mv $CATALINA_HOME/webapps/manager $CATALINA_HOME/webapps/new-name\n",
        "Default Value": "The default name of the manager application is\n“manager\" and is located at:\n$CATALINA_HOME/webapps/manager\n\n"
      },
      "code": "control \"M-10.5\" do\n  title \"10.5 Rename the manager application (Scored)\"\n  desc  \"The manager application allows administrators to manage Tomcat\nremotely via a web interface. The manager application should be renamed to make\nit harder for attackers or automated scripts to locate. Obscurity can be\nhelpful when used with other security measures. By relocating the manager\napplications, an attacker will need to guess its location rather than simply\nnavigate to the standard location in order to carry out an attack. \"\n  impact 0.5\n  tag \"ref\": \"1. https://www.owasp.org/index.php/Securing_tomcat\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Ensure $CATALINA_HOME/conf/Catalina/localhost/manager.xml,\n\n$CATALINA_HOME/webapps/host-manager/manager.xml,\n$CATALINA_HOME/webapps/manager and $CATALINA_HOME/webapps/manager do not\nexsist.\n\"\n  tag \"fix\": \"Perform the following to rename the manager application: Rename\nthe manager application XML file:\n# mv $CATALINA_HOME/webapps/host-manager/manager.xml \\\\\n$CATALINA_HOME/webapps/host-manager/new-name.xml Update the docBase attribute\nwithin $CATALINA_HOME/webapps/host-manager/newname.xml to\n${catalina.home}/webapps/new-name Move $CATALINA_HOME/webapps/manager to\n$CATALINA_HOME/webapps/newname\n# mv $CATALINA_HOME/webapps/manager $CATALINA_HOME/webapps/new-name\n\"\n  tag \"Default Value\": \"The default name of the manager application is\n“manager\\\" and is located at:\\n$CATALINA_HOME/webapps/manager\\n\\n\"\n\n  begin\n    man_dir = command(\"find #{TOMCAT_HOME}/webapps/ -name manager\")\n    man_xml = command(\"find #{TOMCAT_HOME}/webapps/ -name manager.xml\")\n    man_local_xml = command(\"find #{TOMCAT_HOME}/conf/Catalina/localhost/ - name manager.xml\")\n\n    describe man_dir do\n      its('stdout') { should_not include 'manager'}\n    end\n    describe man_xml do\n      its('stdout') { should_not include 'manager.xml'}\n    end\n    describe man_local_xml do\n      its('stdout') { should_not include 'manager.xml'}\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.5.rb",
        "line": 35
      },
      "id": "M-10.5"
    },
    {
      "title": "4.7 Restrict access to Tomcat web application directory (Scored)",
      "desc": "The Tomcat $CATALINA_HOME/webapps directory contains web applications\nthat are deployed through Tomcat. It is recommended that the ownership of this\ndirectory be tomcat_admin:tomcat. It is also recommended that the permission on\n$CATALINA_HOME/webapps prevent read, write, and execute for the world (o-rwx)\nand prevent write access to the group (g-w). Restricting access to these\ndirectories will prevent local users from maliciously or inadvertently\naffecting the integrity of web applications.",
      "descriptions": {
        "default": "The Tomcat $CATALINA_HOME/webapps directory contains web applications\nthat are deployed through Tomcat. It is recommended that the ownership of this\ndirectory be tomcat_admin:tomcat. It is also recommended that the permission on\n$CATALINA_HOME/webapps prevent read, write, and execute for the world (o-rwx)\nand prevent write access to the group (g-w). Restricting access to these\ndirectories will prevent local users from maliciously or inadvertently\naffecting the integrity of web applications."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.7",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/webapps are securely configured. Change to the location of the\n$CATALINA_HOME/webapps and execute the\nfollowing:\n# cd $CATALINA_HOME\n# find webapps -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user tomcat_admin\n\n-o ! -group tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to Tomcat webapps\ndirectory: Set the ownership of the $CATALINA_HOME/webapps to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\n\n# chown tomcat_admin:tomcat $CATALINA_HOME/webapps\n# chmod g-w,o-rwx $CATALINA_HOME/webapps\n\n",
        "Default Value": "The default permissions of the top-level directories is\n770."
      },
      "code": "control \"M-4.7\" do\n  title \"4.7 Restrict access to Tomcat web application directory (Scored)\"\n  desc  \"The Tomcat $CATALINA_HOME/webapps directory contains web applications\nthat are deployed through Tomcat. It is recommended that the ownership of this\ndirectory be tomcat_admin:tomcat. It is also recommended that the permission on\n$CATALINA_HOME/webapps prevent read, write, and execute for the world (o-rwx)\nand prevent write access to the group (g-w). Restricting access to these\ndirectories will prevent local users from maliciously or inadvertently\naffecting the integrity of web applications. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.7\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/webapps are securely configured. Change to the location of the\n$CATALINA_HOME/webapps and execute the\nfollowing:\n# cd $CATALINA_HOME\n# find webapps -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user tomcat_admin\n\n-o ! -group tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to Tomcat webapps\ndirectory: Set the ownership of the $CATALINA_HOME/webapps to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\n\n# chown tomcat_admin:tomcat $CATALINA_HOME/webapps\n# chmod g-w,o-rwx $CATALINA_HOME/webapps\n\n\"\n  tag \"Default Value\": \"The default permissions of the top-level directories is\n770.\"\n\n  describe directory(\"#{TOMCAT_HOME}/webapps\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.7.rb",
        "line": 29
      },
      "id": "M-4.7"
    },
    {
      "title": "10.1 Ensure Web content directory is on a separate partition from the\nTomcat system files (Not Scored)",
      "desc": "Store web content on a separate partition from Tomcat system files.\nThe web document directory is where the files which are severed to the end user\nreside. In the past, directory traversal exploits have allowed malicious users\nto play havoc on a web server including executing code, uploading files, and\nreading sensitive data. Even if you do not have any directory traversal\nexploits in your server or code at this time, that doesn’t mean they won’t be\nintroduced in the future. Moving your web document directory onto a different\npartition will prevent these kinds of attacks from doing more damage to other\npart of the file system.",
      "descriptions": {
        "default": "Store web content on a separate partition from Tomcat system files.\nThe web document directory is where the files which are severed to the end user\nreside. In the past, directory traversal exploits have allowed malicious users\nto play havoc on a web server including executing code, uploading files, and\nreading sensitive data. Even if you do not have any directory traversal\nexploits in your server or code at this time, that doesn’t mean they won’t be\nintroduced in the future. Moving your web document directory onto a different\npartition will prevent these kinds of attacks from doing more damage to other\npart of the file system."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "10.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Locate the Tomcat system files and web content directory.\nReview the system partitions\nand ensure the system files and web content directory are on separate\npartitions.\n# df $CATALINA_HOME/webapps\n# df $CATALINA_HOME\nNote: Use the default value 'webapps' which is defined by 'appBase' attribute\nhere.\n",
        "fix": "Move the web content files to a separate partition from the\ntomcat system files and update\nyour configuration.\n",
        "Default Value": "Not Applicable"
      },
      "code": "control \"M-10.1\" do\n  title \"10.1 Ensure Web content directory is on a separate partition from the\nTomcat system files (Not Scored)\"\n  desc  \"Store web content on a separate partition from Tomcat system files.\nThe web document directory is where the files which are severed to the end user\nreside. In the past, directory traversal exploits have allowed malicious users\nto play havoc on a web server including executing code, uploading files, and\nreading sensitive data. Even if you do not have any directory traversal\nexploits in your server or code at this time, that doesn’t mean they won’t be\nintroduced in the future. Moving your web document directory onto a different\npartition will prevent these kinds of attacks from doing more damage to other\npart of the file system. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Locate the Tomcat system files and web content directory.\nReview the system partitions\nand ensure the system files and web content directory are on separate\npartitions.\n# df $CATALINA_HOME/webapps\n# df $CATALINA_HOME\nNote: Use the default value 'webapps' which is defined by 'appBase' attribute\nhere.\n\"\n  tag \"fix\": \"Move the web content files to a separate partition from the\ntomcat system files and update\nyour configuration.\n\"\n  tag \"Default Value\": \"Not Applicable\"\n\n  begin\n    tomcat_system = command(\"df #{TOMCAT_HOME}\").stdout.split[7]\n    tomcat_web = command(\"df #{TOMCAT_HOME}/webapps\").stdout.split[7]\n\n    describe tomcat_web do\n      it { should_not cmp tomcat_system }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.1.rb",
        "line": 35
      },
      "id": "M-10.1"
    },
    {
      "title": "4.4 Restrict access to Tomcat logs directory (Scored)",
      "desc": "The Tomcat $CATALINA_HOME/logs/ directory contains Tomcat logs. It is\nrecommended that the ownership of this directory be tomcat_admin:tomcat. It is\nalso recommended that the permissions on this directory prevent read, write,\nand execute for the world (o-rwx). Restricting access to these directories will\nprevent local users from maliciously or inadvertently altering Tomcat’s logs.",
      "descriptions": {
        "default": "The Tomcat $CATALINA_HOME/logs/ directory contains Tomcat logs. It is\nrecommended that the ownership of this directory be tomcat_admin:tomcat. It is\nalso recommended that the permissions on this directory prevent read, write,\nand execute for the world (o-rwx). Restricting access to these directories will\nprevent local users from maliciously or inadvertently altering Tomcat’s logs."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/logs are securely configured. Change to the location of the\n$CATALINA_HOME/logs and execute the following:\n# cd $CATALINA_HOME\n# find logs -follow -maxdepth 0 \\( -perm /o+rwx -o ! -user tomcat_admin -o !\ngroup tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to Tomcat log files: Set\nthe ownership of the $CATALINA_HOME/logs to tomcat_admin:tomcat. Remove read,\nwrite, and execute permissions for the world\n# chown tomcat_admin:tomcat $CATALINA_HOME/logs\n# chmod o-rwx $CATALINA_HOME/logs\n",
        "Default Value": "The default permissions of the top-level directories is\n770."
      },
      "code": "control \"M-4.4\" do\n  title \"4.4 Restrict access to Tomcat logs directory (Scored)\"\n  desc  \"The Tomcat $CATALINA_HOME/logs/ directory contains Tomcat logs. It is\nrecommended that the ownership of this directory be tomcat_admin:tomcat. It is\nalso recommended that the permissions on this directory prevent read, write,\nand execute for the world (o-rwx). Restricting access to these directories will\nprevent local users from maliciously or inadvertently altering Tomcat’s logs. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/logs are securely configured. Change to the location of the\n$CATALINA_HOME/logs and execute the following:\n# cd $CATALINA_HOME\n# find logs -follow -maxdepth 0 \\\\( -perm /o+rwx -o ! -user tomcat_admin -o !\ngroup tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to Tomcat log files: Set\nthe ownership of the $CATALINA_HOME/logs to tomcat_admin:tomcat. Remove read,\nwrite, and execute permissions for the world\n# chown tomcat_admin:tomcat $CATALINA_HOME/logs\n# chmod o-rwx $CATALINA_HOME/logs\n\"\n  tag \"Default Value\": \"The default permissions of the top-level directories is\n770.\"\n\n  describe directory(\"#{TOMCAT_HOME}/logs\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0770' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.4.rb",
        "line": 29
      },
      "id": "M-4.4"
    },
    {
      "title": "1.2 Disable Unused Connectors (Not Scored)",
      "desc": "The default installation of Tomcat includes connectors with default\nsettings. These are traditionally set up for convenience. It is best to remove\nthese connectors and enable only what is needed. Improperly configured or\nunnecessarily installed Connectors may lead to a security exposure.",
      "descriptions": {
        "default": "The default installation of Tomcat includes connectors with default\nsettings. These are traditionally set up for convenience. It is best to remove\nthese connectors and enable only what is needed. Improperly configured or\nunnecessarily installed Connectors may lead to a security exposure."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/http.html#Connector_Comparison",
        "severity": "medium",
        "cis_id": "1.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to identify configured Connectors:\nExecute the following command to find configured Connectors. Ensure only those\nrequired\nare present and not commented out:\n$ grep “Connector” $CATALINA_HOME/conf/server.xml\n",
        "fix": "Perform the following to disable unused Connectors: Within\n$CATALINA_HOME/conf/server.xml, remove or comment each unused Connector.\nFor example, to disable an instance of the HTTPConnector, remove the following:\n\n<Connector className='org.apache.catalina.connector.http.HttpConnector'\n...\nconnectionTimeout='60000'/>\n",
        "Default Value": "$CATALINA_HOME/conf/server.xml, has the following\nconnectors defined by default:\nA non-SSL Connector bound to port 8080\nAn AJP\n1.3 Connector bound to port 8009\n\n"
      },
      "code": "control \"M-1.2\" do\n  title \"1.2 Disable Unused Connectors (Not Scored)\"\n  desc  \"The default installation of Tomcat includes connectors with default\nsettings. These are traditionally set up for convenience. It is best to remove\nthese connectors and enable only what is needed. Improperly configured or\nunnecessarily installed Connectors may lead to a security exposure. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/http.html#Connector_Comparison\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"1.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to identify configured Connectors:\nExecute the following command to find configured Connectors. Ensure only those\nrequired\nare present and not commented out:\n$ grep “Connector” $CATALINA_HOME/conf/server.xml\n\"\n  tag \"fix\": \"Perform the following to disable unused Connectors: Within\n$CATALINA_HOME/conf/server.xml, remove or comment each unused Connector.\nFor example, to disable an instance of the HTTPConnector, remove the following:\n\n<Connector className='org.apache.catalina.connector.http.HttpConnector'\n...\nconnectionTimeout='60000'/>\n\"\n  tag \"Default Value\": \"$CATALINA_HOME/conf/server.xml, has the following\nconnectors defined by default:\\nA non-SSL Connector bound to port 8080\\nAn AJP\n1.3 Connector bound to port 8009\\n\\n\"\n\n  # @TODO a resource needs to be created to be able to query more than just the\n  # port but also the full connector's information\n  ports = [\"8084\", \"8009\"]\n\n  tomcat_conf = xml(\"#{TOMCAT_HOME}/conf/server.xml\")\n\n  iter = 1\n  if tomcat_conf['Server/Service/Connector/@port'].is_a?(Array)\n    numConnectors = tomcat_conf['Server/Service/Connector'].count\n    until iter > numConnectors do\n       puts(\"Inside the loop i = #{iter}\" )\n       describe tomcat_conf[\"Server/Service/Connector[#{iter}]/@port\"] do\n         it { should be_in ports }\n       end\n       iter +=1;\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-1.2.rb",
        "line": 17
      },
      "id": "M-1.2"
    },
    {
      "title": "4.8 Restrict access to Tomcat catalina.policy (Scored)",
      "desc": "The catalina.policy file is used to configure security policies for\nTomcat. It is recommended that access to this file has the proper permissions\nto properly protect from unauthorized changes. Restricting access to this file\nwill prevent local users from maliciously or inadvertently altering Tomcat’s\nsecurity policy.",
      "descriptions": {
        "default": "The catalina.policy file is used to configure security policies for\nTomcat. It is recommended that access to this file has the proper permissions\nto properly protect from unauthorized changes. Restricting access to this file\nwill prevent local users from maliciously or inadvertently altering Tomcat’s\nsecurity policy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.8",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/catalina.policy care securely configured. Change to the\nlocation of the $CATALINA_HOME/ and execute the following:\n# cd $CATALINA_HOME/conf/\n# find catalina.policy -follow -maxdepth 0 \\( -perm /o+rwx -o ! -user\ntomcat_admin -o ! -group tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to\n$CATALINA_HOME/conf/catalina.policy. Set the owner and group owner of the\ncontents of\n$CATALINA_HOME/conf/catalina.policy to tomcat_admin and tomcat, respectively.\n# chmod 770 $CATALINA_HOME/conf/catalina.policy\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.policy\n",
        "Default Value": "The default permissions of catalina.policy is 600."
      },
      "code": "control \"M-4.8\" do\n  title \"4.8 Restrict access to Tomcat catalina.policy (Scored)\"\n  desc  \"The catalina.policy file is used to configure security policies for\nTomcat. It is recommended that access to this file has the proper permissions\nto properly protect from unauthorized changes. Restricting access to this file\nwill prevent local users from maliciously or inadvertently altering Tomcat’s\nsecurity policy. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.8\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/catalina.policy care securely configured. Change to the\nlocation of the $CATALINA_HOME/ and execute the following:\n# cd $CATALINA_HOME/conf/\n# find catalina.policy -follow -maxdepth 0 \\\\( -perm /o+rwx -o ! -user\ntomcat_admin -o ! -group tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to\n$CATALINA_HOME/conf/catalina.policy. Set the owner and group owner of the\ncontents of\n$CATALINA_HOME/conf/catalina.policy to tomcat_admin and tomcat, respectively.\n# chmod 770 $CATALINA_HOME/conf/catalina.policy\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.policy\n\"\n  tag \"Default Value\": \"The default permissions of catalina.policy is 600.\"\n\n  describe file(\"#{TOMCAT_HOME}/conf/catalina.policy\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0770' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.8.rb",
        "line": 29
      },
      "id": "M-4.8"
    },
    {
      "title": "10.3 Restrict manager application (Not Scored)",
      "desc": "Limit access to the manager application to only those with a required\nneeded. Limiting access to the least privilege required will ensure only those\npeople with required need have access to a resource. The manager application\nshould be limited to only administrators.",
      "descriptions": {
        "default": "Limit access to the manager application to only those with a required\nneeded. Limiting access to the least privilege required will ensure only those\npeople with required need have access to a resource. The manager application\nshould be limited to only administrators."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://tomcat.apache.org/tomcat-8.0-doc/config/valve.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/manager-howto.html",
        "severity": "medium",
        "cis_id": "10.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Review\n$CATALINA_BASE/conf/[enginename]/[hostname]/manager.xml to ascertain that\nthe RemoteAddrValve option is uncommented and configured to only allow access\nto\nsystems required to connect.\n",
        "fix": "For the manager application, edit\n$CATALINA_BASE/conf/[enginename]/[hostname]/manager.xml, and add the bolded\nline:\n<Context path='/manager' docBase='${catalina.home}/webapps/manager' debug='0'\nprivileged='true'>\n<Valve className='org.apache.catalina.valves.RemoteAddrValve'\nallow='127\\.0\\.0\\.1'/>\n<!-- Link to the user database we will get roles from -->\n<ResourceLink name='users' global='UserDatabase'\ntype='org.apache.catalina.UserDatabase'/>\n</Context>\nAdd hosts, comma separated, which are allowed to access the admin application.\n\nNote: The RemoteAddrValve property expects a regular expression, therefore\nperiods and\nother regular expression meta-characters must be escaped.\n",
        "Default Value": "By default, this setting is not present\n"
      },
      "code": "control \"M-10.3\" do\n  title \"10.3 Restrict manager application (Not Scored)\"\n  desc  \"Limit access to the manager application to only those with a required\nneeded. Limiting access to the least privilege required will ensure only those\npeople with required need have access to a resource. The manager application\nshould be limited to only administrators. \"\n  impact 0.5\n  tag \"ref\": \"1. https://tomcat.apache.org/tomcat-8.0-doc/config/valve.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/manager-howto.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Review\n$CATALINA_BASE/conf/[enginename]/[hostname]/manager.xml to ascertain that\nthe RemoteAddrValve option is uncommented and configured to only allow access\nto\nsystems required to connect.\n\"\n  tag \"fix\": \"For the manager application, edit\n$CATALINA_BASE/conf/[enginename]/[hostname]/manager.xml, and add the bolded\nline:\n<Context path='/manager' docBase='${catalina.home}/webapps/manager' debug='0'\nprivileged='true'>\n<Valve className='org.apache.catalina.valves.RemoteAddrValve'\nallow='127\\\\.0\\\\.0\\\\.1'/>\n<!-- Link to the user database we will get roles from -->\n<ResourceLink name='users' global='UserDatabase'\ntype='org.apache.catalina.UserDatabase'/>\n</Context>\nAdd hosts, comma separated, which are allowed to access the admin application.\n\nNote: The RemoteAddrValve property expects a regular expression, therefore\nperiods and\nother regular expression meta-characters must be escaped.\n\"\n  tag \"Default Value\": \"By default, this setting is not present\\n\"\n\n  begin\n    manager_xml = command(\"find /usr/share/tomcat/conf/ -name manager.xml\").stdout.split.each do |man_xml|\n      describe xml(man_xml) do\n        its('Context/Valve/attribute::className') { should include \"org.apache.catalina.valves.RemoteAddrValve\" }\n        its('Context/Valve/attribute::allow') { should_not cmp [] }\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.3.rb",
        "line": 29
      },
      "id": "M-10.3"
    },
    {
      "title": "7.2 Specify file handler in logging.properties files (Scored)",
      "desc": "Handlers specify where log messages are sent. Console handlers send\nlog messages to the Java console and File handlers specify logging to a file.\nUtilizing file handlers will ensure that security event information is\npersisted to disk.",
      "descriptions": {
        "default": "Handlers specify where log messages are sent. Console handlers send\nlog messages to the Java console and File handlers specify logging to a file.\nUtilizing file handlers will ensure that security event information is\npersisted to disk."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://tomcat.apache.org/tomcat-8.0-doc/logging.html",
        "severity": "medium",
        "cis_id": "7.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review each application’s logging.properties file located\nin the applications\n$CATALINA_BASE\\webapps\\<app name>\\WEB-INF\\classes directory and determine\nif the\nfile handler properties are set.\n$ grep handlers \\\n$CATALINA_BASE\\webapps\\<app name>\\WEB-INF\\classes\\logging.properties\nIn the instance where an application specific logging has not been created, the\n\nlogging.properties file will be located in $CATALINA_BASE\\conf\n$ grep handlers $CATALINA_BASE\\conf\\logging.properties\n",
        "fix": "Add the following entries to your logging.properties file if they\ndo not exist.\nhandlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\nEnsure logging is not off and set the logging level to the desired level such\nas:\norg.apache.juli.FileHandler.level=FINEST\n",
        "Default Value": "No value for new applications by default.\n"
      },
      "code": "control \"M-7.2\" do\n  title \"7.2 Specify file handler in logging.properties files (Scored)\"\n  desc  \"Handlers specify where log messages are sent. Console handlers send\nlog messages to the Java console and File handlers specify logging to a file.\nUtilizing file handlers will ensure that security event information is\npersisted to disk. \"\n  impact 0.5\n  tag \"ref\": \"1. https://tomcat.apache.org/tomcat-8.0-doc/logging.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review each application’s logging.properties file located\nin the applications\n$CATALINA_BASE\\\\webapps\\\\<app name>\\\\WEB-INF\\\\classes directory and determine\nif the\nfile handler properties are set.\n$ grep handlers \\\\\n$CATALINA_BASE\\\\webapps\\\\<app name>\\\\WEB-INF\\\\classes\\\\logging.properties\nIn the instance where an application specific logging has not been created, the\n\nlogging.properties file will be located in $CATALINA_BASE\\\\conf\n$ grep handlers $CATALINA_BASE\\\\conf\\\\logging.properties\n\"\n  tag \"fix\": \"Add the following entries to your logging.properties file if they\ndo not exist.\nhandlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\nEnsure logging is not off and set the logging level to the desired level such\nas:\norg.apache.juli.FileHandler.level=FINEST\n\"\n  tag \"Default Value\": \"No value for new applications by default.\\n\"\n\n  begin\n    log_prop = tomcat_properties_file.read_content(\"#{TOMCAT_HOME}/conf/logging.properties\")\n\n    describe log_prop do\n      its(['handlers']) { should include 'org.apache.juli.FileHandler' }\n      its(['handlers']) { should include 'java.util.logging.ConsoleHandler' }\n      its(['org.apache.juli.FileHandler.level']) { should cmp 'FINEST' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-7.2.rb",
        "line": 41
      },
      "id": "M-7.2"
    },
    {
      "title": "2.3 Alter the Advertised server.built Date (Scored)",
      "desc": "The server.built date represents the date which Tomcat was compiled\nand packaged. This value is presented to Tomcat clients when clients connect to\nthe server. Altering the server.built string may make it harder for attackers\nto fingerprint which vulnerabilities affect the server platform.",
      "descriptions": {
        "default": "The server.built date represents the date which Tomcat was compiled\nand packaged. This value is presented to Tomcat clients when clients connect to\nthe server. Altering the server.built string may make it harder for attackers\nto fingerprint which vulnerabilities affect the server platform."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "2.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to determine if the server.built\nvalue has been changed: Extract the ServerInfo.properties file and examine the\nserver.built attribute.\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n$ grep server.built org/apache/catalina/util/ServerInfo.properties\n",
        "fix": "Perform the following to alter the server version string that\ngets displayed when clients\nconnect to the server. Extract the ServerInfo.properties file from the\ncatalina.jar file:\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties Navigate\nto the util directory that was created\n$ cd org/apache/Catalina/util Open ServerInfo.properties in an editor Update\nthe server.built attribute in the ServerInfo.properties file.\nserver.built= Update the catalina.jar with the modified ServerInfo.properties\nfile.\n$ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties\n\n",
        "Default Value": "The default value for the server.built attribute is\nbuild date and time. For example, Jul 8\n2008 11:40:35."
      },
      "code": "control \"M-2.3\" do\n  title \"2.3 Alter the Advertised server.built Date (Scored)\"\n  desc  \"The server.built date represents the date which Tomcat was compiled\nand packaged. This value is presented to Tomcat clients when clients connect to\nthe server. Altering the server.built string may make it harder for attackers\nto fingerprint which vulnerabilities affect the server platform. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to determine if the server.built\nvalue has been changed: Extract the ServerInfo.properties file and examine the\nserver.built attribute.\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n$ grep server.built org/apache/catalina/util/ServerInfo.properties\n\"\n  tag \"fix\": \"Perform the following to alter the server version string that\ngets displayed when clients\nconnect to the server. Extract the ServerInfo.properties file from the\ncatalina.jar file:\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties Navigate\nto the util directory that was created\n$ cd org/apache/Catalina/util Open ServerInfo.properties in an editor Update\nthe server.built attribute in the ServerInfo.properties file.\nserver.built= Update the catalina.jar with the modified ServerInfo.properties\nfile.\n$ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties\n\n\"\n  tag \"Default Value\": \"The default value for the server.built attribute is\nbuild date and time. For example, Jul 8\\n2008 11:40:35.\"\n\n  describe command(\"unzip -p #{TOMCAT_HOME}/lib/catalina.jar org/apache/catalina/util/ServerInfo.properties | grep server.built\") do\n    its('stdout.strip') { should eq \"#{TOMCAT_SERVER_BUILT}\" }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-2.3.rb",
        "line": 23
      },
      "id": "M-2.3"
    },
    {
      "title": "7.3 Ensure className is set correctly in context.xml (Scored)",
      "desc": "Ensure the className attribute is set to AccessLogValve. The className\nattribute determines the access log valve to be used for logging. Some log\nvalves are not suited for production and should not be used. Apache recommends\norg.apache.catalina.valves.AccessLogValve",
      "descriptions": {
        "default": "Ensure the className attribute is set to AccessLogValve. The className\nattribute determines the access log valve to be used for logging. Some log\nvalves are not suited for production and should not be used. Apache recommends\norg.apache.catalina.valves.AccessLogValve"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://tomcat.apache.org/tomcat-8.0-doc/config/valve.html",
        "severity": "medium",
        "cis_id": "7.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Execute the following to ensure className is set properly:\n\n# grep org.apache.catalina.valves.AccessLogValve $CATALINA_BASE\\webapps\\<app\n\nname>\\META-INF\\context.xml\n",
        "fix": "Add the following statement into the\n$CATALINA_BASE\\webapps\\<app name>\\METAINF\\context.xml file if it does not\nalready exist.\n<Valve\nclassName='org.apache.catalina.valves.AccessLogValve'\ndirectory='$CATALINA_HOME/logs/'\nprefix='access_log'\nfileDateFormat='yyyy-MM-dd.HH'\nsuffix='.log'\npattern='%t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r'\n/>\n",
        "Default Value": "Does not exist by default.\n"
      },
      "code": "control \"M-7.3\" do\n  title \"7.3 Ensure className is set correctly in context.xml (Scored)\"\n  desc  \"Ensure the className attribute is set to AccessLogValve. The className\nattribute determines the access log valve to be used for logging. Some log\nvalves are not suited for production and should not be used. Apache recommends\norg.apache.catalina.valves.AccessLogValve \"\n  impact 0.5\n  tag \"ref\": \"1. https://tomcat.apache.org/tomcat-8.0-doc/config/valve.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Execute the following to ensure className is set properly:\n\n# grep org.apache.catalina.valves.AccessLogValve $CATALINA_BASE\\\\webapps\\\\<app\n\nname>\\\\META-INF\\\\context.xml\n\"\n  tag \"fix\": \"Add the following statement into the\n$CATALINA_BASE\\\\webapps\\\\<app name>\\\\METAINF\\\\context.xml file if it does not\nalready exist.\n<Valve\nclassName='org.apache.catalina.valves.AccessLogValve'\ndirectory='$CATALINA_HOME/logs/'\nprefix='access_log'\nfileDateFormat='yyyy-MM-dd.HH'\nsuffix='.log'\npattern='%t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r'\n/>\n\"\n  tag \"Default Value\": \"Does not exist by default.\\n\"\n\n  begin\n    context_xml = command(\"ls #{TOMCAT_HOME}/webapps/*/META-INF/context.xml\").stdout.split.each do |web_file|\n      describe xml(web_file) do\n        its('Context/Valve/attribute::className') { should include \"org.apache.catalina.valves.AccessLogValve\" }\n        its('Context/Valve/attribute::directory') { should cmp '$CATALINA_HOME/logs/' }\n        its('Context/Valve/attribute::prefix') { should cmp 'access_log' }\n        its('Context/Valve/attribute::fileDateFormat') { should cmp 'yyyy-MM-dd.HH' }\n        its('Context/Valve/attribute::suffix') { should cmp '.log' }\n        its('Context/Valve/attribute::pattern') { should cmp '%h %t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r' }\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-7.3.rb",
        "line": 36
      },
      "id": "M-7.3"
    },
    {
      "title": "6.2 Ensure SSLEnabled is set to True for Sensitive Connectors (Not\nScored)",
      "desc": "The SSLEnabled setting determines if SSL is enabled for a specific\nConnector. It is recommended that SSL be utilized for any Connector that sends\nor receives sensitive information, such as authentication credentials or\npersonal information. The SSLEnabled setting ensures SSL is active, which will\nin-turn ensure the confidentiality and integrity of sensitive information while\nin transit.",
      "descriptions": {
        "default": "The SSLEnabled setting determines if SSL is enabled for a specific\nConnector. It is recommended that SSL be utilized for any Connector that sends\nor receives sensitive information, such as authentication credentials or\npersonal information. The SSLEnabled setting ensures SSL is active, which will\nin-turn ensure the confidentiality and integrity of sensitive information while\nin transit."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/config/http.html",
        "severity": "medium",
        "cis_id": "6.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review server.xml and ensure all Connectors sending or\nreceiving sensitive information\nhave the SSLEnabled attribute set to true.\n",
        "fix": "In server.xml, set the SSLEnabled attribute to true for each\nConnector that sends or\nreceives sensitive information\n<Connector\n…\nSSLEnabled='true'\n…\n/>\n",
        "Default Value": "SSLEnabled is set to false.\n"
      },
      "code": "control \"M-6.2\" do\n  title \"6.2 Ensure SSLEnabled is set to True for Sensitive Connectors (Not\nScored)\"\n  desc  \"The SSLEnabled setting determines if SSL is enabled for a specific\nConnector. It is recommended that SSL be utilized for any Connector that sends\nor receives sensitive information, such as authentication credentials or\npersonal information. The SSLEnabled setting ensures SSL is active, which will\nin-turn ensure the confidentiality and integrity of sensitive information while\nin transit. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/config/http.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review server.xml and ensure all Connectors sending or\nreceiving sensitive information\nhave the SSLEnabled attribute set to true.\n\"\n  tag \"fix\": \"In server.xml, set the SSLEnabled attribute to true for each\nConnector that sends or\nreceives sensitive information\n<Connector\n…\nSSLEnabled='true'\n…\n/>\n\"\n  tag \"Default Value\": \"SSLEnabled is set to false.\\n\"\n\n  begin\n    tomcat_server = tomcat_server_xml(\"#{TOMCAT_CONF_SERVER}\")\n\n    # remove any non secure connectors first\n    tomcat_server.params.each do |connector|\n      if connector[:protocol] == \"HTTP/1.1\" || connector[:protocol] == \"AJP/1.3\"\n        tomcat_server.params.delete(connector)\n      end\n    end\n\n    # check remaining connectors for sslenable attribute\n    tomcat_server.params.each do |connector|\n      describe connector do\n        its([:sslenable]) { should cmp 'true' }\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-6.2.rb",
        "line": 41
      },
      "id": "M-6.2"
    },
    {
      "title": "9.1 Starting Tomcat with Security Manager (Scored)",
      "desc": "Configure application to run in a sandbox using the Security Manager.\nThe Security Manager restricts what classes Tomcat can access thus protecting\nyour server from mistakes, Trojans, and malicious code. By running Tomcat with\nthe Security Manager, applications are run in a sandbox which can prevent\nuntrusted code from accessing files on the file system.",
      "descriptions": {
        "default": "Configure application to run in a sandbox using the Security Manager.\nThe Security Manager restricts what classes Tomcat can access thus protecting\nyour server from mistakes, Trojans, and malicious code. By running Tomcat with\nthe Security Manager, applications are run in a sandbox which can prevent\nuntrusted code from accessing files on the file system."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/security-manager-howto.html",
        "severity": "medium",
        "cis_id": "9.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review the startup configuration in /etc/init.d for Tomcat\nto ascertain if Tomcat is started\nwith the -security option\n",
        "fix": "The security policies implemented by the Java SecurityManager are\nconfigured in the\n$CATALINA_HOME/conf/catalina.policy file. Once you have configured the\ncatalina.policy\nfile for use with a SecurityManager, Tomcat can be started with a\nSecurityManager in place\nby using the --security option:\n$ $CATALINA_HOME/bin/catalina.sh start -security (Unix)\nC:\\> %CATALINA_HOME%\\bin\\catalina start -security (Windows)\n",
        "Default Value": "By default, the -security option is not utilized.\n"
      },
      "code": "control \"M-9.1\" do\n  title \"9.1 Starting Tomcat with Security Manager (Scored)\"\n  desc  \"Configure application to run in a sandbox using the Security Manager.\nThe Security Manager restricts what classes Tomcat can access thus protecting\nyour server from mistakes, Trojans, and malicious code. By running Tomcat with\nthe Security Manager, applications are run in a sandbox which can prevent\nuntrusted code from accessing files on the file system. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/security-manager-howto.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"9.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review the startup configuration in /etc/init.d for Tomcat\nto ascertain if Tomcat is started\nwith the -security option\n\"\n  tag \"fix\": \"The security policies implemented by the Java SecurityManager are\nconfigured in the\n$CATALINA_HOME/conf/catalina.policy file. Once you have configured the\ncatalina.policy\nfile for use with a SecurityManager, Tomcat can be started with a\nSecurityManager in place\nby using the --security option:\n$ $CATALINA_HOME/bin/catalina.sh start -security (Unix)\nC:\\\\> %CATALINA_HOME%\\\\bin\\\\catalina start -security (Windows)\n\"\n  tag \"Default Value\": \"By default, the -security option is not utilized.\\n\"\n\n  begin\n    describe parse_config_file(\"/etc/systemd/system/tomcat.service\") do\n      its('Service.ExecStart') { should cmp \"#{TOMCAT_HOME}/bin/startup.sh -security\" }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-9.1.rb",
        "line": 35
      },
      "id": "M-9.1"
    },
    {
      "title": "4.11 Restrict access to Tomcat logging.properties (Scored)",
      "desc": "logging.properties is a Tomcat files which specifies the logging\nconfiguration. It is recommended that access to this file has the proper\npermissions to properly protect from unauthorized changes. Restricting access\nto this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy.",
      "descriptions": {
        "default": "logging.properties is a Tomcat files which specifies the logging\nconfiguration. It is recommended that access to this file has the proper\npermissions to properly protect from unauthorized changes. Restricting access\nto this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.11",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/logging.properties care securely configured. Change to the\nlocation of the $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf/\n# find logging.properties -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user\ntomcat_admin -o ! -group tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to logging.properties:\nSet the ownership of the $CATALINA_HOME/conf/logging.properties to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/logging.properties\n# chmod g-w,o-rwx $CATALINA_HOME/conf/logging.properties\n\n",
        "Default Value": "The default permissions are 600."
      },
      "code": "control \"M-4.11\" do\n  title \"4.11 Restrict access to Tomcat logging.properties (Scored)\"\n  desc  \"logging.properties is a Tomcat files which specifies the logging\nconfiguration. It is recommended that access to this file has the proper\npermissions to properly protect from unauthorized changes. Restricting access\nto this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.11\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/logging.properties care securely configured. Change to the\nlocation of the $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf/\n# find logging.properties -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user\ntomcat_admin -o ! -group tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to logging.properties:\nSet the ownership of the $CATALINA_HOME/conf/logging.properties to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/logging.properties\n# chmod g-w,o-rwx $CATALINA_HOME/conf/logging.properties\n\n\"\n  tag \"Default Value\": \"The default permissions are 600.\"\n\n  describe file(\"#{TOMCAT_HOME}/conf/logging.properties\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.11.rb",
        "line": 29
      },
      "id": "M-4.11"
    },
    {
      "title": "4.1 Restrict access to $CATALINA_HOME (Scored)",
      "desc": "$CATALINA_HOME is the environment variable which holds the path to the\nroot Tomcat directory. It is important to protect access to this in order to\nprotect the Tomcat binaries and libraries from unauthorized modification. It is\nrecommended that the ownership of $CATALINA_HOME be tomcat_admin:tomcat. It is\nalso recommended that the permission on $CATALINA_HOME prevent read, write, and\nexecute for the world (o-rwx) and prevent write access to the group (g-w). The\nsecurity of processes and data that traverse or depend on Tomcat may become\ncompromised if the $CATALINA_HOME is not secured.",
      "descriptions": {
        "default": "$CATALINA_HOME is the environment variable which holds the path to the\nroot Tomcat directory. It is important to protect access to this in order to\nprotect the Tomcat binaries and libraries from unauthorized modification. It is\nrecommended that the ownership of $CATALINA_HOME be tomcat_admin:tomcat. It is\nalso recommended that the permission on $CATALINA_HOME prevent read, write, and\nexecute for the world (o-rwx) and prevent write access to the group (g-w). The\nsecurity of processes and data that traverse or depend on Tomcat may become\ncompromised if the $CATALINA_HOME is not secured."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to ensure the permission on the\n$CATALINA_HOME directory\nprevent unauthorized modification.\n$ cd $CATALINA_HOME\n$ find . -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user tomcat_admin -o !\n-group\ntomcat \\) -ls\nThe above command should not emit any output.\n",
        "fix": "Perform the following to establish the recommended state: Set the\nownership of the $CATALINA_HOME to tomcat_admin:tomcat. Remove read, write, and\nexecute permissions for the world Remove write permissions for the group.\n\n# chown tomcat_admin.tomcat $CATALINA_HOME\n# chmod g-w,o-rwx $CATALINA_HOME"
      },
      "code": "control \"M-4.1\" do\n  title \"4.1 Restrict access to $CATALINA_HOME (Scored)\"\n  desc  \"$CATALINA_HOME is the environment variable which holds the path to the\nroot Tomcat directory. It is important to protect access to this in order to\nprotect the Tomcat binaries and libraries from unauthorized modification. It is\nrecommended that the ownership of $CATALINA_HOME be tomcat_admin:tomcat. It is\nalso recommended that the permission on $CATALINA_HOME prevent read, write, and\nexecute for the world (o-rwx) and prevent write access to the group (g-w). The\nsecurity of processes and data that traverse or depend on Tomcat may become\ncompromised if the $CATALINA_HOME is not secured. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to ensure the permission on the\n$CATALINA_HOME directory\nprevent unauthorized modification.\n$ cd $CATALINA_HOME\n$ find . -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user tomcat_admin -o !\n-group\ntomcat \\\\) -ls\nThe above command should not emit any output.\n\"\n  tag \"fix\": \"Perform the following to establish the recommended state: Set the\nownership of the $CATALINA_HOME to tomcat_admin:tomcat. Remove read, write, and\nexecute permissions for the world Remove write permissions for the group.\n\n# chown tomcat_admin.tomcat $CATALINA_HOME\n# chmod g-w,o-rwx $CATALINA_HOME\"\n\n  describe directory(\"#{TOMCAT_HOME}\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.1.rb",
        "line": 29
      },
      "id": "M-4.1"
    },
    {
      "title": "2.2 Alter the Advertised server.number String (Scored)",
      "desc": "The server.number attribute represents the specific version of Tomcat\nthat is executing. This value is presented to Tomcat clients when connect.\nAdvertising a valid server version may provide attackers with information\nuseful for locating vulnerabilities that affect the server platform. Altering\nthe server version string may make it harder for attackers to determine which\nvulnerabilities affect the server platform.",
      "descriptions": {
        "default": "The server.number attribute represents the specific version of Tomcat\nthat is executing. This value is presented to Tomcat clients when connect.\nAdvertising a valid server version may provide attackers with information\nuseful for locating vulnerabilities that affect the server platform. Altering\nthe server version string may make it harder for attackers to determine which\nvulnerabilities affect the server platform."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "2.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to determine if the server.number\nvalue has been changed: Extract the ServerInfo.properties file and examine the\nserver.number attribute.\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n$ grep server.number org/apache/catalina/util/ServerInfo.properties\n",
        "fix": "Perform the following to alter the server version string that\ngets displayed when clients\nconnect to the server. Extract the ServerInfo.properties file from the\ncatalina.jar file:\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties Navigate\nto the util directory that was created\n$ cd org/apache/Catalina/util Open ServerInfo.properties in an editor Update\nthe server.number attribute\nserver.number=<someversion> Update the catalina.jar with the modified\nServerInfo.properties file.\n\n$ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties\n",
        "Default Value": "The default value for the server.number attribute is a\nfour part version number, such as\n5.5.20.0."
      },
      "code": "control \"M-2.2\" do\n  title \"2.2 Alter the Advertised server.number String (Scored)\"\n  desc  \"The server.number attribute represents the specific version of Tomcat\nthat is executing. This value is presented to Tomcat clients when connect.\nAdvertising a valid server version may provide attackers with information\nuseful for locating vulnerabilities that affect the server platform. Altering\nthe server version string may make it harder for attackers to determine which\nvulnerabilities affect the server platform. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to determine if the server.number\nvalue has been changed: Extract the ServerInfo.properties file and examine the\nserver.number attribute.\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n$ grep server.number org/apache/catalina/util/ServerInfo.properties\n\"\n  tag \"fix\": \"Perform the following to alter the server version string that\ngets displayed when clients\nconnect to the server. Extract the ServerInfo.properties file from the\ncatalina.jar file:\n$ cd $CATALINA_HOME/lib\n$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties Navigate\nto the util directory that was created\n$ cd org/apache/Catalina/util Open ServerInfo.properties in an editor Update\nthe server.number attribute\nserver.number=<someversion> Update the catalina.jar with the modified\nServerInfo.properties file.\n\n$ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties\n\"\n  tag \"Default Value\": \"The default value for the server.number attribute is a\nfour part version number, such as\\n5.5.20.0.\"\n\n  describe command(\"unzip -p #{TOMCAT_HOME}/lib/catalina.jar org/apache/catalina/util/ServerInfo.properties | grep server.number\") do\n    its('stdout.strip') { should eq \"#{TOMCAT_SERVER_NUMBER}\" }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-2.2.rb",
        "line": 23
      },
      "id": "M-2.2"
    },
    {
      "title": "7.6 Ensure directory in logging.properties is a secure location\n(Scored)",
      "desc": "The directory attribute tells Tomcat where to store logs. The\ndirectory value should be a secure location with restricted access. Securing\nthe log location will help ensure the integrity and confidentiality of web\napplication activity records.",
      "descriptions": {
        "default": "The directory attribute tells Tomcat where to store logs. The\ndirectory value should be a secure location with restricted access. Securing\nthe log location will help ensure the integrity and confidentiality of web\napplication activity records."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.6",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review the permissions of the directory specified by the\ndirectory setting to ensure the\npermissions are o-rwx and owned by tomcat_admin:tomcat:\n# grep directory logging.properties\n# ls –ld <log_location>\n",
        "fix": "Perform the following: Add the following properties into your\nlogging.properties file if they do not exist\n<application_name>.org.apache.juli.FileHandler.directory=<log_location>\n<application_name>.org.apache.juli.FileHandler.prefix=<application_name> Set\nthe location pointed to by the directory attribute to be owned by\ntomcat_admin:tomcat with permissions of o-rwx.\n# chown tomcat_admin:tomcat <log_location>\n# chmod o-rwx <log_location>\n",
        "Default Value": "The directory location is configured to store logs in\n$CATALINA_BASE/logs"
      },
      "code": "control \"M-7.6\" do\n  title \"7.6 Ensure directory in logging.properties is a secure location\n(Scored)\"\n  desc  \"The directory attribute tells Tomcat where to store logs. The\ndirectory value should be a secure location with restricted access. Securing\nthe log location will help ensure the integrity and confidentiality of web\napplication activity records. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.6\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review the permissions of the directory specified by the\ndirectory setting to ensure the\npermissions are o-rwx and owned by tomcat_admin:tomcat:\n# grep directory logging.properties\n# ls –ld <log_location>\n\"\n  tag \"fix\": \"Perform the following: Add the following properties into your\nlogging.properties file if they do not exist\n<application_name>.org.apache.juli.FileHandler.directory=<log_location>\n<application_name>.org.apache.juli.FileHandler.prefix=<application_name> Set\nthe location pointed to by the directory attribute to be owned by\ntomcat_admin:tomcat with permissions of o-rwx.\n# chown tomcat_admin:tomcat <log_location>\n# chmod o-rwx <log_location>\n\"\n  tag \"Default Value\": \"The directory location is configured to store logs in\n$CATALINA_BASE/logs\"\n\n  begin\n    log_prop = tomcat_properties_file.read_content(\"#{TOMCAT_HOME}/conf/logging.properties\")\n    app_dir = command(\"ls #{TOMCAT_HOME}/webapps\").stdout.split\n    app_prefix = command(\"ls #{TOMCAT_HOME}/webapps\").stdout.split\n\n    app_dir.each do |app|\n      app << \".org.apache.juli.FileHandler.directory\"\n    end\n\n    app_prefix.each do |app|\n      app << \".org.apache.juli.FileHandler.prefix\"\n    end\n\n    app_dir.each do |app|\n        describe log_prop do\n          its([app]) { should cmp \"${catalina.base}/logs\"}\n        end\n    end\n\n    app_prefix.each do |app|\n        describe log_prop do\n          its([app]) { should cmp app.strip.split('.')[0] }\n        end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-7.6.rb",
        "line": 41
      },
      "id": "M-7.6"
    },
    {
      "title": "10.10 Configure connectionTimeout (Scored)",
      "desc": "The connectionTimeout setting allows Tomcat to close idle sockets\nafter a specific amount of time to save system resources. Closing idle sockets\nreduces system resource usage thus can provide better performance and help\nprotect against Denial of Service attacks.",
      "descriptions": {
        "default": "The connectionTimeout setting allows Tomcat to close idle sockets\nafter a specific amount of time to save system resources. Closing idle sockets\nreduces system resource usage thus can provide better performance and help\nprotect against Denial of Service attacks."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://tomcat.apache.org/tomcat-8.0-doc/config/http.html",
        "severity": "medium",
        "cis_id": "10.10",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Locate each connectionTimeout setting in\n$CATALINA_HOME/conf/server.xml and verify\nthe setting is correct.\n# grep connectionTimeout $CATALINA_HOME/conf/server.xml\n",
        "fix": "Within $CATALINA_HOME/conf/server.xml ensure each connector is\nconfigured to the\nconnectionTimeout setting that is optimal based on hardware resources, load,\nand number\nof concurrent connections.\nconnectionTimeout='60000'\n",
        "Default Value": "connectionTimeout is set to 60000\n"
      },
      "code": "control \"M-10.10\" do\n  title \"10.10 Configure connectionTimeout (Scored)\"\n  desc  \"The connectionTimeout setting allows Tomcat to close idle sockets\nafter a specific amount of time to save system resources. Closing idle sockets\nreduces system resource usage thus can provide better performance and help\nprotect against Denial of Service attacks. \"\n  impact 0.5\n  tag \"ref\": \"1. https://tomcat.apache.org/tomcat-8.0-doc/config/http.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.10\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Locate each connectionTimeout setting in\n$CATALINA_HOME/conf/server.xml and verify\nthe setting is correct.\n# grep connectionTimeout $CATALINA_HOME/conf/server.xml\n\"\n  tag \"fix\": \"Within $CATALINA_HOME/conf/server.xml ensure each connector is\nconfigured to the\nconnectionTimeout setting that is optimal based on hardware resources, load,\nand number\nof concurrent connections.\nconnectionTimeout='60000'\n\"\n  tag \"Default Value\": \"connectionTimeout is set to 60000\\n\"\n\n  begin\n    tomcat_conf = xml(TOMCAT_CONF_SERVER)\n\n      if tomcat_conf['Server/Service/Connector/attribute::connectionTimeout'].is_a?(Array)\n        tomcat_conf['Server/Service/Connector/attribute::connectionTimeout'].each do |x|\n          describe x do\n            it { should eq \"60000\" }\n          end\n        end\n      else\n        describe xml(tomcat_conf['Server/Service/Connector/attribute::connectionTimeout']) do\n          it { should eq \"60000\" }\n        end\n      end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.10.rb",
        "line": 29
      },
      "id": "M-10.10"
    },
    {
      "title": "4.6 Restrict access to Tomcat binaries directory (Scored)",
      "desc": "The Tomcat $CATALINA_HOME/bin/ directory contains executes that are\npart of the Tomcat run-time. It is recommended that the ownership of this\ndirectory be tomcat_admin:tomcat. It is also recommended that the permission on\n$CATALINA_HOME prevent read, write, and execute for the world (o-rwx) and\nprevent write access to the group (g-w). Restricting access to these\ndirectories will prevent local users from maliciously or inadvertently\naffecting the integrity of Tomcat processes.",
      "descriptions": {
        "default": "The Tomcat $CATALINA_HOME/bin/ directory contains executes that are\npart of the Tomcat run-time. It is recommended that the ownership of this\ndirectory be tomcat_admin:tomcat. It is also recommended that the permission on\n$CATALINA_HOME prevent read, write, and execute for the world (o-rwx) and\nprevent write access to the group (g-w). Restricting access to these\ndirectories will prevent local users from maliciously or inadvertently\naffecting the integrity of Tomcat processes."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.6",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/bin are securely configured. Change to the location of the\n$CATALINA_HOME/bin and execute the following:\n# cd $CATALINA_HOME\n# find bin -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user tomcat_admin -o\n! -group\ntomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed\nwhen executing the above command.\n",
        "fix": "Perform the following to restrict access to Tomcat bin directory:\nSet the ownership of the $CATALINA_HOME/bin to tomcat_admin:tomcat. Remove\nread, write, and execute permissions for the world\n# chown tomcat_admin:tomcat $CATALINA_HOME/bin\n# chmod g-w,o-rwx $CATALINA_HOME/bin\n",
        "Default Value": "The default permissions of the top-level directories is\n770."
      },
      "code": "control \"M-4.6\" do\n  title \"4.6 Restrict access to Tomcat binaries directory (Scored)\"\n  desc  \"The Tomcat $CATALINA_HOME/bin/ directory contains executes that are\npart of the Tomcat run-time. It is recommended that the ownership of this\ndirectory be tomcat_admin:tomcat. It is also recommended that the permission on\n$CATALINA_HOME prevent read, write, and execute for the world (o-rwx) and\nprevent write access to the group (g-w). Restricting access to these\ndirectories will prevent local users from maliciously or inadvertently\naffecting the integrity of Tomcat processes. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.6\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/bin are securely configured. Change to the location of the\n$CATALINA_HOME/bin and execute the following:\n# cd $CATALINA_HOME\n# find bin -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user tomcat_admin -o\n! -group\ntomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed\nwhen executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to Tomcat bin directory:\nSet the ownership of the $CATALINA_HOME/bin to tomcat_admin:tomcat. Remove\nread, write, and execute permissions for the world\n# chown tomcat_admin:tomcat $CATALINA_HOME/bin\n# chmod g-w,o-rwx $CATALINA_HOME/bin\n\"\n  tag \"Default Value\": \"The default permissions of the top-level directories is\n770.\"\n\n  describe directory(\"#{TOMCAT_HOME}/bin\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.6.rb",
        "line": 29
      },
      "id": "M-4.6"
    },
    {
      "title": "4.14 Restrict access to Tomcat web.xml (Scored)",
      "desc": "web.xml is a Tomcat configuration file that stores application\nconfiguration settings. It is recommended that access to this file has the\nproper permissions to properly protect from unauthorized changes. Restricting\naccess to this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy.",
      "descriptions": {
        "default": "web.xml is a Tomcat configuration file that stores application\nconfiguration settings. It is recommended that access to this file has the\nproper permissions to properly protect from unauthorized changes. Restricting\naccess to this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.14",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/web.xml care securely configured. Change to the location of\nthe $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf/\n# find web.xml -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user tomcat_admin\n\n-o ! -group tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to web.xml: Set the\nownership of the $CATALINA_HOME/conf/web.xml to tomcat_admin:tomcat. Remove\nread, write, and execute permissions for the world. Remove write permissions\nfor the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/web.xml\n# chmod g-w,o-rwx $CATALINA_HOME/conf/web.xml\n",
        "Default Value": "The default permissions of web.xml is 400."
      },
      "code": "control \"M-4.14\" do\n  title \"4.14 Restrict access to Tomcat web.xml (Scored)\"\n  desc  \"web.xml is a Tomcat configuration file that stores application\nconfiguration settings. It is recommended that access to this file has the\nproper permissions to properly protect from unauthorized changes. Restricting\naccess to this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.14\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/web.xml care securely configured. Change to the location of\nthe $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf/\n# find web.xml -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user tomcat_admin\n\n-o ! -group tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to web.xml: Set the\nownership of the $CATALINA_HOME/conf/web.xml to tomcat_admin:tomcat. Remove\nread, write, and execute permissions for the world. Remove write permissions\nfor the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/web.xml\n# chmod g-w,o-rwx $CATALINA_HOME/conf/web.xml\n\"\n  tag \"Default Value\": \"The default permissions of web.xml is 400.\"\n\n  describe file(\"#{TOMCAT_HOME}/conf/web.xml\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.14.rb",
        "line": 29
      },
      "id": "M-4.14"
    },
    {
      "title": "5.1 Use secure Realms (Scored)",
      "desc": "A realm is a database of usernames and passwords used to identify\nvalid users of web applications. Review the Realms configuration to ensure\nTomcat is configured to use JDBCRealm, UserDatabaseRealm, or JAASRealm.\nSpecifically, Tomcat should not utilize MemoryRealm. According to the Tomcat\ndocumentation, MemoryRealm, JDBCRealm are not designed for production usage and\ncould result in reduced availability, the UserDatabaseRealm is not intended for\nlarge-scale installations, the JAASRealm is not widely used and therefore the\ncode is not as mature as the other realms.",
      "descriptions": {
        "default": "A realm is a database of usernames and passwords used to identify\nvalid users of web applications. Review the Realms configuration to ensure\nTomcat is configured to use JDBCRealm, UserDatabaseRealm, or JAASRealm.\nSpecifically, Tomcat should not utilize MemoryRealm. According to the Tomcat\ndocumentation, MemoryRealm, JDBCRealm are not designed for production usage and\ncould result in reduced availability, the UserDatabaseRealm is not intended for\nlarge-scale installations, the JAASRealm is not widely used and therefore the\ncode is not as mature as the other realms."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/realm-howto.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/security-howto.html",
        "severity": "medium",
        "cis_id": "5.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to ensure improper realm is not in\nuse:\n#\n#\n#\n#\ngrep\ngrep\ngrep\ngrep\n'Realm\n'Realm\n'Realm\n'Realm\nclassName'\nclassName'\nclassName'\nclassName'\n$CATALINA_HOME/conf/server.xml\n$CATALINA_HOME/conf/server.xml\n$CATALINA_HOME/conf/server.xml\n$CATALINA_HOME/conf/server.xml\n|\n|\n|\n|\ngrep\ngrep\ngrep\ngrep\nMemoryRealm\nJDBCRealm\nUserDatabaseRealm\nJAASRealm\nThe above commands should not emit any output.\n",
        "fix": "Set the Realm className setting in $CATALINA_HOME/conf/server.xml\nto one of the\nappropriate realms.\n"
      },
      "code": "control \"M-5.1\" do\n  title \"5.1 Use secure Realms (Scored)\"\n  desc  \"A realm is a database of usernames and passwords used to identify\nvalid users of web applications. Review the Realms configuration to ensure\nTomcat is configured to use JDBCRealm, UserDatabaseRealm, or JAASRealm.\nSpecifically, Tomcat should not utilize MemoryRealm. According to the Tomcat\ndocumentation, MemoryRealm, JDBCRealm are not designed for production usage and\ncould result in reduced availability, the UserDatabaseRealm is not intended for\nlarge-scale installations, the JAASRealm is not widely used and therefore the\ncode is not as mature as the other realms. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/realm-howto.html 2.\nhttps://tomcat.apache.org/tomcat-8.0-doc/security-howto.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to ensure improper realm is not in\nuse:\n#\n#\n#\n#\ngrep\ngrep\ngrep\ngrep\n'Realm\n'Realm\n'Realm\n'Realm\nclassName'\nclassName'\nclassName'\nclassName'\n$CATALINA_HOME/conf/server.xml\n$CATALINA_HOME/conf/server.xml\n$CATALINA_HOME/conf/server.xml\n$CATALINA_HOME/conf/server.xml\n|\n|\n|\n|\ngrep\ngrep\ngrep\ngrep\nMemoryRealm\nJDBCRealm\nUserDatabaseRealm\nJAASRealm\nThe above commands should not emit any output.\n\"\n  tag \"fix\": \"Set the Realm className setting in $CATALINA_HOME/conf/server.xml\nto one of the\nappropriate realms.\n\"\n\n  describe xml(\"#{TOMCAT_HOME}/conf/server.xml\") do\n    its('Server/Service/Engine/Realm/@className') { should_not be_in TOMCAT_REALMS_LIST }\n\n    its('Server/Service/Engine/Realm/Realm/@className') { should_not be_in TOMCAT_REALMS_LIST }\n\n    its('Server/Service/Host/Realm/@className') { should_not be_in TOMCAT_REALMS_LIST }\n\n    its('Server/Service/Host/Realm/Realm/@className') { should_not be_in TOMCAT_REALMS_LIST }\n\n    its('Server/Service/Context/Realm/@className') { should_not be_in TOMCAT_REALMS_LIST }\n\n    its('Server/Service/Context/Realm/Realm/@className') { should_not be_in TOMCAT_REALMS_LIST }\n  end\n\n  describe xml(\"#{TOMCAT_HOME}/conf/context.xml\") do\n    its('Context/Realm/@className') { should_not be_in TOMCAT_REALMS_LIST }\n\n    its('Context/Realm/Realm/@className') { should_not be_in TOMCAT_REALMS_LIST }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-5.1.rb",
        "line": 26
      },
      "id": "M-5.1"
    },
    {
      "title": "10.13 Do not allow symbolic linking (Scored)",
      "desc": "Symbolic links allows one application to include the libraries from\nanother. This allows for re-use of code but also allows for potential security\nissues when applications include libraries from other applications they should\nnot have access to. Allowing symbolic links opens up Tomcat to directory\ntraversal vulnerability. Also there is a potential that an application could\nlink to another application it should not be linking too. On case-insensitive\noperating systems there is also the threat of source code disclosure.",
      "descriptions": {
        "default": "Symbolic links allows one application to include the libraries from\nanother. This allows for re-use of code but also allows for potential security\nissues when applications include libraries from other applications they should\nnot have access to. Allowing symbolic links opens up Tomcat to directory\ntraversal vulnerability. Also there is a potential that an application could\nlink to another application it should not be linking too. On case-insensitive\noperating systems there is also the threat of source code disclosure."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://tomcat.apache.org/tomcat-8.0-doc/config/resources.html\n2. http://tomcat.apache.org/tomcat-8.0-doc/config/context.html",
        "severity": "medium",
        "cis_id": "10.13",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Ensure all context.xml have the allowLinking attribute set\nto false or allowLinking\ndoes not exist.\n# find . -name context.xml | xargs grep 'allowLinking'\n",
        "fix": "In all context.xml, set the allowLinking attribute to false:\n<Context\n...\n<Resources ... allowLinking=”false” />\n...\n</Context>\n",
        "Default Value": "By default, allowLinking has a value of false\n"
      },
      "code": "control \"M-10.13\" do\n  title \"10.13 Do not allow symbolic linking (Scored)\"\n  desc  \"Symbolic links allows one application to include the libraries from\nanother. This allows for re-use of code but also allows for potential security\nissues when applications include libraries from other applications they should\nnot have access to. Allowing symbolic links opens up Tomcat to directory\ntraversal vulnerability. Also there is a potential that an application could\nlink to another application it should not be linking too. On case-insensitive\noperating systems there is also the threat of source code disclosure. \"\n  impact 0.5\n  tag \"ref\": \"1. https://tomcat.apache.org/tomcat-8.0-doc/config/resources.html\n2. http://tomcat.apache.org/tomcat-8.0-doc/config/context.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.13\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Ensure all context.xml have the allowLinking attribute set\nto false or allowLinking\ndoes not exist.\n# find . -name context.xml | xargs grep 'allowLinking'\n\"\n  tag \"fix\": \"In all context.xml, set the allowLinking attribute to false:\n<Context\n...\n<Resources ... allowLinking=”false” />\n...\n</Context>\n\"\n  tag \"Default Value\": \"By default, allowLinking has a value of false\\n\"\n\n  begin\n    describe.one do\n      describe command(\"find #{TOMCAT_APP_DIR} -name context.xml | xargs grep 'allowLinking'\") do\n        its('stdout') { should eq ''}\n      end\n      describe command (\"find #{TOMCAT_APP_DIR} -name context.xml | xargs grep 'allowLinking'\") do\n        its('stdout') { should_not include 'allowLinking=\"true\"' }\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.13.rb",
        "line": 23
      },
      "id": "M-10.13"
    },
    {
      "title": "2.4 Disable X-Powered-By HTTP Header and Rename the Server Value for\nall Connectors (Scored)",
      "desc": "The xpoweredBy setting determines if Apache Tomcat will advertise its\npresence via the XPowered-By HTTP header. It is recommended that this value be\nset to false. The server attribute overrides the default value that is sent\ndown in the HTTP header further masking Apache Tomcat. Preventing Tomcat from\nadvertising its presence in this manner may make it harder for attackers to\ndetermine which vulnerabilities affect the server platform.",
      "descriptions": {
        "default": "The xpoweredBy setting determines if Apache Tomcat will advertise its\npresence via the XPowered-By HTTP header. It is recommended that this value be\nset to false. The server attribute overrides the default value that is sent\ndown in the HTTP header further masking Apache Tomcat. Preventing Tomcat from\nadvertising its presence in this manner may make it harder for attackers to\ndetermine which vulnerabilities affect the server platform."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/config/http.html",
        "severity": "medium",
        "cis_id": "2.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to determine if the server platform,\nas advertised in the HTTP Server\nheader, has been changed: Locate all Connector elements in\n$CATALINA_HOME/conf/server.xml. Ensure each Connector has a server attribute\nand that the server attribute does not\nreflect Apache Tomcat. Also, make sure that the xpoweredBy attribute is NOT set\nto true.\n",
        "fix": "Perform the following to prevent Tomcat from advertising its\npresence via the XPoweredBy HTTP header. Add the xpoweredBy attribute to each\nConnector specified in\n$CATALINA_HOME/conf/server.xml. Set the xpoweredBy attributes value to false.\n<Connector\n...\nxpoweredBy='false' />\nAlternatively, ensure the xpoweredBy attribute for each Connector specified in\n\n$CATALINA_HOME/conf/server.xml is absent.\n Add the server attribute to each Connector specified in\n$CATALINA_HOME/conf/server.xml. Set the server attribute value to anything\nexcept a\nblank string.\n",
        "Default Value": "The default value is false.\n"
      },
      "code": "control \"M-2.4\" do\n  title \"2.4 Disable X-Powered-By HTTP Header and Rename the Server Value for\nall Connectors (Scored)\"\n  desc  \"The xpoweredBy setting determines if Apache Tomcat will advertise its\npresence via the XPowered-By HTTP header. It is recommended that this value be\nset to false. The server attribute overrides the default value that is sent\ndown in the HTTP header further masking Apache Tomcat. Preventing Tomcat from\nadvertising its presence in this manner may make it harder for attackers to\ndetermine which vulnerabilities affect the server platform. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/config/http.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to determine if the server platform,\nas advertised in the HTTP Server\nheader, has been changed: Locate all Connector elements in\n$CATALINA_HOME/conf/server.xml. Ensure each Connector has a server attribute\nand that the server attribute does not\nreflect Apache Tomcat. Also, make sure that the xpoweredBy attribute is NOT set\nto true.\n\"\n  tag \"fix\": \"Perform the following to prevent Tomcat from advertising its\npresence via the XPoweredBy HTTP header. Add the xpoweredBy attribute to each\nConnector specified in\n$CATALINA_HOME/conf/server.xml. Set the xpoweredBy attributes value to false.\n<Connector\n...\nxpoweredBy='false' />\nAlternatively, ensure the xpoweredBy attribute for each Connector specified in\n\n$CATALINA_HOME/conf/server.xml is absent.\n Add the server attribute to each Connector specified in\n$CATALINA_HOME/conf/server.xml. Set the server attribute value to anything\nexcept a\nblank string.\n\"\n  tag \"Default Value\": \"The default value is false.\\n\"\n\n  tomcat_conf = xml(\"#{TOMCAT_HOME}/conf/server.xml\")\n\n  serverIter = 1\n  if tomcat_conf['Server/Service/Connector/@server'].is_a?(Array)\n    numConnectors = tomcat_conf['Server/Service/Connector'].count\n    until serverIter > numConnectors do\n       describe tomcat_conf[\"Server/Service/Connector[#{serverIter}]/@server\"] do\n         it { should_not eq [] }\n         it { should_not cmp 'Apache Tomcat' }\n       end\n       serverIter +=1\n     end\n  end\n\n  xpoweredByIter = 1\n  if tomcat_conf['Server/Service/Connector/@xpoweredBy'].is_a?(Array) && tomcat_conf['Server/Service/Connector/@xpoweredBy'].any?\n    numConnectors = tomcat_conf['Server/Service/Connector'].count\n    until xpoweredByIter > numConnectors do\n       describe.one do\n         describe tomcat_conf[\"Server/Service/Connector[#{xpoweredByIter}]/@xpoweredBy\"] do\n           it { should cmp 'false' }\n         end\n         describe tomcat_conf[\"Server/Service/Connector[#{xpoweredByIter}]/@xpoweredBy\"] do\n           it { should cmp [] }\n         end\n       end\n       xpoweredByIter +=1\n    end\n  end\n  if !tomcat_conf['Server/Service/Connector/@xpoweredBy'].any?\n    describe tomcat_conf[\"Server/Service/Connector/@xpoweredBy\"] do\n      it { should cmp [] }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-2.4.rb",
        "line": 17
      },
      "id": "M-2.4"
    },
    {
      "title": "4.9 Restrict access to Tomcat catalina.properties (Scored)",
      "desc": "catalina.properties is a Java properties files that contains settings\nfor Tomcat including class loader information, security package lists, and\nperformance properties. It is recommended that access to this file has the\nproper permissions to properly protect from unauthorized changes. Restricting\naccess to this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy.",
      "descriptions": {
        "default": "catalina.properties is a Java properties files that contains settings\nfor Tomcat including class loader information, security package lists, and\nperformance properties. It is recommended that access to this file has the\nproper permissions to properly protect from unauthorized changes. Restricting\naccess to this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.9",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/catalina.properties care securely configured. Change to the\nlocation of the $CATALINA_HOME/ and execute the following:\n# cd $CATALINA_HOME/conf/\n# find catalina.properties -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user\n\ntomcat_admin -o ! -group tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to catalina.properties:\nSet the ownership of the $CATALINA_HOME/conf/catalina.properties to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.properties\n# chmod g-w,o-rwx $CATALINA_HOME/conf/catalina.properties\n\n",
        "Default Value": "The default permissions of the top-level directories is\n600."
      },
      "code": "control \"M-4.9\" do\n  title \"4.9 Restrict access to Tomcat catalina.properties (Scored)\"\n  desc  \"catalina.properties is a Java properties files that contains settings\nfor Tomcat including class loader information, security package lists, and\nperformance properties. It is recommended that access to this file has the\nproper permissions to properly protect from unauthorized changes. Restricting\naccess to this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.9\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/catalina.properties care securely configured. Change to the\nlocation of the $CATALINA_HOME/ and execute the following:\n# cd $CATALINA_HOME/conf/\n# find catalina.properties -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user\n\ntomcat_admin -o ! -group tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to catalina.properties:\nSet the ownership of the $CATALINA_HOME/conf/catalina.properties to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.properties\n# chmod g-w,o-rwx $CATALINA_HOME/conf/catalina.properties\n\n\"\n  tag \"Default Value\": \"The default permissions of the top-level directories is\n600.\"\n\n  describe file(\"#{TOMCAT_HOME}/conf/catalina.properties\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.9.rb",
        "line": 29
      },
      "id": "M-4.9"
    },
    {
      "title": "5.2 Use LockOut Realms (Scored)",
      "desc": "A LockOut realm wraps around standard realms adding the ability to\nlock a user out after multiple failed logins. Locking out a user after multiple\nfailed logins slows down attackers from brute forcing logins.",
      "descriptions": {
        "default": "A LockOut realm wraps around standard realms adding the ability to\nlock a user out after multiple failed logins. Locking out a user after multiple\nfailed logins slows down attackers from brute forcing logins."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/realm-howto.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/realm.html",
        "severity": "medium",
        "cis_id": "5.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to check to see if a LockOut realm\nis being used:\n# grep 'LockOutRealm' $CATALINA_HOME/conf/server.xml\n",
        "fix": "Create a lockout realm wrapping the main realm like the example\nbelow:\n<Realm className='org.apache.catalina.realm.LockOutRealm'\nfailureCount='3' lockOutTime='600' cacheSize='1000'\ncacheRemovalWarningTime='3600'>\n<Realm\nclassName='org.apache.catalina.realm.DataSourceRealm'\ndataSourceName=... />\n</Realm>\n"
      },
      "code": "control \"M-5.2\" do\n  title \"5.2 Use LockOut Realms (Scored)\"\n  desc  \"A LockOut realm wraps around standard realms adding the ability to\nlock a user out after multiple failed logins. Locking out a user after multiple\nfailed logins slows down attackers from brute forcing logins. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/realm-howto.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/realm.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to check to see if a LockOut realm\nis being used:\n# grep 'LockOutRealm' $CATALINA_HOME/conf/server.xml\n\"\n  tag \"fix\": \"Create a lockout realm wrapping the main realm like the example\nbelow:\n<Realm className='org.apache.catalina.realm.LockOutRealm'\nfailureCount='3' lockOutTime='600' cacheSize='1000'\ncacheRemovalWarningTime='3600'>\n<Realm\nclassName='org.apache.catalina.realm.DataSourceRealm'\ndataSourceName=... />\n</Realm>\n\"\n\n  lockoutRealm = \"org.apache.catalina.realm.LockOutRealm\"\n\n  describe.one do\n    describe xml(\"#{TOMCAT_HOME}/conf/server.xml\") do\n      its('Server/Service/Engine/Realm/@className') { should cmp lockoutRealm }\n    end\n    describe xml(\"#{TOMCAT_HOME}/conf/server.xml\") do\n      its('Server/Service/Engine/Realm/Realm/@className') { should cmp lockoutRealm }\n    end\n    describe xml(\"#{TOMCAT_HOME}/conf/server.xml\") do\n      its('Server/Service/Host/Realm/@className') { should cmp lockoutRealm }\n    end\n    describe xml(\"#{TOMCAT_HOME}/conf/server.xml\") do\n      its('Server/Service/Host/Realm/Realm/@className') { should cmp lockoutRealm }\n    end\n    describe xml(\"#{TOMCAT_HOME}/conf/server.xml\") do\n      its('Server/Service/Context/Realm/@className') { should cmp lockoutRealm }\n    end\n    describe xml(\"#{TOMCAT_HOME}/conf/server.xml\") do\n      its('Server/Service/Context/Realm/Realm/@className') { should cmp lockoutRealm }\n    end\n    describe xml(\"#{TOMCAT_HOME}/conf/context.xml\") do\n      its('Context/Realm/@className') { should cmp lockoutRealm }\n    end\n    describe xml(\"#{TOMCAT_HOME}/conf/context.xml\") do\n      its('Context/Realm/Realm/@className') { should cmp lockoutRealm }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-5.2.rb",
        "line": 17
      },
      "id": "M-5.2"
    },
    {
      "title": "1.1 Remove extraneous files and directories (Scored)",
      "desc": "The installation may provide example applications, documentation, and\nother directories which may not serve a production use. Removing sample\nresources is a defense in depth measure that reduces potential exposures\nintroduced by these resources.",
      "descriptions": {
        "default": "The installation may provide example applications, documentation, and\nother directories which may not serve a production use. Removing sample\nresources is a defense in depth measure that reduces potential exposures\nintroduced by these resources."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "1.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to determine the existence of\nextraneous resources:\nList all files extraneous files. The following should yield no output:\n$ ls -l $CATALINA_HOME/webapps/docs \\\n$CATALINA_HOME/webapps/examples\n",
        "fix": "Perform the following to remove extraneous resources:\nThe following should yield no output:\n$ rm -rf $CATALINA_HOME/webapps/docs \\\n$CATALINA_HOME/webapps/examples\nIf the Manager application is not utilized, also remove the following\nresources:\n$ rm –rf $CATALINA_HOME/webapps/host-manager \\\n$CATALINA_HOME/webapps/manager \\\n$CATALINA_HOME/conf/Catalina/localhost/manager.xml\n\n",
        "Default Value": "\"docs\", \"examples\", \"manager\" and\n\"host-manager\" are default web applications shipped\nwith Tomcat."
      },
      "code": "control \"M-1.1\" do\n  title \"1.1 Remove extraneous files and directories (Scored)\"\n  desc  \"The installation may provide example applications, documentation, and\nother directories which may not serve a production use. Removing sample\nresources is a defense in depth measure that reduces potential exposures\nintroduced by these resources. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"1.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to determine the existence of\nextraneous resources:\nList all files extraneous files. The following should yield no output:\n$ ls -l $CATALINA_HOME/webapps/docs \\\\\n$CATALINA_HOME/webapps/examples\n\"\n  tag \"fix\": \"Perform the following to remove extraneous resources:\nThe following should yield no output:\n$ rm -rf $CATALINA_HOME/webapps/docs \\\\\n$CATALINA_HOME/webapps/examples\nIf the Manager application is not utilized, also remove the following\nresources:\n$ rm –rf $CATALINA_HOME/webapps/host-manager \\\\\n$CATALINA_HOME/webapps/manager \\\\\n$CATALINA_HOME/conf/Catalina/localhost/manager.xml\n\n\"\n  tag \"Default Value\": \"\\\"docs\\\", \\\"examples\\\", \\\"manager\\\" and\n\\\"host-manager\\\" are default web applications shipped\\nwith Tomcat.\"\n\n  TOMCAT_EXTRANEOUS_RESOURCE_LIST.each do |app|\n    describe command(\"ls -l #{TOMCAT_HOME}/#{app}\") do\n      its('stdout.strip') { should eq '' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-1.1.rb",
        "line": 26
      },
      "id": "M-1.1"
    },
    {
      "title": "7.5 Ensure pattern in context.xml is correct (Scored)",
      "desc": "The pattern setting informs Tomcat what information should be logged\nper applications. At a minimum, enough information to uniquely identify a\nrequest, what was requested, where the requested originated from, and when the\nrequest occurred should be logged. The following will log the request date and\ntime (%t), the requested URL (%U), the remote IP address (%a), the local IP\naddress (%A), the request method (%m), the local port (%p), query string, if\npresent, (%q), and the HTTP status code of the response (%s). pattern='%t %U %a\n%A %m %p %q %s” The level of logging detail prescribed will assist in\nidentifying correlating security events or incidents.",
      "descriptions": {
        "default": "The pattern setting informs Tomcat what information should be logged\nper applications. At a minimum, enough information to uniquely identify a\nrequest, what was requested, where the requested originated from, and when the\nrequest occurred should be logged. The following will log the request date and\ntime (%t), the requested URL (%U), the remote IP address (%a), the local IP\naddress (%A), the request method (%m), the local port (%p), query string, if\npresent, (%q), and the HTTP status code of the response (%s). pattern='%t %U %a\n%A %m %p %q %s” The level of logging detail prescribed will assist in\nidentifying correlating security events or incidents."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/config/valve.html",
        "severity": "medium",
        "cis_id": "7.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review the pattern settings to ensure it contains all the\nvariables required by the\ninstallation.\n# grep pattern $CATALINA_BASE\\webapps\\<app-name>\\META-INF\\context.xml\n",
        "fix": "Add the following statement into the\n$CATALINA_BASE\\webapps\\<app-name>\\METAINF\\context.xml file if it does not\nalready exist.\n<Valve\nclassName='org.apache.catalina.valves.AccessLogValve'\ndirectory='$CATALINA_HOME/logs/'\nprefix='access_log' fileDateFormat='yyyy-MM-dd.HH' suffix='.log'\npattern='%h %t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r'\n/>\n",
        "Default Value": "Does not exist by default\n"
      },
      "code": "control \"M-7.5\" do\n  title \"7.5 Ensure pattern in context.xml is correct (Scored)\"\n  desc  \"The pattern setting informs Tomcat what information should be logged\nper applications. At a minimum, enough information to uniquely identify a\nrequest, what was requested, where the requested originated from, and when the\nrequest occurred should be logged. The following will log the request date and\ntime (%t), the requested URL (%U), the remote IP address (%a), the local IP\naddress (%A), the request method (%m), the local port (%p), query string, if\npresent, (%q), and the HTTP status code of the response (%s). pattern='%t %U %a\n%A %m %p %q %s” The level of logging detail prescribed will assist in\nidentifying correlating security events or incidents. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/config/valve.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review the pattern settings to ensure it contains all the\nvariables required by the\ninstallation.\n# grep pattern $CATALINA_BASE\\\\webapps\\\\<app-name>\\\\META-INF\\\\context.xml\n\"\n  tag \"fix\": \"Add the following statement into the\n$CATALINA_BASE\\\\webapps\\\\<app-name>\\\\METAINF\\\\context.xml file if it does not\nalready exist.\n<Valve\nclassName='org.apache.catalina.valves.AccessLogValve'\ndirectory='$CATALINA_HOME/logs/'\nprefix='access_log' fileDateFormat='yyyy-MM-dd.HH' suffix='.log'\npattern='%h %t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r'\n/>\n\"\n  tag \"Default Value\": \"Does not exist by default\\n\"\n\n  begin\n    context_xml = command(\"ls #{TOMCAT_HOME}/webapps/*/META-INF/context.xml\").stdout.split.each do |web_file|\n      describe xml(web_file) do\n        its('Context/Valve/attribute::className') { should include \"org.apache.catalina.valves.AccessLogValve\" }\n        its('Context/Valve/attribute::directory') { should cmp '$CATALINA_HOME/logs/' }\n        its('Context/Valve/attribute::prefix') { should cmp 'access_log' }\n        its('Context/Valve/attribute::fileDateFormat') { should cmp 'yyyy-MM-dd.HH' }\n        its('Context/Valve/attribute::suffix') { should cmp '.log' }\n        its('Context/Valve/attribute::pattern') { should cmp '%h %t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r' }\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-7.5.rb",
        "line": 35
      },
      "id": "M-7.5"
    },
    {
      "title": "9.3 Disable deploy on startup of applications (Scored)",
      "desc": "Tomcat allows auto deployment of applications. It is recommended that\nthis capability be disabled. This could allow malicious or untested\napplications to be deployed and should be disabled.",
      "descriptions": {
        "default": "Tomcat allows auto deployment of applications. It is recommended that\nthis capability be disabled. This could allow malicious or untested\napplications to be deployed and should be disabled."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/deployerhowto.html#Deployment_on_Tomcat_startup\n2.\nhttps://tomcat.apache.org/tomcat-8.0doc/config/host.html#Automatic_Application_Deployment\n3. https://tomcat.apache.org/tomcat-8.0-doc/config/host.html  10 Miscellaneous\nConfiguration Settings Store web content on a separate partition from Tomcat\nsystem files.",
        "severity": "medium",
        "cis_id": "9.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to ensure deployOnStartup is set to\nfalse.\n# grep 'deployOnStartup' $CATALINA_HOME/conf/server.xml\n",
        "fix": "In the $CATALINA_HOME/conf/server.xml file, change\ndeployOnStartup to false.\ndeployOnStartup='false'\n",
        "Default Value": "deployOnStartup is set to true\n"
      },
      "code": "control \"M-9.3\" do\n  title \"9.3 Disable deploy on startup of applications (Scored)\"\n  desc  \"Tomcat allows auto deployment of applications. It is recommended that\nthis capability be disabled. This could allow malicious or untested\napplications to be deployed and should be disabled. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/deployerhowto.html#Deployment_on_Tomcat_startup\n2.\nhttps://tomcat.apache.org/tomcat-8.0doc/config/host.html#Automatic_Application_Deployment\n3. https://tomcat.apache.org/tomcat-8.0-doc/config/host.html  10 Miscellaneous\nConfiguration Settings Store web content on a separate partition from Tomcat\nsystem files.\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"9.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to ensure deployOnStartup is set to\nfalse.\n# grep 'deployOnStartup' $CATALINA_HOME/conf/server.xml\n\"\n  tag \"fix\": \"In the $CATALINA_HOME/conf/server.xml file, change\ndeployOnStartup to false.\ndeployOnStartup='false'\n\"\n  tag \"Default Value\": \"deployOnStartup is set to true\\n\"\n\n  begin\n    describe xml(TOMCAT_CONF_SERVER) do\n      its('Server/Service/Engine/Host/attribute::deployOnStartup') { should cmp 'false' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-9.3.rb",
        "line": 35
      },
      "id": "M-9.3"
    },
    {
      "title": "6.3 Ensure scheme is set accurately (Scored)",
      "desc": "The scheme attribute is used to indicate to callers of\nrequest.getScheme() which scheme is in use by the Connector. Ensure the scheme\nattribute is set to http for Connectors operating over HTTP. Ensure the scheme\nattribute is set to https for Connectors operating of HTTPS. Maintaining parity\nbetween the scheme in use by the Connector and advertised by\nrequest.getScheme() will ensure applications built on Tomcat have an accurate\ndepiction of the context and security guarantees provided to them.",
      "descriptions": {
        "default": "The scheme attribute is used to indicate to callers of\nrequest.getScheme() which scheme is in use by the Connector. Ensure the scheme\nattribute is set to http for Connectors operating over HTTP. Ensure the scheme\nattribute is set to https for Connectors operating of HTTPS. Maintaining parity\nbetween the scheme in use by the Connector and advertised by\nrequest.getScheme() will ensure applications built on Tomcat have an accurate\ndepiction of the context and security guarantees provided to them."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/http.html",
        "severity": "medium",
        "cis_id": "6.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review server.xml to ensure the Connector’s scheme\nattribute is set to http for Connectorsperating over HTTP. Also ensure the\nConnector’s scheme attribute is set to https for\nConnectors operating over HTTPS.\n",
        "fix": "In server.xml, set the Connector’s scheme attribute to http for\nConnectors operating over\nHTTP. Set the Connector’s scheme attribute to https for Connectors operating of\nHTTPS.\n<Connector\n…\nscheme='https'\n…\n/>\n",
        "Default Value": "The scheme attribute is set to http.\n"
      },
      "code": "control \"M-6.3\" do\n  title \"6.3 Ensure scheme is set accurately (Scored)\"\n  desc  \"The scheme attribute is used to indicate to callers of\nrequest.getScheme() which scheme is in use by the Connector. Ensure the scheme\nattribute is set to http for Connectors operating over HTTP. Ensure the scheme\nattribute is set to https for Connectors operating of HTTPS. Maintaining parity\nbetween the scheme in use by the Connector and advertised by\nrequest.getScheme() will ensure applications built on Tomcat have an accurate\ndepiction of the context and security guarantees provided to them. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/http.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review server.xml to ensure the Connector’s scheme\nattribute is set to http for Connectorsperating over HTTP. Also ensure the\nConnector’s scheme attribute is set to https for\nConnectors operating over HTTPS.\n\"\n  tag \"fix\": \"In server.xml, set the Connector’s scheme attribute to http for\nConnectors operating over\nHTTP. Set the Connector’s scheme attribute to https for Connectors operating of\nHTTPS.\n<Connector\n…\nscheme='https'\n…\n/>\n\"\n  tag \"Default Value\": \"The scheme attribute is set to http.\\n\"\n\n  begin\n    tomcat_server = tomcat_server_xml(\"#{TOMCAT_CONF_SERVER}\")\n\n    tomcat_server.params.each do |connector|\n      describe connector do\n        if connector[:sslenable] == \"true\"\n          its([:scheme]) { should cmp 'https' }\n        end\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-6.3.rb",
        "line": 41
      },
      "id": "M-6.3"
    },
    {
      "title": "10.9 Do not allow custom header status messages (Scored)",
      "desc": "Being able to specify custom status messages opens up the possibility\nfor additional headers to be injected. If custom header status messages are\nrequired, make sure it is only in US-ASCII and does not include any\nuser-supplied data. Allowing user-supplied data into a header allows the\npossibility of XSS.",
      "descriptions": {
        "default": "Being able to specify custom status messages opens up the possibility\nfor additional headers to be injected. If custom header status messages are\nrequired, make sure it is only in US-ASCII and does not include any\nuser-supplied data. Allowing user-supplied data into a header allows the\npossibility of XSS."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/systemprops.html",
        "severity": "medium",
        "cis_id": "10.9",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Ensure the above parameter is added to the startup script\nwhich by default is located at\n$CATALINA_HOME/bin/catalina.sh.\n",
        "fix": "Start Tomcat with USE_CUSTOM_STATUS_MSG_IN_HEADER set to false.\nAdd the following\nto your startup script.\n-Dorg.apache.coyote.USE_CUSTOM_STATUS_MSG_IN_HEADER=false\n",
        "Default Value": "By default, allowing custom header status messages is\nset to false.\n"
      },
      "code": "control \"M-10.9\" do\n  title \"10.9 Do not allow custom header status messages (Scored)\"\n  desc  \"Being able to specify custom status messages opens up the possibility\nfor additional headers to be injected. If custom header status messages are\nrequired, make sure it is only in US-ASCII and does not include any\nuser-supplied data. Allowing user-supplied data into a header allows the\npossibility of XSS. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/systemprops.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.9\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Ensure the above parameter is added to the startup script\nwhich by default is located at\n$CATALINA_HOME/bin/catalina.sh.\n\"\n  tag \"fix\": \"Start Tomcat with USE_CUSTOM_STATUS_MSG_IN_HEADER set to false.\nAdd the following\nto your startup script.\n-Dorg.apache.coyote.USE_CUSTOM_STATUS_MSG_IN_HEADER=false\n\"\n  tag \"Default Value\": \"By default, allowing custom header status messages is\nset to false.\\n\"\n\n  begin\n    cat_prop = tomcat_properties_file.read_content(\"#{TOMCAT_HOME}/conf/catalina.properties\")\n\n    describe cat_prop['org.apache.coyote.USE_CUSTOM_STATUS_MSG_IN_HEADER'] do\n      it { should cmp 'false' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.9.rb",
        "line": 29
      },
      "id": "M-10.9"
    },
    {
      "title": "6.5 Ensure SSL Protocol is set to TLS for Secure Connectors (Scored)",
      "desc": "The sslProtocol setting determines which protocol Tomcat will use to\nprotect traffic. It is recommended that sslProtocol attribute be set to TLS.\nThe TLS protocol does not contain weaknesses that affect other secure transport\nprotocols, such as SSLv1 or SSLv2. Therefore, TLS is leveraged to protect the\nconfidentiality and integrity of data while in transit.",
      "descriptions": {
        "default": "The sslProtocol setting determines which protocol Tomcat will use to\nprotect traffic. It is recommended that sslProtocol attribute be set to TLS.\nThe TLS protocol does not contain weaknesses that affect other secure transport\nprotocols, such as SSLv1 or SSLv2. Therefore, TLS is leveraged to protect the\nconfidentiality and integrity of data while in transit."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/http.html",
        "severity": "medium",
        "cis_id": "6.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review server.xml to ensure the sslProtocol attribute is\nset to TLS for all Connectors having\nSSLEngine set to on.\n",
        "fix": "In server.xml, set the sslProtocol attribute to 'TLS' for\nConnectors having SSLEnabled set\nto true.\n<Connector\n…\nsslProtocol='TLS'\n…\n/>\n",
        "Default Value": "If not specified, the default value of \"TLS\" will be\nused.\n"
      },
      "code": "control \"M-6.5\" do\n  title \"6.5 Ensure SSL Protocol is set to TLS for Secure Connectors (Scored)\"\n  desc  \"The sslProtocol setting determines which protocol Tomcat will use to\nprotect traffic. It is recommended that sslProtocol attribute be set to TLS.\nThe TLS protocol does not contain weaknesses that affect other secure transport\nprotocols, such as SSLv1 or SSLv2. Therefore, TLS is leveraged to protect the\nconfidentiality and integrity of data while in transit. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html 2.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/http.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review server.xml to ensure the sslProtocol attribute is\nset to TLS for all Connectors having\nSSLEngine set to on.\n\"\n  tag \"fix\": \"In server.xml, set the sslProtocol attribute to 'TLS' for\nConnectors having SSLEnabled set\nto true.\n<Connector\n…\nsslProtocol='TLS'\n…\n/>\n\"\n  tag \"Default Value\": \"If not specified, the default value of \\\"TLS\\\" will be\nused.\\n\"\n\n  begin\n    tomcat_server = tomcat_server_xml(\"#{TOMCAT_CONF_SERVER}\")\n\n    tomcat_server.params.each do |connector|\n      describe connector do\n        if connector[:sslenable] == \"true\"\n          its([:sslprotocol]) { should cmp 'TLS' }\n        end\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-6.5.rb",
        "line": 41
      },
      "id": "M-6.5"
    },
    {
      "title": "10.17 Enable memory leak listener (Scored)",
      "desc": "The JRE Memory Leak Prevention Listener provides a work-around for\nknown places where the Java Runtime environment uses the context class loader\nto load a singleton as this will cause a memory leak if a web application class\nloader happens to be the context class loader at the time. The work-around is\nto initialize these singletons when this listener starts as Tomcat's common\nclass loader is the context class loader at that time. It also provides\nwork-arounds for known issues that can result in locked JAR files. Enable the\nJRE Memory Leak Prevention Listener provides a work-around for preventing a\nmemory leak.",
      "descriptions": {
        "default": "The JRE Memory Leak Prevention Listener provides a work-around for\nknown places where the Java Runtime environment uses the context class loader\nto load a singleton as this will cause a memory leak if a web application class\nloader happens to be the context class loader at the time. The work-around is\nto initialize these singletons when this listener starts as Tomcat's common\nclass loader is the context class loader at that time. It also provides\nwork-arounds for known issues that can result in locked JAR files. Enable the\nJRE Memory Leak Prevention Listener provides a work-around for preventing a\nmemory leak."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://tomcat.apache.org/tomcat-8.0doc/config/listeners.html#JRE_Memory_Leak_Prevention_Listener__org.apache.catalina.core.JreMemoryLeakPreventionListener",
        "severity": "medium",
        "cis_id": "10.17",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review the $CATALINA_HOME/conf/server.xml and see whether\nJRE Memory Leak\nPrevention Listener is enabled.\n",
        "fix": "Uncomment the JRE Memory Leak Prevention Listener in\n$CATALINA_HOME/conf/server.xml\n<Listener className='org.apache.catalina.core.JreMemoryLeakPreventionListener'\n/>\n"
      },
      "code": "control \"M-10.17\" do\n  title \"10.17 Enable memory leak listener (Scored)\"\n  desc  \"The JRE Memory Leak Prevention Listener provides a work-around for\nknown places where the Java Runtime environment uses the context class loader\nto load a singleton as this will cause a memory leak if a web application class\nloader happens to be the context class loader at the time. The work-around is\nto initialize these singletons when this listener starts as Tomcat's common\nclass loader is the context class loader at that time. It also provides\nwork-arounds for known issues that can result in locked JAR files. Enable the\nJRE Memory Leak Prevention Listener provides a work-around for preventing a\nmemory leak. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://tomcat.apache.org/tomcat-8.0doc/config/listeners.html#JRE_Memory_Leak_Prevention_Listener__org.apache.catalina.core.JreMemoryLeakPreventionListener\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.17\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review the $CATALINA_HOME/conf/server.xml and see whether\nJRE Memory Leak\nPrevention Listener is enabled.\n\"\n  tag \"fix\": \"Uncomment the JRE Memory Leak Prevention Listener in\n$CATALINA_HOME/conf/server.xml\n<Listener className='org.apache.catalina.core.JreMemoryLeakPreventionListener'\n/>\n\"\n\n  begin\n    describe xml(TOMCAT_CONF_SERVER) do\n      its('Server/Listener/attribute::className') { should include 'org.apache.catalina.core.JreMemoryLeakPreventionListener' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.17.rb",
        "line": 17
      },
      "id": "M-10.17"
    },
    {
      "title": "4.12 Restrict access to Tomcat server.xml (Scored)",
      "desc": "server.xml contains Tomcat servlet definitions and configurations. It\nis recommended that access to this file has the proper permissions to properly\nprotect from unauthorized changes. Restricting access to this file will prevent\nlocal users from maliciously or inadvertently altering Tomcat’s security\npolicy.",
      "descriptions": {
        "default": "server.xml contains Tomcat servlet definitions and configurations. It\nis recommended that access to this file has the proper permissions to properly\nprotect from unauthorized changes. Restricting access to this file will prevent\nlocal users from maliciously or inadvertently altering Tomcat’s security\npolicy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.12",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/server.xml care securely configured. Change to the location\nof the $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf/\n# find server.xml -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user\ntomcat_admin -o ! -group tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to server.xml: Set the\nownership of the $CATALINA_HOME/conf/server.xml to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/server.xml\n# chmod g-w,o-rwx $CATALINA_HOME/conf/server.xml\n\n",
        "Default Value": "The default permissions of the top-level directories is\n600."
      },
      "code": "control \"M-4.12\" do\n  title \"4.12 Restrict access to Tomcat server.xml (Scored)\"\n  desc  \"server.xml contains Tomcat servlet definitions and configurations. It\nis recommended that access to this file has the proper permissions to properly\nprotect from unauthorized changes. Restricting access to this file will prevent\nlocal users from maliciously or inadvertently altering Tomcat’s security\npolicy. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.12\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/server.xml care securely configured. Change to the location\nof the $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf/\n# find server.xml -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user\ntomcat_admin -o ! -group tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to server.xml: Set the\nownership of the $CATALINA_HOME/conf/server.xml to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/server.xml\n# chmod g-w,o-rwx $CATALINA_HOME/conf/server.xml\n\n\"\n  tag \"Default Value\": \"The default permissions of the top-level directories is\n600.\"\n\n  describe file(\"#{TOMCAT_HOME}/conf/server.xml\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.12.rb",
        "line": 29
      },
      "id": "M-4.12"
    },
    {
      "title": "10.14 Do not run applications as privileged (Scored)",
      "desc": "Setting the privileged attribute for an application changes the class\nloader to the Server class loader instead of the Shared class loader. Running\nan application in privileged mode allows an application to load the manager\nlibraries.",
      "descriptions": {
        "default": "Setting the privileged attribute for an application changes the class\nloader to the Server class loader instead of the Shared class loader. Running\nan application in privileged mode allows an application to load the manager\nlibraries."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/config/context.html",
        "severity": "medium",
        "cis_id": "10.14",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Ensure all context.xml have the privileged attribute set\nto false or privileged does not exist.\n# find . -name context.xml | xargs grep 'privileged'\n",
        "fix": "In all context.xml, set the privileged attribute to false unless\nit is required like the\nmanager application:\n<Context ... privileged=”false” />\n",
        "Default Value": "By default, privileged has a value of false.\n"
      },
      "code": "control \"M-10.14\" do\n  title \"10.14 Do not run applications as privileged (Scored)\"\n  desc  \"Setting the privileged attribute for an application changes the class\nloader to the Server class loader instead of the Shared class loader. Running\nan application in privileged mode allows an application to load the manager\nlibraries. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/config/context.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.14\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Ensure all context.xml have the privileged attribute set\nto false or privileged does not exist.\n# find . -name context.xml | xargs grep 'privileged'\n\"\n  tag \"fix\": \"In all context.xml, set the privileged attribute to false unless\nit is required like the\nmanager application:\n<Context ... privileged=”false” />\n\"\n  tag \"Default Value\": \"By default, privileged has a value of false.\\n\"\n\n  begin\n    describe.one do\n      describe command(\"find #{TOMCAT_APP_DIR} -name context.xml | xargs grep 'privileged'\") do\n        its('stdout') { should eq ''}\n      end\n      describe command (\"find #{TOMCAT_APP_DIR} -name context.xml | xargs grep 'privileged'\") do\n        its('stdout') { should_not include 'privileged=\"true\"' }\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.14.rb",
        "line": 23
      },
      "id": "M-10.14"
    },
    {
      "title": "10.15 Do not allow cross context requests (Scored)",
      "desc": "Setting crossContext to true allows for an application to call\nServletConext.getContext to return a dispatcher for another application.\nAllowing crossContext creates the possibility for a malicious application to\nmake requests to a restricted application.",
      "descriptions": {
        "default": "Setting crossContext to true allows for an application to call\nServletConext.getContext to return a dispatcher for another application.\nAllowing crossContext creates the possibility for a malicious application to\nmake requests to a restricted application."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/config/context.html",
        "severity": "medium",
        "cis_id": "10.15",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Ensure all context.xml have the crossContext attribute set\nto false or crossContext does not\nexist.\n# find . -name context.xml | xargs grep 'crossContext'\n",
        "fix": "In all context.xml, set the crossContext attribute to false:\n<Context ... crossContext=”false” />\n",
        "Default Value": "By default, crossContext has a value of false.\n"
      },
      "code": "control \"M-10.15\" do\n  title \"10.15 Do not allow cross context requests (Scored)\"\n  desc  \"Setting crossContext to true allows for an application to call\nServletConext.getContext to return a dispatcher for another application.\nAllowing crossContext creates the possibility for a malicious application to\nmake requests to a restricted application. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/config/context.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.15\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Ensure all context.xml have the crossContext attribute set\nto false or crossContext does not\nexist.\n# find . -name context.xml | xargs grep 'crossContext'\n\"\n  tag \"fix\": \"In all context.xml, set the crossContext attribute to false:\n<Context ... crossContext=”false” />\n\"\n  tag \"Default Value\": \"By default, crossContext has a value of false.\\n\"\n\n  begin\n    describe.one do\n      describe command(\"find #{TOMCAT_APP_DIR} -name context.xml | xargs grep 'crossContext'\") do\n        its('stdout') { should eq ''}\n      end\n      describe command (\"find #{TOMCAT_APP_DIR} -name context.xml | xargs grep 'crossContext'\") do\n        its('stdout') { should_not include 'crossContext=\"true\"' }\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.15.rb",
        "line": 23
      },
      "id": "M-10.15"
    },
    {
      "title": "10.6 Enable strict servlet Compliance (Scored)",
      "desc": "The STRICT_SERVLET_COMPLIANCE influences Tomcat’s behavior in several\nsubtle ways. See the References below for the complete list. It is recommended\nthat STRICT_SERVLET_COMPLIANCE be set to true. When STRICT_SERVLET_COMPLIANCE\nis set to true, Tomcat will always send an HTTP Content-type header when\nresponding to requests. This is significant as the behavior of web browsers is\ninconsistent in the absence of the Content-type header. Some browsers will\nattempt to determine the appropriate content-type by sniffing",
      "descriptions": {
        "default": "The STRICT_SERVLET_COMPLIANCE influences Tomcat’s behavior in several\nsubtle ways. See the References below for the complete list. It is recommended\nthat STRICT_SERVLET_COMPLIANCE be set to true. When STRICT_SERVLET_COMPLIANCE\nis set to true, Tomcat will always send an HTTP Content-type header when\nresponding to requests. This is significant as the behavior of web browsers is\ninconsistent in the absence of the Content-type header. Some browsers will\nattempt to determine the appropriate content-type by sniffing"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/systemprops.html",
        "severity": "medium",
        "cis_id": "10.6",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Ensure the above parameter is added to the startup script\nwhich by default is located at\n$CATALINA_HOME/bin/catalina.sh.\n",
        "fix": "Start Tomcat with strict compliance enabled. Add the following to\nyour startup script.\n-Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true\n",
        "Default Value": "By default, this configuration parameter is not\npresent.\n"
      },
      "code": "control \"M-10.6\" do\n  title \"10.6 Enable strict servlet Compliance (Scored)\"\n  desc  \"The STRICT_SERVLET_COMPLIANCE influences Tomcat’s behavior in several\nsubtle ways. See the References below for the complete list. It is recommended\nthat STRICT_SERVLET_COMPLIANCE be set to true. When STRICT_SERVLET_COMPLIANCE\nis set to true, Tomcat will always send an HTTP Content-type header when\nresponding to requests. This is significant as the behavior of web browsers is\ninconsistent in the absence of the Content-type header. Some browsers will\nattempt to determine the appropriate content-type by sniffing \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/systemprops.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.6\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Ensure the above parameter is added to the startup script\nwhich by default is located at\n$CATALINA_HOME/bin/catalina.sh.\n\"\n  tag \"fix\": \"Start Tomcat with strict compliance enabled. Add the following to\nyour startup script.\n-Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true\n\"\n  tag \"Default Value\": \"By default, this configuration parameter is not\npresent.\\n\"\n\n  begin\n    cat_prop = tomcat_properties_file.read_content(\"#{TOMCAT_HOME}/conf/catalina.properties\")\n\n    describe cat_prop['org.apache.catalina.STRICT_SERVLET_COMPLIANCE'] do\n      it { should cmp 'true' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.6.rb",
        "line": 29
      },
      "id": "M-10.6"
    },
    {
      "title": "8.1 Restrict runtime access to sensitive packages (Scored)",
      "desc": "package.access grants or revokes access to listed packages during\nruntime. It is recommended that application access to certain packages be\nrestricted. Prevent web applications from accessing restricted or unknown\npackages which may be malicious or dangerous to the application.",
      "descriptions": {
        "default": "package.access grants or revokes access to listed packages during\nruntime. It is recommended that application access to certain packages be\nrestricted. Prevent web applications from accessing restricted or unknown\npackages which may be malicious or dangerous to the application."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "8.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review package.access list in\n$CATALINA_BASE/conf/catalina.properties to ensure only\nallowed packages are defined.\n",
        "fix": "Edit $CATALINA_BASE/conf/catalina.properties by adding allowed\npackages to the\npackage.access list:\npackage.access =\nsun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,\norg.apache.jasper\n",
        "Default Value": "The default package.access value within\n$CATALINA_BASE/conf/catalina.properties is:\npackage.access =\nsun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,\norg.apache.jasper"
      },
      "code": "control \"M-8.1\" do\n  title \"8.1 Restrict runtime access to sensitive packages (Scored)\"\n  desc  \"package.access grants or revokes access to listed packages during\nruntime. It is recommended that application access to certain packages be\nrestricted. Prevent web applications from accessing restricted or unknown\npackages which may be malicious or dangerous to the application. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"8.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review package.access list in\n$CATALINA_BASE/conf/catalina.properties to ensure only\nallowed packages are defined.\n\"\n  tag \"fix\": \"Edit $CATALINA_BASE/conf/catalina.properties by adding allowed\npackages to the\npackage.access list:\npackage.access =\nsun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,\norg.apache.jasper\n\"\n  tag \"Default Value\": \"The default package.access value within\n$CATALINA_BASE/conf/catalina.properties is:\\npackage.access =\nsun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,\\norg.apache.jasper\"\n\n  begin\n    allowed = [\"sun.\", \"org.apache.catalina.\", \"org.apache.coyote.\", \"org.apache.tomcat.\", \"org.apache.jasper.\"]\n    cat_prop = tomcat_properties_file.read_content(\"#{TOMCAT_HOME}/conf/catalina.properties\")\n\n    describe cat_prop['package.access'].strip.split(',') do\n      it { should be_in allowed }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-8.1.rb",
        "line": 35
      },
      "id": "M-8.1"
    },
    {
      "title": "2.5 Disable client facing Stack Traces (Scored)",
      "desc": "When a runtime error occurs during request processing, Apache Tomcat\nwill display debugging information to the requestor. It is recommended that\nsuch debug information be withheld from the requestor. Debugging information,\nsuch as that found in call stacks, often contains sensitive information that\nmay useful to an attacker. By preventing Tomcat from providing this\ninformation, the risk of leaking sensitive information to a potential attacker\nis reduced.",
      "descriptions": {
        "default": "When a runtime error occurs during request processing, Apache Tomcat\nwill display debugging information to the requestor. It is recommended that\nsuch debug information be withheld from the requestor. Debugging information,\nsuch as that found in call stacks, often contains sensitive information that\nmay useful to an attacker. By preventing Tomcat from providing this\ninformation, the risk of leaking sensitive information to a potential attacker\nis reduced."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://tomcat.apache.org/tomcat-8.0doc/api/org/apache/tomcat/util/descriptor/web/ErrorPage.html",
        "severity": "medium",
        "cis_id": "2.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if Tomcat is configured\nto prevent sending debug\ninformation to the requestor Ensure an <error-page> element is defined in$\nCATALINA_HOME/conf/web.xml. Ensure the <error-page> element has an\n<exception-type> child element with a\nvalue of java.lang.Throwable. Ensure the <error-page> element has a <location>\nchild element.\nNote: Perform the above for each application hosted within Tomcat. Per\napplication\ninstances of web.xml can be found at\n$CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml\n",
        "fix": "Perform the following to prevent Tomcat from providing debug\ninformation to the\nrequestor during runtime errors: Create a web page that contains the logic or\nmessage you wish to invoke when\nencountering a runtime error. For example purposes, assume this page is located\nat\n/error.jsp. Add a child element, <error-page>, to the <web-app>element, in the\n\n$CATALINA_HOME/conf/web.xml file. Add a child element, <exception-type>, to the\n<error-page> element. Set the value of\nthe <exception-type> element to java.lang.Throwable.\n Add a child element, <location>, to the <error-page> element. Set the value of\nthe\n<location> element to the location of page created in #1.\nThe resulting entry will look as follows:\n<error-page>\n<exception-type>java.lang.Throwable</exception-type>\n<location>/error.jsp</location>\n</error-page>\n",
        "Default Value": "Tomcat’s default configuration does not include an\n<error-page> element in\n$CATALINA_HOME/conf/web.xml. Therefore, Tomcat will\nprovide debug information to\nthe requestor by default.\n"
      },
      "code": "control \"M-2.5\" do\n  title \"2.5 Disable client facing Stack Traces (Scored)\"\n  desc  \"When a runtime error occurs during request processing, Apache Tomcat\nwill display debugging information to the requestor. It is recommended that\nsuch debug information be withheld from the requestor. Debugging information,\nsuch as that found in call stacks, often contains sensitive information that\nmay useful to an attacker. By preventing Tomcat from providing this\ninformation, the risk of leaking sensitive information to a potential attacker\nis reduced. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://tomcat.apache.org/tomcat-8.0doc/api/org/apache/tomcat/util/descriptor/web/ErrorPage.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if Tomcat is configured\nto prevent sending debug\ninformation to the requestor Ensure an <error-page> element is defined in$\nCATALINA_HOME/conf/web.xml. Ensure the <error-page> element has an\n<exception-type> child element with a\nvalue of java.lang.Throwable. Ensure the <error-page> element has a <location>\nchild element.\nNote: Perform the above for each application hosted within Tomcat. Per\napplication\ninstances of web.xml can be found at\n$CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml\n\"\n  tag \"fix\": \"Perform the following to prevent Tomcat from providing debug\ninformation to the\nrequestor during runtime errors: Create a web page that contains the logic or\nmessage you wish to invoke when\nencountering a runtime error. For example purposes, assume this page is located\nat\n/error.jsp. Add a child element, <error-page>, to the <web-app>element, in the\n\n$CATALINA_HOME/conf/web.xml file. Add a child element, <exception-type>, to the\n<error-page> element. Set the value of\nthe <exception-type> element to java.lang.Throwable.\n Add a child element, <location>, to the <error-page> element. Set the value of\nthe\n<location> element to the location of page created in #1.\nThe resulting entry will look as follows:\n<error-page>\n<exception-type>java.lang.Throwable</exception-type>\n<location>/error.jsp</location>\n</error-page>\n\"\n  tag \"Default Value\": \"Tomcat’s default configuration does not include an\n<error-page> element in\\n$CATALINA_HOME/conf/web.xml. Therefore, Tomcat will\nprovide debug information to\\nthe requestor by default.\\n\"\n\n  # Query the main web.xml\n  web_conf = xml(\"#{TOMCAT_HOME}/conf/web.xml\")\n  errorIter = 1\n  if web_conf['web-app/error-page'].is_a?(Array)\n    numConnectors = web_conf['web-app/error-page'].count\n    until errorIter > numConnectors  do\n       describe web_conf[\"web-app/error-page[#{errorIter}]\"] do\n         it { should_not eq [] }\n       end\n       describe web_conf[\"web-app/error-page[#{errorIter}]/exception-type\"] do\n         it { should cmp \"java.lang.Throwable\"}\n       end\n       describe web_conf[\"web-app/error-page[#{errorIter}]/location\"] do\n         it { should_not eq [] }\n       end\n       errorIter +=1\n     end\n    if !web_conf['web-app/error-page'].any?\n     describe web_conf[\"web-app/error-page\"] do\n       it { should_not eq [] }\n     end\n   end\n  end\n\n  # Query the web.xml for each webapp\n  command(\"find #{TOMCAT_HOME}/webapps/ ! -path #{TOMCAT_HOME}/webapps/ -type d -maxdepth 1\").stdout.split.each do |webappname|\n    webapp_conf = xml(\"#{webappname}/WEB-INF/web.xml\")\n    webAppIter = 1\n    if webapp_conf['web-app/error-page'].is_a?(Array)\n      numConnectors = webapp_conf['web-app/error-page'].count\n      until webAppIter > numConnectors  do\n         describe webapp_conf[\"web-app/error-page[#{webAppIter}]\"] do\n           it { should_not eq [] }\n         end\n         describe webapp_conf[\"web-app/error-page[#{webAppIter}]/exception-type\"] do\n           it { should cmp \"java.lang.Throwable\"}\n         end\n         describe webapp_conf[\"web-app/error-page[#{webAppIter}]/location\"] do\n           it { should_not eq [] }\n         end\n         webAppIter +=1\n       end\n      if !webapp_conf['web-app/error-page'].any?\n       describe webapp_conf[\"web-app/error-page\"] do\n         it { should_not eq [] }\n       end\n     end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-2.5.rb",
        "line": 17
      },
      "id": "M-2.5"
    },
    {
      "title": "10.18 Setting Security Lifecycle Listener (Scored)",
      "desc": "The Security Lifecycle Listener performs a number of security checks\nwhen Tomcat starts and prevents Tomcat from starting if they fail. Enable the\nSecurity Lifecycle Listener can Enforce a blacklist of OS users that must not\nbe used to start Tomcat. set the least restrictive umask before Tomcat start",
      "descriptions": {
        "default": "The Security Lifecycle Listener performs a number of security checks\nwhen Tomcat starts and prevents Tomcat from starting if they fail. Enable the\nSecurity Lifecycle Listener can Enforce a blacklist of OS users that must not\nbe used to start Tomcat. set the least restrictive umask before Tomcat start"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://tomcat.apache.org/tomcat-8.0doc/config/listeners.html#Security_Lifecycle_Listener__org.apache.catalina.security.SecurityListener",
        "severity": "medium",
        "cis_id": "10.18",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Review server.xml to ensure the Security Lifecycle\nListener element is uncommented and\ncheckedOsUsers, minimumUmask attributes are set with expected value.\n",
        "fix": "To enable it uncomment the listener in\n$CATALINA_BASE/conf/server.xml. If the operating\nsystem supports umask then the line in $CATALINA_HOME/bin/catalina.sh that\nobtains the\numask also needs to be uncommented.\nWithin Server elements add:\ncheckedOsUsers: A comma separated list of OS users that must not be used to\nstart\nTomcat. If not specified, the default value of root is used.\nminimumUmask: The least restrictive umask that must be configured before Tomcat\n\nwill start. If not specified, the default value of 0007 is used.\n<Listener className='org.apache.catalina.security.SecurityListener'\ncheckedOsUsers='alex,bob' minimumUmask='0007' />\n",
        "Default Value": "The Security Lifecycle Listener is not enabled by\ndefault. For checkedOsUsers, If not\nspecified, the default value of root is\nused. For minimumUmask, if not specified, the default\nvalue of 0007 is\nused.\n\n"
      },
      "code": "control \"M-10.18\" do\n  title \"10.18 Setting Security Lifecycle Listener (Scored)\"\n  desc  \"The Security Lifecycle Listener performs a number of security checks\nwhen Tomcat starts and prevents Tomcat from starting if they fail. Enable the\nSecurity Lifecycle Listener can Enforce a blacklist of OS users that must not\nbe used to start Tomcat. set the least restrictive umask before Tomcat start \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://tomcat.apache.org/tomcat-8.0doc/config/listeners.html#Security_Lifecycle_Listener__org.apache.catalina.security.SecurityListener\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.18\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Review server.xml to ensure the Security Lifecycle\nListener element is uncommented and\ncheckedOsUsers, minimumUmask attributes are set with expected value.\n\"\n  tag \"fix\": \"To enable it uncomment the listener in\n$CATALINA_BASE/conf/server.xml. If the operating\nsystem supports umask then the line in $CATALINA_HOME/bin/catalina.sh that\nobtains the\numask also needs to be uncommented.\nWithin Server elements add:\ncheckedOsUsers: A comma separated list of OS users that must not be used to\nstart\nTomcat. If not specified, the default value of root is used.\nminimumUmask: The least restrictive umask that must be configured before Tomcat\n\nwill start. If not specified, the default value of 0007 is used.\n<Listener className='org.apache.catalina.security.SecurityListener'\ncheckedOsUsers='alex,bob' minimumUmask='0007' />\n\"\n  tag \"Default Value\": \"The Security Lifecycle Listener is not enabled by\ndefault. For checkedOsUsers, If not\\nspecified, the default value of root is\nused. For minimumUmask, if not specified, the default\\nvalue of 0007 is\nused.\\n\\n\"\n\n  begin\n    describe xml(TOMCAT_CONF_SERVER) do\n      its('Server/Listener/attribute::className') { should include 'org.apache.catalina.security.SecurityListener' }\n      its('Server/Listener/attribute::checkedOsUsers') { should include 'root' }\n      its('Server/Listener/attribute::minimumUmask') { should cmp '0007' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.18.rb",
        "line": 17
      },
      "id": "M-10.18"
    },
    {
      "title": "10.8 Do not allow additional path delimiters (Scored)",
      "desc": "Being able to specify different path-delimiters on Tomcat creates the\npossibility that an attacker can access applications that were previously\nblocked a proxy like mod_proxy Allowing additional path-delimiters allows for\nan attacker to get an application or area that was not previously visible.",
      "descriptions": {
        "default": "Being able to specify different path-delimiters on Tomcat creates the\npossibility that an attacker can access applications that were previously\nblocked a proxy like mod_proxy Allowing additional path-delimiters allows for\nan attacker to get an application or area that was not previously visible."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/systemprops.html",
        "severity": "medium",
        "cis_id": "10.8",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Ensure the above parameters are added to the startup\nscript which by default is located at\n$CATALINA_HOME/bin/catalina.sh.\n",
        "fix": "Start Tomcat with ALLOW_BACKSLASH set to false and\nALLOW_ENCODED_SLASH set to\nfalse. Add the following to your startup script.\n-Dorg.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH=false\n-Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=false\n",
        "Default Value": "By default, allowing additional parameters is set to\nfalse.\n"
      },
      "code": "control \"M-10.8\" do\n  title \"10.8 Do not allow additional path delimiters (Scored)\"\n  desc  \"Being able to specify different path-delimiters on Tomcat creates the\npossibility that an attacker can access applications that were previously\nblocked a proxy like mod_proxy Allowing additional path-delimiters allows for\nan attacker to get an application or area that was not previously visible. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://tomcat.apache.org/tomcat-8.0-doc/config/systemprops.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.8\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Ensure the above parameters are added to the startup\nscript which by default is located at\n$CATALINA_HOME/bin/catalina.sh.\n\"\n  tag \"fix\": \"Start Tomcat with ALLOW_BACKSLASH set to false and\nALLOW_ENCODED_SLASH set to\nfalse. Add the following to your startup script.\n-Dorg.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH=false\n-Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=false\n\"\n  tag \"Default Value\": \"By default, allowing additional parameters is set to\nfalse.\\n\"\n\n  begin\n    describe parse_config_file('/usr/share/tomcat/conf/catalina.properties') do\n      its('ALLOW_BACKSLASH') { should eq 'false' }\n    end\n\n    describe parse_config_file('/usr/share/tomcat/conf/catalina.properties') do\n      its('ALLOW_ENCODED_SLASH') { should eq 'false' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.8.rb",
        "line": 29
      },
      "id": "M-10.8"
    },
    {
      "title": "10.11 Configure maxHttpHeaderSize (Scored)",
      "desc": "The maxHttpHeaderSize limits the size of the request and response\nheaders defined in bytes. If not specified, the default is 8192 bytes. Limiting\nthe size of the header request can help protect against Denial of Service\nrequests.",
      "descriptions": {
        "default": "The maxHttpHeaderSize limits the size of the request and response\nheaders defined in bytes. If not specified, the default is 8192 bytes. Limiting\nthe size of the header request can help protect against Denial of Service\nrequests."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://tomcat.apache.org/tomcat-8.0-doc/config/http.html",
        "severity": "medium",
        "cis_id": "10.11",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Locate each maxHttpHeaderSize setting in\n$CATALINA_HOME/conf/server.xml and verify\nthat they are set to 8192.\n# grep maxHttpHeaderSize $CATALINA_HOME/conf/server.xml\n",
        "fix": "Within $CATALINA_HOME/conf/server.xml ensure each connector is\nconfigured to the\nappropriate maxHttpHeaderSize setting.\nmaxHttpHeaderSize=”8192”\n",
        "Default Value": "maxHttpHeaderSize is set to 8192\n"
      },
      "code": "control \"M-10.11\" do\n  title \"10.11 Configure maxHttpHeaderSize (Scored)\"\n  desc  \"The maxHttpHeaderSize limits the size of the request and response\nheaders defined in bytes. If not specified, the default is 8192 bytes. Limiting\nthe size of the header request can help protect against Denial of Service\nrequests. \"\n  impact 0.5\n  tag \"ref\": \"1. http://tomcat.apache.org/tomcat-8.0-doc/config/http.html\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.11\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Locate each maxHttpHeaderSize setting in\n$CATALINA_HOME/conf/server.xml and verify\nthat they are set to 8192.\n# grep maxHttpHeaderSize $CATALINA_HOME/conf/server.xml\n\"\n  tag \"fix\": \"Within $CATALINA_HOME/conf/server.xml ensure each connector is\nconfigured to the\nappropriate maxHttpHeaderSize setting.\nmaxHttpHeaderSize=”8192”\n\"\n  tag \"Default Value\": \"maxHttpHeaderSize is set to 8192\\n\"\n\n  begin\n    tomcat_conf = xml(TOMCAT_CONF_SERVER)\n\n      if tomcat_conf['Server/Service/Connector/attribute::maxHttpHeaderSize'].is_a?(Array)\n        tomcat_conf['Server/Service/Connector/attribute::maxHttpHeaderSize'].each do |x|\n          describe x do\n            it { should eq \"8192\" }\n          end\n        end\n      else\n        describe xml(tomcat_conf['Server/Service/Connector/attribute::maxHttpHeaderSize']) do\n          it { should eq \"8192\" }\n        end\n      end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.11.rb",
        "line": 29
      },
      "id": "M-10.11"
    },
    {
      "title": "4.13 Restrict access to Tomcat tomcat-users.xml (Scored)",
      "desc": "tomcat-users.xml contains authentication information for Tomcat\napplications. It is recommended that access to this file has the proper\npermissions to properly protect from unauthorized changes. Restricting access\nto this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy.",
      "descriptions": {
        "default": "tomcat-users.xml contains authentication information for Tomcat\napplications. It is recommended that access to this file has the proper\npermissions to properly protect from unauthorized changes. Restricting access\nto this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.13",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/tomcat-users.xml care securely configured. Change to the\nlocation of the $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf/\n# find tomcat-users.xml -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user\ntomcat_admin -o ! -group tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to tomcat-users.xml: Set\nthe ownership of the $CATALINA_HOME/conf/tomcat-users.xml to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/tomcat-users.xml\n# chmod g-w,o-rwx $CATALINA_HOME/conf/tomcat-users.xml\n\n",
        "Default Value": "The default permissions of the top-level directories is\n600."
      },
      "code": "control \"M-4.13\" do\n  title \"4.13 Restrict access to Tomcat tomcat-users.xml (Scored)\"\n  desc  \"tomcat-users.xml contains authentication information for Tomcat\napplications. It is recommended that access to this file has the proper\npermissions to properly protect from unauthorized changes. Restricting access\nto this file will prevent local users from maliciously or inadvertently\naltering Tomcat’s security policy. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.13\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/tomcat-users.xml care securely configured. Change to the\nlocation of the $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf/\n# find tomcat-users.xml -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user\ntomcat_admin -o ! -group tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to tomcat-users.xml: Set\nthe ownership of the $CATALINA_HOME/conf/tomcat-users.xml to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/tomcat-users.xml\n# chmod g-w,o-rwx $CATALINA_HOME/conf/tomcat-users.xml\n\n\"\n  tag \"Default Value\": \"The default permissions of the top-level directories is\n600.\"\n\n  describe file(\"#{TOMCAT_HOME}/conf/tomcat-users.xml\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.13.rb",
        "line": 29
      },
      "id": "M-4.13"
    },
    {
      "title": "4.10 Restrict access to Tomcat context.xml (Scored)",
      "desc": "The context.xml file is loaded by all web applications and sets\ncertain configuration options. It is recommended that access to this file has\nthe proper permissions to properly protect from unauthorized changes.\nRestricting access to this file will prevent local users from maliciously or\ninadvertently altering Tomcat’s security policy.",
      "descriptions": {
        "default": "The context.xml file is loaded by all web applications and sets\ncertain configuration options. It is recommended that access to this file has\nthe proper permissions to properly protect from unauthorized changes.\nRestricting access to this file will prevent local users from maliciously or\ninadvertently altering Tomcat’s security policy."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.10",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/context.xml care securely configured. Change to the\nlocation of the $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf\n# find context.xml -follow -maxdepth 0 \\( -perm /o+rwx,g=w -o ! -user\ntomcat_admin -o ! -group tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to context.xml: Set the\nownership of the $CATALINA_HOME/conf/context.xml to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/context.xml\n# chmod g-w,o-rwx $CATALINA_HOME/conf/context.xml\n\n",
        "Default Value": "The default permissions of context.xml are 600."
      },
      "code": "control \"M-4.10\" do\n  title \"4.10 Restrict access to Tomcat context.xml (Scored)\"\n  desc  \"The context.xml file is loaded by all web applications and sets\ncertain configuration options. It is recommended that access to this file has\nthe proper permissions to properly protect from unauthorized changes.\nRestricting access to this file will prevent local users from maliciously or\ninadvertently altering Tomcat’s security policy. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.10\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/conf/context.xml care securely configured. Change to the\nlocation of the $CATALINA_HOME/conf and execute the following:\n# cd $CATALINA_HOME/conf\n# find context.xml -follow -maxdepth 0 \\\\( -perm /o+rwx,g=w -o ! -user\ntomcat_admin -o ! -group tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to context.xml: Set the\nownership of the $CATALINA_HOME/conf/context.xml to\ntomcat_admin:tomcat. Remove read, write, and execute permissions for the world.\nRemove write permissions for the group.\n# chown tomcat_admin:tomcat $CATALINA_HOME/conf/context.xml\n# chmod g-w,o-rwx $CATALINA_HOME/conf/context.xml\n\n\"\n  tag \"Default Value\": \"The default permissions of context.xml are 600.\"\n\n  describe file(\"#{TOMCAT_HOME}/conf/context.xml\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.10.rb",
        "line": 29
      },
      "id": "M-4.10"
    },
    {
      "title": "4.5 Restrict access to Tomcat temp directory (Scored)",
      "desc": "The Tomcat $CATALINA_HOME/temp/ directory is used by Tomcat to persist\ntemporary information to disk. It is recommended that the ownership of this\ndirectory be tomcat_admin:tomcat. It is also recommended that the permissions\non this directory prevent read, write, and execute for the world (o-rwx).\nRestricting access to these directories will prevent local users from\nmaliciously or inadvertently affecting the integrity of Tomcat processes.",
      "descriptions": {
        "default": "The Tomcat $CATALINA_HOME/temp/ directory is used by Tomcat to persist\ntemporary information to disk. It is recommended that the ownership of this\ndirectory be tomcat_admin:tomcat. It is also recommended that the permissions\non this directory prevent read, write, and execute for the world (o-rwx).\nRestricting access to these directories will prevent local users from\nmaliciously or inadvertently affecting the integrity of Tomcat processes."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/temp are securely configured. Change to the location of the\n$CATALINA_HOME/temp and execute the following:\n# cd $CATALINA_HOME\n# find temp -follow -maxdepth 0 \\( -perm /o+rwx -o ! -user tomcat_admin -o !\ngroup tomcat \\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n",
        "fix": "Perform the following to restrict access to Tomcat temp\ndirectory: Set the ownership of the $CATALINA_HOME/temp to tomcat_admin:tomcat.\nRemove read, write, and execute permissions for the world\n# chown tomcat_admin:tomcat $CATALINA_HOME/temp\n# chmod o-rwx $CATALINA_HOME/temp\n",
        "Default Value": "The default permissions of the top-level directories is\n770."
      },
      "code": "control \"M-4.5\" do\n  title \"4.5 Restrict access to Tomcat temp directory (Scored)\"\n  desc  \"The Tomcat $CATALINA_HOME/temp/ directory is used by Tomcat to persist\ntemporary information to disk. It is recommended that the ownership of this\ndirectory be tomcat_admin:tomcat. It is also recommended that the permissions\non this directory prevent read, write, and execute for the world (o-rwx).\nRestricting access to these directories will prevent local users from\nmaliciously or inadvertently affecting the integrity of Tomcat processes. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the ownership and\npermissions on\n$CATALINA_HOME/temp are securely configured. Change to the location of the\n$CATALINA_HOME/temp and execute the following:\n# cd $CATALINA_HOME\n# find temp -follow -maxdepth 0 \\\\( -perm /o+rwx -o ! -user tomcat_admin -o !\ngroup tomcat \\\\) -ls\nNote: If the ownership and permission are set correctly, no output should be\ndisplayed when executing the above command.\n\"\n  tag \"fix\": \"Perform the following to restrict access to Tomcat temp\ndirectory: Set the ownership of the $CATALINA_HOME/temp to tomcat_admin:tomcat.\nRemove read, write, and execute permissions for the world\n# chown tomcat_admin:tomcat $CATALINA_HOME/temp\n# chmod o-rwx $CATALINA_HOME/temp\n\"\n  tag \"Default Value\": \"The default permissions of the top-level directories is\n770.\"\n\n  describe directory(\"#{TOMCAT_HOME}/temp\") do\n    its('owner') { should eq \"#{TOMCAT_OWNER}\" }\n    its('group') { should eq \"#{TOMCAT_GROUP}\" }\n    its('mode') { should cmp '0770' }\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-4.5.rb",
        "line": 29
      },
      "id": "M-4.5"
    },
    {
      "title": "10.19 use the logEffectiveWebXml and metadata-complete settings for\ndeploying applications in production (Scored)",
      "desc": "Both Fragments and annotations give rise to security concerns. web.xml\ncontains a metadata-complete attribute in the web-app element whose binary\nvalue defines whether other sources of metadata should be considered when\ndeploying this web application, this includes annotations on class files\n(@WebServlet, but also @WebListener, @WebFilter, …), web-fragment.xml as well\nas classes located in WEB-INF/classes. In addition, Tomcat 7 could allow you to\nlog the effective web.xml, when an application starts, and the effective\nweb.xml is the result of taking the main web.xml for your application merging\nin all the fragments applying all the annotations. By logging that you are able\nto review it, and see if that is in fact what you actually want. Enable\n'logEffectiveWebXml' will allow you to log the effective web.xml and you are\nable to see if that is in fact what you actually want. Enable\n'metadata-complete' so that the web.xml is the only metadata considered.",
      "descriptions": {
        "default": "Both Fragments and annotations give rise to security concerns. web.xml\ncontains a metadata-complete attribute in the web-app element whose binary\nvalue defines whether other sources of metadata should be considered when\ndeploying this web application, this includes annotations on class files\n(@WebServlet, but also @WebListener, @WebFilter, …), web-fragment.xml as well\nas classes located in WEB-INF/classes. In addition, Tomcat 7 could allow you to\nlog the effective web.xml, when an application starts, and the effective\nweb.xml is the result of taking the main web.xml for your application merging\nin all the fragments applying all the annotations. By logging that you are able\nto review it, and see if that is in fact what you actually want. Enable\n'logEffectiveWebXml' will allow you to log the effective web.xml and you are\nable to see if that is in fact what you actually want. Enable\n'metadata-complete' so that the web.xml is the only metadata considered."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://tomcat.apache.org/tomcat-8.0-doc/config/context.html\n2.\nhttps://alexismp.wordpress.com/2010/07/28/servlet-3-0-fragments-and-webxml-to-rule-them-all/\n Appendix: Summary Table ",
        "severity": "medium",
        "cis_id": "10.19",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "1. Review each application’s web.xml file located in the\napplications\n$CATALINA_BASE\\<app name>\\WEB-INF\\web.xml and determine if the\nmetadatacomplete property is set.\n<web-app\n...\nmetadata-complete='true'\n...\n> Review each application’s context.xml file located in the applications\n$CATALINA_BASE\\<app name>\\META-INF\\context.xml and determine if the\nmetadata-complete property is set.\n<Context\n...\nlogEffectiveWebXml='true'\n...\n>\n\n",
        "fix": "Set the metadata-complete value in the web.xml in each of\napplications to true,\nthe web.xml contains a metadata-complete attribute in the web-app element whose\n\nbinary value defines whether other sources of metadata should be considered\nwhen\ndeploying this web application, this includes annotations on class files\n(@WebServlet, but also @WebListener, @WebFilter, ...), web-fragment.xml as well\n\nas classes located in WEB-INF/classes. If set to true, all of these will be\nignored\nand web.xml is the only metadata considered.\nNOTE: 'The metadata-complete option is not enough to disable all of annotation\n\nscanning. If there is a ServletContainerInitializer with a @HandlesTypes\nannotation,\nTomcat has to scan your application for classes that use annotations or\ninterfaces\nspecified in that annotation.\nSet the logEffectiveWebXml value in the context.xml in each of applications to\ntrue\n",
        "Default Value": "If logEffectiveWebXml not specified, the default value\nof false is used; If metadatacomplete not specified, the default value of false\nis used\n"
      },
      "code": "control \"M-10.19\" do\n  title \"10.19 use the logEffectiveWebXml and metadata-complete settings for\ndeploying applications in production (Scored)\"\n  desc  \"Both Fragments and annotations give rise to security concerns. web.xml\ncontains a metadata-complete attribute in the web-app element whose binary\nvalue defines whether other sources of metadata should be considered when\ndeploying this web application, this includes annotations on class files\n(@WebServlet, but also @WebListener, @WebFilter, …), web-fragment.xml as well\nas classes located in WEB-INF/classes. In addition, Tomcat 7 could allow you to\nlog the effective web.xml, when an application starts, and the effective\nweb.xml is the result of taking the main web.xml for your application merging\nin all the fragments applying all the annotations. By logging that you are able\nto review it, and see if that is in fact what you actually want. Enable\n'logEffectiveWebXml' will allow you to log the effective web.xml and you are\nable to see if that is in fact what you actually want. Enable\n'metadata-complete' so that the web.xml is the only metadata considered. \"\n  impact 0.5\n  tag \"ref\": \"1. https://tomcat.apache.org/tomcat-8.0-doc/config/context.html\n2.\nhttps://alexismp.wordpress.com/2010/07/28/servlet-3-0-fragments-and-webxml-to-rule-them-all/\n Appendix: Summary Table \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.19\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"1. Review each application’s web.xml file located in the\napplications\n$CATALINA_BASE\\\\<app name>\\\\WEB-INF\\\\web.xml and determine if the\nmetadatacomplete property is set.\n<web-app\n...\nmetadata-complete='true'\n...\n> Review each application’s context.xml file located in the applications\n$CATALINA_BASE\\\\<app name>\\\\META-INF\\\\context.xml and determine if the\nmetadata-complete property is set.\n<Context\n...\nlogEffectiveWebXml='true'\n...\n>\n\n\"\n  tag \"fix\": \"Set the metadata-complete value in the web.xml in each of\napplications to true,\nthe web.xml contains a metadata-complete attribute in the web-app element whose\n\nbinary value defines whether other sources of metadata should be considered\nwhen\ndeploying this web application, this includes annotations on class files\n(@WebServlet, but also @WebListener, @WebFilter, ...), web-fragment.xml as well\n\nas classes located in WEB-INF/classes. If set to true, all of these will be\nignored\nand web.xml is the only metadata considered.\nNOTE: 'The metadata-complete option is not enough to disable all of annotation\n\nscanning. If there is a ServletContainerInitializer with a @HandlesTypes\nannotation,\nTomcat has to scan your application for classes that use annotations or\ninterfaces\nspecified in that annotation.\nSet the logEffectiveWebXml value in the context.xml in each of applications to\ntrue\n\"\n  tag \"Default Value\": \"If logEffectiveWebXml not specified, the default value\nof false is used; If metadatacomplete not specified, the default value of false\nis used\\n\"\n\n  begin\n\n  web_xml = command(\"ls #{TOMCAT_APP_DIR}/webapps/*/WEB-INF/web.xml\").stdout.split.each do |web_file|\n    describe xml(web_file) do\n      its('web-app/attribute::metadata-complete') { should eq ['true'] }\n    end\n  context_xml = command(\"ls #{TOMCAT_APP_DIR}/webapps/*/META-INF/context.xml\").stdout.split.each do |web_file|\n    describe xml(web_file) do\n      its('web-app/attribute::logEffectiveWebXml') { should eq ['true'] }\n    end\n  end\n  end\nend\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.19.rb",
        "line": 17
      },
      "id": "M-10.19"
    },
    {
      "title": "10.4 Force SSL when accessing the manager application (Scored)",
      "desc": "Use the transport-guarantee attribute to ensure SSL protection when\naccessing the manager application. By default when accessing the manager\napplication, login information is sent over the wire in plain text. By using\nthe transport-guarantee attribute within web.xml, SSL is enforced. NOTE: This\nrequires SSL to be configured.",
      "descriptions": {
        "default": "Use the transport-guarantee attribute to ensure SSL protection when\naccessing the manager application. By default when accessing the manager\napplication, login information is sent over the wire in plain text. By using\nthe transport-guarantee attribute within web.xml, SSL is enforced. NOTE: This\nrequires SSL to be configured."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. https://www.owasp.org/index.php/Securing_tomcat",
        "severity": "medium",
        "cis_id": "10.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Ensure $CATALINA_HOME/webapps/manager/WEB-INF/web.xml has\nthe <transportguarantee> attribute set to CONFIDENTIAL.\n# grep transport-guarantee $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n",
        "fix": "Set $CATALINA_HOME/webapps/manager/WEB-INF/web.xml:\n<security-constraint>\n<user-data-constraint>\n<transport-guarantee>CONFIDENTIAL</transport-guarantee>\n<user-data-constraint>\n</security-constraint>\n",
        "Default Value": "By default, this configuration is not present.\n"
      },
      "code": "control \"M-10.4\" do\n  title \"10.4 Force SSL when accessing the manager application (Scored)\"\n  desc  \"Use the transport-guarantee attribute to ensure SSL protection when\naccessing the manager application. By default when accessing the manager\napplication, login information is sent over the wire in plain text. By using\nthe transport-guarantee attribute within web.xml, SSL is enforced. NOTE: This\nrequires SSL to be configured. \"\n  impact 0.5\n  tag \"ref\": \"1. https://www.owasp.org/index.php/Securing_tomcat\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"10.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Ensure $CATALINA_HOME/webapps/manager/WEB-INF/web.xml has\nthe <transportguarantee> attribute set to CONFIDENTIAL.\n# grep transport-guarantee $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n\"\n  tag \"fix\": \"Set $CATALINA_HOME/webapps/manager/WEB-INF/web.xml:\n<security-constraint>\n<user-data-constraint>\n<transport-guarantee>CONFIDENTIAL</transport-guarantee>\n<user-data-constraint>\n</security-constraint>\n\"\n  tag \"Default Value\": \"By default, this configuration is not present.\\n\"\n\n  begin\n    describe xml('/usr/share/tomcat/webapps/manager/WEB-INF/web.xml') do\n      its('web-app/security-constraint/user-data-constraint/transport-guarantee') { should eq ['CONFIDENTIAL'] }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./DRAFT: Tomcat 8 CIS/controls/M-10.4.rb",
        "line": 35
      },
      "id": "M-10.4"
    }
  ],
  "groups": [
    {
      "title": null,
      "controls": [
        "M-2.1"
      ],
      "id": "controls/M-2.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.16"
      ],
      "id": "controls/M-10.16.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.2"
      ],
      "id": "controls/M-4.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.3"
      ],
      "id": "controls/M-4.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.2"
      ],
      "id": "controls/M-10.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.1"
      ],
      "id": "controls/M-6.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.4"
      ],
      "id": "controls/M-6.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.1"
      ],
      "id": "controls/M-3.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-2.6"
      ],
      "id": "controls/M-2.6.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.1"
      ],
      "id": "controls/M-7.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-9.2"
      ],
      "id": "controls/M-9.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.12"
      ],
      "id": "controls/M-10.12.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.2"
      ],
      "id": "controls/M-3.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.7"
      ],
      "id": "controls/M-7.7.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.4"
      ],
      "id": "controls/M-7.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.7"
      ],
      "id": "controls/M-10.7.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.5"
      ],
      "id": "controls/M-10.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.7"
      ],
      "id": "controls/M-4.7.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.1"
      ],
      "id": "controls/M-10.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.4"
      ],
      "id": "controls/M-4.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-1.2"
      ],
      "id": "controls/M-1.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.8"
      ],
      "id": "controls/M-4.8.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.3"
      ],
      "id": "controls/M-10.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.2"
      ],
      "id": "controls/M-7.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-2.3"
      ],
      "id": "controls/M-2.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.3"
      ],
      "id": "controls/M-7.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.2"
      ],
      "id": "controls/M-6.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-9.1"
      ],
      "id": "controls/M-9.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.11"
      ],
      "id": "controls/M-4.11.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.1"
      ],
      "id": "controls/M-4.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-2.2"
      ],
      "id": "controls/M-2.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.6"
      ],
      "id": "controls/M-7.6.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.10"
      ],
      "id": "controls/M-10.10.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.6"
      ],
      "id": "controls/M-4.6.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.14"
      ],
      "id": "controls/M-4.14.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.1"
      ],
      "id": "controls/M-5.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.13"
      ],
      "id": "controls/M-10.13.rb"
    },
    {
      "title": null,
      "controls": [
        "M-2.4"
      ],
      "id": "controls/M-2.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.9"
      ],
      "id": "controls/M-4.9.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.2"
      ],
      "id": "controls/M-5.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-1.1"
      ],
      "id": "controls/M-1.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.5"
      ],
      "id": "controls/M-7.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-9.3"
      ],
      "id": "controls/M-9.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.3"
      ],
      "id": "controls/M-6.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.9"
      ],
      "id": "controls/M-10.9.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.5"
      ],
      "id": "controls/M-6.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.17"
      ],
      "id": "controls/M-10.17.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.12"
      ],
      "id": "controls/M-4.12.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.14"
      ],
      "id": "controls/M-10.14.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.15"
      ],
      "id": "controls/M-10.15.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.6"
      ],
      "id": "controls/M-10.6.rb"
    },
    {
      "title": null,
      "controls": [
        "M-8.1"
      ],
      "id": "controls/M-8.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-2.5"
      ],
      "id": "controls/M-2.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.18"
      ],
      "id": "controls/M-10.18.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.8"
      ],
      "id": "controls/M-10.8.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.11"
      ],
      "id": "controls/M-10.11.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.13"
      ],
      "id": "controls/M-4.13.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.10"
      ],
      "id": "controls/M-4.10.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.5"
      ],
      "id": "controls/M-4.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.19"
      ],
      "id": "controls/M-10.19.rb"
    },
    {
      "title": null,
      "controls": [
        "M-10.4"
      ],
      "id": "controls/M-10.4.rb"
    }
  ],
  "inputs": [],
  "sha256": "e8078e9783dc2d187614099c6dc3fe55dc037bd4bd45f6b19fc21378ecc1fd92",
  "status_message": "",
  "status": "loaded",
  "generator": {
    "name": "inspec",
    "version": "4.23.15"
  }
}