{
  "name": "apache_server_baseline",
  "title": "APACHE SERVER 2.2 for Unix Baseline",
  "maintainer": "MITRE InSpec Team",
  "copyright": "MITRE InSpec Team",
  "copyright_email": "inspec@mitre.org",
  "license": "Apache-2.0",
  "summary": "InSpec testing for baseline compliance with Apache server 2.2 STIG",
  "description": "An InSpec profile verifying compliance with Apacher server 2.2 STIG https://iasecontent.disa.mil/stigs/zip/U_Apache_2-2_UNIX_V1R10_STIG.zip\n",
  "version": "0.1.0",
  "inspec_version": ">= 4.0",
  "supports": [],
  "controls": [
    {
      "title": "The web server must be configured to explicitly deny access to the OS\nroot.",
      "desc": "The Apache Directory directive allows for directory specific\nconfiguration of access controls and many other features and options. One\nimportant usage is to create a default deny policy that does not allow access\nto Operating System directories and files, except for those specifically\nallowed. This is done, with denying access to the OS root directory. One aspect\nof Apache, which is occasionally misunderstood, is the feature of default\naccess. That is, unless you take steps to change it, if the server can find its\nway to a file through normal URL mapping rules, it can and will serve it to\nclients. Having a default deny is a predominate security principal, and then\nhelps prevent the unintended access, and we do that in this case by denying\naccess to the OS root directory. The Order directive is important as it\nprovides for other Allow directives to override the default deny.",
      "descriptions": {
        "default": "The Apache Directory directive allows for directory specific\nconfiguration of access controls and many other features and options. One\nimportant usage is to create a default deny policy that does not allow access\nto Operating System directories and files, except for those specifically\nallowed. This is done, with denying access to the OS root directory. One aspect\nof Apache, which is occasionally misunderstood, is the feature of default\naccess. That is, unless you take steps to change it, if the server can find its\nway to a file through normal URL mapping rules, it can and will serve it to\nclients. Having a default deny is a predominate security principal, and then\nhelps prevent the unintended access, and we do that in this case by denying\naccess to the OS root directory. The Order directive is important as it\nprovides for other Allow directives to override the default deny."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00540",
        "gid": "V-26323",
        "rid": "SV-33226r1_rule",
        "stig_id": "WA00540 A22",
        "fix_id": "F-29418r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\nmore /usr/local/Apache2.2/conf/httpd.conf.\n\nReview the httpd.conf file and search for the following  directive:\n\nDirectory\n\nFor every root directory entry (i.e. <Directory />) ensure the following\nexists; if not, this is a finding.\n\nOrder deny,allow\nDeny from all\n\nIf the statement above is not found in the root directory statement, this is a\nfinding.\n\nIf Allow directives are included in the root directory statement, this is a\nfinding.  ",
        "fix": "Edit the httpd.conf file and set the root directory directive as\nfollows:\n\nDirectory\nOrder deny,allow\nDeny from all"
      },
      "code": "control \"V-26323\" do\n  title \"The web server must be configured to explicitly deny access to the OS\nroot.\"\n  desc  \"The Apache Directory directive allows for directory specific\nconfiguration of access controls and many other features and options. One\nimportant usage is to create a default deny policy that does not allow access\nto Operating System directories and files, except for those specifically\nallowed. This is done, with denying access to the OS root directory. One aspect\nof Apache, which is occasionally misunderstood, is the feature of default\naccess. That is, unless you take steps to change it, if the server can find its\nway to a file through normal URL mapping rules, it can and will serve it to\nclients. Having a default deny is a predominate security principal, and then\nhelps prevent the unintended access, and we do that in this case by denying\naccess to the OS root directory. The Order directive is important as it\nprovides for other Allow directives to override the default deny.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00540\"\n  tag \"gid\": \"V-26323\"\n  tag \"rid\": \"SV-33226r1_rule\"\n  tag \"stig_id\": \"WA00540 A22\"\n  tag \"fix_id\": \"F-29418r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\nmore /usr/local/Apache2.2/conf/httpd.conf.\n\nReview the httpd.conf file and search for the following  directive:\n\nDirectory\n\nFor every root directory entry (i.e. <Directory />) ensure the following\nexists; if not, this is a finding.\n\nOrder deny,allow\nDeny from all\n\nIf the statement above is not found in the root directory statement, this is a\nfinding.\n\nIf Allow directives are included in the root directory statement, this is a\nfinding.  \"\n  tag \"fix\": \"Edit the httpd.conf file and set the root directory directive as\nfollows:\n\nDirectory\nOrder deny,allow\nDeny from all\"\n\n  describe command(\"awk '/<Directory \\\\/>/,/<\\\\/Directory>/' /etc/httpd/conf/httpd.conf\") do\n    its('stdout') { should match /Order\\s+deny,allow$/ }\n    its('stdout') { should match /Deny\\s+from\\s+all$/ }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26323.rb",
        "line": 1
      },
      "id": "V-26323"
    },
    {
      "title": "The HTTP request line must be limited.",
      "desc": "Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. This Apache directives limits the size of the various HTTP header\nsizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestLine directive allows the server administrator to reduce or\nincrease the limit on the allowed size of a client's HTTP request-line. Since\nthe request-line consists of the HTTP method, URI, and protocol version, the\nLimitRequestLine directive places a restriction on the length of a request-URI\nallowed for a request on the server. A server needs this value to be large\nenough to hold any of its resource names, including any information that might\nbe passed in the query part of a GET request.\n\n    This directive gives the server administrator greater control over abnormal\nclient request behavior, which may be useful for avoiding some forms of\ndenial-of-service attacks.",
      "descriptions": {
        "default": "Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. This Apache directives limits the size of the various HTTP header\nsizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestLine directive allows the server administrator to reduce or\nincrease the limit on the allowed size of a client's HTTP request-line. Since\nthe request-line consists of the HTTP method, URI, and protocol version, the\nLimitRequestLine directive places a restriction on the length of a request-URI\nallowed for a request on the server. A server needs this value to be large\nenough to hold any of its resource names, including any information that might\nbe passed in the query part of a GET request.\n\n    This directive gives the server administrator greater control over abnormal\nclient request behavior, which may be useful for avoiding some forms of\ndenial-of-service attacks."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA066",
        "gid": "V-13739",
        "rid": "SV-32768r2_rule",
        "stig_id": "WA000-WWA066 A22",
        "fix_id": "F-29258r2_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the LimitRequestLine value enter the following command:\n\ngrep \"LimitRequestLine\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value of LimitRequestLine is not set to 8190, this is a finding.\nIf no LimitRequestLine directives exist, this is a Finding. Although the\ndefault value is 8190, this directive must be explicitly set.",
        "fix": "Edit the httpd.conf file and set the LimitRequestLine to 8190 or\nother approved value. If no LimitRequestLine directives exist, explicitly add\nthe directive and set to 8190."
      },
      "code": "control \"V-13739\" do\n  title \"The HTTP request line must be limited.\"\n  desc  \"Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. This Apache directives limits the size of the various HTTP header\nsizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestLine directive allows the server administrator to reduce or\nincrease the limit on the allowed size of a client's HTTP request-line. Since\nthe request-line consists of the HTTP method, URI, and protocol version, the\nLimitRequestLine directive places a restriction on the length of a request-URI\nallowed for a request on the server. A server needs this value to be large\nenough to hold any of its resource names, including any information that might\nbe passed in the query part of a GET request.\n\n    This directive gives the server administrator greater control over abnormal\nclient request behavior, which may be useful for avoiding some forms of\ndenial-of-service attacks.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA066\"\n  tag \"gid\": \"V-13739\"\n  tag \"rid\": \"SV-32768r2_rule\"\n  tag \"stig_id\": \"WA000-WWA066 A22\"\n  tag \"fix_id\": \"F-29258r2_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the LimitRequestLine value enter the following command:\n\ngrep \\\"LimitRequestLine\\\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value of LimitRequestLine is not set to 8190, this is a finding.\nIf no LimitRequestLine directives exist, this is a Finding. Although the\ndefault value is 8190, this directive must be explicitly set.\"\n  tag \"fix\": \"Edit the httpd.conf file and set the LimitRequestLine to 8190 or\nother approved value. If no LimitRequestLine directives exist, explicitly add\nthe directive and set to 8190.\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('LimitRequestLine') { should cmp 8190 }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13739.rb",
        "line": 7
      },
      "id": "V-13739"
    },
    {
      "title": "The HTTP request message body size must be limited.",
      "desc": "Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. The Apache directives listed below limit the size of the various\nHTTP header sizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestBody directive allows the user to set a limit on the\nallowed size of an HTTP request message body within the context in which the\ndirective is given (server, per-directory, per-file or per-location). If the\nclient request exceeds that limit, the server will return an error response\ninstead of servicing the request. The size of a normal request message body\nwill vary greatly depending on the nature of the resource and the methods\nallowed on that resource. CGI scripts typically use the message body for\nretrieving form information. Implementations of the PUT method will require a\nvalue at least as large as any representation that the server wishes to accept\nfor that resource.",
      "descriptions": {
        "default": "Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. The Apache directives listed below limit the size of the various\nHTTP header sizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestBody directive allows the user to set a limit on the\nallowed size of an HTTP request message body within the context in which the\ndirective is given (server, per-directory, per-file or per-location). If the\nclient request exceeds that limit, the server will return an error response\ninstead of servicing the request. The size of a normal request message body\nwill vary greatly depending on the nature of the resource and the methods\nallowed on that resource. CGI scripts typically use the message body for\nretrieving form information. Implementations of the PUT method will require a\nvalue at least as large as any representation that the server wishes to accept\nfor that resource."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA060",
        "gid": "V-13736",
        "rid": "SV-32756r1_rule",
        "stig_id": "WA000-WWA060 A22",
        "fix_id": "F-29249r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the LimitRequestBody value enter the following command:\n\ngrep \"LimitRequestBody\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value of LimitRequestBody is not set to 1 or greater or does not exist,\nthis is a finding.\n\nNote: The default value is set to unlimited. It is recommended that the\ndirective be explicitly set to prevent unexpected results should the defaults\nchange with updated software.",
        "fix": "Edit the httpd.conf file and specify a size for the\nLimitRequestBody directive. "
      },
      "code": "control \"V-13736\" do\n  title \"The HTTP request message body size must be limited.\"\n  desc  \"Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. The Apache directives listed below limit the size of the various\nHTTP header sizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestBody directive allows the user to set a limit on the\nallowed size of an HTTP request message body within the context in which the\ndirective is given (server, per-directory, per-file or per-location). If the\nclient request exceeds that limit, the server will return an error response\ninstead of servicing the request. The size of a normal request message body\nwill vary greatly depending on the nature of the resource and the methods\nallowed on that resource. CGI scripts typically use the message body for\nretrieving form information. Implementations of the PUT method will require a\nvalue at least as large as any representation that the server wishes to accept\nfor that resource.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA060\"\n  tag \"gid\": \"V-13736\"\n  tag \"rid\": \"SV-32756r1_rule\"\n  tag \"stig_id\": \"WA000-WWA060 A22\"\n  tag \"fix_id\": \"F-29249r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the LimitRequestBody value enter the following command:\n\ngrep \\\"LimitRequestBody\\\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value of LimitRequestBody is not set to 1 or greater or does not exist,\nthis is a finding.\n\nNote: The default value is set to unlimited. It is recommended that the\ndirective be explicitly set to prevent unexpected results should the defaults\nchange with updated software.\"\n  tag \"fix\": \"Edit the httpd.conf file and specify a size for the\nLimitRequestBody directive. \"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('LimitRequestBody') { should cmp >= 1 }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13736.rb",
        "line": 7
      },
      "id": "V-13736"
    },
    {
      "title": "The process ID (PID) file must be properly secured.",
      "desc": "The PidFile directive sets the file path to the process ID file to\nwhich the server records the process id of the server, which is useful for\nsending a signal to the server process or for checking on the health of the\nprocess. If the PidFile is placed in a writable directory, other accounts could\ncreate a denial of service attack and prevent the server from starting by\ncreating a PID file with the same name.",
      "descriptions": {
        "default": "The PidFile directive sets the file path to the process ID file to\nwhich the server records the process id of the server, which is useful for\nsending a signal to the server process or for checking on the health of the\nprocess. If the PidFile is placed in a writable directory, other accounts could\ncreate a denial of service attack and prevent the server from starting by\ncreating a PID file with the same name."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00530",
        "gid": "V-26305",
        "rid": "SV-33222r1_rule",
        "stig_id": "WA00530 A22",
        "fix_id": "F-29402r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\nmore /usr/local/Apache2.2/conf/httpd.conf.\n\nReview the httpd.conf file and search for the following uncommented directive:\nPidFile\nNote the location and name of the PID file.\nIf the PidFile directive is not found enabled in the conf file, use /logs as\nthe directory containing the Scoreboard file.\nVerify the permissions and ownership on the folder containing the PID file. If\nany user accounts other than root, auditor, or the account used to run the web\nserver have permission to, or ownership of, this folder, this is a finding. If\nthe PID file is located in the web server DocumentRoot this is a finding.",
        "fix": "Modify the location, permissions, and/or ownership for the PID\nfile folder. "
      },
      "code": "control \"V-26305\" do\n  title \"The process ID (PID) file must be properly secured.\"\n  desc  \"The PidFile directive sets the file path to the process ID file to\nwhich the server records the process id of the server, which is useful for\nsending a signal to the server process or for checking on the health of the\nprocess. If the PidFile is placed in a writable directory, other accounts could\ncreate a denial of service attack and prevent the server from starting by\ncreating a PID file with the same name.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00530\"\n  tag \"gid\": \"V-26305\"\n  tag \"rid\": \"SV-33222r1_rule\"\n  tag \"stig_id\": \"WA00530 A22\"\n  tag \"fix_id\": \"F-29402r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\nmore /usr/local/Apache2.2/conf/httpd.conf.\n\nReview the httpd.conf file and search for the following uncommented directive:\nPidFile\nNote the location and name of the PID file.\nIf the PidFile directive is not found enabled in the conf file, use /logs as\nthe directory containing the Scoreboard file.\nVerify the permissions and ownership on the folder containing the PID file. If\nany user accounts other than root, auditor, or the account used to run the web\nserver have permission to, or ownership of, this folder, this is a finding. If\nthe PID file is located in the web server DocumentRoot this is a finding.\"\n  tag \"fix\": \"Modify the location, permissions, and/or ownership for the PID\nfile folder. \"\n\n  authorized_sa_user_list = SYS_ADMIN.clone << APACHE_OWNER\n  authorized_sa_group_list = SYS_ADMIN_GROUP.clone << APACHE_GROUP\n\n  pid_file =  command('find / -type f -name httpd.pid').stdout.chomp\n  pid_dir = File.dirname(\"#{pid_file}\")\n\n  describe file(pid_file) do\n    it { should exist }\n    its('owner') { should be_in authorized_sa_user_list }\n    its('group') { should be_in authorized_sa_group_list }\n    its ('mode')  { should cmp <= 0660 }\n  end\n\n  describe file(pid_dir) do\n    it { should exist }\n    its('owner') { should be_in authorized_sa_user_list }\n    its('group') { should be_in authorized_sa_group_list }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26305.rb",
        "line": 25
      },
      "id": "V-26305"
    },
    {
      "title": "Web server and/or operating system information must be protected.\n\n",
      "desc": "The web server response header of an HTTP response can contain several\nfields of information including the requested HTML page. The information\nincluded in this response can be web server type and version, operating system\nand version, and ports associated with the web server. This provides the\nmalicious user valuable information without the use of extensive tools.",
      "descriptions": {
        "default": "The web server response header of an HTTP response can contain several\nfields of information including the requested HTML page. The information\nincluded in this response can be web server type and version, operating system\nand version, and ports associated with the web server. This provides the\nmalicious user valuable information without the use of extensive tools."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "gtitle": "WG520",
        "gid": "V-6724",
        "rid": "SV-36672r1_rule",
        "stig_id": "WG520 A22",
        "fix_id": "F-26581r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "Enter the following command:\n\ngrep \"ServerTokens\" /usr/local/apache2/conf/httpd.conf\n\nThe directive ServerTokens must be set to “Prod” (ex. ServerTokens Prod).  This\ndirective controls whether Server response header field that is sent back to\nclients that includes a description of the OS-type of the server as well as\ninformation about compiled-in modules.\n\nIf the web server or operating system information are sent to the client via\nthe server response header or the directive does not exist, this is a finding.\n\nNote: The default value is set to Full.",
        "fix": "Edit the /usr/local/apache2/conf/httpd.conf file and ensure the\ndirective is set to Prod.\n\n"
      },
      "code": "control \"V-6724\" do\n  title \"Web server and/or operating system information must be protected.\n\n\"\n  desc  \"The web server response header of an HTTP response can contain several\nfields of information including the requested HTML page. The information\nincluded in this response can be web server type and version, operating system\nand version, and ports associated with the web server. This provides the\nmalicious user valuable information without the use of extensive tools.\"\n  impact 0.3\n  tag \"gtitle\": \"WG520\"\n  tag \"gid\": \"V-6724\"\n  tag \"rid\": \"SV-36672r1_rule\"\n  tag \"stig_id\": \"WG520 A22\"\n  tag \"fix_id\": \"F-26581r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"Enter the following command:\n\ngrep \\\"ServerTokens\\\" /usr/local/apache2/conf/httpd.conf\n\nThe directive ServerTokens must be set to “Prod” (ex. ServerTokens Prod).  This\ndirective controls whether Server response header field that is sent back to\nclients that includes a description of the OS-type of the server as well as\ninformation about compiled-in modules.\n\nIf the web server or operating system information are sent to the client via\nthe server response header or the directive does not exist, this is a finding.\n\nNote: The default value is set to Full.\"\n  tag \"fix\": \"Edit the /usr/local/apache2/conf/httpd.conf file and ensure the\ndirective is set to Prod.\n\n\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('ServerTokens') { should cmp 'Prod' }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-6724.rb",
        "line": 7
      },
      "id": "V-6724"
    },
    {
      "title": "Web server status module must be disabled.",
      "desc": "The Apache mod_info module provides information on the server\nconfiguration via access to a /server-info URL location, while the mod_status\nmodule provides current server performance statistics. While having server\nconfiguration and status information available as a web page may be convenient,\nit is recommended that these modules not be enabled: Once mod_info is loaded\ninto the server, its handler capability is available in per-directory .htaccess\nfiles and can leak sensitive information from the configuration directives of\nother Apache modules such as system paths, usernames/passwords, database names,\netc. If mod_status is loaded into the server, its handler capability is\navailable in all configuration files, including per-directory files (e.g.,\n.htaccess) and may have security-related ramifications.",
      "descriptions": {
        "default": "The Apache mod_info module provides information on the server\nconfiguration via access to a /server-info URL location, while the mod_status\nmodule provides current server performance statistics. While having server\nconfiguration and status information available as a web page may be convenient,\nit is recommended that these modules not be enabled: Once mod_info is loaded\ninto the server, its handler capability is available in per-directory .htaccess\nfiles and can leak sensitive information from the configuration directives of\nother Apache modules such as system paths, usernames/passwords, database names,\netc. If mod_status is loaded into the server, its handler capability is\navailable in all configuration files, including per-directory files (e.g.,\n.htaccess) and may have security-related ramifications."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00510",
        "gid": "V-26294",
        "rid": "SV-33218r1_rule",
        "stig_id": "WA00510 A22",
        "fix_id": "F-29395r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M.\n\nThis will provide a list of all loaded modules.  If any of the following\nmodules are found, this is a finding.\n\ninfo_module\nstatus_module",
        "fix": "Edit the httpd.conf file and disable info_module and\nstatus_module."
      },
      "code": "control \"V-26294\" do\n  title \"Web server status module must be disabled.\"\n  desc  \"The Apache mod_info module provides information on the server\nconfiguration via access to a /server-info URL location, while the mod_status\nmodule provides current server performance statistics. While having server\nconfiguration and status information available as a web page may be convenient,\nit is recommended that these modules not be enabled: Once mod_info is loaded\ninto the server, its handler capability is available in per-directory .htaccess\nfiles and can leak sensitive information from the configuration directives of\nother Apache modules such as system paths, usernames/passwords, database names,\netc. If mod_status is loaded into the server, its handler capability is\navailable in all configuration files, including per-directory files (e.g.,\n.htaccess) and may have security-related ramifications.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00510\"\n  tag \"gid\": \"V-26294\"\n  tag \"rid\": \"SV-33218r1_rule\"\n  tag \"stig_id\": \"WA00510 A22\"\n  tag \"fix_id\": \"F-29395r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M.\n\nThis will provide a list of all loaded modules.  If any of the following\nmodules are found, this is a finding.\n\ninfo_module\nstatus_module\"\n  tag \"fix\": \"Edit the httpd.conf file and disable info_module and\nstatus_module.\"\n\n  apache_loaded_modules = command(\"httpd -M\").stdout.split\n\n  describe APACHE_UNAUTHORIZED_MODULES do\n    it { should_not be_in apache_loaded_modules }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26294.rb",
        "line": 20
      },
      "id": "V-26294"
    },
    {
      "title": "The KeepAliveTimeout directive must be defined.",
      "desc": "The number of seconds Apache will wait for a subsequent request before\nclosing the connection. Once a request has been received, the timeout value\nspecified by the Timeout directive applies. Setting KeepAliveTimeout to a high\nvalue may cause performance problems in heavily loaded servers. The higher the\ntimeout, the more server processes will be kept occupied waiting on connections\nwith idle clients. These requirements are set to mitigate the effects of\nseveral types of denial of service attacks.",
      "descriptions": {
        "default": "The number of seconds Apache will wait for a subsequent request before\nclosing the connection. Once a request has been received, the timeout value\nspecified by the Timeout directive applies. Setting KeepAliveTimeout to a high\nvalue may cause performance problems in heavily loaded servers. The higher the\ntimeout, the more server processes will be kept occupied waiting on connections\nwith idle clients. These requirements are set to mitigate the effects of\nseveral types of denial of service attacks."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA024",
        "gid": "V-13726",
        "rid": "SV-32877r1_rule",
        "stig_id": "WA000-WWA024 A22",
        "fix_id": "F-29216r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the KeepAliveTimeout value enter the following command:\n\ngrep \"KeepAliveTimeout\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value of \"KeepAliveTimeout\" is not set to 15 or less, this is a\nfinding.\n\nNote: If the directive does not exist, this is not a finding because it will\ndefault to 5. It is recommended that the directive be explicitly set to prevent\nunexpected results should the defaults for any reason change(i.e. software\nupdate).",
        "fix": "Edit the httpd.conf file and set the value of\n\"KeepAliveTimeout\" to the value of 15 or less."
      },
      "code": "control \"V-13726\" do\n  title \"The KeepAliveTimeout directive must be defined.\"\n  desc  \"The number of seconds Apache will wait for a subsequent request before\nclosing the connection. Once a request has been received, the timeout value\nspecified by the Timeout directive applies. Setting KeepAliveTimeout to a high\nvalue may cause performance problems in heavily loaded servers. The higher the\ntimeout, the more server processes will be kept occupied waiting on connections\nwith idle clients. These requirements are set to mitigate the effects of\nseveral types of denial of service attacks. \"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA024\"\n  tag \"gid\": \"V-13726\"\n  tag \"rid\": \"SV-32877r1_rule\"\n  tag \"stig_id\": \"WA000-WWA024 A22\"\n  tag \"fix_id\": \"F-29216r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the KeepAliveTimeout value enter the following command:\n\ngrep \\\"KeepAliveTimeout\\\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value of \\\"KeepAliveTimeout\\\" is not set to 15 or less, this is a\nfinding.\n\nNote: If the directive does not exist, this is not a finding because it will\ndefault to 5. It is recommended that the directive be explicitly set to prevent\nunexpected results should the defaults for any reason change(i.e. software\nupdate).\"\n  tag \"fix\": \"Edit the httpd.conf file and set the value of\n\\\"KeepAliveTimeout\\\" to the value of 15 or less.\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('KeepAliveTimeout') { should cmp <= '15' }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13726.rb",
        "line": 7
      },
      "id": "V-13726"
    },
    {
      "title": "A public web server must limit email to outbound only.",
      "desc": "Incoming E-mail has been known to provide hackers with access to\nservers. Disabling the incoming mail service prevents this type of attacks.\nAdditionally, Email represents the main use of the Internet. It is specialized\napplication that requires the dedication of server resources. To combine this\ntype of transaction processing function with the file serving role of the web\nserver creates an inherent conflict. Supporting mail services on a web server\nopens the server to the risk of abuse as an email relay.",
      "descriptions": {
        "default": "Incoming E-mail has been known to provide hackers with access to\nservers. Disabling the incoming mail service prevents this type of attacks.\nAdditionally, Email represents the main use of the Internet. It is specialized\napplication that requires the dedication of server resources. To combine this\ntype of transaction processing function with the file serving role of the web\nserver creates an inherent conflict. Supporting mail services on a web server\nopens the server to the risk of abuse as an email relay."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG330",
        "gid": "V-2261",
        "rid": "SV-32937r1_rule",
        "stig_id": "WG330 A22",
        "fix_id": "F-29266r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "\"To determine if email applications are excepting incoming\nconnections (on standard ports)enter the following command:\n\ntelnet localhost 25\n\nreview the command results, If an e-mail program is installed and that program\nhas been configured to accept inbound email, this is a finding.\"\n",
        "fix": "Configure the email application to not allow incoming connections.\n"
      },
      "code": "control \"V-2261\" do\n  title \"A public web server must limit email to outbound only.\"\n  desc  \"Incoming E-mail has been known to provide hackers with access to\nservers. Disabling the incoming mail service prevents this type of attacks.\nAdditionally, Email represents the main use of the Internet. It is specialized\napplication that requires the dedication of server resources. To combine this\ntype of transaction processing function with the file serving role of the web\nserver creates an inherent conflict. Supporting mail services on a web server\nopens the server to the risk of abuse as an email relay.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WG330\"\n  tag \"gid\": \"V-2261\"\n  tag \"rid\": \"SV-32937r1_rule\"\n  tag \"stig_id\": \"WG330 A22\"\n  tag \"fix_id\": \"F-29266r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"\\\"To determine if email applications are excepting incoming\nconnections (on standard ports)enter the following command:\n\ntelnet localhost 25\n\nreview the command results, If an e-mail program is installed and that program\nhas been configured to accept inbound email, this is a finding.\\\"\n\"\n  tag \"fix\": \"Configure the email application to not allow incoming connections.\n\"\n\n  describe package(\"telnet\") do\n    it { should_not be_installed }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2261.rb",
        "line": 1
      },
      "id": "V-2261"
    },
    {
      "title": "The web server password(s) must be entrusted to the SA or Web Manager.\n",
      "desc": "Normally, a service account is established for the web server. This is\nbecause a privileged account is not desirable and the server is designed to run\nfor long uninterrupted periods of time. The SA or Web Manager will need\npassword access to the web server to restart the service in the event of an\nemergency as the web server is not to restart automatically after an\nunscheduled interruption.  If the password is not entrusted to an SA or web\nmanager the ability to ensure the availability of the web server is\ncompromised.",
      "descriptions": {
        "default": "Normally, a service account is established for the web server. This is\nbecause a privileged account is not desirable and the server is designed to run\nfor long uninterrupted periods of time. The SA or Web Manager will need\npassword access to the web server to restart the service in the event of an\nemergency as the web server is not to restart automatically after an\nunscheduled interruption.  If the password is not entrusted to an SA or web\nmanager the ability to ensure the availability of the web server is\ncompromised."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG050",
        "gid": "V-2232",
        "rid": "SV-32788r1_rule",
        "stig_id": "WG050 A22",
        "fix_id": "F-2281r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "The reviewer should make a note of the name of the account\nbeing used for the web service. This\ninformation may be needed later in the SRR. There may also be other server\nservices running related to the web server in support of a particular web\napplication, these passwords must be entrusted to the SA or Web Manager as well.\nQuery the SA or Web Manager to determine if they have the web service\npassword(s).\n\nIf the web services password(s) are not entrusted to the SA or Web Manager,\nthis is a finding.\n\nNOTE: For installations that run as a service, or without a password, the SA or\nWeb Manager having an Admin account on the system would meet the intent of this\ncheck.\n",
        "fix": "Ensure the SA or Web Manager are entrusted with the web\nservice(s) password."
      },
      "code": "control \"V-2232\" do\n  title \"The web server password(s) must be entrusted to the SA or Web Manager.\n\"\n  desc  \"Normally, a service account is established for the web server. This is\nbecause a privileged account is not desirable and the server is designed to run\nfor long uninterrupted periods of time. The SA or Web Manager will need\npassword access to the web server to restart the service in the event of an\nemergency as the web server is not to restart automatically after an\nunscheduled interruption.  If the password is not entrusted to an SA or web\nmanager the ability to ensure the availability of the web server is\ncompromised.\"\n  impact 0.5\n  tag \"gtitle\": \"WG050\"\n  tag \"gid\": \"V-2232\"\n  tag \"rid\": \"SV-32788r1_rule\"\n  tag \"stig_id\": \"WG050 A22\"\n  tag \"fix_id\": \"F-2281r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"The reviewer should make a note of the name of the account\nbeing used for the web service. This\ninformation may be needed later in the SRR. There may also be other server\nservices running related to the web server in support of a particular web\napplication, these passwords must be entrusted to the SA or Web Manager as well.\nQuery the SA or Web Manager to determine if they have the web service\npassword(s).\n\nIf the web services password(s) are not entrusted to the SA or Web Manager,\nthis is a finding.\n\nNOTE: For installations that run as a service, or without a password, the SA or\nWeb Manager having an Admin account on the system would meet the intent of this\ncheck.\n\"\n  tag \"fix\": \"Ensure the SA or Web Manager are entrusted with the web\nservice(s) password.\"\n\nbegin\n  describe passwd.users(APACHE_OWNER).passwords do\n    it { should_not cmp ['']}\n  end\nrescue Exception => msg\n  describe \"Exception: #{msg}\" do\n    it { should be_nil }\n  end\nend\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2232.rb",
        "line": 8
      },
      "id": "V-2232"
    },
    {
      "title": "The TRACE  method must be disabled.",
      "desc": "Diagnostics help establish a history of activities, and can be useful\nin detecting attack attempts or determining tuning adjustments to improve\nserver availability. Trace logs are essential to the investigation and\nprosecution of unauthorized access to web server software and data. However, in\nstandard production operations, use of diagnostics may reveal undiscovered\nvulnerabilities and ultimately, to compromise of the data. Because of the\npotential for abuse, the HTTP Trace method should be disabled.",
      "descriptions": {
        "default": "Diagnostics help establish a history of activities, and can be useful\nin detecting attack attempts or determining tuning adjustments to improve\nserver availability. Trace logs are essential to the investigation and\nprosecution of unauthorized access to web server software and data. However, in\nstandard production operations, use of diagnostics may reveal undiscovered\nvulnerabilities and ultimately, to compromise of the data. Because of the\npotential for abuse, the HTTP Trace method should be disabled."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00550",
        "gid": "V-26325",
        "rid": "SV-33227r1_rule",
        "stig_id": "WA00550 A22",
        "fix_id": "F-29424r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\ngrep \"TraceEnable\" /usr/local/apache2/conf/httpd.conf.\n\nReview the results for the following directive:\n\nTraceEnable.\n\nFor any enabled TraceEnable directives ensure they are part of the server level\nconfiguration (i.e. not nested in a $Directory or $Location directive). Also\nensure that the TraceEnable directive is set to “Off”.\n\nIf the TraceEnable directive is not part of the server level configuration\nand/or is not set to “Off”, this is a finding.\n\nIf the directive does not exist in the conf file, this is a finding because the\ndefault value is \"On\".\n",
        "fix": "Edit the httpd.conf file and add or set the value of EnableTrace\nto \"Off\"."
      },
      "code": "control \"V-26325\" do\n  title \"The TRACE  method must be disabled.\"\n  desc  \"Diagnostics help establish a history of activities, and can be useful\nin detecting attack attempts or determining tuning adjustments to improve\nserver availability. Trace logs are essential to the investigation and\nprosecution of unauthorized access to web server software and data. However, in\nstandard production operations, use of diagnostics may reveal undiscovered\nvulnerabilities and ultimately, to compromise of the data. Because of the\npotential for abuse, the HTTP Trace method should be disabled.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00550\"\n  tag \"gid\": \"V-26325\"\n  tag \"rid\": \"SV-33227r1_rule\"\n  tag \"stig_id\": \"WA00550 A22\"\n  tag \"fix_id\": \"F-29424r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\ngrep \\\"TraceEnable\\\" /usr/local/apache2/conf/httpd.conf.\n\nReview the results for the following directive:\n\nTraceEnable.\n\nFor any enabled TraceEnable directives ensure they are part of the server level\nconfiguration (i.e. not nested in a $Directory or $Location directive). Also\nensure that the TraceEnable directive is set to “Off”.\n\nIf the TraceEnable directive is not part of the server level configuration\nand/or is not set to “Off”, this is a finding.\n\nIf the directive does not exist in the conf file, this is a finding because the\ndefault value is \\\"On\\\".\n\"\n  tag \"fix\": \"Edit the httpd.conf file and add or set the value of EnableTrace\nto \\\"Off\\\".\"\n\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('TraceEnable') { should cmp \"Off\" }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26325.rb",
        "line": 7
      },
      "id": "V-26325"
    },
    {
      "title": "User specific directories must not be globally enabled.",
      "desc": "The UserDir directive must be disabled so that user home directories\nare not accessed via the web site with a tilde (~) preceding the username. The\ndirective also sets the path name of the directory that will be accessed. The\nuser directories should not be globally enabled since it allows anonymous\naccess to anything users may want to share with other users on the network.\nAlso consider that every time a new account is created on the system, there is\npotentially new content available via the web site.",
      "descriptions": {
        "default": "The UserDir directive must be disabled so that user home directories\nare not accessed via the web site with a tilde (~) preceding the username. The\ndirective also sets the path name of the directory that will be accessed. The\nuser directories should not be globally enabled since it allows anonymous\naccess to anything users may want to share with other users on the network.\nAlso consider that every time a new account is created on the system, there is\npotentially new content available via the web site."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00525",
        "gid": "V-26302",
        "rid": "SV-33221r1_rule",
        "stig_id": "WA00525 A22",
        "fix_id": "F-29401r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M.\n\nThis will provide a list of all loaded modules. If userdir_module is listed,\nthis is a finding.",
        "fix": "Edit the httpd.conf file and remove userdir_module."
      },
      "code": "control \"V-26302\" do\n  title \"User specific directories must not be globally enabled.\"\n  desc  \"The UserDir directive must be disabled so that user home directories\nare not accessed via the web site with a tilde (~) preceding the username. The\ndirective also sets the path name of the directory that will be accessed. The\nuser directories should not be globally enabled since it allows anonymous\naccess to anything users may want to share with other users on the network.\nAlso consider that every time a new account is created on the system, there is\npotentially new content available via the web site.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00525\"\n  tag \"gid\": \"V-26302\"\n  tag \"rid\": \"SV-33221r1_rule\"\n  tag \"stig_id\": \"WA00525 A22\"\n  tag \"fix_id\": \"F-29401r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M.\n\nThis will provide a list of all loaded modules. If userdir_module is listed,\nthis is a finding.\"\n  tag \"fix\": \"Edit the httpd.conf file and remove userdir_module.\"\n\n  apache_loaded_modules = command(\"httpd -M\").stdout.split\n\n  describe APACHE_UNAUTHORIZED_MODULES do\n    it { should_not be_in apache_loaded_modules }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26302.rb",
        "line": 19
      },
      "id": "V-26302"
    },
    {
      "title": "Web server content and configuration files must be part of a routine\nbackup program.",
      "desc": "Backing up web server data and web server application software after\nupgrades or maintenance ensures that recovery can be accomplished up to the\ncurrent version. It also provides a means to determine and recover from\nsubsequent unauthorized changes to the software and data.\n\n    A tested and verifiable backup strategy will be implemented for web server\nsoftware as well as all web server data files. Backup and recovery procedures\nwill be documented and the Web Manager or SA for the specific application will\nbe responsible for the design, test, and implementation of the procedures.\n\n    The site will have a contingency processing plan/disaster recovery plan\nthat includes web servers. The contingency plan will be periodically tested in\naccordance with DoDI 8500.2 requirements.\n\n    The site will identify an off-site storage facility in accordance with DoDI\n8500.2 requirements. Off-site backups will be updated on a regular basis and\nthe frequency will be documented in the contingency plan.",
      "descriptions": {
        "default": "Backing up web server data and web server application software after\nupgrades or maintenance ensures that recovery can be accomplished up to the\ncurrent version. It also provides a means to determine and recover from\nsubsequent unauthorized changes to the software and data.\n\n    A tested and verifiable backup strategy will be implemented for web server\nsoftware as well as all web server data files. Backup and recovery procedures\nwill be documented and the Web Manager or SA for the specific application will\nbe responsible for the design, test, and implementation of the procedures.\n\n    The site will have a contingency processing plan/disaster recovery plan\nthat includes web servers. The contingency plan will be periodically tested in\naccordance with DoDI 8500.2 requirements.\n\n    The site will identify an off-site storage facility in accordance with DoDI\n8500.2 requirements. Off-site backups will be updated on a regular basis and\nthe frequency will be documented in the contingency plan."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "gtitle": "WA140",
        "gid": "V-6485",
        "rid": "SV-32964r2_rule",
        "stig_id": "WA140 A22",
        "fix_id": "F-29284r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "Interview the Information Systems Security Officer (ISSO), SA,\nWeb Manager, Webmaster or developers as necessary to determine whether or not a\ntested and verifiable backup strategy has been implemented for web server\nsoftware as well as all web server data files.\n\nProposed Questions:\nWho maintains the backup and recovery procedures?\nDo you have a copy of the backup and recovery procedures?\nWhere is the off-site backup location?\nIs the contingency plan documented?\nWhen was the last time the contingency plan was tested?\nAre the test dates and results documented?\n\nIf there is not a backup and recovery process for the web server, this is a\nfinding.\n",
        "fix": "Document the backup procedures.\n"
      },
      "code": "control \"V-6485\" do\n  title \"Web server content and configuration files must be part of a routine\nbackup program.\"\n  desc  \"Backing up web server data and web server application software after\nupgrades or maintenance ensures that recovery can be accomplished up to the\ncurrent version. It also provides a means to determine and recover from\nsubsequent unauthorized changes to the software and data.\n\n    A tested and verifiable backup strategy will be implemented for web server\nsoftware as well as all web server data files. Backup and recovery procedures\nwill be documented and the Web Manager or SA for the specific application will\nbe responsible for the design, test, and implementation of the procedures.\n\n    The site will have a contingency processing plan/disaster recovery plan\nthat includes web servers. The contingency plan will be periodically tested in\naccordance with DoDI 8500.2 requirements.\n\n    The site will identify an off-site storage facility in accordance with DoDI\n8500.2 requirements. Off-site backups will be updated on a regular basis and\nthe frequency will be documented in the contingency plan.\n\n  \"\n  impact 0.3\n  tag \"gtitle\": \"WA140\"\n  tag \"gid\": \"V-6485\"\n  tag \"rid\": \"SV-32964r2_rule\"\n  tag \"stig_id\": \"WA140 A22\"\n  tag \"fix_id\": \"F-29284r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"Interview the Information Systems Security Officer (ISSO), SA,\nWeb Manager, Webmaster or developers as necessary to determine whether or not a\ntested and verifiable backup strategy has been implemented for web server\nsoftware as well as all web server data files.\n\nProposed Questions:\nWho maintains the backup and recovery procedures?\nDo you have a copy of the backup and recovery procedures?\nWhere is the off-site backup location?\nIs the contingency plan documented?\nWhen was the last time the contingency plan was tested?\nAre the test dates and results documented?\n\nIf there is not a backup and recovery process for the web server, this is a\nfinding.\n\"\n  tag \"fix\": \"Document the backup procedures.\n\"\n  describe \"This test currently has no automated tests, you must check manually\" do\n    skip \"This check must be preformed manually\"\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-6485.rb",
        "line": 1
      },
      "id": "V-6485"
    },
    {
      "title": "Directory indexing must be disabled on directories not containing\nindex files.",
      "desc": "Directory options directives are directives that can be applied to\nfurther restrict access to file and directories.  If a URL which maps to a\ndirectory is requested, and there is no DirectoryIndex (e.g., index.html) in\nthat directory, then mod_autoindex will return a formatted listing of the\ndirectory which is not acceptable.",
      "descriptions": {
        "default": "Directory options directives are directives that can be applied to\nfurther restrict access to file and directories.  If a URL which maps to a\ndirectory is requested, and there is no DirectoryIndex (e.g., index.html) in\nthat directory, then mod_autoindex will return a formatted listing of the\ndirectory which is not acceptable."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA058",
        "gid": "V-13735",
        "rid": "SV-32755r1_rule",
        "stig_id": "WA000-WWA058 A22",
        "fix_id": "F-29248r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the Indexes value enter the following command:\n\ngrep \"Indexes\" /usr/local/apache2/conf/httpd.conf.\n\nReview all uncommented Options statements for the following value: -Indexes\n\nIf the value is found on the Options statement, and it does not have a\npreceding ‘-‘, this is a finding.\n\nNotes:\n- If the value does NOT exist, this is a finding.\n- If all enabled Options statement are set to None this is not a finding.\n",
        "fix": "Edit the httpd.conf file and add an \"-\" to the Indexes setting,\nor set the options directive to None. "
      },
      "code": "control \"V-13735\" do\n  title \"Directory indexing must be disabled on directories not containing\nindex files.\"\n  desc  \"Directory options directives are directives that can be applied to\nfurther restrict access to file and directories.  If a URL which maps to a\ndirectory is requested, and there is no DirectoryIndex (e.g., index.html) in\nthat directory, then mod_autoindex will return a formatted listing of the\ndirectory which is not acceptable.\"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA058\"\n  tag \"gid\": \"V-13735\"\n  tag \"rid\": \"SV-32755r1_rule\"\n  tag \"stig_id\": \"WA000-WWA058 A22\"\n  tag \"fix_id\": \"F-29248r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the Indexes value enter the following command:\n\ngrep \\\"Indexes\\\" /usr/local/apache2/conf/httpd.conf.\n\nReview all uncommented Options statements for the following value: -Indexes\n\nIf the value is found on the Options statement, and it does not have a\npreceding ‘-‘, this is a finding.\n\nNotes:\n- If the value does NOT exist, this is a finding.\n- If all enabled Options statement are set to None this is not a finding.\n\"\n  tag \"fix\": \"Edit the httpd.conf file and add an \\\"-\\\" to the Indexes setting,\nor set the options directive to None. \"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('Options') { should be_in APPROVED_OPTIONS }\n    its('Options') { should_not be_in UNAPPROVED_OPTIONS }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13735.rb",
        "line": 19
      },
      "id": "V-13735"
    },
    {
      "title": "The HTTP request header field size must be limited.",
      "desc": "Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. This Apache directives limits the size of the various HTTP header\nsizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestFieldSize directive allows the server administrator to\nreduce or increase the limit on the allowed size of an HTTP request header\nfield. A server needs this value to be large enough to hold any one header\nfield from a normal client request. The size of a normal request header field\nwill vary greatly among different client implementations, often depending upon\nthe extent to which a user has configured their browser to support detailed\ncontent negotiation. SPNEGO authentication headers can be up to 12392 bytes.\n\n    This directive gives the server administrator greater control over abnormal\nclient request behavior, which may be useful for avoiding some forms of\ndenial-of-service attacks.",
      "descriptions": {
        "default": "Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. This Apache directives limits the size of the various HTTP header\nsizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestFieldSize directive allows the server administrator to\nreduce or increase the limit on the allowed size of an HTTP request header\nfield. A server needs this value to be large enough to hold any one header\nfield from a normal client request. The size of a normal request header field\nwill vary greatly among different client implementations, often depending upon\nthe extent to which a user has configured their browser to support detailed\ncontent negotiation. SPNEGO authentication headers can be up to 12392 bytes.\n\n    This directive gives the server administrator greater control over abnormal\nclient request behavior, which may be useful for avoiding some forms of\ndenial-of-service attacks."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA064",
        "gid": "V-13738",
        "rid": "SV-32766r2_rule",
        "stig_id": "WA000-WWA064 A22",
        "fix_id": "F-29256r4_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the LimitRequestFieldSize value enter the following\ncommand:\n\ngrep \"LimitRequestFieldSize\" /usr/local/apache2/conf/httpd.conf.\n\nIf no LimitRequestFieldSize directives exist, this is a Finding. Although the\ndefault value is 8190, this directive must be explicitly set.\n\nIf the value of LimitRequestFieldSize is not set to 8190, this is a finding.\n",
        "fix": "Edit the httpd.conf file and ensure the LimitRequestFieldSize is\nexplicitly configured and set to 8190 or other approved value. "
      },
      "code": "control \"V-13738\" do\n  title \"The HTTP request header field size must be limited.\"\n  desc  \"Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. This Apache directives limits the size of the various HTTP header\nsizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestFieldSize directive allows the server administrator to\nreduce or increase the limit on the allowed size of an HTTP request header\nfield. A server needs this value to be large enough to hold any one header\nfield from a normal client request. The size of a normal request header field\nwill vary greatly among different client implementations, often depending upon\nthe extent to which a user has configured their browser to support detailed\ncontent negotiation. SPNEGO authentication headers can be up to 12392 bytes.\n\n    This directive gives the server administrator greater control over abnormal\nclient request behavior, which may be useful for avoiding some forms of\ndenial-of-service attacks.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA064\"\n  tag \"gid\": \"V-13738\"\n  tag \"rid\": \"SV-32766r2_rule\"\n  tag \"stig_id\": \"WA000-WWA064 A22\"\n  tag \"fix_id\": \"F-29256r4_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the LimitRequestFieldSize value enter the following\ncommand:\n\ngrep \\\"LimitRequestFieldSize\\\" /usr/local/apache2/conf/httpd.conf.\n\nIf no LimitRequestFieldSize directives exist, this is a Finding. Although the\ndefault value is 8190, this directive must be explicitly set.\n\nIf the value of LimitRequestFieldSize is not set to 8190, this is a finding.\n\"\n  tag \"fix\": \"Edit the httpd.conf file and ensure the LimitRequestFieldSize is\nexplicitly configured and set to 8190 or other approved value. \"\n\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('LimitRequestFieldSize') { should cmp 8190 }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13738.rb",
        "line": 7
      },
      "id": "V-13738"
    },
    {
      "title": "All utility programs, not necessary for operations, must be removed or\ndisabled. ",
      "desc": "Just as running unneeded services and protocols is a danger to the web\nserver at the lower levels of the OSI model, running unneeded utilities and\nprograms is also a danger at the application layer of the OSI model. Office\nsuites, development tools, and graphical editors are examples of such programs\nthat are troublesome. Individual productivity tools have no legitimate place or\nuse on an enterprise, production web server and they are also prone to their\nown security risks.",
      "descriptions": {
        "default": "Just as running unneeded services and protocols is a danger to the web\nserver at the lower levels of the OSI model, running unneeded utilities and\nprograms is also a danger at the application layer of the OSI model. Office\nsuites, development tools, and graphical editors are examples of such programs\nthat are troublesome. Individual productivity tools have no legitimate place or\nuse on an enterprise, production web server and they are also prone to their\nown security risks."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "gtitle": "WG130",
        "gid": "V-2251",
        "rid": "SV-32955r2_rule",
        "stig_id": "WG130 A22",
        "fix_id": "F-29278r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "If the site requires the use of a particular piece of software,\nthe ISSO will need to maintain documentation identifying this software as\nnecessary for operations. The software must be operated at the vendor’s current\npatch level and must be a supported vendor release.\nIf programs or utilities that meet the above criteria are installed on the Web\nServer, and appropriate documentation and signatures are in evidence, this is\nnot a finding.\n\nDetermine whether the web server is configured with unnecessary software.\n\nDetermine whether processes other than those that support the web server are\nloaded and/or run on the web server.\n\nExamples of software that should not be on the web server are all web\ndevelopment tools, office suites (unless the web server is a private web\ndevelopment server), compilers, and other utilities that are not part of the\nweb server suite or the basic operating system.\n\nCheck the directory structure of the server and ensure that additional,\nunintended, or unneeded applications are not loaded on the system.\n\nIf, after review of the application on the system, there is no justification\nfor the identified software, this is a finding.\n",
        "fix": "Remove any unnecessary applications."
      },
      "code": "control \"V-2251\" do\n  title \"All utility programs, not necessary for operations, must be removed or\ndisabled. \"\n  desc  \"Just as running unneeded services and protocols is a danger to the web\nserver at the lower levels of the OSI model, running unneeded utilities and\nprograms is also a danger at the application layer of the OSI model. Office\nsuites, development tools, and graphical editors are examples of such programs\nthat are troublesome. Individual productivity tools have no legitimate place or\nuse on an enterprise, production web server and they are also prone to their\nown security risks.\n\n  \"\n  impact 0.3\n  tag \"gtitle\": \"WG130\"\n  tag \"gid\": \"V-2251\"\n  tag \"rid\": \"SV-32955r2_rule\"\n  tag \"stig_id\": \"WG130 A22\"\n  tag \"fix_id\": \"F-29278r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"If the site requires the use of a particular piece of software,\nthe ISSO will need to maintain documentation identifying this software as\nnecessary for operations. The software must be operated at the vendor’s current\npatch level and must be a supported vendor release.\nIf programs or utilities that meet the above criteria are installed on the Web\nServer, and appropriate documentation and signatures are in evidence, this is\nnot a finding.\n\nDetermine whether the web server is configured with unnecessary software.\n\nDetermine whether processes other than those that support the web server are\nloaded and/or run on the web server.\n\nExamples of software that should not be on the web server are all web\ndevelopment tools, office suites (unless the web server is a private web\ndevelopment server), compilers, and other utilities that are not part of the\nweb server suite or the basic operating system.\n\nCheck the directory structure of the server and ensure that additional,\nunintended, or unneeded applications are not loaded on the system.\n\nIf, after review of the application on the system, there is no justification\nfor the identified software, this is a finding.\n\"\n  tag \"fix\": \"Remove any unnecessary applications.\"\n\n  describe \"This test currently has no automated tests, you must check manually\" do\n    skip \"This check must be preformed manually\"\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2251.rb",
        "line": 2
      },
      "id": "V-2251"
    },
    {
      "title": "Web Distributed Authoring and Versioning (WebDAV) must be disabled.",
      "desc": "The Apache mod_dav and mod_dav_fs modules support WebDAV ('Web-based\nDistributed Authoring and Versioning') functionality for Apache. WebDAV is an\nextension to the HTTP protocol which allows clients to create, move, and delete\nfiles and resources on the web server. WebDAV is not widely used, and has\nserious security concerns as it may allow clients to modify unauthorized files\non the web server. Therefore, the WebDav modules mod_dav and mod_dav_fs should\nbe disabled.",
      "descriptions": {
        "default": "The Apache mod_dav and mod_dav_fs modules support WebDAV ('Web-based\nDistributed Authoring and Versioning') functionality for Apache. WebDAV is an\nextension to the HTTP protocol which allows clients to create, move, and delete\nfiles and resources on the web server. WebDAV is not widely used, and has\nserious security concerns as it may allow clients to modify unauthorized files\non the web server. Therefore, the WebDav modules mod_dav and mod_dav_fs should\nbe disabled."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00505",
        "gid": "V-26287",
        "rid": "SV-33216r1_rule",
        "stig_id": "WA00505 A22",
        "fix_id": "F-29390r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M.\n\nThis will provide a list of all loaded modules.  If any of the following\nmodules are found, this is a finding.\n\ndav_module\ndav_fs_module\ndav_lock_module",
        "fix": "Edit the httpd.conf file and remove the following modules:\n\ndav_module\ndav_fs_module\ndav_lock_module"
      },
      "code": "control \"V-26287\" do\n  title \"Web Distributed Authoring and Versioning (WebDAV) must be disabled.\"\n  desc  \"The Apache mod_dav and mod_dav_fs modules support WebDAV ('Web-based\nDistributed Authoring and Versioning') functionality for Apache. WebDAV is an\nextension to the HTTP protocol which allows clients to create, move, and delete\nfiles and resources on the web server. WebDAV is not widely used, and has\nserious security concerns as it may allow clients to modify unauthorized files\non the web server. Therefore, the WebDav modules mod_dav and mod_dav_fs should\nbe disabled.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00505\"\n  tag \"gid\": \"V-26287\"\n  tag \"rid\": \"SV-33216r1_rule\"\n  tag \"stig_id\": \"WA00505 A22\"\n  tag \"fix_id\": \"F-29390r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M.\n\nThis will provide a list of all loaded modules.  If any of the following\nmodules are found, this is a finding.\n\ndav_module\ndav_fs_module\ndav_lock_module\"\n  tag \"fix\": \"Edit the httpd.conf file and remove the following modules:\n\ndav_module\ndav_fs_module\ndav_lock_module\"\n\n  apache = command(\"httpd -M\").stdout.split\n\n  describe APACHE_UNAUTHORIZED_MODULES do\n    it { should_not be_in apache }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26287.rb",
        "line": 21
      },
      "id": "V-26287"
    },
    {
      "title": "The httpd.conf MinSpareServers directive must be set properly. ",
      "desc": "These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org: The MinSpareServers directive sets the desired minimum\nnumber of idle child server processes. An idle process is one which is not\nhandling a request. If there are fewer than MinSpareServers idle, then the\nparent process creates new children at a maximum rate of 1 per second.\n\n    Tuning of this parameter should only be necessary on very busy sites.\nSetting this parameter to a large number is almost always a bad idea.",
      "descriptions": {
        "default": "These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org: The MinSpareServers directive sets the desired minimum\nnumber of idle child server processes. An idle process is one which is not\nhandling a request. If there are fewer than MinSpareServers idle, then the\nparent process creates new children at a maximum rate of 1 per second.\n\n    Tuning of this parameter should only be necessary on very busy sites.\nSetting this parameter to a large number is almost always a bad idea."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA028",
        "gid": "V-13728",
        "rid": "SV-36646r2_rule",
        "stig_id": "WA000-WWA028 A22",
        "fix_id": "F-13176r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMinSpareServers\n\nThe value needs to be between 5 and 10\n\nIf the directive is set improperly, this is a finding.\n\nIf the directive is not found, you will need to review the httpd.conf file to\nsee if there are other .conf files that are included of \"linked\" to the\nhttpd.conf. The other conf files may contain these directives.\n\nIf the directive does not exist, this is NOT a finding because it will default\nto 5.  It is recommended that the directive be explicitly set to prevent\nunexpected results if the defaults change with updated software.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for the use of increased  or decreased value. If\nthe site has this documentation, this should be marked as Not a Finding.\n",
        "fix": "Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMinSpareServers\n\nSet the directive to a value of between 5 and 10, add the directive if it does\nnot exist.\n\nIt is recommended that the directive be explicitly set to prevent unexpected\nresults if the defaults change with updated software.\n"
      },
      "code": "control \"V-13728\" do\n  title \"The httpd.conf MinSpareServers directive must be set properly. \"\n  desc  \"These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org: The MinSpareServers directive sets the desired minimum\nnumber of idle child server processes. An idle process is one which is not\nhandling a request. If there are fewer than MinSpareServers idle, then the\nparent process creates new children at a maximum rate of 1 per second.\n\n    Tuning of this parameter should only be necessary on very busy sites.\nSetting this parameter to a large number is almost always a bad idea.\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA028\"\n  tag \"gid\": \"V-13728\"\n  tag \"rid\": \"SV-36646r2_rule\"\n  tag \"stig_id\": \"WA000-WWA028 A22\"\n  tag \"fix_id\": \"F-13176r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMinSpareServers\n\nThe value needs to be between 5 and 10\n\nIf the directive is set improperly, this is a finding.\n\nIf the directive is not found, you will need to review the httpd.conf file to\nsee if there are other .conf files that are included of \\\"linked\\\" to the\nhttpd.conf. The other conf files may contain these directives.\n\nIf the directive does not exist, this is NOT a finding because it will default\nto 5.  It is recommended that the directive be explicitly set to prevent\nunexpected results if the defaults change with updated software.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for the use of increased  or decreased value. If\nthe site has this documentation, this should be marked as Not a Finding.\n\"\n  tag \"fix\": \"Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMinSpareServers\n\nSet the directive to a value of between 5 and 10, add the directive if it does\nnot exist.\n\nIt is recommended that the directive be explicitly set to prevent unexpected\nresults if the defaults change with updated software.\n\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('MinSpareServers') { should cmp > 5 }\n    its('MinSpareServers') { should cmp < 10 }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13728.rb",
        "line": 7
      },
      "id": "V-13728"
    },
    {
      "title": "Web server options for the OS root must be disabled.",
      "desc": "The Apache Options directive allows for specific configuration of\noptions, including execution of CGI, following symbolic links, server side\nincludes, and content negotiation. The Options directive for the root OS level\nis used to create a default minimal options policy that allows only the minimal\noptions at the root directory level. Then for specific web sites or portions of\nthe web site, options may be enabled as needed and appropriate. No options\nshould be enabled and the value for the Options Directive should be None.",
      "descriptions": {
        "default": "The Apache Options directive allows for specific configuration of\noptions, including execution of CGI, following symbolic links, server side\nincludes, and content negotiation. The Options directive for the root OS level\nis used to create a default minimal options policy that allows only the minimal\noptions at the root directory level. Then for specific web sites or portions of\nthe web site, options may be enabled as needed and appropriate. No options\nshould be enabled and the value for the Options Directive should be None."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00545",
        "gid": "V-26324",
        "rid": "SV-33213r1_rule",
        "stig_id": "WA00545 A22",
        "fix_id": "F-29422r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\nmore /usr/local/Apache2.2/conf/httpd.conf.\n\nReview the httpd.conf file and search for the following  directive:\n\nDirectory\n\nFor every root directory entry (i.e. <Directory />) ensure the following entry\nexists:\n\nOptions None\n\nIf the statement above is not found in the root directory statement, this is a\nfinding.\n\nIf Allow directives are included in the root directory statement, this is a\nfinding.\n\nIf the root directory statement is not found at all, this is a finding.",
        "fix": "Ensure the root directory has the appropriate Options assignment."
      },
      "code": "control \"V-26324\" do\n  title \"Web server options for the OS root must be disabled.\"\n  desc  \"The Apache Options directive allows for specific configuration of\noptions, including execution of CGI, following symbolic links, server side\nincludes, and content negotiation. The Options directive for the root OS level\nis used to create a default minimal options policy that allows only the minimal\noptions at the root directory level. Then for specific web sites or portions of\nthe web site, options may be enabled as needed and appropriate. No options\nshould be enabled and the value for the Options Directive should be None.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00545\"\n  tag \"gid\": \"V-26324\"\n  tag \"rid\": \"SV-33213r1_rule\"\n  tag \"stig_id\": \"WA00545 A22\"\n  tag \"fix_id\": \"F-29422r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\nmore /usr/local/Apache2.2/conf/httpd.conf.\n\nReview the httpd.conf file and search for the following  directive:\n\nDirectory\n\nFor every root directory entry (i.e. <Directory />) ensure the following entry\nexists:\n\nOptions None\n\nIf the statement above is not found in the root directory statement, this is a\nfinding.\n\nIf Allow directives are included in the root directory statement, this is a\nfinding.\n\nIf the root directory statement is not found at all, this is a finding.\"\n  tag \"fix\": \"Ensure the root directory has the appropriate Options assignment.\"\n\n  describe command(\"awk '/<Directory \\\\/>/,/<\\\\/Directory>/' /etc/httpd/conf/httpd.conf\") do\n    its('stdout') { should match /Options\\s+None$/ }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26324.rb",
        "line": 1
      },
      "id": "V-26324"
    },
    {
      "title": "The web server must be configured to listen on a specific IP address\nand port.",
      "desc": "The Apache Listen directive specifies the IP addresses and port\nnumbers the Apache web server will listen for requests. Rather than be\nunrestricted to listen on all IP addresses available to the system, the\nspecific IP address or addresses intended must be explicitly specified.\nSpecifically a Listen directive with no IP address specified, or with an IP\naddress of zero’s should not be used. Having multiple interfaces on web servers\nis fairly common, and without explicit Listen directives, the web server is\nlikely to be listening on an inappropriate IP address / interface that were not\nintended for the web server. Single homed system with a single IP addressed are\nalso required to have an explicit IP address in the Listen directive, in case\nadditional interfaces are added to the system at a later date.",
      "descriptions": {
        "default": "The Apache Listen directive specifies the IP addresses and port\nnumbers the Apache web server will listen for requests. Rather than be\nunrestricted to listen on all IP addresses available to the system, the\nspecific IP address or addresses intended must be explicitly specified.\nSpecifically a Listen directive with no IP address specified, or with an IP\naddress of zero’s should not be used. Having multiple interfaces on web servers\nis fairly common, and without explicit Listen directives, the web server is\nlikely to be listening on an inappropriate IP address / interface that were not\nintended for the web server. Single homed system with a single IP addressed are\nalso required to have an explicit IP address in the Listen directive, in case\nadditional interfaces are added to the system at a later date."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00555",
        "gid": "V-26326",
        "rid": "SV-33228r1_rule",
        "stig_id": "WA00555 A22",
        "fix_id": "F-29425r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\ngrep \"Listen\" /usr/local/apache2/conf/httpd.conf\n\nReview the results for the following  directive:   Listen\n\nFor any enabled Listen directives ensure they specify both an IP address and\nport number.\n\nIf the Listen directive is found with only an IP address, or only a port number\nspecified, this is finding.\nIf the IP address is all zeros (i.e. 0.0.0.0:80 or [::ffff:0.0.0.0]:80, this is\na finding.\nIf the Listen directive does not exist, this is a finding.",
        "fix": "Edit the httpd.conf file and set the \"Listen directive\" to\nlisten on a specific IP address and port. "
      },
      "code": "control \"V-26326\" do\n  title \"The web server must be configured to listen on a specific IP address\nand port.\"\n  desc  \"The Apache Listen directive specifies the IP addresses and port\nnumbers the Apache web server will listen for requests. Rather than be\nunrestricted to listen on all IP addresses available to the system, the\nspecific IP address or addresses intended must be explicitly specified.\nSpecifically a Listen directive with no IP address specified, or with an IP\naddress of zero’s should not be used. Having multiple interfaces on web servers\nis fairly common, and without explicit Listen directives, the web server is\nlikely to be listening on an inappropriate IP address / interface that were not\nintended for the web server. Single homed system with a single IP addressed are\nalso required to have an explicit IP address in the Listen directive, in case\nadditional interfaces are added to the system at a later date.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00555\"\n  tag \"gid\": \"V-26326\"\n  tag \"rid\": \"SV-33228r1_rule\"\n  tag \"stig_id\": \"WA00555 A22\"\n  tag \"fix_id\": \"F-29425r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\ngrep \\\"Listen\\\" /usr/local/apache2/conf/httpd.conf\n\nReview the results for the following  directive:   Listen\n\nFor any enabled Listen directives ensure they specify both an IP address and\nport number.\n\nIf the Listen directive is found with only an IP address, or only a port number\nspecified, this is finding.\nIf the IP address is all zeros (i.e. 0.0.0.0:80 or [::ffff:0.0.0.0]:80, this is\na finding.\nIf the Listen directive does not exist, this is a finding.\"\n  tag \"fix\": \"Edit the httpd.conf file and set the \\\"Listen directive\\\" to\nlisten on a specific IP address and port. \"\n\n  describe apache_conf(APACHE_CONF_FILE).Listen do\n    it { should_not cmp '0.0.0.0' }\n    it { should_not cmp '[::ffff:0.0.0.0]' }\n    it { should cmp /(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}):(\\d{1,5})/ }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26326.rb",
        "line": 7
      },
      "id": "V-26326"
    },
    {
      "title": "Automatic directory indexing must be disabled.",
      "desc": "To identify the type of web servers and versions software installed it\nis common for attackers to scan for icons or special content specific to the\nserver type and version. A simple request like\nhttp://example.com/icons/apache_pb2.png may tell the attacker that the server\nis Apache 2.2 as shown below. The many icons are used primary for auto\nindexing, which is recommended to be disabled.",
      "descriptions": {
        "default": "To identify the type of web servers and versions software installed it\nis common for attackers to scan for icons or special content specific to the\nserver type and version. A simple request like\nhttp://example.com/icons/apache_pb2.png may tell the attacker that the server\nis Apache 2.2 as shown below. The many icons are used primary for auto\nindexing, which is recommended to be disabled."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00515",
        "gid": "V-26368",
        "rid": "SV-33219r1_rule",
        "stig_id": "WA00515 A22",
        "fix_id": "F-29492r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M.\n\nThis will provide a list of all loaded modules. If autoindex_module is found,\nthis is a finding.",
        "fix": "Edit the httpd.conf file and remove autoindex_module."
      },
      "code": "control \"V-26368\" do\n  title \"Automatic directory indexing must be disabled.\"\n  desc  \"To identify the type of web servers and versions software installed it\nis common for attackers to scan for icons or special content specific to the\nserver type and version. A simple request like\nhttp://example.com/icons/apache_pb2.png may tell the attacker that the server\nis Apache 2.2 as shown below. The many icons are used primary for auto\nindexing, which is recommended to be disabled.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00515\"\n  tag \"gid\": \"V-26368\"\n  tag \"rid\": \"SV-33219r1_rule\"\n  tag \"stig_id\": \"WA00515 A22\"\n  tag \"fix_id\": \"F-29492r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M.\n\nThis will provide a list of all loaded modules. If autoindex_module is found,\nthis is a finding.\"\n  tag \"fix\": \"Edit the httpd.conf file and remove autoindex_module.\"\n\n  apache = command(\"httpd -M\").stdout.split\n\n  describe APACHE_UNAUTHORIZED_MODULES do\n    it { should_not be_in apache }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26368.rb",
        "line": 15
      },
      "id": "V-26368"
    },
    {
      "title": "Active software modules must be minimized.",
      "desc": "Modules are the source of Apache httpd servers core and dynamic\ncapabilities. Thus not every module available is needed for operation. Most\ninstallations only need a small subset of the modules available. By minimizing\nthe enabled modules to only those that are required, we reduce the number of\ndoors and have therefore reduced the attack surface of the web site. Likewise\nhaving fewer modules means less software that could have vulnerabilities.",
      "descriptions": {
        "default": "Modules are the source of Apache httpd servers core and dynamic\ncapabilities. Thus not every module available is needed for operation. Most\ninstallations only need a small subset of the modules available. By minimizing\nthe enabled modules to only those that are required, we reduce the number of\ndoors and have therefore reduced the attack surface of the web site. Likewise\nhaving fewer modules means less software that could have vulnerabilities."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00500",
        "gid": "V-26285",
        "rid": "SV-33215r1_rule",
        "stig_id": "WA00500 A22",
        "fix_id": "F-29389r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M\n\nThis will provide a list of the loaded modules. Validate that all displayed\nmodules are required for operations. If any module is not required for\noperation, this is a finding.\n\nNote:  The following modules are needed for basic web function and do not need\nto be reviewed:\n\ncore_module\nhttp_module\nso_module\nmpm_prefork_module",
        "fix": "Disable any modules that are not needed."
      },
      "code": "control \"V-26285\" do\n  title \"Active software modules must be minimized.\"\n  desc  \"Modules are the source of Apache httpd servers core and dynamic\ncapabilities. Thus not every module available is needed for operation. Most\ninstallations only need a small subset of the modules available. By minimizing\nthe enabled modules to only those that are required, we reduce the number of\ndoors and have therefore reduced the attack surface of the web site. Likewise\nhaving fewer modules means less software that could have vulnerabilities.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00500\"\n  tag \"gid\": \"V-26285\"\n  tag \"rid\": \"SV-33215r1_rule\"\n  tag \"stig_id\": \"WA00500 A22\"\n  tag \"fix_id\": \"F-29389r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\n/usr/local/Apache2.2/bin/httpd –M\n\nThis will provide a list of the loaded modules. Validate that all displayed\nmodules are required for operations. If any module is not required for\noperation, this is a finding.\n\nNote:  The following modules are needed for basic web function and do not need\nto be reviewed:\n\ncore_module\nhttp_module\nso_module\nmpm_prefork_module\"\n  tag \"fix\": \"Disable any modules that are not needed.\"\n\n  apache = command(\"httpd -M\").stdout.split\n\n  describe APACHE_AUTHORIZED_MODULES do\n    it { should be_in apache }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26285.rb",
        "line": 18
      },
      "id": "V-26285"
    },
    {
      "title": "A public web server, if hosted on the NIPRNet, must be isolated in an\naccredited DoD DMZ Extension.",
      "desc": "To minimize exposure of private assets to unnecessary risk by\nattackers, public web servers must be isolated from internal systems.  Public\nweb servers are by nature more vulnerable to attack from publically based\nsources, such as the public Internet. Once compromised, a public web server\nmight be used as a base for further attack on private resources, unless\nadditional layers of protection are implemented. Public web servers must be\nlocated in a DoD DMZ Extension, if hosted on the NIPRNet, with carefully\ncontrolled access. Failure to isolate resources in this way increase risk that\nprivate assets are exposed to attacks from public sources.",
      "descriptions": {
        "default": "To minimize exposure of private assets to unnecessary risk by\nattackers, public web servers must be isolated from internal systems.  Public\nweb servers are by nature more vulnerable to attack from publically based\nsources, such as the public Internet. Once compromised, a public web server\nmight be used as a base for further attack on private resources, unless\nadditional layers of protection are implemented. Public web servers must be\nlocated in a DoD DMZ Extension, if hosted on the NIPRNet, with carefully\ncontrolled access. Failure to isolate resources in this way increase risk that\nprivate assets are exposed to attacks from public sources."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA060",
        "gid": "V-2242",
        "rid": "SV-32932r2_rule",
        "stig_id": "WA060 A22",
        "fix_id": "F-29264r2_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": " Interview the SA or web administrator to see where the public\nweb server is logically located in the data center. Review the site’s network\ndiagram to see how the web server is connected to the LAN. Visually check the\nweb server hardware connections to see if it conforms to the site’s network\ndiagram.   An improperly located public web server is a potential threat to the\nentire network.  If the web server is not isolated in an accredited DoD DMZ\nExtension, this is a finding.",
        "fix": "Logically relocate the public web server to be isolated from\ninternal systems. In addition, ensure the public web server does not have\ntrusted connections with assets outside the confines of the demilitarized zone\n(DMZ) other than application and/or database servers that are a part of the\nsame system as the web server."
      },
      "code": "control \"V-2242\" do\n  title \"A public web server, if hosted on the NIPRNet, must be isolated in an\naccredited DoD DMZ Extension.\"\n  desc  \"To minimize exposure of private assets to unnecessary risk by\nattackers, public web servers must be isolated from internal systems.  Public\nweb servers are by nature more vulnerable to attack from publically based\nsources, such as the public Internet. Once compromised, a public web server\nmight be used as a base for further attack on private resources, unless\nadditional layers of protection are implemented. Public web servers must be\nlocated in a DoD DMZ Extension, if hosted on the NIPRNet, with carefully\ncontrolled access. Failure to isolate resources in this way increase risk that\nprivate assets are exposed to attacks from public sources.\"\n  impact 0.5\n  tag \"gtitle\": \"WA060\"\n  tag \"gid\": \"V-2242\"\n  tag \"rid\": \"SV-32932r2_rule\"\n  tag \"stig_id\": \"WA060 A22\"\n  tag \"fix_id\": \"F-29264r2_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \" Interview the SA or web administrator to see where the public\nweb server is logically located in the data center. Review the site’s network\ndiagram to see how the web server is connected to the LAN. Visually check the\nweb server hardware connections to see if it conforms to the site’s network\ndiagram.   An improperly located public web server is a potential threat to the\nentire network.  If the web server is not isolated in an accredited DoD DMZ\nExtension, this is a finding.\"\n  tag \"fix\": \"Logically relocate the public web server to be isolated from\ninternal systems. In addition, ensure the public web server does not have\ntrusted connections with assets outside the confines of the demilitarized zone\n(DMZ) other than application and/or database servers that are a part of the\nsame system as the web server.\"\n\n  only_if { false } # this will always skip\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2242.rb",
        "line": 1
      },
      "id": "V-2242"
    },
    {
      "title": "Administrators must be the only users allowed access to the directory\ntree, the shell, or other operating system functions and utilities.",
      "desc": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. This is in addition to the\nanonymous web user account. The resources to which these accounts have access\nmust also be closely monitored and controlled. Only the SA needs access to all\nthe system’s capabilities, while the web administrator and associated staff\nrequire access and control of the web content and web server configuration\nfiles. The anonymous web user account must not have access to system resources\nas that account could then control the server.",
      "descriptions": {
        "default": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. This is in addition to the\nanonymous web user account. The resources to which these accounts have access\nmust also be closely monitored and controlled. Only the SA needs access to all\nthe system’s capabilities, while the web administrator and associated staff\nrequire access and control of the web content and web server configuration\nfiles. The anonymous web user account must not have access to system resources\nas that account could then control the server."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "WG200",
        "gid": "V-2247",
        "rid": "SV-36456r2_rule",
        "stig_id": "WG200 A22",
        "fix_id": "F-26806r2_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "Obtain a list of the user accounts for the system, noting the\npriviledges for each account.\n\nVerify with the system administrator or the ISSO that all privileged accounts\nare mission essential and documented.\n\nVerify with the system administrator or the ISSO that all non-administrator\naccess to shell scripts and operating system functions are mission essential\nand documented.\n\nIf undocumented privileged accounts are found, this is a finding.\n\nIf undocumented access to shell scripts or operating system functions is found,\nthis is a finding.",
        "fix": "Ensure non-administrators are not allowed access to the directory\ntree, the shell, or other operating system functions and utilities."
      },
      "code": "control \"V-2247\" do\n  title \"Administrators must be the only users allowed access to the directory\ntree, the shell, or other operating system functions and utilities.\"\n  desc  \"As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. This is in addition to the\nanonymous web user account. The resources to which these accounts have access\nmust also be closely monitored and controlled. Only the SA needs access to all\nthe system’s capabilities, while the web administrator and associated staff\nrequire access and control of the web content and web server configuration\nfiles. The anonymous web user account must not have access to system resources\nas that account could then control the server.\"\n  impact 0.7\n  tag \"gtitle\": \"WG200\"\n  tag \"gid\": \"V-2247\"\n  tag \"rid\": \"SV-36456r2_rule\"\n  tag \"stig_id\": \"WG200 A22\"\n  tag \"fix_id\": \"F-26806r2_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"Obtain a list of the user accounts for the system, noting the\npriviledges for each account.\n\nVerify with the system administrator or the ISSO that all privileged accounts\nare mission essential and documented.\n\nVerify with the system administrator or the ISSO that all non-administrator\naccess to shell scripts and operating system functions are mission essential\nand documented.\n\nIf undocumented privileged accounts are found, this is a finding.\n\nIf undocumented access to shell scripts or operating system functions is found,\nthis is a finding.\"\n  tag \"fix\": \"Ensure non-administrators are not allowed access to the directory\ntree, the shell, or other operating system functions and utilities.\"\n\n  begin\n\n    authorized_sa_user_list = SYS_ADMIN.clone << APACHE_OWNER\n\n    describe users.shells(/bash/).usernames do\n      it { should be_in authorized_sa_user_list}\n    end\n\n    if users.shells(/bash/).usernames.empty?\n      describe \"Skip Message\" do\n        skip \"Skipped: no users found with shell acccess.\"\n      end\n    end\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2247.rb",
        "line": 13
      },
      "id": "V-2247"
    },
    {
      "title": "A private web server’s list of CAs in a trust hierarchy must lead to\nan authorized  DoD PKI Root CA.",
      "desc": "A PKI certificate is a digital identifier that establishes the\nidentity of an individual or a platform. A server that has a certificate\nprovides users with third-party confirmation of authenticity. Most web browsers\nperform server authentication automatically and the user is notified only if\nthe authentication fails. The authentication process between the server and the\nclient is performed using the SSL/TLS protocol. Digital certificates are\nauthenticated, issued, and managed by a trusted Certificate Authority (CA).\n\n    The use of a trusted certificate validation hierarchy is crucial to the\nability to control access to a site’s server and to prevent unauthorized\naccess. Only DoD-approved PKIs will be utilized.",
      "descriptions": {
        "default": "A PKI certificate is a digital identifier that establishes the\nidentity of an individual or a platform. A server that has a certificate\nprovides users with third-party confirmation of authenticity. Most web browsers\nperform server authentication automatically and the user is notified only if\nthe authentication fails. The authentication process between the server and the\nclient is performed using the SSL/TLS protocol. Digital certificates are\nauthenticated, issued, and managed by a trusted Certificate Authority (CA).\n\n    The use of a trusted certificate validation hierarchy is crucial to the\nability to control access to a site’s server and to prevent unauthorized\naccess. Only DoD-approved PKIs will be utilized."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG355",
        "gid": "V-13620",
        "rid": "SV-32936r1_rule",
        "stig_id": "WG355 A22",
        "fix_id": "F-29265r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Information Assurance Officer",
        "check": "Enter the following command:\n\nfind / -name ssl.conf  note the path of the file.\n\ngrep \"SSLCACertificateFile\" /path/of/ssl.conf\n\nReview the results to determine the path of the SSLCACertificateFile.\n\nmore /path/of/ca-bundle.crt\n\nExamine the contents of this file to determine if the trusted CAs are DoD\napproved. If the trusted CA that is used to authenticate users to the web site\ndoes not lead to an approved DoD CA, this is a finding.\n\nNOTE: There are non DoD roots that must be on the server in order for it to\nfunction. Some applications, such as anti-virus programs, require root CAs to\nfunction. DoD approved certificate can include the External Certificate\nAuthorities (ECA), if approved by the DAA. The PKE InstallRoot 3.06 System\nAdministrator Guide (SAG), dated 8 Jul 2008, contains a complete list of DoD,\nECA, and IECA CAs.",
        "fix": "Configure the web server’s trust store to trust only DoD-approved\nPKIs (e.g., DoD PKI, DoD ECA, and DoD-approved external partners)."
      },
      "code": "control \"V-13620\" do\n  title \"A private web server’s list of CAs in a trust hierarchy must lead to\nan authorized  DoD PKI Root CA.\"\n  desc  \"A PKI certificate is a digital identifier that establishes the\nidentity of an individual or a platform. A server that has a certificate\nprovides users with third-party confirmation of authenticity. Most web browsers\nperform server authentication automatically and the user is notified only if\nthe authentication fails. The authentication process between the server and the\nclient is performed using the SSL/TLS protocol. Digital certificates are\nauthenticated, issued, and managed by a trusted Certificate Authority (CA).\n\n    The use of a trusted certificate validation hierarchy is crucial to the\nability to control access to a site’s server and to prevent unauthorized\naccess. Only DoD-approved PKIs will be utilized.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WG355\"\n  tag \"gid\": \"V-13620\"\n  tag \"rid\": \"SV-32936r1_rule\"\n  tag \"stig_id\": \"WG355 A22\"\n  tag \"fix_id\": \"F-29265r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Information Assurance Officer\"\n  tag \"check\": \"Enter the following command:\n\nfind / -name ssl.conf  note the path of the file.\n\ngrep \\\"SSLCACertificateFile\\\" /path/of/ssl.conf\n\nReview the results to determine the path of the SSLCACertificateFile.\n\nmore /path/of/ca-bundle.crt\n\nExamine the contents of this file to determine if the trusted CAs are DoD\napproved. If the trusted CA that is used to authenticate users to the web site\ndoes not lead to an approved DoD CA, this is a finding.\n\nNOTE: There are non DoD roots that must be on the server in order for it to\nfunction. Some applications, such as anti-virus programs, require root CAs to\nfunction. DoD approved certificate can include the External Certificate\nAuthorities (ECA), if approved by the DAA. The PKE InstallRoot 3.06 System\nAdministrator Guide (SAG), dated 8 Jul 2008, contains a complete list of DoD,\nECA, and IECA CAs.\"\n  tag \"fix\": \"Configure the web server’s trust store to trust only DoD-approved\nPKIs (e.g., DoD PKI, DoD ECA, and DoD-approved external partners).\"\n\n  describe \"This test currently has no automated tests, you must check manually\" do\n    skip \"This check must be preformed manually\"\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13620.rb",
        "line": 1
      },
      "id": "V-13620"
    },
    {
      "title": "Installation of a compiler on production web server is prohibited.",
      "desc": "The presence of a compiler on a production server facilitates the\nmalicious user’s task of creating custom versions of programs and installing\nTrojan Horses or viruses. For example, the attacker’s code can be uploaded and\ncompiled on the server under attack.",
      "descriptions": {
        "default": "The presence of a compiler on a production server facilitates the\nmalicious user’s task of creating custom versions of programs and installing\nTrojan Horses or viruses. For example, the attacker’s code can be uploaded and\ncompiled on the server under attack."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG080",
        "gid": "V-2236",
        "rid": "SV-32956r3_rule",
        "stig_id": "WG080 A22",
        "fix_id": "F-29279r4_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Query the SA and the Web Manager to determine if a compiler is\npresent on the server.  If a compiler is present, this is a finding.\n\nNOTE:  If the web server is part of an application suite and a compiler is\nneeded for installation, patching, and upgrading of the suite or if the\ncompiler is embedded and can't be removed without breaking the suite, document\nthe installation of the compiler with the ISSO/ISSM and verify that the\ncompiler is restricted to administrative users only.  If documented and\nrestricted to administrative users, this is not a finding.\n",
        "fix": "Remove any compiler found on the production web server, but if\nthe compiler program is needed to patch or upgrade an application suite in a\nproduction environment or the compiler is embedded and will break the suite if\nremoved, document the compiler installation with the ISSO/ISSM and ensure that\nthe compiler is restricted to only administrative users."
      },
      "code": "control \"V-2236\" do\n  title \"Installation of a compiler on production web server is prohibited.\"\n  desc  \"The presence of a compiler on a production server facilitates the\nmalicious user’s task of creating custom versions of programs and installing\nTrojan Horses or viruses. For example, the attacker’s code can be uploaded and\ncompiled on the server under attack.\"\n  impact 0.5\n  tag \"gtitle\": \"WG080\"\n  tag \"gid\": \"V-2236\"\n  tag \"rid\": \"SV-32956r3_rule\"\n  tag \"stig_id\": \"WG080 A22\"\n  tag \"fix_id\": \"F-29279r4_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Query the SA and the Web Manager to determine if a compiler is\npresent on the server.  If a compiler is present, this is a finding.\n\nNOTE:  If the web server is part of an application suite and a compiler is\nneeded for installation, patching, and upgrading of the suite or if the\ncompiler is embedded and can't be removed without breaking the suite, document\nthe installation of the compiler with the ISSO/ISSM and verify that the\ncompiler is restricted to administrative users only.  If documented and\nrestricted to administrative users, this is not a finding.\n\"\n  tag \"fix\": \"Remove any compiler found on the production web server, but if\nthe compiler program is needed to patch or upgrade an application suite in a\nproduction environment or the compiler is embedded and will break the suite if\nremoved, document the compiler installation with the ISSO/ISSM and ensure that\nthe compiler is restricted to only administrative users.\"\n\n  begin\n    if inspec.os.family.eql?(\"redhat\")\n      compiler_list = command('yum search all compiler').stdout.scan(/^(\\S+)\\s:\\s/).flatten\n    elsif inspec.os.family.eql?(\"debian\")\n      compiler_list = command('apt-cache search compiler').stdout.scan(/^(\\S+)\\s-\\s/).flatten\n    end\n\n\n    compiler_list.each do |compiler|\n      describe package(compiler) do\n        it { should_not be_installed }\n      end\n    end\n\n    DISALLOWED_COMPILER_LIST.each do |compiler|\n      describe package(compiler) do\n        it { should_not be_installed }\n      end\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2236.rb",
        "line": 7
      },
      "id": "V-2236"
    },
    {
      "title": "MIME types for csh or sh shell programs must be disabled.",
      "desc": "Users must not be allowed to access the shell programs. Shell programs\nmight execute shell escapes and could then perform unauthorized activities that\ncould damage the security posture of the web server. A shell is a program that\nserves as the basic interface between the user and the operating system. In\nthis regard, there are shells that are security risks in the context of a web\nserver and shells that are unauthorized in the context of the Security Features\nUser's Guide.",
      "descriptions": {
        "default": "Users must not be allowed to access the shell programs. Shell programs\nmight execute shell escapes and could then perform unauthorized activities that\ncould damage the security posture of the web server. A shell is a program that\nserves as the basic interface between the user and the operating system. In\nthis regard, there are shells that are security risks in the context of a web\nserver and shells that are unauthorized in the context of the Security Features\nUser's Guide."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG370",
        "gid": "V-2225",
        "rid": "SV-36309r2_rule",
        "stig_id": "WG370 A22",
        "fix_id": "F-26772r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "Enter the following commands:\n\ngrep \"Action\" /usr/local/apache2/conf/httpd.conf grep \"AddHandler\"\n/usr/local/apache2/conf/httpd.conf\n\nIf either of these exist and they configure /bin/csh, or any other shell as a\nviewer for documents, this is a finding.",
        "fix": "Disable MIME types for csh or sh shell programs."
      },
      "code": "control \"V-2225\" do\n  title \"MIME types for csh or sh shell programs must be disabled.\"\n  desc  \"Users must not be allowed to access the shell programs. Shell programs\nmight execute shell escapes and could then perform unauthorized activities that\ncould damage the security posture of the web server. A shell is a program that\nserves as the basic interface between the user and the operating system. In\nthis regard, there are shells that are security risks in the context of a web\nserver and shells that are unauthorized in the context of the Security Features\nUser's Guide.\"\n  impact 0.5\n  tag \"gtitle\": \"WG370\"\n  tag \"gid\": \"V-2225\"\n  tag \"rid\": \"SV-36309r2_rule\"\n  tag \"stig_id\": \"WG370 A22\"\n  tag \"fix_id\": \"F-26772r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"Enter the following commands:\n\ngrep \\\"Action\\\" /usr/local/apache2/conf/httpd.conf grep \\\"AddHandler\\\"\n/usr/local/apache2/conf/httpd.conf\n\nIf either of these exist and they configure /bin/csh, or any other shell as a\nviewer for documents, this is a finding.\"\n  tag \"fix\": \"Disable MIME types for csh or sh shell programs.\"\n  \n  describe apache_conf('/etc/httpd/conf/httpd.conf') do\n    its('Action') { should_not match /\\/bin/ }\n    its('AddHandler') { should_not match /\\/bin/ }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2225.rb",
        "line": 19
      },
      "id": "V-2225"
    },
    {
      "title": "The URL-path name must be set to the file path name or the directory\npath name.",
      "desc": "The ScriptAlias directive controls which directories the Apache server\n\"sees\" as containing scripts.  If the directive uses a URL-path name that is\ndifferent than the actual file system path, the potential exists to expose the\nscript source code.",
      "descriptions": {
        "default": "The ScriptAlias directive controls which directories the Apache server\n\"sees\" as containing scripts.  If the directive uses a URL-path name that is\ndifferent than the actual file system path, the potential exists to expose the\nscript source code."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00560",
        "gid": "V-26327",
        "rid": "SV-33229r1_rule",
        "stig_id": "WA00560 A22",
        "fix_id": "F-29427r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\ngrep \"ScriptAlias\" /usr/local/apache2/conf/httpd.conf.\n\nIf any enabled ScriptAlias directive do not have matching URL-path and\nfile-path or directory-path entries, this is a finding.\n",
        "fix": "Edit the httpd.conf file and set the ScriptAlias URL-path and\nfile-path or directory-path entries."
      },
      "code": "control \"V-26327\" do\n  title \"The URL-path name must be set to the file path name or the directory\npath name.\"\n  desc  \"The ScriptAlias directive controls which directories the Apache server\n\\\"sees\\\" as containing scripts.  If the directive uses a URL-path name that is\ndifferent than the actual file system path, the potential exists to expose the\nscript source code.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00560\"\n  tag \"gid\": \"V-26327\"\n  tag \"rid\": \"SV-33229r1_rule\"\n  tag \"stig_id\": \"WA00560 A22\"\n  tag \"fix_id\": \"F-29427r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\ngrep \\\"ScriptAlias\\\" /usr/local/apache2/conf/httpd.conf.\n\nIf any enabled ScriptAlias directive do not have matching URL-path and\nfile-path or directory-path entries, this is a finding.\n\"\n  tag \"fix\": \"Edit the httpd.conf file and set the ScriptAlias URL-path and\nfile-path or directory-path entries.\"\n\n  entries = apache_conf('/etc/httpd/conf/httpd.conf').ScriptAlias\n  entries.each { |entry|\n    describe entry do\n      it { should match /\\/.+\\/\\s+\"\\/.+\\/\"/ }\n    end\n    url_path = command(\"echo #{entry} | awk '{print $1}'\").stdout.chomp\n    file_path = command(\"echo #{entry} | awk '{print $2}'\").stdout.chomp\n    describe file_path do\n      it { should match url_path }\n    end\n  } unless entries.nil?\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26327.rb",
        "line": 1
      },
      "id": "V-26327"
    },
    {
      "title": "The HTTP request header fields must be limited. ",
      "desc": "Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. This Apache directives limits the size of the various HTTP header\nsizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestFields directive allows the server administrator to modify\nthe limit on the number of request header fields allowed in an HTTP request. A\nserver needs this value to be larger than the number of fields that a normal\nclient request might include. The number of request header fields used by a\nclient rarely exceeds 20, but this may vary among different client\nimplementations, often depending upon the extent to which a user has configured\ntheir browser to support detailed content negotiation. Optional HTTP extensions\nare often expressed using request header fields.\n\n    This directive gives the server administrator greater control over abnormal\nclient request behavior, which may be useful for avoiding some forms of\ndenial-of-service attacks. The value should be increased if normal clients see\nan error response from the server that indicates too many fields were sent in\nthe request.",
      "descriptions": {
        "default": "Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. This Apache directives limits the size of the various HTTP header\nsizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestFields directive allows the server administrator to modify\nthe limit on the number of request header fields allowed in an HTTP request. A\nserver needs this value to be larger than the number of fields that a normal\nclient request might include. The number of request header fields used by a\nclient rarely exceeds 20, but this may vary among different client\nimplementations, often depending upon the extent to which a user has configured\ntheir browser to support detailed content negotiation. Optional HTTP extensions\nare often expressed using request header fields.\n\n    This directive gives the server administrator greater control over abnormal\nclient request behavior, which may be useful for avoiding some forms of\ndenial-of-service attacks. The value should be increased if normal clients see\nan error response from the server that indicates too many fields were sent in\nthe request."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA062",
        "gid": "V-13737",
        "rid": "SV-32757r1_rule",
        "stig_id": "WA000-WWA062 A22",
        "fix_id": "F-29252r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the LimitRequestFields value enter the following\ncommand:\n\ngrep \"LimitRequestFields\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value of LimitRequestFields is not set to a value greater than 0, this\nis a finding.\n",
        "fix": "Edit the httpd.conf file and set LimitRequestFields Directive to\na value greater than 0. "
      },
      "code": "control \"V-13737\" do\n  title \"The HTTP request header fields must be limited. \"\n  desc  \"Buffer overflow attacks are carried out by a malicious attacker\nsending amounts of data that the web server cannot store in a given size\nbuffer. The eventual overflow of this buffer can overwrite system memory.\nSubsequently an attacker may be able to elevate privileges and take control of\nthe server. This Apache directives limits the size of the various HTTP header\nsizes thereby limiting the chances for a buffer overflow.\n\n    The LimitRequestFields directive allows the server administrator to modify\nthe limit on the number of request header fields allowed in an HTTP request. A\nserver needs this value to be larger than the number of fields that a normal\nclient request might include. The number of request header fields used by a\nclient rarely exceeds 20, but this may vary among different client\nimplementations, often depending upon the extent to which a user has configured\ntheir browser to support detailed content negotiation. Optional HTTP extensions\nare often expressed using request header fields.\n\n    This directive gives the server administrator greater control over abnormal\nclient request behavior, which may be useful for avoiding some forms of\ndenial-of-service attacks. The value should be increased if normal clients see\nan error response from the server that indicates too many fields were sent in\nthe request.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA062\"\n  tag \"gid\": \"V-13737\"\n  tag \"rid\": \"SV-32757r1_rule\"\n  tag \"stig_id\": \"WA000-WWA062 A22\"\n  tag \"fix_id\": \"F-29252r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the LimitRequestFields value enter the following\ncommand:\n\ngrep \\\"LimitRequestFields\\\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value of LimitRequestFields is not set to a value greater than 0, this\nis a finding.\n\"\n  tag \"fix\": \"Edit the httpd.conf file and set LimitRequestFields Directive to\na value greater than 0. \"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('LimitRequestFields') { should cmp > 0 }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13737.rb",
        "line": 7
      },
      "id": "V-13737"
    },
    {
      "title": "The httpd.conf MaxClients directive must be set properly.",
      "desc": "These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org: The MaxClients directive sets the limit on the number of\nsimultaneous requests that will be served. Any connection attempts over the\nMaxClients limit will normally be queued, up to a number based on the\nListenBacklog directive. Once a child process is freed at the end of a\ndifferent request, the connection will then be serviced.\n\n    For non-threaded servers (i.e., prefork), MaxClients translates into the\nmaximum number of child processes that will be launched to serve requests. The\ndefault value is 256; to increase it, you must also raise ServerLimit.\n\n    For threaded and hybrid servers (e.g. beos or worker) MaxClients restricts\nthe total number of threads that will be available to serve clients. The\ndefault value for beos is 50. For hybrid MPMs the default value is 16\n(ServerLimit) multiplied by the value of 25 (ThreadsPerChild). Therefore, to\nincrease MaxClients to a value that requires more than 16 processes, you must\nalso raise ServerLimit.",
      "descriptions": {
        "default": "These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org: The MaxClients directive sets the limit on the number of\nsimultaneous requests that will be served. Any connection attempts over the\nMaxClients limit will normally be queued, up to a number based on the\nListenBacklog directive. Once a child process is freed at the end of a\ndifferent request, the connection will then be serviced.\n\n    For non-threaded servers (i.e., prefork), MaxClients translates into the\nmaximum number of child processes that will be launched to serve requests. The\ndefault value is 256; to increase it, you must also raise ServerLimit.\n\n    For threaded and hybrid servers (e.g. beos or worker) MaxClients restricts\nthe total number of threads that will be available to serve clients. The\ndefault value for beos is 50. For hybrid MPMs the default value is 16\n(ServerLimit) multiplied by the value of 25 (ThreadsPerChild). Therefore, to\nincrease MaxClients to a value that requires more than 16 processes, you must\nalso raise ServerLimit."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA032",
        "gid": "V-13730",
        "rid": "SV-36649r2_rule",
        "stig_id": "WA000-WWA032 A22",
        "fix_id": "F-13178r3_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMaxClients\n\nThe value needs to be 256 or less\n\nIf the directive is set improperly, this is a finding.\n\nIf the directive does not exist, this is NOT a finding because it will default\nto 256.  It is recommended that the directive be explicitly set to prevent\nunexpected results if the defaults change with updated software.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for the use of increased value. If the site has\nthis documentation, this should be marked as Not a Finding.\n",
        "fix": "Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMaxClients\n\nSet the directive to a value of 256 or less, add the directive if it does not\nexist.\n\nIt is recommended that the directive be explicitly set to prevent unexpected\nresults if the defaults change with updated software.\n"
      },
      "code": "control \"V-13730\" do\n  title \"The httpd.conf MaxClients directive must be set properly.\"\n  desc  \"These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org: The MaxClients directive sets the limit on the number of\nsimultaneous requests that will be served. Any connection attempts over the\nMaxClients limit will normally be queued, up to a number based on the\nListenBacklog directive. Once a child process is freed at the end of a\ndifferent request, the connection will then be serviced.\n\n    For non-threaded servers (i.e., prefork), MaxClients translates into the\nmaximum number of child processes that will be launched to serve requests. The\ndefault value is 256; to increase it, you must also raise ServerLimit.\n\n    For threaded and hybrid servers (e.g. beos or worker) MaxClients restricts\nthe total number of threads that will be available to serve clients. The\ndefault value for beos is 50. For hybrid MPMs the default value is 16\n(ServerLimit) multiplied by the value of 25 (ThreadsPerChild). Therefore, to\nincrease MaxClients to a value that requires more than 16 processes, you must\nalso raise ServerLimit.\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA032\"\n  tag \"gid\": \"V-13730\"\n  tag \"rid\": \"SV-36649r2_rule\"\n  tag \"stig_id\": \"WA000-WWA032 A22\"\n  tag \"fix_id\": \"F-13178r3_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMaxClients\n\nThe value needs to be 256 or less\n\nIf the directive is set improperly, this is a finding.\n\nIf the directive does not exist, this is NOT a finding because it will default\nto 256.  It is recommended that the directive be explicitly set to prevent\nunexpected results if the defaults change with updated software.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for the use of increased value. If the site has\nthis documentation, this should be marked as Not a Finding.\n\"\n  tag \"fix\": \"Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMaxClients\n\nSet the directive to a value of 256 or less, add the directive if it does not\nexist.\n\nIt is recommended that the directive be explicitly set to prevent unexpected\nresults if the defaults change with updated software.\n\"\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('MaxClients') { should cmp <= 256 }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13730.rb",
        "line": 7
      },
      "id": "V-13730"
    },
    {
      "title": "Backup interactive scripts on the production web server are\nprohibited.",
      "desc": "Copies of backup files will not execute on the server, but they can be\nread by the anonymous user if special precautions are not taken. Such backup\ncopies contain the same sensitive information as the actual script being\nexecuted and, as such, are useful to malicious users. Techniques and systems\nexist today that search web servers for such files and are able to exploit the\ninformation contained in them.\n\n    Backup copies of files are automatically created by some text editors such\nas emacs and edit plus. The emacs editor will write a backup file with an\nextension ~ added to the name of the original file. The edit plus editor will\ncreate a .bak file. Of course, this would imply the presence and use of\ndevelopment tools on the web server, which is a finding under WG130. Having\nbackup scripts on the web server provides one more opportunity for malicious\npersons to view these scripts and use the information found in them.",
      "descriptions": {
        "default": "Copies of backup files will not execute on the server, but they can be\nread by the anonymous user if special precautions are not taken. Such backup\ncopies contain the same sensitive information as the actual script being\nexecuted and, as such, are useful to malicious users. Techniques and systems\nexist today that search web servers for such files and are able to exploit the\ninformation contained in them.\n\n    Backup copies of files are automatically created by some text editors such\nas emacs and edit plus. The emacs editor will write a backup file with an\nextension ~ added to the name of the original file. The edit plus editor will\ncreate a .bak file. Of course, this would imply the presence and use of\ndevelopment tools on the web server, which is a finding under WG130. Having\nbackup scripts on the web server provides one more opportunity for malicious\npersons to view these scripts and use the information found in them."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "gtitle": "WG420",
        "gid": "V-2230",
        "rid": "SV-6930r1_rule",
        "stig_id": "WG420 A22",
        "fix_id": "F-27282r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "This check is limited to CGI/interactive content and not static\nHTML.\n\nSearch for backup copies of CGI scripts on the web server or ask the SA or the\nWeb Administrator if they keep backup copies of CGI scripts on the web server.\n\nCommon backup file extensions are: *.bak, *.old, *.temp, *.tmp, *.backup,\n*.??0. This would also apply to .jsp files.\n\nUNIX:\nfind / name “*.bak” –print\nfind / name “*.*~” –print\nfind / name “*.old” –print\n\nIf files with these extensions are found in either the document directory or\nthe home directory of the web server, this is a finding.\n\nIf files with these extensions are stored in a repository (not in the document\nroot) as backups for the web server, this is a finding.\n\nIf files with these extensions have no relationship with web activity, such as\na backup batch file for operating system utility, and they are not accessible\nby the web application, this is not a finding.\n",
        "fix": "Ensure that CGI backup scripts are not left on the production web\nserver."
      },
      "code": "control \"V-2230\" do\n  title \"Backup interactive scripts on the production web server are\nprohibited.\"\n  desc  \"Copies of backup files will not execute on the server, but they can be\nread by the anonymous user if special precautions are not taken. Such backup\ncopies contain the same sensitive information as the actual script being\nexecuted and, as such, are useful to malicious users. Techniques and systems\nexist today that search web servers for such files and are able to exploit the\ninformation contained in them.\n\n    Backup copies of files are automatically created by some text editors such\nas emacs and edit plus. The emacs editor will write a backup file with an\nextension ~ added to the name of the original file. The edit plus editor will\ncreate a .bak file. Of course, this would imply the presence and use of\ndevelopment tools on the web server, which is a finding under WG130. Having\nbackup scripts on the web server provides one more opportunity for malicious\npersons to view these scripts and use the information found in them.\n\n  \"\n  impact 0.3\n  tag \"gtitle\": \"WG420\"\n  tag \"gid\": \"V-2230\"\n  tag \"rid\": \"SV-6930r1_rule\"\n  tag \"stig_id\": \"WG420 A22\"\n  tag \"fix_id\": \"F-27282r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"This check is limited to CGI/interactive content and not static\nHTML.\n\nSearch for backup copies of CGI scripts on the web server or ask the SA or the\nWeb Administrator if they keep backup copies of CGI scripts on the web server.\n\nCommon backup file extensions are: *.bak, *.old, *.temp, *.tmp, *.backup,\n*.??0. This would also apply to .jsp files.\n\nUNIX:\nfind / name “*.bak” –print\nfind / name “*.*~” –print\nfind / name “*.old” –print\n\nIf files with these extensions are found in either the document directory or\nthe home directory of the web server, this is a finding.\n\nIf files with these extensions are stored in a repository (not in the document\nroot) as backups for the web server, this is a finding.\n\nIf files with these extensions have no relationship with web activity, such as\na backup batch file for operating system utility, and they are not accessible\nby the web application, this is not a finding.\n\"\n  tag \"fix\": \"Ensure that CGI backup scripts are not left on the production web\nserver.\"\nbegin\n  dirs = ['/var/www', APACHE_BACKUP_REPOSITORY]\n\n  apache_conf_handle = apache_conf(APACHE_CONF_FILE)\n\n  dirs.each do |dir|\n    next unless directory(dir).exist?\n    describe \"List of backup NINGX and/or CGI scripts found in #{dir}\" do\n      subject { command(\"find #{dir} -name '.?*' -not-name '.ht*' -or-name '*~' -or-name '*.bak' -or-name '*.old*'\").stdout.chomp.split }\n      it { should be_empty }\n    end\n  end\nrescue Exception => msg\n  describe \"Exception: #{msg}\" do\n    it { should be_nil }\n  end\nend\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2230.rb",
        "line": 13
      },
      "id": "V-2230"
    },
    {
      "title": "All interactive programs must be placed in a designated directory with\nappropriate permissions.",
      "desc": "Directory options directives are directives that can be applied to\nfurther restrict access to file and directories.  The Options directive\ncontrols which server features are available in a particular directory. The\nExecCGI option controls the execution of CGI scripts using mod_cgi.  This needs\nto be restricted to only the directory intended for script execution.",
      "descriptions": {
        "default": "Directory options directives are directives that can be applied to\nfurther restrict access to file and directories.  The Options directive\ncontrols which server features are available in a particular directory. The\nExecCGI option controls the execution of CGI scripts using mod_cgi.  This needs\nto be restricted to only the directory intended for script execution."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA050",
        "gid": "V-13731",
        "rid": "SV-32763r1_rule",
        "stig_id": "WA000-WWA050 A22",
        "fix_id": "F-29240r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Search for the unnecessary CGI programs which may be found in\nthe directories configured with ScriptAlias, Script or other Script*\ndirectives. Often, CGI directories are named cgi-bin. Also, CGI AddHandler or\nSetHandler directives may also be in use for specific handlers such as perl,\npython and PHP.\n\nTo search the http.conf file for Options enter the following command:\n\ngrep \"Options\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value for Options is returned with a ExecCGI (no +) this is a finding.",
        "fix": "Locate any cgi-bin files and directories enabled in the Apache\nconfiguration via Script, ScriptAlias or other Script* directives.\n\nRemove the printenv default CGI in cgi-bin directory if it is installed.\n\nrm $APACHE_PREFIX/cgi-bin/printenv.\n\nRemove the test-cgi file from the cgi-bin directory if it is installed.\n\nrm $APACHE_PREFIX/cgi-bin/test-cgi.\n\nReview and remove any other cgi-bin files which are not needed for business\npurposes."
      },
      "code": "control \"V-13731\" do\n  title \"All interactive programs must be placed in a designated directory with\nappropriate permissions.\"\n  desc  \"Directory options directives are directives that can be applied to\nfurther restrict access to file and directories.  The Options directive\ncontrols which server features are available in a particular directory. The\nExecCGI option controls the execution of CGI scripts using mod_cgi.  This needs\nto be restricted to only the directory intended for script execution.\"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA050\"\n  tag \"gid\": \"V-13731\"\n  tag \"rid\": \"SV-32763r1_rule\"\n  tag \"stig_id\": \"WA000-WWA050 A22\"\n  tag \"fix_id\": \"F-29240r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Search for the unnecessary CGI programs which may be found in\nthe directories configured with ScriptAlias, Script or other Script*\ndirectives. Often, CGI directories are named cgi-bin. Also, CGI AddHandler or\nSetHandler directives may also be in use for specific handlers such as perl,\npython and PHP.\n\nTo search the http.conf file for Options enter the following command:\n\ngrep \\\"Options\\\" /usr/local/apache2/conf/httpd.conf.\n\nIf the value for Options is returned with a ExecCGI (no +) this is a finding.\"\n  tag \"fix\": \"Locate any cgi-bin files and directories enabled in the Apache\nconfiguration via Script, ScriptAlias or other Script* directives.\n\nRemove the printenv default CGI in cgi-bin directory if it is installed.\n\nrm $APACHE_PREFIX/cgi-bin/printenv.\n\nRemove the test-cgi file from the cgi-bin directory if it is installed.\n\nrm $APACHE_PREFIX/cgi-bin/test-cgi.\n\nReview and remove any other cgi-bin files which are not needed for business\npurposes.\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('Options') { should_not match /ExecCGI/i }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13731.rb",
        "line": 7
      },
      "id": "V-13731"
    },
    {
      "title": "The web server must not be configured as a proxy server.",
      "desc": "The Apache proxy modules allow the server to act as a proxy (either\nforward or reverse proxy) of http and other protocols with additional proxy\nmodules loaded. If the Apache installation is not intended to proxy requests to\nor from another network then the proxy module should not be loaded. Proxy\nservers can act as an important security control when properly configured,\nhowever a secure proxy server is not within the scope of this STIG. A web\nserver should be primarily a web server or a proxy server but not both, for the\nsame reasons that other multi-use servers are not recommended. Scanning for web\nservers that will also proxy requests is a very common attack, as proxy servers\nare useful for anonymizing attacks on other servers, or possibly proxying\nrequests into an otherwise protected network.",
      "descriptions": {
        "default": "The Apache proxy modules allow the server to act as a proxy (either\nforward or reverse proxy) of http and other protocols with additional proxy\nmodules loaded. If the Apache installation is not intended to proxy requests to\nor from another network then the proxy module should not be loaded. Proxy\nservers can act as an important security control when properly configured,\nhowever a secure proxy server is not within the scope of this STIG. A web\nserver should be primarily a web server or a proxy server but not both, for the\nsame reasons that other multi-use servers are not recommended. Scanning for web\nservers that will also proxy requests is a very common attack, as proxy servers\nare useful for anonymizing attacks on other servers, or possibly proxying\nrequests into an otherwise protected network."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00520",
        "gid": "V-26299",
        "rid": "SV-33220r2_rule",
        "stig_id": "WA00520 A22",
        "fix_id": "F-29398r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "If the Apache web server is only performing in a proxy server\nrole and does not host any websites nor support any applications, this check is\nNot Applicable.\nEnter the following command:\n/usr/local/Apache2.2/bin/httpd –M.\nThis will provide a list of all loaded modules. If any of the following modules\nare found this is a finding:\nproxy_module\nproxy_ajp_module\nproxy_balancer_module\nproxy_ftp_module\nproxy_http_module\nproxy_connect_module\n\nFix Text: Edit the httpd.conf file and remove the following modules:\n\nproxy_module\nproxy_ajp_module\nproxy_balancer_module\nproxy_ftp_module\nproxy_http_module\nproxy_connect_module\n",
        "fix": "Edit the httpd.conf file and remove the following modules:\n\nproxy_module\nproxy_ajp_module\nproxy_balancer_module\nproxy_ftp_module\nproxy_http_module\nproxy_connect_module"
      },
      "code": "control \"V-26299\" do\n  title \"The web server must not be configured as a proxy server.\"\n  desc  \"The Apache proxy modules allow the server to act as a proxy (either\nforward or reverse proxy) of http and other protocols with additional proxy\nmodules loaded. If the Apache installation is not intended to proxy requests to\nor from another network then the proxy module should not be loaded. Proxy\nservers can act as an important security control when properly configured,\nhowever a secure proxy server is not within the scope of this STIG. A web\nserver should be primarily a web server or a proxy server but not both, for the\nsame reasons that other multi-use servers are not recommended. Scanning for web\nservers that will also proxy requests is a very common attack, as proxy servers\nare useful for anonymizing attacks on other servers, or possibly proxying\nrequests into an otherwise protected network.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00520\"\n  tag \"gid\": \"V-26299\"\n  tag \"rid\": \"SV-33220r2_rule\"\n  tag \"stig_id\": \"WA00520 A22\"\n  tag \"fix_id\": \"F-29398r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"If the Apache web server is only performing in a proxy server\nrole and does not host any websites nor support any applications, this check is\nNot Applicable.\nEnter the following command:\n/usr/local/Apache2.2/bin/httpd –M.\nThis will provide a list of all loaded modules. If any of the following modules\nare found this is a finding:\nproxy_module\nproxy_ajp_module\nproxy_balancer_module\nproxy_ftp_module\nproxy_http_module\nproxy_connect_module\n\nFix Text: Edit the httpd.conf file and remove the following modules:\n\nproxy_module\nproxy_ajp_module\nproxy_balancer_module\nproxy_ftp_module\nproxy_http_module\nproxy_connect_module\n\"\n  tag \"fix\": \"Edit the httpd.conf file and remove the following modules:\n\nproxy_module\nproxy_ajp_module\nproxy_balancer_module\nproxy_ftp_module\nproxy_http_module\nproxy_connect_module\"\n\n  apache_loaded_modules = command(\"httpd -M\").stdout.split\n\n  describe APACHE_UNAUTHORIZED_MODULES do\n    it { should_not be_in apache_loaded_modules }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26299.rb",
        "line": 24
      },
      "id": "V-26299"
    },
    {
      "title": "The score board file must be properly secured.\n",
      "desc": "The ScoreBoardfile directive sets a file path which the server will\nuse for Inter-Process Communication (IPC) among the Apache processes.  If the\ndirective is specified, then Apache will use the configured file for the\ninter-process communication. Therefore if it is specified it needs to be\nlocated in a secure directory. If the ScoreBoardfile is placed in a writable\ndirectory, other accounts could create a denial of service attack and prevent\nthe server from starting by creating a file with the same name, and or users\ncould monitor and disrupt the communication between the processes by reading\nand writing to the file.",
      "descriptions": {
        "default": "The ScoreBoardfile directive sets a file path which the server will\nuse for Inter-Process Communication (IPC) among the Apache processes.  If the\ndirective is specified, then Apache will use the configured file for the\ninter-process communication. Therefore if it is specified it needs to be\nlocated in a secure directory. If the ScoreBoardfile is placed in a writable\ndirectory, other accounts could create a denial of service attack and prevent\nthe server from starting by creating a file with the same name, and or users\ncould monitor and disrupt the communication between the processes by reading\nand writing to the file."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00535",
        "gid": "V-26322",
        "rid": "SV-33223r1_rule",
        "stig_id": "WA00535 A22",
        "fix_id": "F-29415r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To determine the location of the file enter the following\ncommand:\n\nfind / -name ScoreBoard.\n\nTo view the permissions on the file enter the following command:\n\nls -lL /path/of/ScoreBoard.\n\nIf the permissions on the file are not set to 644 or less restrictive, this is\na finding. ",
        "fix": "The scoreboard file is created when the server starts, and is\ndeleted when it shuts down, set the permissions during the creation of the\nfile."
      },
      "code": "control \"V-26322\" do\n  title \"The score board file must be properly secured.\n\"\n  desc  \"The ScoreBoardfile directive sets a file path which the server will\nuse for Inter-Process Communication (IPC) among the Apache processes.  If the\ndirective is specified, then Apache will use the configured file for the\ninter-process communication. Therefore if it is specified it needs to be\nlocated in a secure directory. If the ScoreBoardfile is placed in a writable\ndirectory, other accounts could create a denial of service attack and prevent\nthe server from starting by creating a file with the same name, and or users\ncould monitor and disrupt the communication between the processes by reading\nand writing to the file.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00535\"\n  tag \"gid\": \"V-26322\"\n  tag \"rid\": \"SV-33223r1_rule\"\n  tag \"stig_id\": \"WA00535 A22\"\n  tag \"fix_id\": \"F-29415r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To determine the location of the file enter the following\ncommand:\n\nfind / -name ScoreBoard.\n\nTo view the permissions on the file enter the following command:\n\nls -lL /path/of/ScoreBoard.\n\nIf the permissions on the file are not set to 644 or less restrictive, this is\na finding. \"\n  tag \"fix\": \"The scoreboard file is created when the server starts, and is\ndeleted when it shuts down, set the permissions during the creation of the\nfile.\"\n\n  score_board = command('find / -type f -name ScoreBoard').stdout.strip\n  only_if do\n    file(score_board).exist?\n  end\n  describe file(score_board) do\n    its('mode') { should cmp <= 644 }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26322.rb",
        "line": 1
      },
      "id": "V-26322"
    },
    {
      "title": "Administrative users and groups that have access rights to the web\nserver must be documented.",
      "desc": "There are typically several individuals and groups that are involved\nin running a production web server.  These accounts must be restricted to only\nthose necessary to maintain web services, review the server’s operation, and\nthe operating system.  By minimizing the amount of user and group accounts on a\nweb server the total attack surface of the server is minimized.  Additionally,\nif the required accounts aren’t documented no known standard is created.\nWithout a known standard the ability to identify required accounts is\ndiminished, increasing the opportunity for error when such a standard is needed\n(i.e. COOP, IR, etc.).",
      "descriptions": {
        "default": "There are typically several individuals and groups that are involved\nin running a production web server.  These accounts must be restricted to only\nthose necessary to maintain web services, review the server’s operation, and\nthe operating system.  By minimizing the amount of user and group accounts on a\nweb server the total attack surface of the server is minimized.  Additionally,\nif the required accounts aren’t documented no known standard is created.\nWithout a known standard the ability to identify required accounts is\ndiminished, increasing the opportunity for error when such a standard is needed\n(i.e. COOP, IR, etc.)."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "gtitle": "WA120",
        "gid": "V-2257",
        "rid": "SV-32951r1_rule",
        "stig_id": "WA120 A22",
        "fix_id": "F-29275r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "Proposed Questions:\nHow many user accounts are associated with the Web server operation and\nmaintenance?\n\nWhere are these accounts documented?\n\nUse the command line utility more /etc/passwd to identify the accounts on the\nweb server.\n\nQuery the SA or Web Manager regarding the use of each account and each group.\n\nIf the documentation does not match the users and groups found on the server,\nthis is a finding.\n",
        "fix": "Document the administrative users and groups which have access\nrights to the web server in the web site SOP or in an equivalent document."
      },
      "code": "control \"V-2257\" do\n  title \"Administrative users and groups that have access rights to the web\nserver must be documented.\"\n  desc  \"There are typically several individuals and groups that are involved\nin running a production web server.  These accounts must be restricted to only\nthose necessary to maintain web services, review the server’s operation, and\nthe operating system.  By minimizing the amount of user and group accounts on a\nweb server the total attack surface of the server is minimized.  Additionally,\nif the required accounts aren’t documented no known standard is created.\nWithout a known standard the ability to identify required accounts is\ndiminished, increasing the opportunity for error when such a standard is needed\n(i.e. COOP, IR, etc.).\"\n  impact 0.3\n  tag \"gtitle\": \"WA120\"\n  tag \"gid\": \"V-2257\"\n  tag \"rid\": \"SV-32951r1_rule\"\n  tag \"stig_id\": \"WA120 A22\"\n  tag \"fix_id\": \"F-29275r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"Proposed Questions:\nHow many user accounts are associated with the Web server operation and\nmaintenance?\n\nWhere are these accounts documented?\n\nUse the command line utility more /etc/passwd to identify the accounts on the\nweb server.\n\nQuery the SA or Web Manager regarding the use of each account and each group.\n\nIf the documentation does not match the users and groups found on the server,\nthis is a finding.\n\"\n  tag \"fix\": \"Document the administrative users and groups which have access\nrights to the web server in the web site SOP or in an equivalent document.\"\n\n  describe \"This test currently has no automated tests, you must check manually\" do\n    skip \"This check must be preformed manually\"\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2257.rb",
        "line": 1
      },
      "id": "V-2257"
    },
    {
      "title": "HTTP request methods must be limited.",
      "desc": "The HTTP 1.1 protocol supports several request methods which are\nrarely used and potentially high risk. For example, methods such as PUT and\nDELETE are rarely used and should be disabled in keeping with the primary\nsecurity principal of minimize features and options. Also since the usage of\nthese methods is typically to modify resources on the web server, they should\nbe explicitly disallowed. For normal web server operation, you will typically\nneed to allow only the GET, HEAD and POST request methods. This will allow for\ndownloading of web pages and submitting information to web forms. The OPTIONS\nrequest method will also be allowed as it is used to request which HTTP request\nmethods are allowed.",
      "descriptions": {
        "default": "The HTTP 1.1 protocol supports several request methods which are\nrarely used and potentially high risk. For example, methods such as PUT and\nDELETE are rarely used and should be disabled in keeping with the primary\nsecurity principal of minimize features and options. Also since the usage of\nthese methods is typically to modify resources on the web server, they should\nbe explicitly disallowed. For normal web server operation, you will typically\nneed to allow only the GET, HEAD and POST request methods. This will allow for\ndownloading of web pages and submitting information to web forms. The OPTIONS\nrequest method will also be allowed as it is used to request which HTTP request\nmethods are allowed."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00565 ",
        "gid": "V-26396",
        "rid": "SV-33236r1_rule",
        "stig_id": "WA00565 A22",
        "fix_id": "F-29499r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\nmore /usr/local/apache2/conf/httpd.conf\n\nFor every enabled $Directory directive (except root), ensure the following\nentry exists:\n\nOrder allow,deny\n\n<LimitExcept GET POST OPTIONS>\nDeny from all\n</LimitExcept>\n\nIf the statement above is found in the root directory statement (i.e.\n<Directory />), this is a finding.\n\nIf the statement above is found enabled but without the appropriate LimitExcept\nor Order statement, this is a finding.\n\nIf the statement is not found inside an enabled $Directory directive, this is a\nfinding.\n\nNote: If the LimitExcept statement above is operationally limiting. This should\nbe explicitly documented with the Web Manager, at which point this can be\nconsidered not a finding.",
        "fix": "Edit the https.conf file and add the following entries for every\nenabled directory except root.\n\nOrder allow,deny\n\n<LimitExcept GET POST OPTIONS>\n     Deny from all\n</LimitExcept>\n"
      },
      "code": "control \"V-26396\" do\n  title \"HTTP request methods must be limited.\"\n  desc  \"The HTTP 1.1 protocol supports several request methods which are\nrarely used and potentially high risk. For example, methods such as PUT and\nDELETE are rarely used and should be disabled in keeping with the primary\nsecurity principal of minimize features and options. Also since the usage of\nthese methods is typically to modify resources on the web server, they should\nbe explicitly disallowed. For normal web server operation, you will typically\nneed to allow only the GET, HEAD and POST request methods. This will allow for\ndownloading of web pages and submitting information to web forms. The OPTIONS\nrequest method will also be allowed as it is used to request which HTTP request\nmethods are allowed.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00565 \"\n  tag \"gid\": \"V-26396\"\n  tag \"rid\": \"SV-33236r1_rule\"\n  tag \"stig_id\": \"WA00565 A22\"\n  tag \"fix_id\": \"F-29499r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\nmore /usr/local/apache2/conf/httpd.conf\n\nFor every enabled $Directory directive (except root), ensure the following\nentry exists:\n\nOrder allow,deny\n\n<LimitExcept GET POST OPTIONS>\nDeny from all\n</LimitExcept>\n\nIf the statement above is found in the root directory statement (i.e.\n<Directory />), this is a finding.\n\nIf the statement above is found enabled but without the appropriate LimitExcept\nor Order statement, this is a finding.\n\nIf the statement is not found inside an enabled $Directory directive, this is a\nfinding.\n\nNote: If the LimitExcept statement above is operationally limiting. This should\nbe explicitly documented with the Web Manager, at which point this can be\nconsidered not a finding.\"\n  tag \"fix\": \"Edit the https.conf file and add the following entries for every\nenabled directory except root.\n\nOrder allow,deny\n\n<LimitExcept GET POST OPTIONS>\n     Deny from all\n</LimitExcept>\n\"\n  describe command(\"awk '/<Directory \\\\/>/,/<\\\\/Directory>/' /etc/httpd/conf/httpd.conf\") do\n    its('stdout') { should_not match \"Order allow,deny\" }\n    # its('stdout') { should_not match /<LimitExcept GET POST OPTIONS>\\nDeny\\s+from\\s+all\\n<\\/LimitExcept>/ }\n  end\n  d = command(\"grep -i '^<Directory' /etc/httpd/conf/httpd.conf |grep -v 'Directory /'\").stdout\n  directories = []\n  directories = d.split(/\\n/)\n  directories.each { |dir|\n    val_dir = dir.gsub(/\\//, \"\\\\/\")\n\n    describe command(\"awk '/#{val_dir}/,/<\\\\/Directory>/' /etc/httpd/conf/httpd.conf\").stdout.split(\"\\n\").map(&:strip) do\n      it { should include \"Order allow,deny\" }\n      it { should include \"<LimitExcept GET POST OPTIONS>\" }\n      it { should include \"</LimitExcept>\" }\n      it { should include \"Deny from all\" }\n\n    end\n  }\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26396.rb",
        "line": 1
      },
      "id": "V-26396"
    },
    {
      "title": "The MultiViews directive must be disabled.",
      "desc": "Directory options directives are directives that can be applied to\nfurther restrict access to file and directories. MultiViews is a per-directory\noption, meaning it can be set with an Options directive within a $Directory,\n$Location or $Files section in httpd.conf, or (if AllowOverride is properly\nset) in .htaccess files. The effect of MultiViews is as follows: if the server\nreceives a request for /some/dir/foo, if /some/dir has MultiViews enabled, and\n/some/dir/foo does not exist, then the server reads the directory looking for\nfiles named foo.*, and effectively fakes up a type map which names all those\nfiles, assigning them the same media types and content-encodings it would have\nif the client had asked for one of them by name. It then chooses the best match\nto the client's requirements.",
      "descriptions": {
        "default": "Directory options directives are directives that can be applied to\nfurther restrict access to file and directories. MultiViews is a per-directory\noption, meaning it can be set with an Options directive within a $Directory,\n$Location or $Files section in httpd.conf, or (if AllowOverride is properly\nset) in .htaccess files. The effect of MultiViews is as follows: if the server\nreceives a request for /some/dir/foo, if /some/dir has MultiViews enabled, and\n/some/dir/foo does not exist, then the server reads the directory looking for\nfiles named foo.*, and effectively fakes up a type map which names all those\nfiles, assigning them the same media types and content-encodings it would have\nif the client had asked for one of them by name. It then chooses the best match\nto the client's requirements."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA056",
        "gid": "V-13734",
        "rid": "SV-32754r1_rule",
        "stig_id": "WA000-WWA056 A22",
        "fix_id": "F-29247r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the MultiViews value enter the following command:\n\ngrep \"MultiView\" /usr/local/apache2/conf/httpd.conf.\n\nReview all uncommented Options statements for the following value: -MultiViews\n\nIf the value is found on the Options statement, and it does not have a\npreceding ‘-‘, this is a finding.\n\nNotes:\n- If the value does NOT exist, this is a finding.\n- If all enabled Options statement are set to None this is not a finding.\n",
        "fix": "Edit the httpd.conf file and add the \"-\" to the MultiViews\nsetting, or set the options directive to None.\n"
      },
      "code": "control \"V-13734\" do\n  title \"The MultiViews directive must be disabled.\"\n  desc  \"Directory options directives are directives that can be applied to\nfurther restrict access to file and directories. MultiViews is a per-directory\noption, meaning it can be set with an Options directive within a $Directory,\n$Location or $Files section in httpd.conf, or (if AllowOverride is properly\nset) in .htaccess files. The effect of MultiViews is as follows: if the server\nreceives a request for /some/dir/foo, if /some/dir has MultiViews enabled, and\n/some/dir/foo does not exist, then the server reads the directory looking for\nfiles named foo.*, and effectively fakes up a type map which names all those\nfiles, assigning them the same media types and content-encodings it would have\nif the client had asked for one of them by name. It then chooses the best match\nto the client's requirements.\"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA056\"\n  tag \"gid\": \"V-13734\"\n  tag \"rid\": \"SV-32754r1_rule\"\n  tag \"stig_id\": \"WA000-WWA056 A22\"\n  tag \"fix_id\": \"F-29247r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the MultiViews value enter the following command:\n\ngrep \\\"MultiView\\\" /usr/local/apache2/conf/httpd.conf.\n\nReview all uncommented Options statements for the following value: -MultiViews\n\nIf the value is found on the Options statement, and it does not have a\npreceding ‘-‘, this is a finding.\n\nNotes:\n- If the value does NOT exist, this is a finding.\n- If all enabled Options statement are set to None this is not a finding.\n\"\n  tag \"fix\": \"Edit the httpd.conf file and add the \\\"-\\\" to the MultiViews\nsetting, or set the options directive to None.\n\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('Options') { should be_in APPROVED_OPTIONS }\n    its('Options') { should_not be_in UNAPPROVED_OPTIONS }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13734.rb",
        "line": 20
      },
      "id": "V-13734"
    },
    {
      "title": "The private web server must use an approved DoD certificate validation\nprocess.",
      "desc": "Without the use of a certificate validation process, the site is\nvulnerable to accepting certificates that have expired or have been revoked.\nThis would allow unauthorized individuals access to the web server.  This also\ndefeats the purpose of the multi-factor authentication provided by the PKI\nprocess.",
      "descriptions": {
        "default": "Without the use of a certificate validation process, the site is\nvulnerable to accepting certificates that have expired or have been revoked.\nThis would allow unauthorized individuals access to the web server.  This also\ndefeats the purpose of the multi-factor authentication provided by the PKI\nprocess."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG145",
        "gid": "V-13672",
        "rid": "SV-32954r2_rule",
        "stig_id": "WG145 A22",
        "fix_id": "F-29277r2_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "The reviewer should query the ISSO, the SA, the web\nadministrator, or developers as necessary to determine if the web server is\nconfigured to utilize an approved DoD certificate validation process.\n\nThe web administrator should be questioned to determine if a validation process\nis being utilized on the web server.\n\nTo validate this, the reviewer can ask the web administrator to describe the\nvalidation process being used. They should be able to identify either the use\nof certificate revocation lists (CRLs) or Online Certificate Status Protocol\n(OCSP).\n\nIf the production web server is accessible, the SA or the web administrator\nshould be able to demonstrate the validation of good certificates and the\nrejection of bad certificates.\n\nIf CRLs are being used, the SA should be able to identify how often the CRL is\nupdated and the location from which the CRL is downloaded.\n\nIf the web administrator cannot identify the type of validation process being\nused, this is a finding.",
        "fix": "Configure DoD Private Web Servers to conduct certificate\nrevocation checking utilizing certificate revocation lists (CRLs) or Online\nCertificate Status Protocol (OCSP)."
      },
      "code": "control \"V-13672\" do\n  title \"The private web server must use an approved DoD certificate validation\nprocess.\"\n  desc  \"Without the use of a certificate validation process, the site is\nvulnerable to accepting certificates that have expired or have been revoked.\nThis would allow unauthorized individuals access to the web server.  This also\ndefeats the purpose of the multi-factor authentication provided by the PKI\nprocess.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WG145\"\n  tag \"gid\": \"V-13672\"\n  tag \"rid\": \"SV-32954r2_rule\"\n  tag \"stig_id\": \"WG145 A22\"\n  tag \"fix_id\": \"F-29277r2_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"The reviewer should query the ISSO, the SA, the web\nadministrator, or developers as necessary to determine if the web server is\nconfigured to utilize an approved DoD certificate validation process.\n\nThe web administrator should be questioned to determine if a validation process\nis being utilized on the web server.\n\nTo validate this, the reviewer can ask the web administrator to describe the\nvalidation process being used. They should be able to identify either the use\nof certificate revocation lists (CRLs) or Online Certificate Status Protocol\n(OCSP).\n\nIf the production web server is accessible, the SA or the web administrator\nshould be able to demonstrate the validation of good certificates and the\nrejection of bad certificates.\n\nIf CRLs are being used, the SA should be able to identify how often the CRL is\nupdated and the location from which the CRL is downloaded.\n\nIf the web administrator cannot identify the type of validation process being\nused, this is a finding.\"\n  tag \"fix\": \"Configure DoD Private Web Servers to conduct certificate\nrevocation checking utilizing certificate revocation lists (CRLs) or Online\nCertificate Status Protocol (OCSP).\"\n\n  describe \"This test currently has no automated tests, you must check manually\" do\n    skip \"This check must be preformed manually\"\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13672.rb",
        "line": 1
      },
      "id": "V-13672"
    },
    {
      "title": "The httpd.conf StartServers directive must be set properly.",
      "desc": "These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org: The StartServers directive sets the number of child server\nprocesses created on startup. As the number of processes is dynamically\ncontrolled depending on the load, there is usually little reason to adjust this\nparameter.\n\n    The default value differs from MPM to MPM. For worker the default is\nStartServers 3. For prefork defaults to 5 and for mpmt_os2 to 2.",
      "descriptions": {
        "default": "These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org: The StartServers directive sets the number of child server\nprocesses created on startup. As the number of processes is dynamically\ncontrolled depending on the load, there is usually little reason to adjust this\nparameter.\n\n    The default value differs from MPM to MPM. For worker the default is\nStartServers 3. For prefork defaults to 5 and for mpmt_os2 to 2."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA026",
        "gid": "V-13727",
        "rid": "SV-36645r2_rule",
        "stig_id": "WA000-WWA026 A22",
        "fix_id": "F-13175r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Locate the Apache httpd.conf file.  If you cannot locate the\nfile, you can do a search of the drive to find the location of the file.\n\nOpen the httpd.conf file with an editor and search for the following directive:\n\nStartServers\n\nThe value needs to be between 5 and 10\n\nIf the directive is set improperly, this is a finding.\n\nIf the directive does not exist, this is NOT a finding because it will default\nto 5.  It is recommended that the directive be explicitly set to prevent\nunexpected results if the defaults change with updated software.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for the use of increased or decreased value. If\nthe site has this documentation, this should be marked as Not a Finding.\n",
        "fix": "Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nStartServer\n\nSet the directive to a value between 5 and 10, add the directive if it does not\nexist.\n\nIt is recommended that the directive be explicitly set to prevent unexpected\nresults if the defaults change with updated software.\n"
      },
      "code": "control \"V-13727\" do\n  title \"The httpd.conf StartServers directive must be set properly.\"\n  desc  \"These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org: The StartServers directive sets the number of child server\nprocesses created on startup. As the number of processes is dynamically\ncontrolled depending on the load, there is usually little reason to adjust this\nparameter.\n\n    The default value differs from MPM to MPM. For worker the default is\nStartServers 3. For prefork defaults to 5 and for mpmt_os2 to 2.\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA026\"\n  tag \"gid\": \"V-13727\"\n  tag \"rid\": \"SV-36645r2_rule\"\n  tag \"stig_id\": \"WA000-WWA026 A22\"\n  tag \"fix_id\": \"F-13175r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Locate the Apache httpd.conf file.  If you cannot locate the\nfile, you can do a search of the drive to find the location of the file.\n\nOpen the httpd.conf file with an editor and search for the following directive:\n\nStartServers\n\nThe value needs to be between 5 and 10\n\nIf the directive is set improperly, this is a finding.\n\nIf the directive does not exist, this is NOT a finding because it will default\nto 5.  It is recommended that the directive be explicitly set to prevent\nunexpected results if the defaults change with updated software.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for the use of increased or decreased value. If\nthe site has this documentation, this should be marked as Not a Finding.\n\"\n  tag \"fix\": \"Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nStartServer\n\nSet the directive to a value between 5 and 10, add the directive if it does not\nexist.\n\nIt is recommended that the directive be explicitly set to prevent unexpected\nresults if the defaults change with updated software.\n\"\n\nentries = apache_conf(APACHE_CONF_FILE).StartServers\nentries.each { |entry|\n  describe entry do\n    it { should cmp <= 10 }\n    it { should cmp >= 5 }\n  end\n} unless entries.nil?\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13727.rb",
        "line": 7
      },
      "id": "V-13727"
    },
    {
      "title": "Server side includes (SSIs) must run with execution capability\ndisabled.",
      "desc": "The Options directive configures the web server features that are\navailable in particular directories.  The IncludesNOEXEC feature controls the\nability of the server to utilize SSIs while disabling the exec command, which\nis used to execute external scripts.  If the full includes feature is used it\ncould allow the execution of malware leading to a system compromise.",
      "descriptions": {
        "default": "The Options directive configures the web server features that are\navailable in particular directories.  The IncludesNOEXEC feature controls the\nability of the server to utilize SSIs while disabling the exec command, which\nis used to execute external scripts.  If the full includes feature is used it\ncould allow the execution of malware leading to a system compromise."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA054",
        "gid": "V-13733",
        "rid": "SV-32753r1_rule",
        "stig_id": "WA000-WWA054 A22",
        "fix_id": "F-29246r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the Options value enter the following command:\n\ngrep \"Options\" /usr/local/apache2/conf/httpd.conf.\n\nReview all uncommented Options statements for the following values:\n\n+IncludesNoExec\n-IncludesNoExec\n-Includes\n\nIf these values don’t exist this is a finding.\n\nNotes:\n- If the value does NOT exist, this is a finding.\n- If all enabled Options statement are set to None this is not a finding.\n",
        "fix": "Edit the httpd.conf file and add one of the following to the\nenabled Options directive:\n\n+IncludesNoExec\n-IncludesNoExec\n-Includes\n\nRemove the ‘Includes’ or ‘+Includes’ setting from the options statement. "
      },
      "code": "control \"V-13733\" do\n  title \"Server side includes (SSIs) must run with execution capability\ndisabled.\"\n  desc  \"The Options directive configures the web server features that are\navailable in particular directories.  The IncludesNOEXEC feature controls the\nability of the server to utilize SSIs while disabling the exec command, which\nis used to execute external scripts.  If the full includes feature is used it\ncould allow the execution of malware leading to a system compromise. \"\n  impact 0.7\n  tag \"gtitle\": \"WA000-WWA054\"\n  tag \"gid\": \"V-13733\"\n  tag \"rid\": \"SV-32753r1_rule\"\n  tag \"stig_id\": \"WA000-WWA054 A22\"\n  tag \"fix_id\": \"F-29246r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the Options value enter the following command:\n\ngrep \\\"Options\\\" /usr/local/apache2/conf/httpd.conf.\n\nReview all uncommented Options statements for the following values:\n\n+IncludesNoExec\n-IncludesNoExec\n-Includes\n\nIf these values don’t exist this is a finding.\n\nNotes:\n- If the value does NOT exist, this is a finding.\n- If all enabled Options statement are set to None this is not a finding.\n\"\n  tag \"fix\": \"Edit the httpd.conf file and add one of the following to the\nenabled Options directive:\n\n+IncludesNoExec\n-IncludesNoExec\n-Includes\n\nRemove the ‘Includes’ or ‘+Includes’ setting from the options statement. \"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('Options') { should be_in APPROVED_OPTIONS }\n    its('Options') { should_not be_in UNAPPROVED_OPTIONS }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13733.rb",
        "line": 19
      },
      "id": "V-13733"
    },
    {
      "title": "The web server’s htpasswd files (if present) must reflect proper\nownership and permissions",
      "desc": "In addition to OS restrictions, access rights to files and directories\ncan be set on a web site using the web server software.  That is, in addition\nto allowing or denying all access rights, a rule can be specified that allows\nor denies partial access rights.  For example, users can be given read-only\naccess rights to files, to view the information but not change the files.\n\n    This check verifies that the htpasswd file is only accessible by system\nadministrators or web managers, with the account running the web service having\ngroup permissions of read and execute.  htpasswd is a utility used by Netscape\nand Apache to provide for password access to designated web sites.  I",
      "descriptions": {
        "default": "In addition to OS restrictions, access rights to files and directories\ncan be set on a web site using the web server software.  That is, in addition\nto allowing or denying all access rights, a rule can be specified that allows\nor denies partial access rights.  For example, users can be given read-only\naccess rights to files, to view the information but not change the files.\n\n    This check verifies that the htpasswd file is only accessible by system\nadministrators or web managers, with the account running the web service having\ngroup permissions of read and execute.  htpasswd is a utility used by Netscape\nand Apache to provide for password access to designated web sites.  I"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG270",
        "gid": "V-2255",
        "rid": "SV-36478r2_rule",
        "stig_id": "WG270 A22",
        "fix_id": "F-6758r2_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "To locate the htpasswd file enter the following command:\n\nFind / -name htpasswd\nPermissions should be r-x r - x - - - (550)\n\nIf permissions on htpasswd are greater than 550, this is a finding.\n\nOwner should be the SA or Web Manager account, if another account has access to\nthis file, this is a finding.\n",
        "fix": "The SA or Web Manager account should own the htpasswd file and\npermissions should be set to 550."
      },
      "code": "control \"V-2255\" do\n  title \"The web server’s htpasswd files (if present) must reflect proper\nownership and permissions\"\n  desc  \"In addition to OS restrictions, access rights to files and directories\ncan be set on a web site using the web server software.  That is, in addition\nto allowing or denying all access rights, a rule can be specified that allows\nor denies partial access rights.  For example, users can be given read-only\naccess rights to files, to view the information but not change the files.\n\n    This check verifies that the htpasswd file is only accessible by system\nadministrators or web managers, with the account running the web service having\ngroup permissions of read and execute.  htpasswd is a utility used by Netscape\nand Apache to provide for password access to designated web sites.  I\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WG270\"\n  tag \"gid\": \"V-2255\"\n  tag \"rid\": \"SV-36478r2_rule\"\n  tag \"stig_id\": \"WG270 A22\"\n  tag \"fix_id\": \"F-6758r2_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"To locate the htpasswd file enter the following command:\n\nFind / -name htpasswd\nPermissions should be r-x r - x - - - (550)\n\nIf permissions on htpasswd are greater than 550, this is a finding.\n\nOwner should be the SA or Web Manager account, if another account has access to\nthis file, this is a finding.\n\"\n  tag \"fix\": \"The SA or Web Manager account should own the htpasswd file and\npermissions should be set to 550.\"\n\n  begin\n\n    authorized_sa_user_list = SYS_ADMIN.clone << APACHE_OWNER\n    authorized_sa_group_list = SYS_ADMIN_GROUP.clone << APACHE_GROUP\n\n    htpasswd = command('find / -name .htpasswd').stdout.chomp\n    htpasswd.split.each do |htpwd|\n      describe file(htpwd) do\n        its('mode') { should cmp <= 0550 }\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n      end\n    end\n\n    if htpasswd.empty?\n      describe \"Skip Message\" do\n        skip \"Skipped: .htpasswd file not found\"\n      end\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2255.rb",
        "line": 31
      },
      "id": "V-2255"
    },
    {
      "title": "Public web server resources must not be shared with private assets.",
      "desc": "It is important to segregate public web server resources from private\nresources located behind the DoD DMZ in order to protect private assets. When\nfolders, drives or other resources are directly shared between the public web\nserver and private servers the intent of data and resource segregation can be\ncompromised.\n\n    In addition to the requirements of the DoD Internet-NIPRNet DMZ STIG that\nisolates inbound traffic from the external network to the internal network,\nresources such as printers, files, and folders/directories will not be shared\nbetween public web servers and assets located within the internal network.",
      "descriptions": {
        "default": "It is important to segregate public web server resources from private\nresources located behind the DoD DMZ in order to protect private assets. When\nfolders, drives or other resources are directly shared between the public web\nserver and private servers the intent of data and resource segregation can be\ncompromised.\n\n    In addition to the requirements of the DoD Internet-NIPRNet DMZ STIG that\nisolates inbound traffic from the external network to the internal network,\nresources such as printers, files, and folders/directories will not be shared\nbetween public web servers and assets located within the internal network."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG040",
        "gid": "V-2234",
        "rid": "SV-32957r1_rule",
        "stig_id": "WG040 A22",
        "fix_id": "F-29280r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Determine whether the public web server has a two-way trusted\nrelationship with any private asset located within the network. Private web\nserver resources (e.g., drives, folders, printers, etc.) will not be directly\nmapped to or shared with public web servers.\n\nIf sharing is selected for any web folder, this is a finding.\n\nThe following checks indicate inappropriate sharing of private resources with\nthe public web server:\n\nIf private resources (e.g., drives, partitions, folders/directories, printers,\netc.) are shared with the public web server, then this is a finding.\n",
        "fix": "Configure the public web server to not have a trusted\nrelationship with any system resource that is also not accessible to the\npublic. Web content is not to be shared via Microsoft shares or NFS mounts."
      },
      "code": "control \"V-2234\" do\n  title \"Public web server resources must not be shared with private assets.\"\n  desc  \"It is important to segregate public web server resources from private\nresources located behind the DoD DMZ in order to protect private assets. When\nfolders, drives or other resources are directly shared between the public web\nserver and private servers the intent of data and resource segregation can be\ncompromised.\n\n    In addition to the requirements of the DoD Internet-NIPRNet DMZ STIG that\nisolates inbound traffic from the external network to the internal network,\nresources such as printers, files, and folders/directories will not be shared\nbetween public web servers and assets located within the internal network.\n\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WG040\"\n  tag \"gid\": \"V-2234\"\n  tag \"rid\": \"SV-32957r1_rule\"\n  tag \"stig_id\": \"WG040 A22\"\n  tag \"fix_id\": \"F-29280r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Determine whether the public web server has a two-way trusted\nrelationship with any private asset located within the network. Private web\nserver resources (e.g., drives, folders, printers, etc.) will not be directly\nmapped to or shared with public web servers.\n\nIf sharing is selected for any web folder, this is a finding.\n\nThe following checks indicate inappropriate sharing of private resources with\nthe public web server:\n\nIf private resources (e.g., drives, partitions, folders/directories, printers,\netc.) are shared with the public web server, then this is a finding.\n\"\n  tag \"fix\": \"Configure the public web server to not have a trusted\nrelationship with any system resource that is also not accessible to the\npublic. Web content is not to be shared via Microsoft shares or NFS mounts.\"\n\n  describe \"This test currently has no automated tests, you must check manually\" do\n    skip \"This check must be preformed manually\"\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2234.rb",
        "line": 1
      },
      "id": "V-2234"
    },
    {
      "title": "The Timeout directive must be properly set.",
      "desc": "The Timeout requirements are set to mitigate the effects of several\ntypes of denial of service attacks. Although there is some latitude concerning\nthe settings themselves, the requirements attempt to provide reasonable limits\nfor the protection of the web server. If necessary, these limits can be\nadjusted to accommodate the operational requirement of a given system.",
      "descriptions": {
        "default": "The Timeout requirements are set to mitigate the effects of several\ntypes of denial of service attacks. Although there is some latitude concerning\nthe settings themselves, the requirements attempt to provide reasonable limits\nfor the protection of the web server. If necessary, these limits can be\nadjusted to accommodate the operational requirement of a given system."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA020",
        "gid": "V-13724",
        "rid": "SV-32977r1_rule",
        "stig_id": "WA000-WWA020 A22",
        "fix_id": "F-13172r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the Timeout value enter the following command:\n\ngrep \"Timeout\" /usr/local/apache2/conf/httpd.conf.\n\nVerify the value is 300 or less if not, this is a finding.\n\nNote:If the directive does not exist, this is not a finding because it will\ndefault to 300.  It is recommended that the directive be explicitly set to\nprevent unexpected results should the defaults for any reason be changed (i.e.\nsoftware update).\n",
        "fix": "Edit the httpd.conf file and set the value of \"Timeout\" to 300\nseconds or less."
      },
      "code": "control \"V-13724\" do\n  title \"The Timeout directive must be properly set.\"\n  desc  \"The Timeout requirements are set to mitigate the effects of several\ntypes of denial of service attacks. Although there is some latitude concerning\nthe settings themselves, the requirements attempt to provide reasonable limits\nfor the protection of the web server. If necessary, these limits can be\nadjusted to accommodate the operational requirement of a given system.\"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA020\"\n  tag \"gid\": \"V-13724\"\n  tag \"rid\": \"SV-32977r1_rule\"\n  tag \"stig_id\": \"WA000-WWA020 A22\"\n  tag \"fix_id\": \"F-13172r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the Timeout value enter the following command:\n\ngrep \\\"Timeout\\\" /usr/local/apache2/conf/httpd.conf.\n\nVerify the value is 300 or less if not, this is a finding.\n\nNote:If the directive does not exist, this is not a finding because it will\ndefault to 300.  It is recommended that the directive be explicitly set to\nprevent unexpected results should the defaults for any reason be changed (i.e.\nsoftware update).\n\"\n  tag \"fix\": \"Edit the httpd.conf file and set the value of \\\"Timeout\\\" to 300\nseconds or less.\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('Timeout') { should cmp '300' }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13724.rb",
        "line": 7
      },
      "id": "V-13724"
    },
    {
      "title": "The Web site software used with the web server must have all\napplicable security patches applied and documented.",
      "desc": "The IAVM process does not address all patches that have been\nidentified for the host operating system or, in this case, the web server\nsoftware environment. Many vendors have subscription services available to\nnotify users of known security threats. The site needs to be aware of these\nfixes and make determinations based on local policy and what software features\nare installed, if these patches need to be applied.\n\n    In some cases, patches also apply to middleware and database systems.\nMaintaining the security of web servers requires frequent reviews of security\nnotices. Many security notices mandate the installation of a software patch to\novercome security vulnerabilities.\n\n    SAs and ISSOs should regularly check the vendor support web site for\npatches and information related to the web server software. All applicable\nsecurity patches will be applied to the operating system and to the web server\nsoftware. Security patches are deemed applicable if the product is installed,\neven if it is not used or is disabled.",
      "descriptions": {
        "default": "The IAVM process does not address all patches that have been\nidentified for the host operating system or, in this case, the web server\nsoftware environment. Many vendors have subscription services available to\nnotify users of known security threats. The site needs to be aware of these\nfixes and make determinations based on local policy and what software features\nare installed, if these patches need to be applied.\n\n    In some cases, patches also apply to middleware and database systems.\nMaintaining the security of web servers requires frequent reviews of security\nnotices. Many security notices mandate the installation of a software patch to\novercome security vulnerabilities.\n\n    SAs and ISSOs should regularly check the vendor support web site for\npatches and information related to the web server software. All applicable\nsecurity patches will be applied to the operating system and to the web server\nsoftware. Security patches are deemed applicable if the product is installed,\neven if it is not used or is disabled."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA230",
        "gid": "V-13613",
        "rid": "SV-32969r2_rule",
        "stig_id": "WA230 A22",
        "fix_id": "F-29289r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Information Assurance Officer",
        "check": "Query the web administrator to determine if the site has a\ndetailed process as part of its configuration management plan to stay compliant\nwith all security-related patches.\n\nProposed Questions:\nHow does the SA stay current with web server vendor patches?\nHow is the SA notified when a new security patch is issued by the vendor?\n(Exclude the IAVM.)\nWhat is the process followed for applying patches to the web server?\n\nIf the site is not in compliance with all applicable security patches, this is\na finding.",
        "fix": "Establish a detailed process as part of the configuration\nmanagement plan to stay compliant with all web server security-related patches."
      },
      "code": "control \"V-13613\" do\n  title \"The Web site software used with the web server must have all\napplicable security patches applied and documented.\"\n  desc  \"The IAVM process does not address all patches that have been\nidentified for the host operating system or, in this case, the web server\nsoftware environment. Many vendors have subscription services available to\nnotify users of known security threats. The site needs to be aware of these\nfixes and make determinations based on local policy and what software features\nare installed, if these patches need to be applied.\n\n    In some cases, patches also apply to middleware and database systems.\nMaintaining the security of web servers requires frequent reviews of security\nnotices. Many security notices mandate the installation of a software patch to\novercome security vulnerabilities.\n\n    SAs and ISSOs should regularly check the vendor support web site for\npatches and information related to the web server software. All applicable\nsecurity patches will be applied to the operating system and to the web server\nsoftware. Security patches are deemed applicable if the product is installed,\neven if it is not used or is disabled.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WA230\"\n  tag \"gid\": \"V-13613\"\n  tag \"rid\": \"SV-32969r2_rule\"\n  tag \"stig_id\": \"WA230 A22\"\n  tag \"fix_id\": \"F-29289r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Information Assurance Officer\"\n  tag \"check\": \"Query the web administrator to determine if the site has a\ndetailed process as part of its configuration management plan to stay compliant\nwith all security-related patches.\n\nProposed Questions:\nHow does the SA stay current with web server vendor patches?\nHow is the SA notified when a new security patch is issued by the vendor?\n(Exclude the IAVM.)\nWhat is the process followed for applying patches to the web server?\n\nIf the site is not in compliance with all applicable security patches, this is\na finding.\"\n  tag \"fix\": \"Establish a detailed process as part of the configuration\nmanagement plan to stay compliant with all web server security-related patches.\"\n\n  describe \"This test currently has no automated tests, you must check manually\" do\n    skip \"This check must be preformed manually\"\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13613.rb",
        "line": 1
      },
      "id": "V-13613"
    },
    {
      "title": "The httpd.conf MaxSpareServers directive must be set properly. ",
      "desc": "These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org:The MaxSpareServers directive sets the desired maximum\nnumber of idle child server processes. An idle process is one which is not\nhandling a request. If there are more than MaxSpareServers idle, then the\nparent process will kill off the excess processes.\n\n    Tuning of this parameter should only be necessary on very busy sites.\nSetting this parameter to a large number is almost always a bad idea. If you\nare trying to set the value equal to or lower than MinSpareServers, Apache will\nautomatically adjust it to MinSpareServers + 1.",
      "descriptions": {
        "default": "These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org:The MaxSpareServers directive sets the desired maximum\nnumber of idle child server processes. An idle process is one which is not\nhandling a request. If there are more than MaxSpareServers idle, then the\nparent process will kill off the excess processes.\n\n    Tuning of this parameter should only be necessary on very busy sites.\nSetting this parameter to a large number is almost always a bad idea. If you\nare trying to set the value equal to or lower than MinSpareServers, Apache will\nautomatically adjust it to MinSpareServers + 1."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA030",
        "gid": "V-13729",
        "rid": "SV-36648r2_rule",
        "stig_id": "WA000-WWA030 A22",
        "fix_id": "F-13177r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMaxSpareServers\n\nThe value needs to be 10 or less\n\nIf the directive is set improperly, this is a finding.\n\nIf the directive is not found, you will need to review the httpd.conf file to\nsee if there are other .conf files that are included of \"linked\" to the\nhttpd.conf. The other conf files may contain these directives.\n\n\nIf the directive does not exist, this is NOT a finding because it will default\nto 10.  It is recommended that the directive be explicitly set to prevent\nunexpected results if the defaults change with updated software.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for the use of increased value. If the site has\nthis documentation, this should be marked as Not a Finding.\n",
        "fix": "Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMaxSpareServers\n\nSet the directive to a value of 10 or less, add the directive if it does not\nexist.\n\nIt is recommended that the directive be explicitly set to prevent unexpected\nresults if the defaults change with updated software.\n"
      },
      "code": "control \"V-13729\" do\n  title \"The httpd.conf MaxSpareServers directive must be set properly. \"\n  desc  \"These requirements are set to mitigate the effects of several types of\ndenial of service attacks. Although there is some latitude concerning the\nsettings themselves, the requirements attempt to provide reasonable limits for\nthe protection of the web server. If necessary, these limits can be adjusted to\naccommodate the operational requirement of a given system.\n\n    From Apache.org:The MaxSpareServers directive sets the desired maximum\nnumber of idle child server processes. An idle process is one which is not\nhandling a request. If there are more than MaxSpareServers idle, then the\nparent process will kill off the excess processes.\n\n    Tuning of this parameter should only be necessary on very busy sites.\nSetting this parameter to a large number is almost always a bad idea. If you\nare trying to set the value equal to or lower than MinSpareServers, Apache will\nautomatically adjust it to MinSpareServers + 1.\n  \"\n  impact 0.3\n  tag \"gtitle\": \"WA000-WWA030\"\n  tag \"gid\": \"V-13729\"\n  tag \"rid\": \"SV-36648r2_rule\"\n  tag \"stig_id\": \"WA000-WWA030 A22\"\n  tag \"fix_id\": \"F-13177r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMaxSpareServers\n\nThe value needs to be 10 or less\n\nIf the directive is set improperly, this is a finding.\n\nIf the directive is not found, you will need to review the httpd.conf file to\nsee if there are other .conf files that are included of \\\"linked\\\" to the\nhttpd.conf. The other conf files may contain these directives.\n\n\nIf the directive does not exist, this is NOT a finding because it will default\nto 10.  It is recommended that the directive be explicitly set to prevent\nunexpected results if the defaults change with updated software.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for the use of increased value. If the site has\nthis documentation, this should be marked as Not a Finding.\n\"\n  tag \"fix\": \"Open the httpd.conf file with an editor and search for the\nfollowing directive:\n\nMaxSpareServers\n\nSet the directive to a value of 10 or less, add the directive if it does not\nexist.\n\nIt is recommended that the directive be explicitly set to prevent unexpected\nresults if the defaults change with updated software.\n\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('MaxSpareServers') { should cmp <= 10 }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13729.rb",
        "line": 7
      },
      "id": "V-13729"
    },
    {
      "title": "All web server documentation, sample code, example applications, and\ntutorials must be removed from a production web server.",
      "desc": "Web server documentation, sample code, example applications, and\ntutorials may be an exploitable threat to a web server. A production web server\nmay only contain components that are operationally necessary (e.g., compiled\ncode, scripts, web-content, etc.). Delete all directories that contain samples\nand any scripts used to execute the samples. If there is a requirement to\nmaintain these directories at the site on non-production servers for training\npurposes, have NTFS permissions set to only allow access to authorized users\n(i.e., web administrators and systems administrators). Sample applications or\nscripts have not been evaluated and approved for use and may introduce\nvulnerabilities to the system.",
      "descriptions": {
        "default": "Web server documentation, sample code, example applications, and\ntutorials may be an exploitable threat to a web server. A production web server\nmay only contain components that are operationally necessary (e.g., compiled\ncode, scripts, web-content, etc.). Delete all directories that contain samples\nand any scripts used to execute the samples. If there is a requirement to\nmaintain these directories at the site on non-production servers for training\npurposes, have NTFS permissions set to only allow access to authorized users\n(i.e., web administrators and systems administrators). Sample applications or\nscripts have not been evaluated and approved for use and may introduce\nvulnerabilities to the system."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "WG385",
        "gid": "V-13621",
        "rid": "SV-32933r1_rule",
        "stig_id": "WG385 A22",
        "fix_id": "F-29260r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "severity_override_guidance": "Any sample application or sample\nexecutable script found on the production web server will be a CAT I finding.\n\nAny web server documentation or sample file found on the production web server\nand accessible to web users or non-administrators will be a CAT III finding.\n\nAny web server documentation or sample file found on the production web server\nand accessible only to SAs or to web administrators is permissible and not a\nfinding.\n",
        "responsibility": "Information Assurance Officer",
        "check": "Query the SA to determine if all directories that contain\nsamples and any scripts used to execute the samples have been removed from the\nserver. Each web server has its own list of sample files. This may change with\nthe software versions, but the following are some examples of what to look for\n(This should not be the definitive list of sample files, but only an example of\nthe common samples that are provided with the associated web server. This list\nwill be updated as additional information is discovered.):\n\nls -Ll /usr/local/apache2/manual.\n\nIf there is a requirement to maintain these directories at the site for\ntraining or other such purposes, have permissions or set the permissions to\nonly allow access to authorized users. If any sample files are found on the web\nserver, this is a finding.",
        "fix": "Ensure sample code and documentation have been removed from the\nweb server."
      },
      "code": "control \"V-13621\" do\n  title \"All web server documentation, sample code, example applications, and\ntutorials must be removed from a production web server.\"\n  desc  \"Web server documentation, sample code, example applications, and\ntutorials may be an exploitable threat to a web server. A production web server\nmay only contain components that are operationally necessary (e.g., compiled\ncode, scripts, web-content, etc.). Delete all directories that contain samples\nand any scripts used to execute the samples. If there is a requirement to\nmaintain these directories at the site on non-production servers for training\npurposes, have NTFS permissions set to only allow access to authorized users\n(i.e., web administrators and systems administrators). Sample applications or\nscripts have not been evaluated and approved for use and may introduce\nvulnerabilities to the system.\"\n  impact 0.7\n  tag \"gtitle\": \"WG385\"\n  tag \"gid\": \"V-13621\"\n  tag \"rid\": \"SV-32933r1_rule\"\n  tag \"stig_id\": \"WG385 A22\"\n  tag \"fix_id\": \"F-29260r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"severity_override_guidance\": \"Any sample application or sample\nexecutable script found on the production web server will be a CAT I finding.\n\nAny web server documentation or sample file found on the production web server\nand accessible to web users or non-administrators will be a CAT III finding.\n\nAny web server documentation or sample file found on the production web server\nand accessible only to SAs or to web administrators is permissible and not a\nfinding.\n\"\n  tag \"responsibility\": \"Information Assurance Officer\"\n  tag \"check\": \"Query the SA to determine if all directories that contain\nsamples and any scripts used to execute the samples have been removed from the\nserver. Each web server has its own list of sample files. This may change with\nthe software versions, but the following are some examples of what to look for\n(This should not be the definitive list of sample files, but only an example of\nthe common samples that are provided with the associated web server. This list\nwill be updated as additional information is discovered.):\n\nls -Ll /usr/local/apache2/manual.\n\nIf there is a requirement to maintain these directories at the site for\ntraining or other such purposes, have permissions or set the permissions to\nonly allow access to authorized users. If any sample files are found on the web\nserver, this is a finding.\"\n  tag \"fix\": \"Ensure sample code and documentation have been removed from the\nweb server.\"\n\n  begin\n\n    authorized_sa_user_list = SYS_ADMIN.clone << APACHE_OWNER\n    authorized_sa_group_list = SYS_ADMIN_GROUP.clone << APACHE_GROUP\n\n    APACHE_DISALLOWED_FILE_LIST.each do |file|\n      describe file(file) do\n        it { should_not exist }\n      end\n    end\n\n    APACHE_EXCEPTION_FILES.each do |file|\n      describe file(file) do\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n        its('mode') { should cmp '640' }\n      end\n    end\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13621.rb",
        "line": 38
      },
      "id": "V-13621"
    },
    {
      "title": "The KeepAlive directive must be enabled.",
      "desc": "The KeepAlive extension to HTTP/1.0 and the persistent connection\nfeature of HTTP/1.1 provide long lived HTTP sessions which allow multiple\nrequests to be sent over the same connection. These requirements are set to\nmitigate the effects of several types of denial of service attacks. Although\nthere is some latitude concerning the settings themselves, the requirements\nattempt to provide reasonable limits for the protection of the web server. If\nnecessary, these limits can be adjusted to accommodate the operational\nrequirement of a given system.",
      "descriptions": {
        "default": "The KeepAlive extension to HTTP/1.0 and the persistent connection\nfeature of HTTP/1.1 provide long lived HTTP sessions which allow multiple\nrequests to be sent over the same connection. These requirements are set to\nmitigate the effects of several types of denial of service attacks. Although\nthere is some latitude concerning the settings themselves, the requirements\nattempt to provide reasonable limits for the protection of the web server. If\nnecessary, these limits can be adjusted to accommodate the operational\nrequirement of a given system."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA022",
        "gid": "V-13725",
        "rid": "SV-32844r2_rule",
        "stig_id": "WA000-WWA022 A22",
        "fix_id": "F-13173r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the KeepAlive value enter the following command:\n\ngrep \"KeepAlive\" /usr/local/apache2/conf/httpd.conf.\n\nVerify the Value of KeepAlive is set to “On” If not, this is a finding.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for not using persistent connections. If the site\nhas this documentation, this should be marked as Not a Finding.\n",
        "fix": "Edit the httpd.conf file and set the value of \"KeepAlive\" to\n\"On\""
      },
      "code": "control \"V-13725\" do\n  title \"The KeepAlive directive must be enabled.\"\n  desc  \"The KeepAlive extension to HTTP/1.0 and the persistent connection\nfeature of HTTP/1.1 provide long lived HTTP sessions which allow multiple\nrequests to be sent over the same connection. These requirements are set to\nmitigate the effects of several types of denial of service attacks. Although\nthere is some latitude concerning the settings themselves, the requirements\nattempt to provide reasonable limits for the protection of the web server. If\nnecessary, these limits can be adjusted to accommodate the operational\nrequirement of a given system.\"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA022\"\n  tag \"gid\": \"V-13725\"\n  tag \"rid\": \"SV-32844r2_rule\"\n  tag \"stig_id\": \"WA000-WWA022 A22\"\n  tag \"fix_id\": \"F-13173r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the KeepAlive value enter the following command:\n\ngrep \\\"KeepAlive\\\" /usr/local/apache2/conf/httpd.conf.\n\nVerify the Value of KeepAlive is set to “On” If not, this is a finding.\n\nNOTE: This vulnerability can be documented locally with the ISSM/ISSO if the\nsite has operational reasons for not using persistent connections. If the site\nhas this documentation, this should be marked as Not a Finding.\n\"\n  tag \"fix\": \"Edit the httpd.conf file and set the value of \\\"KeepAlive\\\" to\n\\\"On\\\"\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('KeepAlive') { should cmp 'On' }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13725.rb",
        "line": 7
      },
      "id": "V-13725"
    },
    {
      "title": "The \"–FollowSymLinks” setting must be disabled.\n\n",
      "desc": "The Options directive configures the web server features that are\navailable in particular directories. The FollowSymLinks option controls the\nability of the server to follow symbolic links. A symbolic link allows a file\nor a directory to be referenced using a symbolic name raising a potential\nhazard if symbolic linkage is made to a sensitive area. When web scripts are\nexecuted and symbolic links are allowed, the web user could be allowed to\naccess locations on the web server that are outside the scope of the web\ndocument root or home directory.",
      "descriptions": {
        "default": "The Options directive configures the web server features that are\navailable in particular directories. The FollowSymLinks option controls the\nability of the server to follow symbolic links. A symbolic link allows a file\nor a directory to be referenced using a symbolic name raising a potential\nhazard if symbolic linkage is made to a sensitive area. When web scripts are\nexecuted and symbolic links are allowed, the web user could be allowed to\naccess locations on the web server that are outside the scope of the web\ndocument root or home directory."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA000-WWA052",
        "gid": "V-13732",
        "rid": "SV-40129r1_rule",
        "stig_id": "WA000-WWA052 A22",
        "fix_id": "F-34186r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "To view the Options value enter the following command:\n\ngrep \"Options\" /usr/local/apache2/conf/httpd.conf.\n\nReview all uncommented Options statements for the following value:\n-FollowSymLinks\n\nIf the value is found with an Options statement, and it does not have a\npreceding ‘-‘, this is a finding.\n\nNotes:\n- If the value does NOT exist, this is a finding.\n- If all enabled Options statement are set to None this is not a finding.",
        "fix": "Edit the httpd.conf file and set the value of \"FollowSymLinks\"\nto \"-FollowSymLinks\"."
      },
      "code": "control \"V-13732\" do\n  title \"The \\\"–FollowSymLinks” setting must be disabled.\n\n\"\n  desc  \"The Options directive configures the web server features that are\navailable in particular directories. The FollowSymLinks option controls the\nability of the server to follow symbolic links. A symbolic link allows a file\nor a directory to be referenced using a symbolic name raising a potential\nhazard if symbolic linkage is made to a sensitive area. When web scripts are\nexecuted and symbolic links are allowed, the web user could be allowed to\naccess locations on the web server that are outside the scope of the web\ndocument root or home directory.\"\n  impact 0.5\n  tag \"gtitle\": \"WA000-WWA052\"\n  tag \"gid\": \"V-13732\"\n  tag \"rid\": \"SV-40129r1_rule\"\n  tag \"stig_id\": \"WA000-WWA052 A22\"\n  tag \"fix_id\": \"F-34186r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"To view the Options value enter the following command:\n\ngrep \\\"Options\\\" /usr/local/apache2/conf/httpd.conf.\n\nReview all uncommented Options statements for the following value:\n-FollowSymLinks\n\nIf the value is found with an Options statement, and it does not have a\npreceding ‘-‘, this is a finding.\n\nNotes:\n- If the value does NOT exist, this is a finding.\n- If all enabled Options statement are set to None this is not a finding.\"\n  tag \"fix\": \"Edit the httpd.conf file and set the value of \\\"FollowSymLinks\\\"\nto \\\"-FollowSymLinks\\\".\"\n\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('Options') { should be_in APPROVED_OPTIONS }\n    its('Options') { should_not be_in UNAPPROVED_OPTIONS }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-13732.rb",
        "line": 19
      },
      "id": "V-13732"
    },
    {
      "title": "The web server must remove all export ciphers from the cipher suite.",
      "desc": "During the initial setup of a Transport Layer Security (TLS)\nconnection to the web server, the client sends a list of supported cipher\nsuites in order of preference.  The web server will reply with the cipher suite\nit will use for communication from the client list.  If an attacker can\nintercept the submission of cipher suites to the web server and place, as the\npreferred cipher suite, a weak export suite, the encryption used for the\nsession becomes easy for the attacker to break, often within minutes to hours.",
      "descriptions": {
        "default": "During the initial setup of a Transport Layer Security (TLS)\nconnection to the web server, the client sends a list of supported cipher\nsuites in order of preference.  The web server will reply with the cipher suite\nit will use for communication from the client list.  If an attacker can\nintercept the submission of cipher suites to the web server and place, as the\npreferred cipher suite, a weak export suite, the encryption used for the\nsession becomes easy for the attacker to break, often within minutes to hours."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG345",
        "gid": "V-60707",
        "rid": "SV-75159r1_rule",
        "stig_id": "WG345 A22",
        "fix_id": "F-66387r2_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Locate the Apache httpd.conf and ssl.conf file if available.\nOpen the httpd.conf and ssl.conf file with an editor and search for the\nfollowing uncommented directive: SSLCipherSuite\nFor all enabled SSLCipherSuite directives, ensure the cipher specification\nstring contains the kill cipher from list option for all export cipher suites,\ni.e., !EXPORT, which may be abbreviated !EXP.  If the SSLCipherSuite directive\ndoes not contain !EXPORT or there are no enabled SSLCipherSuite directives,\nthis is a finding.\n",
        "fix": "Update the cipher specification string for all enabled\nSSLCipherSuite directives to include !EXPORT."
      },
      "code": "control \"V-60707\" do\n  title \"The web server must remove all export ciphers from the cipher suite.\"\n  desc  \"During the initial setup of a Transport Layer Security (TLS)\nconnection to the web server, the client sends a list of supported cipher\nsuites in order of preference.  The web server will reply with the cipher suite\nit will use for communication from the client list.  If an attacker can\nintercept the submission of cipher suites to the web server and place, as the\npreferred cipher suite, a weak export suite, the encryption used for the\nsession becomes easy for the attacker to break, often within minutes to hours.\"\n  impact 0.5\n  tag \"gtitle\": \"WG345\"\n  tag \"gid\": \"V-60707\"\n  tag \"rid\": \"SV-75159r1_rule\"\n  tag \"stig_id\": \"WG345 A22\"\n  tag \"fix_id\": \"F-66387r2_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Locate the Apache httpd.conf and ssl.conf file if available.\nOpen the httpd.conf and ssl.conf file with an editor and search for the\nfollowing uncommented directive: SSLCipherSuite\nFor all enabled SSLCipherSuite directives, ensure the cipher specification\nstring contains the kill cipher from list option for all export cipher suites,\ni.e., !EXPORT, which may be abbreviated !EXP.  If the SSLCipherSuite directive\ndoes not contain !EXPORT or there are no enabled SSLCipherSuite directives,\nthis is a finding.\n\"\n  tag \"fix\": \"Update the cipher specification string for all enabled\nSSLCipherSuite directives to include !EXPORT.\"\n\n  describe apache_conf(APACHE_SSL_FILE) do\n    its('SSLCipherSuite') { should include /(!EXPORT|!EXP)/ }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-60707.rb",
        "line": 7
      },
      "id": "V-60707"
    },
    {
      "title": "Web server software must be a vendor-supported version.",
      "desc": "Many vulnerabilities are associated with older versions of web server\nsoftware. As hot fixes and patches are issued, these solutions are included in\nthe next version of the server software. Maintaining the web server at a\ncurrent version makes the efforts of a malicious user to exploit the web\nservice more difficult.",
      "descriptions": {
        "default": "Many vulnerabilities are associated with older versions of web server\nsoftware. As hot fixes and patches are issued, these solutions are included in\nthe next version of the server software. Maintaining the web server at a\ncurrent version makes the efforts of a malicious user to exploit the web\nservice more difficult."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "WG190",
        "gid": "V-2246",
        "rid": "SV-36441r2_rule",
        "stig_id": "WG190 A22",
        "fix_id": "F-2295r5_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "To determine the version of the Apache software that is running\non the system. Use the command:\n\nhttpd –v\n\nhttpd2 –v\n\nIf the version of Apache is not at the following version or higher, this is a\nfinding.\n\nApache httpd server version 2.2 - Release 2.2.31 (July 2015)\n\nNote: In some situations, the Apache software that is being used is supported\nby another vendor, such as Oracle in the case of the Oracle Application Server\nor IBMs HTTP Server.\nThe versions of the software in these cases may not match the above mentioned\nversion numbers. If the site can provide vendor documentation showing the\nversion of the web server is supported, this would not be a finding.\n",
        "fix": "Install the current version of the web server software and\nmaintain appropriate service packs and patches."
      },
      "code": "control \"V-2246\" do\n  title \"Web server software must be a vendor-supported version.\"\n  desc  \"Many vulnerabilities are associated with older versions of web server\nsoftware. As hot fixes and patches are issued, these solutions are included in\nthe next version of the server software. Maintaining the web server at a\ncurrent version makes the efforts of a malicious user to exploit the web\nservice more difficult.\"\n  impact 0.7\n  tag \"gtitle\": \"WG190\"\n  tag \"gid\": \"V-2246\"\n  tag \"rid\": \"SV-36441r2_rule\"\n  tag \"stig_id\": \"WG190 A22\"\n  tag \"fix_id\": \"F-2295r5_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"To determine the version of the Apache software that is running\non the system. Use the command:\n\nhttpd –v\n\nhttpd2 –v\n\nIf the version of Apache is not at the following version or higher, this is a\nfinding.\n\nApache httpd server version 2.2 - Release 2.2.31 (July 2015)\n\nNote: In some situations, the Apache software that is being used is supported\nby another vendor, such as Oracle in the case of the Oracle Application Server\nor IBMs HTTP Server.\nThe versions of the software in these cases may not match the above mentioned\nversion numbers. If the site can provide vendor documentation showing the\nversion of the web server is supported, this would not be a finding.\n\"\n  tag \"fix\": \"Install the current version of the web server software and\nmaintain appropriate service packs and patches.\"\n\n  begin\n    describe package('httpd') do\n      its('version') { should cmp >= '2.2.31' }\n    end\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2246.rb",
        "line": 14
      },
      "id": "V-2246"
    },
    {
      "title": "The access control files are owned by a privileged web server account.",
      "desc": "This check verifies that the key web server system configuration files\nare owned by the SA or Web Manager controlled account. These same files which\ncontrol the configuration of the web server, and thus its behavior, must also\nbe accessible by the account which runs the web service. If these files are\naltered by a malicious user, the web server would no longer be under the\ncontrol of its managers and owners; properties in the web server configuration\ncould be altered to compromise the entire server platform.",
      "descriptions": {
        "default": "This check verifies that the key web server system configuration files\nare owned by the SA or Web Manager controlled account. These same files which\ncontrol the configuration of the web server, and thus its behavior, must also\nbe accessible by the account which runs the web service. If these files are\naltered by a malicious user, the web server would no longer be under the\ncontrol of its managers and owners; properties in the web server configuration\ncould be altered to compromise the entire server platform."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG280",
        "gid": "V-2256",
        "rid": "SV-6880r1_rule",
        "stig_id": "WG280",
        "fix_id": "F-6761r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "This check verifies that the SA or Web Manager controlled\naccount owns the key web server files. These same files, which control the\nconfiguration of the web server, and thus its behavior, must also be accessible\nby the account that runs the web service process.\n\nIf it exists, the following file need to be owned by a privileged account.\n\n.htaccess\nhttpd.conf\n\nUse the command find / -name httpd.conf to find the file\nChange to the Directory that contains the httpd.conf file\nUse the command ls -l httpd.conf to determine ownership of the file\n\n-The Web Manager or the SA should own all the system files and directories.\n-The configurable directories can be owned by the WebManager or equivalent\nuser.\n\nPermissions on these files should be 660 or more restrictive.\n\nIf root or an authorized user does not own the web system files and the\npermission are not correct, this is a finding.",
        "fix": "The site needs to ensure that the owner should be the\nnon-privileged web server account or equivalent which runs the web service;\nhowever, the group permissions represent those of the user accessing the web\nsite that must execute the directives in .htacces."
      },
      "code": "control \"V-2256\" do\n  title \"The access control files are owned by a privileged web server account.\"\n  desc  \"This check verifies that the key web server system configuration files\nare owned by the SA or Web Manager controlled account. These same files which\ncontrol the configuration of the web server, and thus its behavior, must also\nbe accessible by the account which runs the web service. If these files are\naltered by a malicious user, the web server would no longer be under the\ncontrol of its managers and owners; properties in the web server configuration\ncould be altered to compromise the entire server platform.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WG280\"\n  tag \"gid\": \"V-2256\"\n  tag \"rid\": \"SV-6880r1_rule\"\n  tag \"stig_id\": \"WG280\"\n  tag \"fix_id\": \"F-6761r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"This check verifies that the SA or Web Manager controlled\naccount owns the key web server files. These same files, which control the\nconfiguration of the web server, and thus its behavior, must also be accessible\nby the account that runs the web service process.\n\nIf it exists, the following file need to be owned by a privileged account.\n\n.htaccess\nhttpd.conf\n\nUse the command find / -name httpd.conf to find the file\nChange to the Directory that contains the httpd.conf file\nUse the command ls -l httpd.conf to determine ownership of the file\n\n-The Web Manager or the SA should own all the system files and directories.\n-The configurable directories can be owned by the WebManager or equivalent\nuser.\n\nPermissions on these files should be 660 or more restrictive.\n\nIf root or an authorized user does not own the web system files and the\npermission are not correct, this is a finding.\"\n  tag \"fix\": \"The site needs to ensure that the owner should be the\nnon-privileged web server account or equivalent which runs the web service;\nhowever, the group permissions represent those of the user accessing the web\nsite that must execute the directives in .htacces.\"\n\n  begin\n    apache_conf_handle = apache_conf(APACHE_CONF_FILE)\n    authorized_sa_user_list = SYS_ADMIN.clone << APACHE_OWNER\n    authorized_sa_group_list = SYS_ADMIN_GROUP.clone << APACHE_GROUP\n    doc_root = apache_conf_handle.DocumentRoot.map{ |element| element.gsub(/\"/, '') }[0]\n\n    access_control_files = [ '.htaccess',\n                            '.htpasswd']\n\n    apache_conf_handle.params\n\n    describe apache_conf_handle do\n      its ('params') { should_not be_empty }\n    end\n\n    access_control_files.each do |file|\n      file_path = command(\"find / -name #{file}\").stdout.chomp\n\n      if file_path.empty?\n        describe \"Skip Message\" do\n          skip \"Skipped: Access control file #{file} not found\"\n        end\n      end\n\n      file_path.split.each do |file|\n        describe file(file) do\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n          its('mode')  { should cmp <= 0660 }\n        end\n      end\n    end\n\n    describe file(APACHE_CONF_FILE) do\n      its('owner') { should be_in authorized_sa_user_list }\n      its('group') { should be_in authorized_sa_group_list }\n      its('mode')  { should cmp <= 0660 }\n    end\n\n      describe file(doc_root) do\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n      end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2256.rb",
        "line": 31
      },
      "id": "V-2256"
    },
    {
      "title": "A web server must be segregated from other services.",
      "desc": "The web server installation and configuration plan should not support\nthe co-hosting of multiple services such as Domain Name Service (DNS), e-mail,\ndatabases, search engines, indexing, or streaming media on the same server that\nis providing the web publishing service.  By separating these services\nadditional defensive layers are established between the web service and the\napplicable application should either be compromised.\n\n    Disallowed or restricted services in the context of this vulnerability\napplies to services that are not directly associated with the delivery of web\ncontent. An operating system that supports a web server will not provide other\nservices (e.g., domain controller, e-mail server, database server, etc.). Only\nthose services necessary to support the web server and its hosted sites are\nspecifically allowed and may include, but are not limited to, operating system,\nlogging, anti-virus, host intrusion detection, administrative maintenance, or\nnetwork requirements.",
      "descriptions": {
        "default": "The web server installation and configuration plan should not support\nthe co-hosting of multiple services such as Domain Name Service (DNS), e-mail,\ndatabases, search engines, indexing, or streaming media on the same server that\nis providing the web publishing service.  By separating these services\nadditional defensive layers are established between the web service and the\napplicable application should either be compromised.\n\n    Disallowed or restricted services in the context of this vulnerability\napplies to services that are not directly associated with the delivery of web\ncontent. An operating system that supports a web server will not provide other\nservices (e.g., domain controller, e-mail server, database server, etc.). Only\nthose services necessary to support the web server and its hosted sites are\nspecifically allowed and may include, but are not limited to, operating system,\nlogging, anti-virus, host intrusion detection, administrative maintenance, or\nnetwork requirements."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG204",
        "gid": "V-6577",
        "rid": "SV-32950r1_rule",
        "stig_id": "WG204 A22",
        "fix_id": "F-29274r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Request a copy of and review the web server’s installation and\nconfiguration plan. Ensure that the server is in compliance with this plan. If\nthe server is not in compliance with the plan, this is a finding.\n\nQuery the SA to ascertain if and where the additional services are installed.\n\nConfirm that the additional service or application is not installed on the same\npartition as the operating systems root directory or the web document root. If\nit is, this is a finding.\n",
        "fix": "Move or install additional services and applications to\npartitions that are not the operating system root or the web document root.\n"
      },
      "code": "control \"V-6577\" do\n  title \"A web server must be segregated from other services.\"\n  desc  \"The web server installation and configuration plan should not support\nthe co-hosting of multiple services such as Domain Name Service (DNS), e-mail,\ndatabases, search engines, indexing, or streaming media on the same server that\nis providing the web publishing service.  By separating these services\nadditional defensive layers are established between the web service and the\napplicable application should either be compromised.\n\n    Disallowed or restricted services in the context of this vulnerability\napplies to services that are not directly associated with the delivery of web\ncontent. An operating system that supports a web server will not provide other\nservices (e.g., domain controller, e-mail server, database server, etc.). Only\nthose services necessary to support the web server and its hosted sites are\nspecifically allowed and may include, but are not limited to, operating system,\nlogging, anti-virus, host intrusion detection, administrative maintenance, or\nnetwork requirements.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WG204\"\n  tag \"gid\": \"V-6577\"\n  tag \"rid\": \"SV-32950r1_rule\"\n  tag \"stig_id\": \"WG204 A22\"\n  tag \"fix_id\": \"F-29274r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Request a copy of and review the web server’s installation and\nconfiguration plan. Ensure that the server is in compliance with this plan. If\nthe server is not in compliance with the plan, this is a finding.\n\nQuery the SA to ascertain if and where the additional services are installed.\n\nConfirm that the additional service or application is not installed on the same\npartition as the operating systems root directory or the web document root. If\nit is, this is a finding.\n\"\n  tag \"fix\": \"Move or install additional services and applications to\npartitions that are not the operating system root or the web document root.\n\"\n\n  describe \"This test currently has no automated tests, you must check manually\" do\n    skip \"This check must be preformed manually\"\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-6577.rb",
        "line": 1
      },
      "id": "V-6577"
    },
    {
      "title": "Web administration tools must be restricted to the web manager and the\nweb manager’s designees.",
      "desc": "All automated information systems are at risk of data loss due to\ndisaster or compromise. Failure to provide adequate protection to the\nadministration tools creates risk of potential theft or damage that may\nultimately compromise the mission.  Adequate protection ensures that server\nadministration operates with less risk of losses or operations outages.  The\nkey web service administrative and configuration tools must be accessible only\nby the authorized web server administrators. All users granted this authority\nmust be documented and approved by the ISSO. Access to the IIS Manager will be\nlimited to authorized users and administrators.",
      "descriptions": {
        "default": "All automated information systems are at risk of data loss due to\ndisaster or compromise. Failure to provide adequate protection to the\nadministration tools creates risk of potential theft or damage that may\nultimately compromise the mission.  Adequate protection ensures that server\nadministration operates with less risk of losses or operations outages.  The\nkey web service administrative and configuration tools must be accessible only\nby the authorized web server administrators. All users granted this authority\nmust be documented and approved by the ISSO. Access to the IIS Manager will be\nlimited to authorized users and administrators."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG220",
        "gid": "V-2248",
        "rid": "SV-32948r2_rule",
        "stig_id": "WG220 A22",
        "fix_id": "F-26807r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "Determine which tool or control file is used to control the\nconfiguration of the web server.\n\nIf the control of the web server is done via control files, verify who has\nupdate access to them. If tools are being used to configure the web server,\ndetermine who has access to execute the tools.\n\nIf accounts other than the SA, the web manager, or the web manager designees\nhave access to the web administration tool or control files, this is a finding.\n",
        "fix": "Restrict access to the web administration tool to only the web\nmanager and the web manager’s designees."
      },
      "code": "control \"V-2248\" do\n  title \"Web administration tools must be restricted to the web manager and the\nweb manager’s designees.\"\n  desc  \"All automated information systems are at risk of data loss due to\ndisaster or compromise. Failure to provide adequate protection to the\nadministration tools creates risk of potential theft or damage that may\nultimately compromise the mission.  Adequate protection ensures that server\nadministration operates with less risk of losses or operations outages.  The\nkey web service administrative and configuration tools must be accessible only\nby the authorized web server administrators. All users granted this authority\nmust be documented and approved by the ISSO. Access to the IIS Manager will be\nlimited to authorized users and administrators. \"\n  impact 0.5\n  tag \"gtitle\": \"WG220\"\n  tag \"gid\": \"V-2248\"\n  tag \"rid\": \"SV-32948r2_rule\"\n  tag \"stig_id\": \"WG220 A22\"\n  tag \"fix_id\": \"F-26807r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"Determine which tool or control file is used to control the\nconfiguration of the web server.\n\nIf the control of the web server is done via control files, verify who has\nupdate access to them. If tools are being used to configure the web server,\ndetermine who has access to execute the tools.\n\nIf accounts other than the SA, the web manager, or the web manager designees\nhave access to the web administration tool or control files, this is a finding.\n\"\n  tag \"fix\": \"Restrict access to the web administration tool to only the web\nmanager and the web manager’s designees.\"\n\n\n  begin\n\n    authorized_sa_user_list = SYS_ADMIN.clone << APACHE_OWNER\n    authorized_sa_group_list = SYS_ADMIN_GROUP.clone << APACHE_GROUP\n\n    apache_conf_handle = apache_conf(APACHE_CONF_FILE)\n    apache_conf_handle.params\n\n    describe apache_conf_handle do\n      its ('params') { should_not be_empty }\n    end\n\n    describe file(APACHE_CONF_FILE) do\n      its('owner') { should be_in authorized_sa_user_list }\n      its('group') { should be_in authorized_sa_group_list }\n      its('mode')  { should cmp <= 0660 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2248.rb",
        "line": 31
      },
      "id": "V-2248"
    },
    {
      "title": "A private web server must be located on a separate controlled access\nsubnet.",
      "desc": "Private web servers, which host sites that serve controlled access\ndata, must be protected from outside threats in addition to insider threats.\nInsider threat may be accidental or intentional but, in either case, can cause\na disruption in service of the web server. To protect the private web server\nfrom these threats, it must be located on a separate controlled access subnet\nand must not be a part of the public DMZ that houses the public web servers. It\nalso cannot be located inside the enclave as part of the local general\npopulation LAN.",
      "descriptions": {
        "default": "Private web servers, which host sites that serve controlled access\ndata, must be protected from outside threats in addition to insider threats.\nInsider threat may be accidental or intentional but, in either case, can cause\na disruption in service of the web server. To protect the private web server\nfrom these threats, it must be located on a separate controlled access subnet\nand must not be a part of the public DMZ that houses the public web servers. It\nalso cannot be located inside the enclave as part of the local general\npopulation LAN."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA070",
        "gid": "V-2243",
        "rid": "SV-32935r1_rule",
        "stig_id": "WA070 A22",
        "fix_id": "F-29263r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "System Administrator",
        "check": "Verify the site’s network diagram and visually check the web\nserver, to ensure that the private web server is located on a separate\ncontrolled access subnet and is not a part of the public DMZ that houses the\npublic web servers. In addition, the private web server needs to be isolated\nvia a controlled access mechanism from the local general population LAN.",
        "fix": "Isolate the private web server from the public DMZ and separate\nit from the internal general population LAN. "
      },
      "code": "control \"V-2243\" do\n  title \"A private web server must be located on a separate controlled access\nsubnet.\"\n  desc  \"Private web servers, which host sites that serve controlled access\ndata, must be protected from outside threats in addition to insider threats.\nInsider threat may be accidental or intentional but, in either case, can cause\na disruption in service of the web server. To protect the private web server\nfrom these threats, it must be located on a separate controlled access subnet\nand must not be a part of the public DMZ that houses the public web servers. It\nalso cannot be located inside the enclave as part of the local general\npopulation LAN.\"\n  impact 0.5\n  tag \"gtitle\": \"WA070\"\n  tag \"gid\": \"V-2243\"\n  tag \"rid\": \"SV-32935r1_rule\"\n  tag \"stig_id\": \"WA070 A22\"\n  tag \"fix_id\": \"F-29263r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"System Administrator\"\n  tag \"check\": \"Verify the site’s network diagram and visually check the web\nserver, to ensure that the private web server is located on a separate\ncontrolled access subnet and is not a part of the public DMZ that houses the\npublic web servers. In addition, the private web server needs to be isolated\nvia a controlled access mechanism from the local general population LAN.\"\n  tag \"fix\": \"Isolate the private web server from the public DMZ and separate\nit from the internal general population LAN. \"\n\nbegin\n  describe apache_conf(APACHE_CONF_FILE) do\n    its('Listen') { should cmp /(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}):(\\d{1,5})/ }\n  end\n\n  apache_httpd = apache_conf(APACHE_CONF_FILE)\n  server_ip = apache_httpd.Listen.join.split(':').first\n  server_ip = server_ip.eql?('localhost') ? '127.0.0.1' : server_ip\n\n  describe IPAddr.new(DMZ_SUBNET) === IPAddr.new(server_ip) do\n    it { should be false }\n  end unless (IPAddr.new(server_ip) rescue nil).nil?\n\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2243.rb",
        "line": 13
      },
      "id": "V-2243"
    },
    {
      "title": "Web server system files must conform to minimum file permission\nrequirements.",
      "desc": "This check verifies that the key web server system configuration files\nare owned by the SA or the web administrator controlled account. These same\nfiles that control the configuration of the web server, and thus its behavior,\nmust also be accessible by the account that runs the web service. If these\nfiles are altered by a malicious user, the web server would no longer be under\nthe control of its managers and owners; properties in the web server\nconfiguration could be altered to compromise the entire server platform.",
      "descriptions": {
        "default": "This check verifies that the key web server system configuration files\nare owned by the SA or the web administrator controlled account. These same\nfiles that control the configuration of the web server, and thus its behavior,\nmust also be accessible by the account that runs the web service. If these\nfiles are altered by a malicious user, the web server would no longer be under\nthe control of its managers and owners; properties in the web server\nconfiguration could be altered to compromise the entire server platform."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG300",
        "gid": "V-2259",
        "rid": "SV-32938r1_rule",
        "stig_id": "WG300 A22",
        "fix_id": "F-29268r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Apache directory and file permissions and ownership should be\nset per the following table.. The installation directories may vary from one\ninstallation to the next.  If used, the WebAmins group should contain only\naccounts of persons authorized to manage the web server configuration,\notherwise the root group should own all Apache files and directories.\n\nIf the files and directories are not set to the following permissions or more\nrestrictive, this is a finding.\n\nTo locate the ServerRoot directory enter the following command.\ngrep ^ ServerRoot /usr/local/apache2/conf/httpd.conf\n\n/Server\nroot dir\napache\t      root\tWebAdmin\t771/660\n\n/apache/cgi-bin    root\tWebAdmin\t775/775\n/apache/bin\t       root\tWebAdmin\t550/550\n/apache/config     root\tWebAdmin\t770/660\n/apache/htdocs    root\tWebAdmin\t775/664\n/apache/logs       root\tWebAdmin\t750/640\n\nNOTE:  The permissions are noted as directories / files",
        "fix": "Use the chmod command to set permissions on the web server system\ndirectories and files as follows.\n\nroot dir\napache\t      root\tWebAdmin\t771/660\n/apache/cgi-bin    root\tWebAdmin\t775/775\n/apache/bin\t       root\tWebAdmin\t550/550\n/apache/config     root\tWebAdmin\t770/660\n/apache/htdocs    root\tWebAdmin\t775/664\n/apache/logs       root\tWebAdmin\t750/640\n\n\n"
      },
      "code": "control \"V-2259\" do\n  title \"Web server system files must conform to minimum file permission\nrequirements.\"\n  desc  \"This check verifies that the key web server system configuration files\nare owned by the SA or the web administrator controlled account. These same\nfiles that control the configuration of the web server, and thus its behavior,\nmust also be accessible by the account that runs the web service. If these\nfiles are altered by a malicious user, the web server would no longer be under\nthe control of its managers and owners; properties in the web server\nconfiguration could be altered to compromise the entire server platform.\"\n  impact 0.5\n  tag \"gtitle\": \"WG300\"\n  tag \"gid\": \"V-2259\"\n  tag \"rid\": \"SV-32938r1_rule\"\n  tag \"stig_id\": \"WG300 A22\"\n  tag \"fix_id\": \"F-29268r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Apache directory and file permissions and ownership should be\nset per the following table.. The installation directories may vary from one\ninstallation to the next.  If used, the WebAmins group should contain only\naccounts of persons authorized to manage the web server configuration,\notherwise the root group should own all Apache files and directories.\n\nIf the files and directories are not set to the following permissions or more\nrestrictive, this is a finding.\n\nTo locate the ServerRoot directory enter the following command.\ngrep ^ ServerRoot /usr/local/apache2/conf/httpd.conf\n\n/Server\nroot dir\napache\\t      root\\tWebAdmin\\t771/660\n\n/apache/cgi-bin    root\\tWebAdmin\\t775/775\n/apache/bin\\t       root\\tWebAdmin\\t550/550\n/apache/config     root\\tWebAdmin\\t770/660\n/apache/htdocs    root\\tWebAdmin\\t775/664\n/apache/logs       root\\tWebAdmin\\t750/640\n\nNOTE:  The permissions are noted as directories / files\"\n  tag \"fix\": \"Use the chmod command to set permissions on the web server system\ndirectories and files as follows.\n\nroot dir\napache\\t      root\\tWebAdmin\\t771/660\n/apache/cgi-bin    root\\tWebAdmin\\t775/775\n/apache/bin\\t       root\\tWebAdmin\\t550/550\n/apache/config     root\\tWebAdmin\\t770/660\n/apache/htdocs    root\\tWebAdmin\\t775/664\n/apache/logs       root\\tWebAdmin\\t750/640\n\n\n\"\n  begin\n    authorized_sa_user_list = SYS_ADMIN.clone << APACHE_OWNER\n    authorized_sa_group_list = SYS_ADMIN_GROUP.clone << APACHE_GROUP\n\n    describe.one do\n      describe file('/usr/sbin/httpd') do\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n        its('mode') { should cmp <= 0550 }\n      end\n      describe file('/usr/sbin/httpd') do\n        it { should be_owned_by APACHE_OWNER }\n        its('group') { should cmp APACHE_GROUP }\n        its('mode') { should cmp <= 0550 }\n      end\n    end\n    describe.one do\n      describe file('/etc/httpd/') do\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n        its('mode') { should cmp <= 0770 }\n      end\n      describe file('/etc/httpd/') do\n        it { should be_owned_by APACHE_OWNER }\n        its('group') { should cmp APACHE_GROUP }\n        its('mode') { should cmp <= 0660 }\n      end\n    end\n    describe.one do\n      describe file('/etc/httpd/conf.d') do\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n        its('mode') { should cmp <= 0770 }\n      end\n      describe file('/etc/httpd/conf.d') do\n        it { should be_owned_by APACHE_OWNER }\n        its('group') { should cmp APACHE_GROUP }\n        its('mode') { should cmp <= 0660 }\n      end\n    end\n    describe.one do\n      describe file('/etc/httpd/modules') do\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n        its('mode') { should cmp <= 0770 }\n      end\n      describe file('/etc/httpd/modules') do\n        it { should be_owned_by APACHE_OWNER }\n        its('group') { should cmp APACHE_GROUP }\n        its('mode') { should cmp <= 0660 }\n      end\n    end\n    describe.one do\n      describe file('/var/www/cgi-bin/') do\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n        its('mode') { should cmp <= 1775 }\n      end\n      describe file('/var/www/cgi-bin/') do\n        it { should be_owned_by APACHE_OWNER }\n        its('group') { should cmp APACHE_GROUP }\n        its('mode') { should cmp <= 0664 }\n      end\n    end\n    describe.one do\n      describe file('/var/log/httpd') do\n        its('owner') { should be_in authorized_sa_user_list }\n        its('group') { should be_in authorized_sa_group_list }\n        its('mode') { should cmp <= 0750 }\n      end\n      describe file('/var/log/httpd') do\n        it { should be_owned_by APACHE_OWNER }\n        its('group') { should cmp APACHE_GROUP }\n        its('mode') { should cmp <= 0640 }\n      end\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2259.rb",
        "line": 31
      },
      "id": "V-2259"
    },
    {
      "title": "The ability to override the access configuration for the OS root\ndirectory must be disabled.",
      "desc": "The Apache OverRide directive allows for .htaccess files to be used to\noverride much of the configuration, including authentication, handling of\ndocument types, auto generated indexes, access control, and options. When the\nserver finds an .htaccess file (as specified by AccessFileName) it needs to\nknow which directives declared in that file can override earlier access\ninformation. When this directive is set to None, then .htaccess files are\ncompletely ignored. In this case, the server will not even attempt to read\n.htaccess files in the file system. When this directive is set to All, then any\ndirective which has the .htaccess Context is allowed in .htaccess files.",
      "descriptions": {
        "default": "The Apache OverRide directive allows for .htaccess files to be used to\noverride much of the configuration, including authentication, handling of\ndocument types, auto generated indexes, access control, and options. When the\nserver finds an .htaccess file (as specified by AccessFileName) it needs to\nknow which directives declared in that file can override earlier access\ninformation. When this directive is set to None, then .htaccess files are\ncompletely ignored. In this case, the server will not even attempt to read\n.htaccess files in the file system. When this directive is set to All, then any\ndirective which has the .htaccess Context is allowed in .htaccess files."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WA00547",
        "gid": "V-26393",
        "rid": "SV-33232r1_rule",
        "stig_id": "WA00547 A22",
        "fix_id": "F-29497r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "Enter the following command:\n\nmore /usr/local/Apache2.2/conf/httpd.conf.\n\nReview the httpd.conf file and search for the following directive:\n\nDirectory\n\nFor every root directory entry (i.e. <Directory />) ensure the following entry\nexists:\n\nAllowOverride None\n\nIf the statement above is not found in the root directory statement, this is a\nfinding.\n\nIf Allow directives are included in the root directory statement, this is a\nfinding.\n\nIf the root directory statement is not listed at all, this is a finding.\n",
        "fix": "Edit the httpd.conf file and add or set the value of\nAllowOverride to \"None\".\n"
      },
      "code": "control \"V-26393\" do\n  title \"The ability to override the access configuration for the OS root\ndirectory must be disabled.\"\n  desc  \"The Apache OverRide directive allows for .htaccess files to be used to\noverride much of the configuration, including authentication, handling of\ndocument types, auto generated indexes, access control, and options. When the\nserver finds an .htaccess file (as specified by AccessFileName) it needs to\nknow which directives declared in that file can override earlier access\ninformation. When this directive is set to None, then .htaccess files are\ncompletely ignored. In this case, the server will not even attempt to read\n.htaccess files in the file system. When this directive is set to All, then any\ndirective which has the .htaccess Context is allowed in .htaccess files.\"\n  impact 0.5\n  tag \"gtitle\": \"WA00547\"\n  tag \"gid\": \"V-26393\"\n  tag \"rid\": \"SV-33232r1_rule\"\n  tag \"stig_id\": \"WA00547 A22\"\n  tag \"fix_id\": \"F-29497r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"Enter the following command:\n\nmore /usr/local/Apache2.2/conf/httpd.conf.\n\nReview the httpd.conf file and search for the following directive:\n\nDirectory\n\nFor every root directory entry (i.e. <Directory />) ensure the following entry\nexists:\n\nAllowOverride None\n\nIf the statement above is not found in the root directory statement, this is a\nfinding.\n\nIf Allow directives are included in the root directory statement, this is a\nfinding.\n\nIf the root directory statement is not listed at all, this is a finding.\n\"\n  tag \"fix\": \"Edit the httpd.conf file and add or set the value of\nAllowOverride to \\\"None\\\".\n\"\n  describe command(\"awk '/<Directory \\\\/>/,/<\\\\/Directory>/' /etc/httpd/conf/httpd.conf\") do\n    its('stdout') { should match \"AllowOverride None\" }\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-26393.rb",
        "line": 1
      },
      "id": "V-26393"
    },
    {
      "title": "Monitoring software must include CGI or equivalent programs in its\nscope.",
      "desc": "By their very nature, CGI type files permit the anonymous web user to\ninteract with data and perhaps store data on the web server. In many cases, CGI\nscripts exercise system-level control over the server’s resources. These files\nmake appealing targets for the malicious user. If these files can be modified\nor exploited, the web server can be compromised. These files must be monitored\nby a security tool that reports unauthorized changes to these files.",
      "descriptions": {
        "default": "By their very nature, CGI type files permit the anonymous web user to\ninteract with data and perhaps store data on the web server. In many cases, CGI\nscripts exercise system-level control over the server’s resources. These files\nmake appealing targets for the malicious user. If these files can be modified\nor exploited, the web server can be compromised. These files must be monitored\nby a security tool that reports unauthorized changes to these files."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "WG440",
        "gid": "V-2271",
        "rid": "SV-32927r2_rule",
        "stig_id": "WG440 A22",
        "fix_id": "F-29255r1_fix",
        "cci": [],
        "nist": [
          "Rev_4"
        ],
        "documentable": false,
        "responsibility": "Web Administrator",
        "check": "CGI or equivalent files must be monitored by a security tool\nthat reports unauthorized changes. It is the purpose of such software to\nmonitor key files for unauthorized changes to them. The reviewer should query\nthe ISSO, the SA, and the web administrator and verify the information provided\nby asking to see the template file or configuration file of the software being\nused to accomplish this security task. Example file extensions for files\nconsidered to provide active content are, but not limited to, .cgi, .asp,\n.aspx, .class, .vb, .php, .pl, and .c.\n\nIf the site does not have a process in place to monitor changes to CGI program\nfiles, this is a finding.",
        "fix": "Use a monitoring tool to monitor changes to the CGI or equivalent\ndirectory. This can be done with something as simple as a script or batch file\nthat would identify a change in the file.\n"
      },
      "code": "control \"V-2271\" do\n  title \"Monitoring software must include CGI or equivalent programs in its\nscope.\"\n  desc  \"By their very nature, CGI type files permit the anonymous web user to\ninteract with data and perhaps store data on the web server. In many cases, CGI\nscripts exercise system-level control over the server’s resources. These files\nmake appealing targets for the malicious user. If these files can be modified\nor exploited, the web server can be compromised. These files must be monitored\nby a security tool that reports unauthorized changes to these files.\n\n\n  \"\n  impact 0.5\n  tag \"gtitle\": \"WG440\"\n  tag \"gid\": \"V-2271\"\n  tag \"rid\": \"SV-32927r2_rule\"\n  tag \"stig_id\": \"WG440 A22\"\n  tag \"fix_id\": \"F-29255r1_fix\"\n  tag \"cci\": []\n  tag \"nist\": [\"Rev_4\"]\n  tag \"documentable\": false\n  tag \"responsibility\": \"Web Administrator\"\n  tag \"check\": \"CGI or equivalent files must be monitored by a security tool\nthat reports unauthorized changes. It is the purpose of such software to\nmonitor key files for unauthorized changes to them. The reviewer should query\nthe ISSO, the SA, and the web administrator and verify the information provided\nby asking to see the template file or configuration file of the software being\nused to accomplish this security task. Example file extensions for files\nconsidered to provide active content are, but not limited to, .cgi, .asp,\n.aspx, .class, .vb, .php, .pl, and .c.\n\nIf the site does not have a process in place to monitor changes to CGI program\nfiles, this is a finding.\"\n  tag \"fix\": \"Use a monitoring tool to monitor changes to the CGI or equivalent\ndirectory. This can be done with something as simple as a script or batch file\nthat would identify a change in the file.\n\"\n\n  begin\n    describe.one do\n      MONITORINGSOFTWARE.each do |software|\n        describe package(software) do\n          it{ should be_installed }\n        end\n      end\n    end\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Apache Server STIG/controls/V-2271.rb",
        "line": 7
      },
      "id": "V-2271"
    }
  ],
  "groups": [
    {
      "title": null,
      "controls": [
        "V-26323"
      ],
      "id": "controls/V-26323.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13739"
      ],
      "id": "controls/V-13739.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13736"
      ],
      "id": "controls/V-13736.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26305"
      ],
      "id": "controls/V-26305.rb"
    },
    {
      "title": null,
      "controls": [
        "V-6724"
      ],
      "id": "controls/V-6724.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26294"
      ],
      "id": "controls/V-26294.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13726"
      ],
      "id": "controls/V-13726.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2261"
      ],
      "id": "controls/V-2261.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2232"
      ],
      "id": "controls/V-2232.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26325"
      ],
      "id": "controls/V-26325.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26302"
      ],
      "id": "controls/V-26302.rb"
    },
    {
      "title": null,
      "controls": [
        "V-6485"
      ],
      "id": "controls/V-6485.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13735"
      ],
      "id": "controls/V-13735.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13738"
      ],
      "id": "controls/V-13738.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2251"
      ],
      "id": "controls/V-2251.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26287"
      ],
      "id": "controls/V-26287.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13728"
      ],
      "id": "controls/V-13728.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26324"
      ],
      "id": "controls/V-26324.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26326"
      ],
      "id": "controls/V-26326.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26368"
      ],
      "id": "controls/V-26368.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26285"
      ],
      "id": "controls/V-26285.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2242"
      ],
      "id": "controls/V-2242.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2247"
      ],
      "id": "controls/V-2247.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13620"
      ],
      "id": "controls/V-13620.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2236"
      ],
      "id": "controls/V-2236.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2225"
      ],
      "id": "controls/V-2225.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26327"
      ],
      "id": "controls/V-26327.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13737"
      ],
      "id": "controls/V-13737.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13730"
      ],
      "id": "controls/V-13730.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2230"
      ],
      "id": "controls/V-2230.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13731"
      ],
      "id": "controls/V-13731.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26299"
      ],
      "id": "controls/V-26299.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26322"
      ],
      "id": "controls/V-26322.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2257"
      ],
      "id": "controls/V-2257.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26396"
      ],
      "id": "controls/V-26396.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13734"
      ],
      "id": "controls/V-13734.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13672"
      ],
      "id": "controls/V-13672.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13727"
      ],
      "id": "controls/V-13727.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13733"
      ],
      "id": "controls/V-13733.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2255"
      ],
      "id": "controls/V-2255.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2234"
      ],
      "id": "controls/V-2234.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13724"
      ],
      "id": "controls/V-13724.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13613"
      ],
      "id": "controls/V-13613.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13729"
      ],
      "id": "controls/V-13729.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13621"
      ],
      "id": "controls/V-13621.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13725"
      ],
      "id": "controls/V-13725.rb"
    },
    {
      "title": null,
      "controls": [
        "V-13732"
      ],
      "id": "controls/V-13732.rb"
    },
    {
      "title": null,
      "controls": [
        "V-60707"
      ],
      "id": "controls/V-60707.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2246"
      ],
      "id": "controls/V-2246.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2256"
      ],
      "id": "controls/V-2256.rb"
    },
    {
      "title": null,
      "controls": [
        "V-6577"
      ],
      "id": "controls/V-6577.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2248"
      ],
      "id": "controls/V-2248.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2243"
      ],
      "id": "controls/V-2243.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2259"
      ],
      "id": "controls/V-2259.rb"
    },
    {
      "title": null,
      "controls": [
        "V-26393"
      ],
      "id": "controls/V-26393.rb"
    },
    {
      "title": null,
      "controls": [
        "V-2271"
      ],
      "id": "controls/V-2271.rb"
    }
  ],
  "inputs": [],
  "sha256": "2dda5b964f731a0448e64d17e95b88395cd5ed2111a23ee414d5abb00e4a79d8",
  "status_message": "",
  "status": "loaded",
  "generator": {
    "name": "inspec",
    "version": "4.23.15"
  }
}