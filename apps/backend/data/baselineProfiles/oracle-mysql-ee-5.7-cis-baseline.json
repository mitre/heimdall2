{
  "name": "oracle-mysql-ee-5.7-cis-baseline",
  "title": "oracle-mysql-ee-5.7-cis-baseline",
  "maintainer": "MITRE InSpec Team",
  "copyright": "The MITRE Corporation, 2021",
  "copyright_email": ".",
  "summary": "InSpec Validation Profile for Oracle MySQL Server Enterprise Edition 5.7 CIS",
  "license": "Apache-2.0",
  "Description": "An InSpec Compliance Profile.",
  "version": "1.10.1",
  "inspec_version": ">= 4.0",
  "inputs": [],
  "supports": [],
  "controls": [
    {
      "title": "Ensure 'slow_query_log' Has Appropriate Permissions and Ownership (Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions\n  and ownership structure provided by the host and may be accessible by users other than the MySQL user",
      "descriptions": {
        "default": "MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions\n  and ownership structure provided by the host and may be accessible by users other than the MySQL user"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.4",
        "cis_level": 1,
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of slow_query_log_file\n  show variables like 'slow_query_log_file';\n  • Execute the following command at a terminal prompt to list all slow_query_log_file.* files\n  ls <slow_query_log_file>.*\n  • For each file listed, execute the following command\n  ls -l <slow_query_log_file> | egrep '^-[r|w]{2}-[r|w]{2}---- *.*$''\n  Lack of output implies a finding",
        "fix": "Execute the following command for each log file location requiring corrected permissions:\n    chmod 660 <log file>\n    chown mysql:mysql <log file>"
      },
      "code": "control '3.4' do\n  title \"Ensure 'slow_query_log' Has Appropriate Permissions and Ownership (Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions\n  and ownership structure provided by the host and may be accessible by users other than the MySQL user\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '3.4'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-9', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of slow_query_log_file\n  show variables like 'slow_query_log_file';\n  • Execute the following command at a terminal prompt to list all slow_query_log_file.* files\n  ls <slow_query_log_file>.*\n  • For each file listed, execute the following command\n  ls -l <slow_query_log_file> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$''\n  Lack of output implies a finding\"\n  tag \"fix\": \"Execute the following command for each log file location requiring corrected permissions:\n    chmod 660 <log file>\n    chown mysql:mysql <log file>\"\n\n  query = %{select @@slow_query_log_file;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  slow_query_log_file = sql_session.query(query).stdout.strip.split\n\n  describe directory(slow_query_log_file.to_s) do\n    it { should exist }\n    its('owner') { should eq 'mysql' }\n    its('group') { should eq 'mysql' }\n    its('mode') { should be <= 0660 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/3.4.rb",
        "line": 1
      },
      "id": "3.4"
    },
    {
      "title": "Ensure No Replication Users Have Wildcard Hostnames (Scored)",
      "desc": "MySQL can make use of host wildcards when granting permissions to users on specific databases. For example, you may grant a given privilege to '<user>'@'%'.",
      "descriptions": {
        "default": "MySQL can make use of host wildcards when granting permissions to users on specific databases. For example, you may grant a given privilege to '<user>'@'%'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "1.1",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement to assess this recommendation:\n    SELECT user, host FROM mysql.user WHERE user='repl' AND host = '%';\n  Ensure no rows are returned.",
        "fix": "Perform the following actions to remediate this setting:\n  1. Enumerate all users returned after running the audit procedure\n  2. Either ALTER the user's host to be specific or DROP the user"
      },
      "code": "control '9.5' do\n  title 'Ensure No Replication Users Have Wildcard Hostnames (Scored)'\n  desc  \"MySQL can make use of host wildcards when granting permissions to users on specific databases. For example, you may grant a given privilege to '<user>'@'%'.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '1.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to assess this recommendation:\n    SELECT user, host FROM mysql.user WHERE user='repl' AND host = '%';\n  Ensure no rows are returned.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n  1. Enumerate all users returned after running the audit procedure\n  2. Either ALTER the user's host to be specific or DROP the user\"\n  query = \"SELECT user, host FROM mysql.user WHERE user='repl' AND host = '%';\"\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  wildcard_hostname = sql_session.query(query).stdout.strip\n  describe 'The list of replication users with wildcard hostnames' do\n    subject { wildcard_hostname }\n    it { should be_empty }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/9.5.rb",
        "line": 1
      },
      "id": "9.5"
    },
    {
      "title": "Disable Interactive Login (Scored)",
      "desc": "When created, the MySQL user may have interactive access to the operating system, which means that the MySQL user could login to the host as any other user would",
      "descriptions": {
        "default": "When created, the MySQL user may have interactive access to the operating system, which means that the MySQL user could login to the host as any other user would"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "1.5",
        "cis_level": 2,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS on Linux",
        "check": "Execute the following command to assess this recommendation\n  getent passwd mysql | egrep '^.*[/bin/false|/sbin/nologin]$''\n  Lack of output implies a finding",
        "fix": "Perform the following steps to remediate this setting:\n  • Execute one of the following commands in a terminal\n  usermod -s /bin/false\n  usermod -s /sbin/nologin"
      },
      "code": "control '1.5' do\n  title 'Disable Interactive Login (Scored)'\n  desc  'When created, the MySQL user may have interactive access to the operating system, which means that the MySQL user could login to the host as any other user would'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '1.5'\n  tag \"cis_level\": 2\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS on Linux'\n  tag \"check\": \"Execute the following command to assess this recommendation\n  getent passwd mysql | egrep '^.*[\\/bin\\/false|\\/sbin\\/nologin]$''\n  Lack of output implies a finding\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\n  • Execute one of the following commands in a terminal\n  usermod -s /bin/false\n  usermod -s /sbin/nologin\"\n\n  describe.one do\n    describe passwd.users('mysql') do\n      its('shells') { should cmp '/bin/false' }\n    end\n    describe passwd.users('mysql') do\n      its('shells') { should cmp '/sbin/nologin' }\n    end\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/1.5.rb",
        "line": 1
      },
      "id": "1.5"
    },
    {
      "title": "Do Not Use Default or Shared Cryptographic Material (Not Scored)",
      "desc": "The cryptographic material used by MySQL, such as digital certificates and encryption keys, should be used only for MySQL and only for one instance.\n  Default cryptographic material should not be used because others are likely to have copies of them",
      "descriptions": {
        "default": "The cryptographic material used by MySQL, such as digital certificates and encryption keys, should be used only for MySQL and only for one instance.\n  Default cryptographic material should not be used because others are likely to have copies of them"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "2.4",
        "cis_level": 2,
        "nist": [
          "IA-5(2)",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS on Linux",
        "check": "Review all cryptographic material and check to see if any of it is default or is used for other MySQL instances or for purposes other than MySQL",
        "fix": "Generate new certificates, keys, and other cryptographic material as needed for each affected MySQL instance"
      },
      "code": "control '2.4' do\n  title 'Do Not Use Default or Shared Cryptographic Material (Not Scored)'\n  desc  \"The cryptographic material used by MySQL, such as digital certificates and encryption keys, should be used only for MySQL and only for one instance.\n  Default cryptographic material should not be used because others are likely to have copies of them\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '2.4'\n  tag \"cis_level\": 2\n  tag \"nist\": ['IA-5(2)', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS on Linux'\n  tag \"check\": 'Review all cryptographic material and check to see if any of it is default or is used for other MySQL instances or for purposes other than MySQL'\n  tag \"fix\": 'Generate new certificates, keys, and other cryptographic material as needed for each affected MySQL instance'\n  describe 'A manual review is required to ensure the default or shared cryptographic material is not being used' do\n    skip 'A manual review is required to ensure the default or shared cryptographic material is not being used'\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/2.4.rb",
        "line": 1
      },
      "id": "2.4"
    },
    {
      "title": "Ensure 'file_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)",
      "desc": "The File_priv privilege found in the mysql.user table is used to allow or disallow a user from reading and writing files on the server host.\n  Any user with the File_priv right granted has the ability to:\n  • Read files from the local file system that are readable by the MySQL server (this includes world-readable files)\n  • Write files to the local file system where the MySQL server has write access",
      "descriptions": {
        "default": "The File_priv privilege found in the mysql.user table is used to allow or disallow a user from reading and writing files on the server host.\n  Any user with the File_priv right granted has the ability to:\n  • Read files from the local file system that are readable by the MySQL server (this includes world-readable files)\n  • Write files to the local file system where the MySQL server has write access"
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.2",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement to audit this setting\n    select user, host from mysql.user where File_priv = 'Y';\n  Ensure only administrative users are returned in the result set.",
        "fix": "\n  Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user:\n    REVOKE FILE ON *.* FROM '<user>';\n  "
      },
      "code": "control '5.2' do\n  title \"Ensure 'file_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)\"\n  desc  \"The File_priv privilege found in the mysql.user table is used to allow or disallow a user from reading and writing files on the server host.\n  Any user with the File_priv right granted has the ability to:\n  • Read files from the local file system that are readable by the MySQL server (this includes world-readable files)\n  • Write files to the local file system where the MySQL server has write access\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '5.2'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to audit this setting\n    select user, host from mysql.user where File_priv = 'Y';\n  Ensure only administrative users are returned in the result set.\"\n  tag \"fix\": \"\n  Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user:\n    REVOKE FILE ON *.* FROM '<user>';\n  \"\n  query = %{select user from mysql.user where File_priv = 'Y';}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  mysql_user_file_priv = sql_session.query(query).stdout.strip.split(\"\\n\")\n\n  if !mysql_user_file_priv.empty?\n    mysql_user_file_priv.each do |user|\n      describe \"The mysql user: #{user} with file_priv\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n\n  if mysql_user_file_priv.empty?\n    impact 0.0\n    describe 'There are no mysql users with file_priv allowed, therefore this control is not applicable' do\n      skip 'There are no mysql users with file_priv allowed, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/5.2.rb",
        "line": 1
      },
      "id": "5.2"
    },
    {
      "title": "Ensure audit_log_connection_policy is not set to 'NONE' (Scored)",
      "desc": "The audit_log_connection_policy variable controls how the audit plugin writes connection events to the audit log file.",
      "descriptions": {
        "default": "The audit_log_connection_policy variable controls how the audit plugin writes connection events to the audit log file."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.5",
        "cis_level": 1,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "To assess this recommendation, execute the following SQL statement:\n    show variables like '%audit_log_connection_policy%';\n  Ensure the value is set to either ERRORS or ALL.\n  ",
        "fix": "To remediate this configuration setting, execute one of the following SQL statements:\n    set global audit_log_connection_policy = ERRORS\n      Or\n    set global audit_log_connection_policy = ALL\n  To ensure this remediation remains indefinite for the life of the MySQL Server, set audit_log_connection_policy in the server's assigned MySQL configuration file (usually named my.cnf, but not always).",
        "Default Value": "The default value for audit_log_connection_policy is ALL."
      },
      "code": "control '6.5' do\n  title \"Ensure audit_log_connection_policy is not set to 'NONE' (Scored)\"\n  desc  'The audit_log_connection_policy variable controls how the audit plugin writes connection events to the audit log file.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.5'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"To assess this recommendation, execute the following SQL statement:\n    show variables like '%audit_log_connection_policy%';\n  Ensure the value is set to either ERRORS or ALL.\n  \"\n  tag \"fix\": \"To remediate this configuration setting, execute one of the following SQL statements:\n    set global audit_log_connection_policy = ERRORS\n      Or\n    set global audit_log_connection_policy = ALL\n  To ensure this remediation remains indefinite for the life of the MySQL Server, set audit_log_connection_policy in the server's assigned MySQL configuration file (usually named my.cnf, but not always).\"\n  tag \"Default Value\": 'The default value for audit_log_connection_policy is ALL.'\n\n  query = %{SELECT @@audit_log_connection_policy;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  audit_log_connection_policy = sql_session.query(query).stdout.strip\n\n  describe.one do\n    describe 'The MySQL audit_log_connection_policy' do\n      subject { audit_log_connection_policy }\n      it { should cmp 'ALL' }\n    end\n    describe 'The MySQL audit_log_connection_policy' do\n      subject { audit_log_connection_policy }\n      it { should cmp 'ERRORS' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.5.rb",
        "line": 1
      },
      "id": "6.5"
    },
    {
      "title": "Ensure 'log_error' Is Not Empty (Scored)",
      "desc": "The error log contains information about events such as mysqld starting and stopping, when a table needs to be checked or repaired, and,\n  depending on the host operating system, stack traces when mysqld fails.",
      "descriptions": {
        "default": "The error log contains information about events such as mysqld starting and stopping, when a table needs to be checked or repaired, and,\n  depending on the host operating system, stack traces when mysqld fails."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.1",
        "cis_level": 1,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "\n  Execute the following SQL statement to audit this setting:\n    SHOW variables LIKE 'log_error';\n  Ensure the Value returned is not empty.",
        "fix": "Perform the following actions to remediate this setting:\n  1. Open the MySQL configuration file (my.cnf or my.ini)\n  2. Set the log-error option to the path for the error log"
      },
      "code": "control '6.1' do\n  title \"Ensure 'log_error' Is Not Empty (Scored)\"\n  desc  \"The error log contains information about events such as mysqld starting and stopping, when a table needs to be checked or repaired, and,\n  depending on the host operating system, stack traces when mysqld fails.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"\n  Execute the following SQL statement to audit this setting:\n    SHOW variables LIKE 'log_error';\n  Ensure the Value returned is not empty.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n  1. Open the MySQL configuration file (my.cnf or my.ini)\n  2. Set the log-error option to the path for the error log\"\n\n  query = %{select @@log_error;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  log_error = sql_session.query(query).stdout.strip.split\n\n  describe \"The MySQL log_error variable set to: #{log_error}\" do\n    subject { log_error }\n    it { should_not be_empty }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.1.rb",
        "line": 1
      },
      "id": "6.1"
    },
    {
      "title": "Ensure SSL Key Files Have Appropriate Permissions and Ownership (Scored)",
      "desc": "When configured to use SSL/TLS, MySQL relies on key files, which are stored on the host's filesystem.\n  These key files are subject to the host's permissions and ownership structure.",
      "descriptions": {
        "default": "When configured to use SSL/TLS, MySQL relies on key files, which are stored on the host's filesystem.\n  These key files are subject to the host's permissions and ownership structure."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.7",
        "cis_level": 1,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "To assess this recommendation, locate the SSL key in use by executing the following SQL statement to get the Value of ssl_key:\n  show variables where variable_name = 'ssl_key';\n  Then, execute the following command to assess the permissions of the Value:\n  ls -l <ssl_key Value> | egrep '^-r--------[ \t]*.[ \t]*mysql[ \t]*mysql.*$'\n  Lack of output from the above command implies a finding.",
        "fix": "Execute the following commands at a terminal prompt to remediate these settings using the Value from the audit procedure:\n    chown mysql:mysql <ssl_key Value>\n    chmod 400 <ssl_key Value>"
      },
      "code": "control '3.7' do\n  title 'Ensure SSL Key Files Have Appropriate Permissions and Ownership (Scored)'\n  desc  \"When configured to use SSL/TLS, MySQL relies on key files, which are stored on the host's filesystem.\n  These key files are subject to the host's permissions and ownership structure.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '3.7'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"To assess this recommendation, locate the SSL key in use by executing the following SQL statement to get the Value of ssl_key:\n  show variables where variable_name = 'ssl_key';\n  Then, execute the following command to assess the permissions of the Value:\n  ls -l <ssl_key Value> | egrep '^-r--------[ \\t]*.[ \\t]*mysql[ \\t]*mysql.*$'\n  Lack of output from the above command implies a finding.\"\n  tag \"fix\": \"Execute the following commands at a terminal prompt to remediate these settings using the Value from the audit procedure:\n    chown mysql:mysql <ssl_key Value>\n    chmod 400 <ssl_key Value>\"\n\n  query = %{select @@ssl_key;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  ssl_key = sql_session.query(query).stdout.strip.split\n\n  describe directory(ssl_key.to_s) do\n    it { should exist }\n    its('owner') { should eq 'mysql' }\n    its('group') { should eq 'mysql' }\n    its('mode') { should be <= 0400 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/3.7.rb",
        "line": 1
      },
      "id": "3.7"
    },
    {
      "title": "Ensure audit_log_include_accounts is set to NULL (Scored)",
      "desc": "The audit_log_include_accounts variable enables the administrator to set accounts for which events should be logged in the audit log.",
      "descriptions": {
        "default": "The audit_log_include_accounts variable enables the administrator to set accounts for which events should be logged in the audit log."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.7",
        "cis_level": 1,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "To assess this recommendation, execute the following SQL statement:\n    SHOW VARIABLES LIKE '%audit_log_include_accounts%';\n  Ensure the resulting value is NULL.",
        "fix": "To remediate this configuration setting, execute the following SQL statement\n    SET GLOBAL audit_log_include_accounts = NULL\n  Or set audit_log_include_accounts=NULL in my.cnf.",
        "Default Value": "audit_log_exclude_accounts is set to NULL by default."
      },
      "code": "control '6.7' do\n  title 'Ensure audit_log_include_accounts is set to NULL (Scored)'\n  desc  'The audit_log_include_accounts variable enables the administrator to set accounts for which events should be logged in the audit log.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.7'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"To assess this recommendation, execute the following SQL statement:\n    SHOW VARIABLES LIKE '%audit_log_include_accounts%';\n  Ensure the resulting value is NULL.\"\n  tag \"fix\": \"To remediate this configuration setting, execute the following SQL statement\n    SET GLOBAL audit_log_include_accounts = NULL\n  Or set audit_log_include_accounts=NULL in my.cnf.\"\n  tag \"Default Value\": 'audit_log_exclude_accounts is set to NULL by default.'\n\n  query = %{SELECT @@audit_log_include_accounts;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  audit_log_include_accounts = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL audit_log_include_accounts' do\n    subject { audit_log_include_accounts }\n    it { should cmp 'NULL' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.7.rb",
        "line": 1
      },
      "id": "6.7"
    },
    {
      "title": "Ensure 'grant_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)",
      "desc": "The GRANT OPTION privilege exists in different contexts (mysql.user, mysql.db) for the purpose of governing the ability of a privileged user to manipulate the privileges of other users.",
      "descriptions": {
        "default": "The GRANT OPTION privilege exists in different contexts (mysql.user, mysql.db) for the purpose of governing the ability of a privileged user to manipulate the privileges of other users."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.7",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statements to audit this setting:\n      SELECT user, host FROM mysql.user WHERE Grant_priv = 'Y';\n      SELECT user, host FROM mysql.db WHERE Grant_priv = 'Y';\n  Ensure only administrative users are returned in the result set.",
        "fix": "Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result sets of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user:\n    REVOKE GRANT OPTION ON *.* FROM <user>;"
      },
      "code": "control '5.7' do\n  title \"Ensure 'grant_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)\"\n  desc  'The GRANT OPTION privilege exists in different contexts (mysql.user, mysql.db) for the purpose of governing the ability of a privileged user to manipulate the privileges of other users.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '5.7'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statements to audit this setting:\n      SELECT user, host FROM mysql.user WHERE Grant_priv = 'Y';\n      SELECT user, host FROM mysql.db WHERE Grant_priv = 'Y';\n  Ensure only administrative users are returned in the result set.\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result sets of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user:\n    REVOKE GRANT OPTION ON *.* FROM <user>;\"\n\n  mysql_user_query = %{SELECT user FROM mysql.user WHERE Grant_priv = 'Y';}\n  mysql_user_db_query = %{SELECT user FROM mysql.db WHERE Grant_priv = 'Y';}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  mysql_user_privs = sql_session.query(mysql_user_query).stdout.strip.split(\"\\n\")\n  mysql_user_db_privs = sql_session.query(mysql_user_db_query).stdout.strip.split(\"\\n\")\n\n  if !mysql_user_privs.empty?\n    mysql_user_privs.each do |user|\n      describe \"The mysql user: #{user} with grant_priv access in the mysql.user table\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n  if !mysql_user_db_privs.empty?\n    mysql_user_db_privs.each do |user|\n      describe \"The mysql user: #{user} with grant_priv access in the mysql.db table\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n\n  if mysql_user_privs.empty? && mysql_user_db_privs.empty?\n    impact 0.0\n    describe 'There are no mysql users configured with grant_priv access, therefore this control is not applicable' do\n      skip 'There are no mysql users configured with grant_priv access, therefore this control is not applicable'\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/5.7.rb",
        "line": 1
      },
      "id": "5.7"
    },
    {
      "title": "Ensure 'log_warnings' Is Set to '2' (Scored)",
      "desc": "The log_warnings system variable, enabled by default, provides additional information to the MySQL log.\n  A value of 1 enables logging of warning messages, and higher integer values tend to enable more logging.\n  NOTE: log_warnings has been deprecated as of MySQL 5.7.2.\n  Setting log_warnings will also cause log_error_verbosity to be set.The variable scope for log_warnings is global.",
      "descriptions": {
        "default": "The log_warnings system variable, enabled by default, provides additional information to the MySQL log.\n  A value of 1 enables logging of warning messages, and higher integer values tend to enable more logging.\n  NOTE: log_warnings has been deprecated as of MySQL 5.7.2.\n  Setting log_warnings will also cause log_error_verbosity to be set.The variable scope for log_warnings is global."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.3",
        "cis_level": 2,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "Execute the following SQL statement to assess this recommendation:\n    SHOW GLOBAL VARIABLES LIKE 'log_warnings';\n  Ensure the Value returned equals 2.",
        "fix": "Perform the following actions to remediate this setting:\n  • Open the MySQL configuration file (my.cnf)\n  • Ensure the following line is found in the mysqld section\n    log-warnings = 2",
        "Default Value": "The option is enabled (1) by default."
      },
      "code": "control '6.3' do\n  title \"Ensure 'log_warnings' Is Set to '2' (Scored)\"\n  desc  \"The log_warnings system variable, enabled by default, provides additional information to the MySQL log.\n  A value of 1 enables logging of warning messages, and higher integer values tend to enable more logging.\n  NOTE: log_warnings has been deprecated as of MySQL 5.7.2.\n  Setting log_warnings will also cause log_error_verbosity to be set.The variable scope for log_warnings is global.\n  \"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.3'\n  tag \"cis_level\": 2\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to assess this recommendation:\n    SHOW GLOBAL VARIABLES LIKE 'log_warnings';\n  Ensure the Value returned equals 2.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n  • Open the MySQL configuration file (my.cnf)\n  • Ensure the following line is found in the mysqld section\n    log-warnings = 2\"\n  tag \"Default Value\": 'The option is enabled (1) by default.'\n\n  query = %{SELECT @@log_warnings;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  log_warnings = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL log_warnings' do\n    subject { log_warnings }\n    it { should cmp 2 }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.3.rb",
        "line": 1
      },
      "id": "6.3"
    },
    {
      "title": "Ensure 'master_info_repository' Is Set to 'TABLE' (Scored)",
      "desc": "The master_info_repository setting determines to where a slave logs master status and connection information.\n  The options are FILE or TABLE. Note also that this setting is associated with the sync_master_info setting as well.",
      "descriptions": {
        "default": "The master_info_repository setting determines to where a slave logs master status and connection information.\n  The options are FILE or TABLE. Note also that this setting is associated with the sync_master_info setting as well."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "9.3",
        "cis_level": 2,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "Execute the following SQL statement to assess this recommendation:\n    SHOW GLOBAL VARIABLES LIKE 'master_info_repository';\n  The result should be TABLE instead of FILE.\n  NOTE: There also should not be a master.info file in the datadir.",
        "fix": "Perform the following actions to remediate this setting:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Locate master_info_repository\n  3. Set the master_info_repository value to TABLE\n  NOTE: If master_info_repository does not exist, add it to the configuration file.",
        "Default Value": "FILE"
      },
      "code": "control '9.3' do\n  title \"Ensure 'master_info_repository' Is Set to 'TABLE' (Scored)\"\n  desc  \"The master_info_repository setting determines to where a slave logs master status and connection information.\n  The options are FILE or TABLE. Note also that this setting is associated with the sync_master_info setting as well.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '9.3'\n  tag \"cis_level\": 2\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to assess this recommendation:\n    SHOW GLOBAL VARIABLES LIKE 'master_info_repository';\n  The result should be TABLE instead of FILE.\n  NOTE: There also should not be a master.info file in the datadir.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Locate master_info_repository\n  3. Set the master_info_repository value to TABLE\n  NOTE: If master_info_repository does not exist, add it to the configuration file.\"\n  tag \"Default Value\": 'FILE'\n  query = 'select @@master_info_repository'\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  master_info_repository = sql_session.query(query).stdout.strip\n  describe 'The master_info_repository' do\n    subject { master_info_repository }\n    it { should cmp 'TABLE' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/9.3.rb",
        "line": 1
      },
      "id": "9.3"
    },
    {
      "title": "Set audit_log_strategy to SYNCHRONOUS or SEMISYNCRONOUS (Scored)",
      "desc": "The audit_log_strategy must be set to SYNCHRONOUS or SEMISYNCHRONOUS",
      "descriptions": {
        "default": "The audit_log_strategy must be set to SYNCHRONOUS or SEMISYNCHRONOUS"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.11",
        "cis_level": 2,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "To assess this recommendation, execute the following SQL statement:\n    SHOW GLOBAL VARIABLES LIKE 'audit_log_strategy';\n  The result should be SYNCHRONOUS or SEMISYNCHRONOUS",
        "fix": "To remediate this configuration:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Navigate to the mysqld section of the configuration file\n  3. Set audit_log_strategy='SEMISYNCHRONOUS' (or SYNCHRONOUS)\n  ",
        "Default Value": "ASYNCHRONOUS"
      },
      "code": "control '6.11' do\n  title 'Set audit_log_strategy to SYNCHRONOUS or SEMISYNCRONOUS (Scored)'\n  desc  'The audit_log_strategy must be set to SYNCHRONOUS or SEMISYNCHRONOUS'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.11'\n  tag \"cis_level\": 2\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"To assess this recommendation, execute the following SQL statement:\n    SHOW GLOBAL VARIABLES LIKE 'audit_log_strategy';\n  The result should be SYNCHRONOUS or SEMISYNCHRONOUS\"\n  tag \"fix\": \"To remediate this configuration:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Navigate to the mysqld section of the configuration file\n  3. Set audit_log_strategy='SEMISYNCHRONOUS' (or SYNCHRONOUS)\n  \"\n  tag \"Default Value\": 'ASYNCHRONOUS'\n\n  query = %{SHOW GLOBAL VARIABLES LIKE 'audit_log_strategy';}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  audit_log_strategy = sql_session.query(query).stdout.strip\n\n  describe.one do\n    describe 'The MySQL audit_log_strategy variable' do\n      subject { audit_log_strategy }\n      it { should cmp 'SYNCHRONOUS' }\n    end\n    describe 'The MySQL audit_log_strategy variable' do\n      subject { audit_log_strategy }\n      it { should cmp 'SEMISYNCHRONOUS' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.11.rb",
        "line": 1
      },
      "id": "6.11"
    },
    {
      "title": "1.1 Place Databases on Non-System Partitions (Scored)",
      "desc": "It is generally accepted that host operating systems should include different filesystem partitions for different purposes.\n  One set of filesystems are typically called system partitions, and are generally reserved for host system/application operation.\n  The other set of filesystems are typically called non-system partitions, and such locations are generally reserved for storing data.",
      "descriptions": {
        "default": "It is generally accepted that host operating systems should include different filesystem partitions for different purposes.\n  One set of filesystems are typically called system partitions, and are generally reserved for host system/application operation.\n  The other set of filesystems are typically called non-system partitions, and such locations are generally reserved for storing data."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "1.1",
        "cis_level": 1,
        "nist": [
          "SC-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Execute the following steps to assess this recommendation:\n  • Discover the datadir by executing the following SQL statement\n  show variables where variable_name = 'datadir';\n  • Using the returned datadir Value from the above query, execute the following in a system terminal\n  df -h <datadir Value>\n  The output returned from the df command above should not include root ('/'), '/var', or '/usr'.",
        "fix": "Perform the following steps to remediate this setting:\n  1. Choose a non-system partition new location for the MySQL data\n  2. Stop mysqld using a command like: service mysql stop\n  3. Copy the data using a command like: cp -rp <datadir Value> <new location> 4. Set the datadir location to the new location in the MySQL configuration file\n  5. Start mysqld using a command like: service mysql start\n  NOTE: On some Linux distributions you may need to additionally modify apparmor settings. For example, on a Ubuntu 14.04.1 system edit the file /etc/apparmor.d/usr.sbin.mysqld so that the datadir access is appropriate. The original might look like this:\n  # Allow data dir access\n  /var/lib/mysql/ r,\n  /var/lib/mysql/** rwk,\n  Alter those two paths to be the new location you chose above. For example, if that new location were /media/mysql, then the /etc/apparmor.d/usr.sbin.mysqld file should include something like this:\n  # Allow data dir access /media/mysql/ r,\n   /media/mysql/** rwk,\n",
        "Default Value": "Not Applicable"
      },
      "code": "control '1.1' do\n  title '1.1 Place Databases on Non-System Partitions (Scored)'\n  desc  \"It is generally accepted that host operating systems should include different filesystem partitions for different purposes.\n  One set of filesystems are typically called system partitions, and are generally reserved for host system/application operation.\n  The other set of filesystems are typically called non-system partitions, and such locations are generally reserved for storing data.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '1.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['SC-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Execute the following steps to assess this recommendation:\n  • Discover the datadir by executing the following SQL statement\n  show variables where variable_name = 'datadir';\n  • Using the returned datadir Value from the above query, execute the following in a system terminal\n  df -h <datadir Value>\n  The output returned from the df command above should not include root ('/'), '/var', or '/usr'.\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\n  1. Choose a non-system partition new location for the MySQL data\n  2. Stop mysqld using a command like: service mysql stop\n  3. Copy the data using a command like: cp -rp <datadir Value> <new location> 4. Set the datadir location to the new location in the MySQL configuration file\n  5. Start mysqld using a command like: service mysql start\n  NOTE: On some Linux distributions you may need to additionally modify apparmor settings. For example, on a Ubuntu 14.04.1 system edit the file /etc/apparmor.d/usr.sbin.mysqld so that the datadir access is appropriate. The original might look like this:\n  # Allow data dir access\n  /var/lib/mysql/ r,\n  /var/lib/mysql/** rwk,\n  Alter those two paths to be the new location you chose above. For example, if that new location were /media/mysql, then the /etc/apparmor.d/usr.sbin.mysqld file should include something like this:\n  # Allow data dir access /media/mysql/ r,\n   /media/mysql/** rwk,\n\"\n  tag \"Default Value\": 'Not Applicable'\n\n  query = %{select @@datadir;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  datadir = sql_session.query(query).stdout.strip.split\n\n  describe 'The mysql data directory partition installed on' do\n    subject { command(\"df -h #{datadir}\").stdout }\n    it { should_not include '/' }\n  end\n\n  describe 'The mysql data directory partition installed on' do\n    subject { command(\"df -h #{datadir}\").stdout }\n    it { should_not include '/var' }\n  end\n\n  describe 'The mysql data directory partition installed on' do\n    subject { command(\"df -h #{datadir}\").stdout }\n    it { should_not include '/usr' }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/1.1.rb",
        "line": 1
      },
      "id": "1.1"
    },
    {
      "title": "Ensure Passwords Are Not Stored in the Global Configuration (Scored)",
      "desc": "The [client] section of the MySQL configuration file allows setting a user and password to be used. Verify the password option is not used in the global configuration file (my.cnf).",
      "descriptions": {
        "default": "The [client] section of the MySQL configuration file allows setting a user and password to be used. Verify the password option is not used in the global configuration file (my.cnf)."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.3",
        "cis_level": 2,
        "nist": [
          "IA-5(1)",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS on Linux",
        "check": "\n  To assess this recommendation, perform the following steps:\n  • Open the MySQL configuration file (e.g. my.cnf)\n  • Examine the [client] section of the MySQL configuration file and ensure password\n  is not employed.",
        "fix": "Use the mysql_config_editor to store authtentication credentials in .mylogin.cnf in encrypted form.\n  If not possible, use the user-specific options file, .my.cnf., and restricting file access permissions to the user identity."
      },
      "code": "control '7.3' do\n  title 'Ensure Passwords Are Not Stored in the Global Configuration (Scored)'\n  desc  'The [client] section of the MySQL configuration file allows setting a user and password to be used. Verify the password option is not used in the global configuration file (my.cnf).'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '7.3'\n  tag \"cis_level\": 1\n  tag \"cis_level\": 2\n  tag \"nist\": ['IA-5(1)', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS on Linux'\n  tag \"check\": \"\n  To assess this recommendation, perform the following steps:\n  • Open the MySQL configuration file (e.g. my.cnf)\n  • Examine the [client] section of the MySQL configuration file and ensure password\n  is not employed.\"\n  tag \"fix\": \"Use the mysql_config_editor to store authtentication credentials in .mylogin.cnf in encrypted form.\n  If not possible, use the user-specific options file, .my.cnf., and restricting file access permissions to the user identity.\"\n  describe mysql_conf do\n    its('client.password') { should be_nil }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/7.3.rb",
        "line": 1
      },
      "id": "7.3"
    },
    {
      "title": "Ensure 'secure_auth' is set to 'ON' (Scored)",
      "desc": "This option dictates whether the server will deny connections by clients that attempt to use accounts that have their password stored in the mysql_old_password format.",
      "descriptions": {
        "default": "This option dictates whether the server will deny connections by clients that attempt to use accounts that have their password stored in the mysql_old_password format."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.2",
        "cis_level": 2,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "\n  Execute the following SQL statement and ensure the Value field is not set to ON:\n    SHOW VARIABLES WHERE Variable_name = 'secure_auth';",
        "fix": "\n  Add the following line to [mysqld] portions of the MySQL option file to establish the recommended state:\n    secure_auth=ON\n  ",
        "Default Value": "Before MySQL 5.6.5, this option is disabled by default. As of MySQL 5.6.5, it is enabled by default; to disable it, use --skip-secure-auth."
      },
      "code": "control '7.2' do\n  title \"Ensure 'secure_auth' is set to 'ON' (Scored)\"\n  desc  'This option dictates whether the server will deny connections by clients that attempt to use accounts that have their password stored in the mysql_old_password format.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '7.2'\n  tag \"cis_level\": 1\n  tag \"cis_level\": 2\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"\n  Execute the following SQL statement and ensure the Value field is not set to ON:\n    SHOW VARIABLES WHERE Variable_name = 'secure_auth';\"\n  tag \"fix\": \"\n  Add the following line to [mysqld] portions of the MySQL option file to establish the recommended state:\n    secure_auth=ON\n  \"\n  tag \"Default Value\": 'Before MySQL 5.6.5, this option is disabled by default. As of MySQL 5.6.5, it is enabled by default; to disable it, use --skip-secure-auth.'\n\n  query = %{SELECT @@secure_auth;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  secure_auth = sql_session.query(query).stdout.strip\n\n  describe \"The MySQL secure_auth variable set to: #{secure_auth}\" do\n    subject { secure_auth }\n    it { should cmp 1 }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/7.2.rb",
        "line": 1
      },
      "id": "7.2"
    },
    {
      "title": "Ensure No Users Have Wildcard Hostnames (Scored)",
      "desc": "MySQL can make use of host wildcards when granting permissions to users on specific databases. For example, you may grant a given privilege to '<user>'@'%'.",
      "descriptions": {
        "default": "MySQL can make use of host wildcards when granting permissions to users on specific databases. For example, you may grant a given privilege to '<user>'@'%'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.7",
        "cis_level": 2,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "Execute the following SQL statement to assess this recommendation:\n    SELECT user, host FROM mysql.user WHERE host = '%';\n  Ensure no rows are returned.",
        "fix": "Perform the following actions to remediate this setting:\n  1. Enumerate all users returned after running the audit procedure\n  2. Either ALTER the user's host to be specific or DROP the user"
      },
      "code": "control '7.7' do\n  title 'Ensure No Users Have Wildcard Hostnames (Scored)'\n  desc  \"MySQL can make use of host wildcards when granting permissions to users on specific databases. For example, you may grant a given privilege to '<user>'@'%'.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '7.7'\n  tag \"cis_level\": 1\n  tag \"cis_level\": 2\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to assess this recommendation:\n    SELECT user, host FROM mysql.user WHERE host = '%';\n  Ensure no rows are returned.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n  1. Enumerate all users returned after running the audit procedure\n  2. Either ALTER the user's host to be specific or DROP the user\"\n\n  query = %{SELECT user, host FROM mysql.user WHERE host = '%';}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  users_with_wildcard_hostnames = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL users that have Wildcard Hostnames' do\n    subject { users_with_wildcard_hostnames }\n    it { should be_empty }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/7.7.rb",
        "line": 1
      },
      "id": "7.7"
    },
    {
      "title": "Ensure 'sql_mode' Contains 'NO_AUTO_CREATE_USER' (Scored)",
      "desc": "NO_AUTO_CREATE_USER is an option for sql_mode that prevents a GRANT statement from\n  automatically creating a user when authentication information is not provided.",
      "descriptions": {
        "default": "NO_AUTO_CREATE_USER is an option for sql_mode that prevents a GRANT statement from\n  automatically creating a user when authentication information is not provided."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.4",
        "cis_level": 2,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "\n  Execute the following SQL statements to assess this recommendation:\n      SELECT @@global.sql_mode;\n      SELECT @@session.sql_mode;\n  Ensure that each result contains NO_AUTO_CREATE_USER.\n  ",
        "fix": "\n  Perform the following actions to remediate this setting:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Find the sql_mode setting in the [mysqld] area\n  3. Add the NO_AUTO_CREATE_USER to the sql_mode setting"
      },
      "code": "control '7.4' do\n  title \"Ensure 'sql_mode' Contains 'NO_AUTO_CREATE_USER' (Scored)\"\n  desc  \"NO_AUTO_CREATE_USER is an option for sql_mode that prevents a GRANT statement from\n  automatically creating a user when authentication information is not provided.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '7.4'\n  tag \"cis_level\": 1\n  tag \"cis_level\": 2\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS on Linux'\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"\n  Execute the following SQL statements to assess this recommendation:\n      SELECT @@global.sql_mode;\n      SELECT @@session.sql_mode;\n  Ensure that each result contains NO_AUTO_CREATE_USER.\n  \"\n  tag \"fix\": \"\n  Perform the following actions to remediate this setting:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Find the sql_mode setting in the [mysqld] area\n  3. Add the NO_AUTO_CREATE_USER to the sql_mode setting\"\n\n  global_query = %{SELECT @@global.sql_mode;}\n  session_query = %{SELECT @@session.sql_mode;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  global_sql_mode = sql_session.query(global_query).stdout.strip\n  session_sql_mode = sql_session.query(session_query).stdout.strip\n\n  describe 'The MySQL global sql mode' do\n    subject { global_sql_mode }\n    it { should include 'NO_AUTO_CREATE_USER' }\n  end\n\n  describe 'The MySQL session sql mode' do\n    subject { session_sql_mode }\n    it { should include 'NO_AUTO_CREATE_USER' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/7.4.rb",
        "line": 1
      },
      "id": "7.4"
    },
    {
      "title": "Ensure audit_log_statement_policy is set to ALL (Scored)",
      "desc": "This setting controls whether statements are written to the audit log",
      "descriptions": {
        "default": "This setting controls whether statements are written to the audit log"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.10",
        "cis_level": 2,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "SHOW GLOBAL VARIABLES LIKE 'audit_log_statement_policy';\n  It must return ALL",
        "fix": "Add this to the mysqld section of the mysql configuration file and restart the server:\n  audit_log_statement_policy='ALL'",
        "Default Value": "ALL"
      },
      "code": "control '6.10' do\n  title 'Ensure audit_log_statement_policy is set to ALL (Scored)'\n  desc  'This setting controls whether statements are written to the audit log'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.10'\n  tag \"cis_level\": 2\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"SHOW GLOBAL VARIABLES LIKE 'audit_log_statement_policy';\n  It must return ALL\"\n  tag \"fix\": \"Add this to the mysqld section of the mysql configuration file and restart the server:\n  audit_log_statement_policy='ALL'\"\n  tag \"Default Value\": 'ALL'\n\n  query = %{select @@log_error;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  log_error = sql_session.query(query).stdout.strip.split\n\n  describe 'The MySQL log_error' do\n    subject { log_error }\n    it { should_not be_empty }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.10.rb",
        "line": 1
      },
      "id": "6.10"
    },
    {
      "title": "Ensure audit_log_policy is set to log logins and connections (Scored)",
      "desc": "With the audit_log_policy setting the amount of information which is sent to the audit log is controlled. It must be set to log logins and connections.",
      "descriptions": {
        "default": "With the audit_log_policy setting the amount of information which is sent to the audit log is controlled. It must be set to log logins and connections."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.9",
        "cis_level": 2,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "SHOW GLOBAL VARIABLES LIKE 'audit_log_policy';\n  The result must be ALL.",
        "fix": "Set audit_log_policy='ALL' in the MySQL configuration file and activate the setting by restarting the server or executing SET GLOBAL audit_log_policy='ALL';",
        "Default Value": "ALL"
      },
      "code": "control '6.9' do\n  title 'Ensure audit_log_policy is set to log logins and connections (Scored)'\n  desc  'With the audit_log_policy setting the amount of information which is sent to the audit log is controlled. It must be set to log logins and connections.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.9'\n  tag \"cis_level\": 2\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"SHOW GLOBAL VARIABLES LIKE 'audit_log_policy';\n  The result must be ALL.\"\n  tag \"fix\": \"Set audit_log_policy='ALL' in the MySQL configuration file and activate the setting by restarting the server or executing SET GLOBAL audit_log_policy='ALL';\"\n  tag \"Default Value\": 'ALL'\n\n  query = %{SELECT @@audit_log_include_accounts;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  audit_log_policy = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL audit_log_policy' do\n    subject { audit_log_policy }\n    it { should cmp 'ALL' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.9.rb",
        "line": 1
      },
      "id": "6.9"
    },
    {
      "title": " Ensure 'shutdown_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)",
      "desc": "The SHUTDOWN privilege simply enables use of the shutdown option to the mysqladmin command,\n   which allows a user with the SHUTDOWN privilege the ability to shut down the MySQL server.",
      "descriptions": {
        "default": "The SHUTDOWN privilege simply enables use of the shutdown option to the mysqladmin command,\n   which allows a user with the SHUTDOWN privilege the ability to shut down the MySQL server."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.5",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement to audit this setting:\n      SELECT user, host FROM mysql.user WHERE Shutdown_priv = 'Y';\n  Ensure only administrative users are returned in the result set.",
        "fix": "Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user):\n    REVOKE SHUTDOWN ON *.* FROM '<user>';"
      },
      "code": "control '5.5' do\n  title \" Ensure 'shutdown_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)\"\n  desc  \"The SHUTDOWN privilege simply enables use of the shutdown option to the mysqladmin command,\n   which allows a user with the SHUTDOWN privilege the ability to shut down the MySQL server.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '5.5'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to audit this setting:\n      SELECT user, host FROM mysql.user WHERE Shutdown_priv = 'Y';\n  Ensure only administrative users are returned in the result set.\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user):\n    REVOKE SHUTDOWN ON *.* FROM '<user>';\"\n  query = %{select user from mysql.user where Shutdown_priv = 'Y';}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  mysql_user_shutdown_priv = sql_session.query(query).stdout.strip.split(\"\\n\")\n\n  if !mysql_user_shutdown_priv.empty?\n    mysql_user_shutdown_priv.each do |user|\n      describe \"The mysql user: #{user} with shutdown_priv\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n  if mysql_user_shutdown_priv.empty?\n    impact 0.0\n    describe 'There are no mysql users with shutdown_priv allowed, therefore this control is not applicable' do\n      skip 'There are no mysql users with shutdown_priv allowed, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/5.5.rb",
        "line": 1
      },
      "id": "5.5"
    },
    {
      "title": "Ensure 'log_bin_basename' Files Have Appropriate Permissions and Ownership (Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, and general log.\n  Because these are files on the host operating system, they are subject to the permissions\n  and ownership structure provided by the host and may be accessible by users other than the MySQL user",
      "descriptions": {
        "default": "MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, and general log.\n  Because these are files on the host operating system, they are subject to the permissions\n  and ownership structure provided by the host and may be accessible by users other than the MySQL user"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.2",
        "cis_level": 1,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of log_bin_basename\n      show variables like 'log_bin_basename';\n  • Execute the following command at a terminal prompt to list all log_bin_basename.* files\n      ls <log_bin_basename>.*\n  • For each file listed, execute the following command\n      ls -l <log_bin_basename.nnnnn> | egrep '^-[r|w]{2}-[r|w]{2}---- *.*$'\n  Lack of output implies a finding",
        "fix": "Execute the following command for each log file location requiring corrected permissions and ownership:\n      chmod 660 <log file>\n      chown mysql:mysql <log file>"
      },
      "code": "control '3.2' do\n  title \"Ensure 'log_bin_basename' Files Have Appropriate Permissions and Ownership (Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, and general log.\n  Because these are files on the host operating system, they are subject to the permissions\n  and ownership structure provided by the host and may be accessible by users other than the MySQL user\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '3.2'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of log_bin_basename\n      show variables like 'log_bin_basename';\n  • Execute the following command at a terminal prompt to list all log_bin_basename.* files\n      ls <log_bin_basename>.*\n  • For each file listed, execute the following command\n      ls -l <log_bin_basename.nnnnn> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$'\n  Lack of output implies a finding\"\n  tag \"fix\": \"Execute the following command for each log file location requiring corrected permissions and ownership:\n      chmod 660 <log file>\n      chown mysql:mysql <log file>\"\n\n  query = %{select @@log_bin_basename;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  log_bin_basename = sql_session.query(query).stdout.strip.split\n\n  describe directory(log_bin_basename.to_s) do\n    it { should exist }\n    its('owner') { should eq 'mysql' }\n    its('group') { should eq 'mysql' }\n    its('mode') { should be <= 0660 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/3.2.rb",
        "line": 1
      },
      "id": "3.2"
    },
    {
      "title": "Ensure 'relay_log_basename' Files Have Appropriate Permissions and Ownership (Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions and ownership structure provided\n  by the host and may be accessible by users other than the MySQL user",
      "descriptions": {
        "default": "MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions and ownership structure provided\n  by the host and may be accessible by users other than the MySQL user"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.5",
        "cis_level": 1,
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of relay_log_basename\n    show variables like 'relay_log_basename';\n  • Execute the following command at a terminal prompt to list all relay_log_basename.* files\n    ls <relay_log_basename>.*\n  • For each file listed, execute the following command\n    ls -l <relay_log_basename> | egrep '^-[r|w]{2}-[r|w]{2}---- *.*$'\n  Lack of output implies a finding",
        "fix": "Execute the following command for each log file location requiring corrected permissions and ownership:\n      chmod 660 <log file>\n      chown mysql:mysql <log file>"
      },
      "code": "control '3.5' do\n  title \"Ensure 'relay_log_basename' Files Have Appropriate Permissions and Ownership (Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions and ownership structure provided\n  by the host and may be accessible by users other than the MySQL user\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '3.5'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-9', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of relay_log_basename\n    show variables like 'relay_log_basename';\n  • Execute the following command at a terminal prompt to list all relay_log_basename.* files\n    ls <relay_log_basename>.*\n  • For each file listed, execute the following command\n    ls -l <relay_log_basename> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$'\n  Lack of output implies a finding\"\n  tag \"fix\": \"Execute the following command for each log file location requiring corrected permissions and ownership:\n      chmod 660 <log file>\n      chown mysql:mysql <log file>\"\n\n  query = %{select @@relay_log_basename;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  relay_log_basename = sql_session.query(query).stdout.strip.split\n\n  describe directory(relay_log_basename.to_s) do\n    it { should exist }\n    its('owner') { should eq 'mysql' }\n    its('group') { should eq 'mysql' }\n    its('mode') { should be <= 0660 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/3.5.rb",
        "line": 1
      },
      "id": "3.5"
    },
    {
      "title": "Ensure audit_log_exclude_accounts is set to NULL (Scored)",
      "desc": "The audit_log_exclude_accounts variable enables the administrator to set accounts for which events will not be logged in the audit log.",
      "descriptions": {
        "default": "The audit_log_exclude_accounts variable enables the administrator to set accounts for which events will not be logged in the audit log."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.6",
        "cis_level": 1,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "To assess this recommendation, execute the following SQL statement:\n    SHOW VARIABLES LIKE '%audit_log_exclude_accounts%';\n  Ensure the resulting audit_log_exclude_accounts value is NULL.",
        "fix": "To remediate this configuration setting, execute the following SQL statement\n    SET GLOBAL audit_log_exclude_accounts = NULL\n  Or set audit_log_exclude_accounts=NULL in my.cnf.",
        "Default Value": "audit_log_exclude_accounts is set to NULL by default"
      },
      "code": "control '6.6' do\n  title 'Ensure audit_log_exclude_accounts is set to NULL (Scored)'\n  desc  'The audit_log_exclude_accounts variable enables the administrator to set accounts for which events will not be logged in the audit log.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.6'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"To assess this recommendation, execute the following SQL statement:\n    SHOW VARIABLES LIKE '%audit_log_exclude_accounts%';\n  Ensure the resulting audit_log_exclude_accounts value is NULL.\"\n  tag \"fix\": \"To remediate this configuration setting, execute the following SQL statement\n    SET GLOBAL audit_log_exclude_accounts = NULL\n  Or set audit_log_exclude_accounts=NULL in my.cnf.\"\n  tag \"Default Value\": 'audit_log_exclude_accounts is set to NULL by default'\n\n  query = %{SELECT @@audit_log_exclude_accounts;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  audit_log_exclude_accounts = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL audit_log_exclude_accounts' do\n    subject { audit_log_exclude_accounts }\n    it { should cmp 'NULL' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.6.rb",
        "line": 1
      },
      "id": "6.6"
    },
    {
      "title": "Ensure 'MASTER_SSL_VERIFY_SERVER_CERT' Is Set to 'YES' or '1' (Scored)",
      "desc": "In the MySQL slave context the setting MASTER_SSL_VERIFY_SERVER_CERT indicates whether the slave should verify the master's certificate.\n  This configuration item may be set to Yes or No, and unless SSL has been enabled on the slave, the value will be ignored.",
      "descriptions": {
        "default": "In the MySQL slave context the setting MASTER_SSL_VERIFY_SERVER_CERT indicates whether the slave should verify the master's certificate.\n  This configuration item may be set to Yes or No, and unless SSL has been enabled on the slave, the value will be ignored."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "9.2",
        "cis_level": 1,
        "nist": [
          "SC-23",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "To assess this recommendation, issue the following statement:\n  select ssl_verify_server_cert from mysql.slave_master_info;\n  Verify the value of ssl_verify_server_cert is 1.",
        "fix": "To remediate this setting you must use the CHANGE MASTER TO command.\n              STOP SLAVE; -- required if replication was already running\n              CHANGE MASTER TO MASTER_SSL_VERIFY_SERVER_CERT=1;\n              START SLAVE; -- required if you want to restart replication"
      },
      "code": "control '9.2' do\n  title \"Ensure 'MASTER_SSL_VERIFY_SERVER_CERT' Is Set to 'YES' or '1' (Scored)\"\n  desc  \"In the MySQL slave context the setting MASTER_SSL_VERIFY_SERVER_CERT indicates whether the slave should verify the master's certificate.\n  This configuration item may be set to Yes or No, and unless SSL has been enabled on the slave, the value will be ignored.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '9.2'\n  tag \"cis_level\": 1\n  tag \"nist\": ['SC-23', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"To assess this recommendation, issue the following statement:\n  select ssl_verify_server_cert from mysql.slave_master_info;\n  Verify the value of ssl_verify_server_cert is 1.\"\n  tag \"fix\": \"To remediate this setting you must use the CHANGE MASTER TO command.\n              STOP SLAVE; -- required if replication was already running\n              CHANGE MASTER TO MASTER_SSL_VERIFY_SERVER_CERT=1;\n              START SLAVE; -- required if you want to restart replication\"\n\n  query = 'select ssl_verify_server_cert from mysql.slave_master_info;'\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  master_ssl_verify_server_cert = sql_session.query(query).stdout.strip\n  if attribute('is_mysql_server_slave_configured')\n    describe 'The MASTER_SSL_VERIFY_SERVER_CERT' do\n      subject { master_ssl_verify_server_cert }\n      it { should cmp 1 }\n    end\n  else\n    impact 0.0\n    describe 'There is no mysql server slave configured, therfore this control is not applicable' do\n      skip 'There is no mysql server slave configured, therfore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/9.2.rb",
        "line": 1
      },
      "id": "9.2"
    },
    {
      "title": " Do Not Specify Passwords in Command Line (Not Scored)",
      "desc": "When a command is executed on the command line, for example mysql -u admin - p password, the password may be visible in the user's shell/command history or in the process list",
      "descriptions": {
        "default": "When a command is executed on the command line, for example mysql -u admin - p password, the password may be visible in the user's shell/command history or in the process list"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "2.2",
        "cis_level": 1,
        "nist": [
          "IA-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Check the process or task list if the password is visible.\n  Check the shell or command history if the password is visible",
        "fix": "Use -p without password and then enter the password when prompted, use a properly secured .my.cnf file, or store authentication information in encrypted format in .mylogin.cnf"
      },
      "code": "control '2.2' do\n  title ' Do Not Specify Passwords in Command Line (Not Scored)'\n  desc  \"When a command is executed on the command line, for example mysql -u admin - p password, the password may be visible in the user's shell/command history or in the process list\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '2.2'\n  tag \"cis_level\": 1\n  tag \"nist\": ['IA-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Check the process or task list if the password is visible.\n  Check the shell or command history if the password is visible\"\n  tag \"fix\": 'Use -p without password and then enter the password when prompted, use a properly secured .my.cnf file, or store authentication information in encrypted format in .mylogin.cnf'\n\n  bash_history_file = command(\"find / -name '.bash_history'\").stdout.strip\n\n  describe 'The linux bash history file' do\n    subject { file(bash_history_file.to_s) }\n    its('content') { should_not include attribute('password') }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/2.2.rb",
        "line": 1
      },
      "id": "2.2"
    },
    {
      "title": "Ensure Log Files Are Stored on a Non-System Partition (Scored)",
      "desc": "MySQL log files can be set in the MySQL configuration to exist anywhere on the filesystem.\n  It is common practice to ensure that the system filesystem is left uncluttered by applicationlogs.\n  System filesystems include the root, /var, or /usr.",
      "descriptions": {
        "default": "MySQL log files can be set in the MySQL configuration to exist anywhere on the filesystem.\n  It is common practice to ensure that the system filesystem is left uncluttered by applicationlogs.\n  System filesystems include the root, /var, or /usr."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.2",
        "cis_level": 1,
        "nist": [
          "AU-9(2)",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS in Linux",
        "check": "Execute the following SQL statement to assess this recommendation:\n    SELECT @@global.log_bin_basename;\n  Ensure the value returned does not indicate root ('/'), /var, or /usr.",
        "fix": "Perform the following actions to remediate this setting:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Locate the log-bin entry and set it to a file not on root ('/'), /var, or /usr"
      },
      "code": "control '6.2' do\n  title 'Ensure Log Files Are Stored on a Non-System Partition (Scored)'\n  desc  \"MySQL log files can be set in the MySQL configuration to exist anywhere on the filesystem.\n  It is common practice to ensure that the system filesystem is left uncluttered by applicationlogs.\n  System filesystems include the root, /var, or /usr.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.2'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-9(2)', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS in Linux'\n  tag \"check\": \"Execute the following SQL statement to assess this recommendation:\n    SELECT @@global.log_bin_basename;\n  Ensure the value returned does not indicate root ('/'), /var, or /usr.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Locate the log-bin entry and set it to a file not on root ('/'), /var, or /usr\"\n\n  query = %{select @@global.log_bin_basename;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  global_log_bin_basename = sql_session.query(query).stdout.strip.split\n\n  describe 'The mysql log files partition installed on' do\n    subject { command(\"df -h #{global_log_bin_basename}\").stdout }\n    it { should_not include '/' }\n  end\n\n  describe 'The mysql log files partition installed on' do\n    subject { command(\"df -h #{global_log_bin_basename}\").stdout }\n    it { should_not include '/var' }\n  end\n\n  describe 'The mysql log files partition installed on' do\n    subject { command(\"df -h #{global_log_bin_basename}\").stdout }\n    it { should_not include '/usr' }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.2.rb",
        "line": 1
      },
      "id": "6.2"
    },
    {
      "title": "Disable MySQL Command History (Scored)",
      "desc": "On Linux/UNIX, the MySQL client logs statements executed interactively to a history\n  file. By default, this file is named .mysql_history in the user's home directory. Most interactive commands run in the MySQL client application are saved to a history file.\n  The MySQL command history should be disabled.",
      "descriptions": {
        "default": "On Linux/UNIX, the MySQL client logs statements executed interactively to a history\n  file. By default, this file is named .mysql_history in the user's home directory. Most interactive commands run in the MySQL client application are saved to a history file.\n  The MySQL command history should be disabled."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "1.3",
        "cis_level": 2,
        "nist": [
          "CM-7",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS on Linux",
        "check": "Execute the following commands to assess this recommendation:\n  find /home -name '.mysql_history'\n  For each file returned determine whether that file is symbolically linked to /dev/null.",
        "fix": "Perform the following steps to remediate this setting:\n  1. Remove .mysql_history if it exists.\n  2. Use either of the techniques below to prevent it from being created again:\n  1. Set the MYSQL_HISTFILE environment variable to /dev/null. This will need to be placed in the shell's startup script.\n  2. Create $HOME/.mysql_history as a symbolic to /dev/null.\n  > ln -s /dev/null $HOME/.mysql_history\n  ",
        "Default Value": "By default, the MySQL command history file is located in $HOME/.mysql_history"
      },
      "code": "control '1.3' do\n  title 'Disable MySQL Command History (Scored)'\n  desc  \"On Linux/UNIX, the MySQL client logs statements executed interactively to a history\n  file. By default, this file is named .mysql_history in the user's home directory. Most interactive commands run in the MySQL client application are saved to a history file.\n  The MySQL command history should be disabled.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '1.3'\n  tag \"cis_level\": 2\n  tag \"nist\": ['CM-7', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS on Linux'\n  tag \"check\": \"Execute the following commands to assess this recommendation:\n  find /home -name '.mysql_history'\n  For each file returned determine whether that file is symbolically linked to /dev/null.\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\n  1. Remove .mysql_history if it exists.\n  2. Use either of the techniques below to prevent it from being created again:\n  1. Set the MYSQL_HISTFILE environment variable to /dev/null. This will need to be placed in the shell's startup script.\n  2. Create $HOME/.mysql_history as a symbolic to /dev/null.\n  > ln -s /dev/null $HOME/.mysql_history\n  \"\n  tag \"Default Value\": 'By default, the MySQL command history file is located in $HOME/.mysql_history'\n\n  history_file = command(\"find / -name '.mysql_history'\").stdout.strip.split(\"\\n\")\n\n  describe \"The MySql history file: #{history_file}\" do\n    subject { file(history_file.to_s) }\n    its('link_path') { should eq '/dev/null' }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/1.3.rb",
        "line": 1
      },
      "id": "1.3"
    },
    {
      "title": "Ensure 'general_log_file' Has Appropriate Permissions and Ownership (Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for different purposes. These are the binary log, error log, slow query log, relay log, audit log and general log. Because these are files on the host operating system, they are subject to the permissions and ownership structure provided by the host and may be accessible by users other than the MySQL user.",
      "descriptions": {
        "default": "MySQL can operate using a variety of log files, each used for different purposes. These are the binary log, error log, slow query log, relay log, audit log and general log. Because these are files on the host operating system, they are subject to the permissions and ownership structure provided by the host and may be accessible by users other than the MySQL user."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.6",
        "cis_level": 1,
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of general_log_file\n    show variables like 'general_log_file';\n  • Execute the following command at a terminal prompt to list all general_log_file.* files\n    ls <general_log_file>.*\n  • For each file listed, execute the following command\n    ls -l <general_log_file> | egrep '^-[r|w]{2}-[r|w]{2}---- *.*$''\n  Lack of output implies a finding",
        "fix": "Execute the following command for each log file location requiring corrected permissions and ownership:\n      chmod 660 <log file>\n      chown mysql:mysql <log file>"
      },
      "code": "control '3.6' do\n  title \"Ensure 'general_log_file' Has Appropriate Permissions and Ownership (Scored)\"\n  desc  'MySQL can operate using a variety of log files, each used for different purposes. These are the binary log, error log, slow query log, relay log, audit log and general log. Because these are files on the host operating system, they are subject to the permissions and ownership structure provided by the host and may be accessible by users other than the MySQL user.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '3.6'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-9', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of general_log_file\n    show variables like 'general_log_file';\n  • Execute the following command at a terminal prompt to list all general_log_file.* files\n    ls <general_log_file>.*\n  • For each file listed, execute the following command\n    ls -l <general_log_file> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$''\n  Lack of output implies a finding\"\n  tag \"fix\": \"Execute the following command for each log file location requiring corrected permissions and ownership:\n      chmod 660 <log file>\n      chown mysql:mysql <log file>\"\n\n  query = %{select @@general_log_file;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  general_log_file = sql_session.query(query).stdout.strip.split\n\n  describe directory(general_log_file.to_s) do\n    it { should exist }\n    its('owner') { should eq 'mysql' }\n    its('group') { should eq 'mysql' }\n    its('mode') { should be <= 0660 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/3.6.rb",
        "line": 1
      },
      "id": "3.6"
    },
    {
      "title": "Ensure Passwords Are Set for All MySQL Accounts (Scored)",
      "desc": "Blank passwords allow a user to login without using a password.",
      "descriptions": {
        "default": "Blank passwords allow a user to login without using a password."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.5",
        "cis_level": 2,
        "nist": [
          "IA-5(1)",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "Execute the following SQL query to determine if any users have a blank password:\n      SELECT User,host\n      FROM mysql.user\n      WHERE (plugin IN('mysql_native_password', 'mysql_old_password')\n        AND (LENGTH(authentication_string) = 0\n        OR authentication_string IS NULL))\n        OR (plugin='sha256_password' AND LENGTH(authentication_string) = 0);\n  No rows will be returned if all accounts have a password set.",
        "fix": "or each row returned from the audit procedure, set a password for the given user using the following statement (as an example):\n  SET PASSWORD FOR <user>@'<host>' = PASSWORD('<clear password>')\n  NOTE: Replace <user>, <host>, and <clear password> with appropriate values."
      },
      "code": "control '7.5' do\n  title 'Ensure Passwords Are Set for All MySQL Accounts (Scored)'\n  desc  'Blank passwords allow a user to login without using a password.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '7.5'\n  tag \"cis_level\": 1\n  tag \"cis_level\": 2\n  tag \"nist\": ['IA-5(1)', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL query to determine if any users have a blank password:\n      SELECT User,host\n      FROM mysql.user\n      WHERE (plugin IN('mysql_native_password', 'mysql_old_password')\n        AND (LENGTH(authentication_string) = 0\n        OR authentication_string IS NULL))\n        OR (plugin='sha256_password' AND LENGTH(authentication_string) = 0);\n  No rows will be returned if all accounts have a password set.\"\n  tag \"fix\": \"or each row returned from the audit procedure, set a password for the given user using the following statement (as an example):\n  SET PASSWORD FOR <user>@'<host>' = PASSWORD('<clear password>')\n  NOTE: Replace <user>, <host>, and <clear password> with appropriate values.\"\n\n  query = %{SELECT User,host\n      FROM mysql.user\n      WHERE (plugin IN('mysql_native_password', 'mysql_old_password')\n        AND (LENGTH(authentication_string) = 0\n        OR authentication_string IS NULL))\n        OR (plugin='sha256_password' AND LENGTH(authentication_string) = 0);}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  users_with_blank_passwords = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL users with blank passwords' do\n    subject { users_with_blank_passwords }\n    it { should be_empty }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/7.5.rb",
        "line": 1
      },
      "id": "7.5"
    },
    {
      "title": "Ensure 'create_user_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)",
      "desc": "The CREATE USER privilege governs the right of a given user to add or remove users, change existing users' names, or revoke existing users' privileges.",
      "descriptions": {
        "default": "The CREATE USER privilege governs the right of a given user to add or remove users, change existing users' names, or revoke existing users' privileges."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.6",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement to audit this setting:\n    SELECT user, host FROM mysql.user WHERE Create_user_priv = 'Y';\n  Ensure only administrative users are returned in the result set.",
        "fix": "Perform the following steps to remediate this setting:\n    1. Enumerate the non-administrative users found in the result set of the audit procedure\n    2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user):\n    REVOKE CREATE USER ON *.* FROM '<user>';"
      },
      "code": "control '5.6' do\n  title \"Ensure 'create_user_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)\"\n  desc  \"The CREATE USER privilege governs the right of a given user to add or remove users, change existing users' names, or revoke existing users' privileges.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '5.6'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to audit this setting:\n    SELECT user, host FROM mysql.user WHERE Create_user_priv = 'Y';\n  Ensure only administrative users are returned in the result set.\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\n    1. Enumerate the non-administrative users found in the result set of the audit procedure\n    2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user):\n    REVOKE CREATE USER ON *.* FROM '<user>';\"\n  query = %{select user from mysql.user where Create_user_priv = 'Y';}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  mysql_user_create_user_priv = sql_session.query(query).stdout.strip.split(\"\\n\")\n\n  if !mysql_user_create_user_priv.empty?\n    mysql_user_create_user_priv.each do |user|\n      describe \"The mysql user: #{user} with create_user_priv\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n  if mysql_user_create_user_priv.empty?\n    impact 0.0\n    describe 'There are no mysql users with create_user_priv allowed, therefore this control is not applicable' do\n      skip 'There are no mysql users with create_user_priv allowed, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/5.6.rb",
        "line": 1
      },
      "id": "5.6"
    },
    {
      "title": "Make sure the audit plugin can't be unloaded (Scored)",
      "desc": "Set audit_log to FORCE_PLUS_PERMANENT",
      "descriptions": {
        "default": "Set audit_log to FORCE_PLUS_PERMANENT"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.12",
        "cis_level": 1,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "To assess this recommendation, execute the following SQL statement:\n    SELECT LOAD_OPTION FROM information_schema.plugins WHERE PLUGIN_NAME='audit_log';\n  The result must be FORCE_PLUS_PERMANENT",
        "fix": "To remediate this setting, follow these steps:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Ensure the following line is found in the mysqld section\n  audit_log = 'FORCE_PLUS_PERMANENT'",
        "Default Value": "ON"
      },
      "code": "control '6.12' do\n  title \"Make sure the audit plugin can't be unloaded (Scored)\"\n  desc  'Set audit_log to FORCE_PLUS_PERMANENT'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.12'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"To assess this recommendation, execute the following SQL statement:\n    SELECT LOAD_OPTION FROM information_schema.plugins WHERE PLUGIN_NAME='audit_log';\n  The result must be FORCE_PLUS_PERMANENT\"\n  tag \"fix\": \"To remediate this setting, follow these steps:\n  1. Open the MySQL configuration file (my.cnf)\n  2. Ensure the following line is found in the mysqld section\n  audit_log = 'FORCE_PLUS_PERMANENT'\"\n  tag \"Default Value\": 'ON'\n\n  query = %{SELECT LOAD_OPTION FROM information_schema.plugins WHERE PLUGIN_NAME='audit_log';}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  audit_log_plugin = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL audit plugin' do\n    subject { audit_log_plugin }\n    it { should cmp 'FORCE_PLUS_PERMANENT' }\n  end\n\n  describe mysql_conf do\n    its('mysqld.audit_log') { should cmp 'FORCE_PLUS_PERMANENT' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.12.rb",
        "line": 1
      },
      "id": "6.12"
    },
    {
      "title": "Ensure 'local_infile' Is Disabled (Scored)",
      "desc": "The local_infile parameter dictates whether files located on the MySQL client's computer can be loaded or selected via LOAD DATA INFILE or SELECT local_file.",
      "descriptions": {
        "default": "The local_infile parameter dictates whether files located on the MySQL client's computer can be loaded or selected via LOAD DATA INFILE or SELECT local_file."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.4",
        "cis_level": 1,
        "nist": [
          "CM-7",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement and ensure the Value field is set to OFF:\n      SHOW VARIABLES WHERE Variable_name = 'local_infile';",
        "fix": "Add the following line to the [mysqld] section of the MySQL configuration file and restart the MySQL service:\n      local-infile=0",
        "Default Value": "ON"
      },
      "code": "control '4.4' do\n  title \"Ensure 'local_infile' Is Disabled (Scored)\"\n  desc  \"The local_infile parameter dictates whether files located on the MySQL client's computer can be loaded or selected via LOAD DATA INFILE or SELECT local_file.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '4.4'\n  tag \"cis_level\": 1\n  tag \"nist\": ['CM-7', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement and ensure the Value field is set to OFF:\n      SHOW VARIABLES WHERE Variable_name = 'local_infile';\"\n  tag \"fix\": \"Add the following line to the [mysqld] section of the MySQL configuration file and restart the MySQL service:\n      local-infile=0\"\n  tag \"Default Value\": 'ON'\n\n  query = %{select @@local_infile;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  local_infile = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL local_infile setting' do\n    subject { local_infile }\n    it { should cmp 0 }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/4.4.rb",
        "line": 1
      },
      "id": "4.4"
    },
    {
      "title": "Ensure 'old_passwords' Is Not Set to '1' (Scored)",
      "desc": "This variable controls the password hashing method used by the PASSWORD() function and for the IDENTIFIED BY clause of the CREATE USER and GRANT statements.\n  The value can be one of the following:\n    • 0 - authenticate with the mysql_native_password plugin\n    • 1 - authenticate with the mysql_old_password plugin\n    • 2 - authenticate with the sha256_password plugin",
      "descriptions": {
        "default": "This variable controls the password hashing method used by the PASSWORD() function and for the IDENTIFIED BY clause of the CREATE USER and GRANT statements.\n  The value can be one of the following:\n    • 0 - authenticate with the mysql_native_password plugin\n    • 1 - authenticate with the mysql_old_password plugin\n    • 2 - authenticate with the sha256_password plugin"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.1",
        "cis_level": 1,
        "nist": [
          "IA-5(1)",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "\n  Execute the following SQL statement to assess this recommendation:\n    SHOW VARIABLES WHERE Variable_name = 'old_passwords';\n  Ensure the Value field is not set to 1.",
        "fix": "Configure mysql to leverage the mysql_native_password or sha256_password plugin. For more information, see:\n  • http://dev.mysql.com/doc/refman/5.6/en/password-hashing.html\n  • http://dev.mysql.com/doc/refman/5.6/en/sha256-authentication-plugin.html",
        "Default Value": "0"
      },
      "code": "control '7.1' do\n  title \"Ensure 'old_passwords' Is Not Set to '1' (Scored)\"\n  desc  \"This variable controls the password hashing method used by the PASSWORD() function and for the IDENTIFIED BY clause of the CREATE USER and GRANT statements.\n  The value can be one of the following:\n    • 0 - authenticate with the mysql_native_password plugin\n    • 1 - authenticate with the mysql_old_password plugin\n    • 2 - authenticate with the sha256_password plugin\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '7.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['IA-5(1)', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"\n  Execute the following SQL statement to assess this recommendation:\n    SHOW VARIABLES WHERE Variable_name = 'old_passwords';\n  Ensure the Value field is not set to 1.\"\n  tag \"fix\": \"Configure mysql to leverage the mysql_native_password or sha256_password plugin. For more information, see:\n  • http://dev.mysql.com/doc/refman/5.6/en/password-hashing.html\n  • http://dev.mysql.com/doc/refman/5.6/en/sha256-authentication-plugin.html\"\n  tag \"Default Value\": '0'\n\n  query = %{SELECT @@old_passwords;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  old_passwords = sql_session.query(query).stdout.strip\n\n  describe \"The MySQL old_passwords variable set to: #{old_passwords}\" do\n    subject { old_passwords }\n    it { should_not cmp 1 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/7.1.rb",
        "line": 1
      },
      "id": "7.1"
    },
    {
      "title": "Ensure Password Policy Is in Place (Scored)",
      "desc": "Password complexity includes password characteristics such as length, case, length, and character sets.",
      "descriptions": {
        "default": "Password complexity includes password characteristics such as length, case, length, and character sets."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_level": 1,
        "nist": [
          "IA-5(1)",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statements to assess this recommendation:\n    SHOW VARIABLES LIKE 'validate_password%';\n\n  The result set from the above statement should show:\n    • validate_password_length should be 14 or more\n    • validate_password_mixed_case_count should be 1 or more\n    • validate_password_number_count should be 1 or more\n    • validate_password_special_char_count should be 1 or more\n    • validate_password_policy should be MEDIUM or STRONG\n\n  The following lines should be present in the global configuration:\n    plugin-load=validate_password.so\n    validate-password=FORCE_PLUS_PERMANENT\n\n  Check if users have a password which is identical to the username:\n    * the Password field is now called authentication_string\n    SELECT User,authentication_string,Host FROM mysql.user\n    WHERE authentication_string=CONCAT('*', UPPER(SHA1(UNHEX(SHA1(user)))));\n\n  NOTE: This method is only capable of checking the post-4.1 password format which is also known as mysql_native_password.",
        "fix": "Add to the global configuration:\n\n      plugin-load=validate_password.so\n      validate-password=FORCE_PLUS_PERMANENT\n       validate_password_length=14\n       validate_password_mixed_case_count=1\n       validate_password_number_count=1\n       validate_password_special_char_count=1\n       validate_password_policy=MEDIUM\n\n  And change passwords for users which have passwords which are identical to their username."
      },
      "code": "control '7.6' do\n  title 'Ensure Password Policy Is in Place (Scored)'\n  desc  'Password complexity includes password characteristics such as length, case, length, and character sets.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_level\": 1\n  tag \"nist\": ['IA-5(1)', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statements to assess this recommendation:\n    SHOW VARIABLES LIKE 'validate_password%';\n\n  The result set from the above statement should show:\n    • validate_password_length should be 14 or more\n    • validate_password_mixed_case_count should be 1 or more\n    • validate_password_number_count should be 1 or more\n    • validate_password_special_char_count should be 1 or more\n    • validate_password_policy should be MEDIUM or STRONG\n\n  The following lines should be present in the global configuration:\n    plugin-load=validate_password.so\n    validate-password=FORCE_PLUS_PERMANENT\n\n  Check if users have a password which is identical to the username:\n    * the Password field is now called authentication_string\n    SELECT User,authentication_string,Host FROM mysql.user\n    WHERE authentication_string=CONCAT('*', UPPER(SHA1(UNHEX(SHA1(user)))));\n\n  NOTE: This method is only capable of checking the post-4.1 password format which is also known as mysql_native_password.\"\n  tag \"fix\": \"Add to the global configuration:\n\n      plugin-load=validate_password.so\n      validate-password=FORCE_PLUS_PERMANENT\n       validate_password_length=14\n       validate_password_mixed_case_count=1\n       validate_password_number_count=1\n       validate_password_special_char_count=1\n       validate_password_policy=MEDIUM\n\n  And change passwords for users which have passwords which are identical to their username.\"\n\n  validate_password_length_query = %{SELECT @@validate_password_length}\n  validate_password_mixed_case_count_query = %{SELECT @@validate_password_mixed_case_count}\n  validate_password_number_count_query = %{SELECT @@validate_password_number_count}\n  validate_password_special_char_count_query = %{SELECT @@validate_password_special_char_count}\n  validate_password_policy_query = %{SELECT @@validate_password_policy}\n  validate_password_check_user_name_query = %{SELECT @@validate_password_check_user_name}\n  users_wih_username_equal_to_password_query = %{SELECT User,authentication_string,Host FROM mysql.user\n    WHERE authentication_string=CONCAT('*', UPPER(SHA1(UNHEX(SHA1(user)))));}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  validate_password_length = sql_session.query(validate_password_length_query).stdout.strip\n  validate_password_mixed_case_count = sql_session.query(validate_password_mixed_case_count_query).stdout.strip\n  validate_password_number_count = sql_session.query(validate_password_number_count_query).stdout.strip\n  validate_password_special_char_count = sql_session.query(validate_password_special_char_count_query).stdout.strip\n  validate_password_policy = sql_session.query(validate_password_policy_query).stdout.strip\n  validate_password_check_user_name = sql_session.query(validate_password_check_user_name_query).stdout.strip\n  users_wih_username_equal_to_password = sql_session.query(users_wih_username_equal_to_password_query).stdout.strip\n\n  describe 'The MySQL validate_password_length variable' do\n    subject { validate_password_length }\n    it { should cmp >= 14 }\n  end\n\n  describe 'The MySQL validate_password_mixed_case_count variable' do\n    subject { validate_password_mixed_case_count }\n    it { should cmp >= 1 }\n  end\n\n  describe 'The MySQL validate_password_number_count variable' do\n    subject { validate_password_number_count }\n    it { should cmp >= 1 }\n  end\n\n  describe 'The MySQL validate_password_special_char_count variable' do\n    subject { validate_password_special_char_count }\n    it { should cmp >= 1 }\n  end\n\n  describe.one do\n    describe 'The MySQL validate_password_policy variable' do\n      subject { validate_password_policy }\n      it { should cmp 'MEDIUM' }\n    end\n    describe 'The MySQL validate_password_policy variable' do\n      subject { validate_password_policy }\n      it { should cmp 'STRONG' }\n    end\n  end\n\n  describe mysql_conf do\n    its('plugin-load') { should cmp 'validate_password.so' }\n    its('validate-password') { should cmp 'FORCE_PLUS_PERMANENT' }\n  end\n\n  describe.one do\n    describe 'The MySQL validate_password_check_user_name variable' do\n      subject { validate_password_check_user_name }\n      it { should cmp 1 }\n    end\n    describe 'The MySQL users with their password identical to their username' do\n      subject { users_wih_username_equal_to_password }\n      it { should be_empty }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/7.6.rb",
        "line": 1
      },
      "id": "7.6"
    },
    {
      "title": "Ensure audit_log_policy is set to log logins (Scored)",
      "desc": "With the audit_log_policy setting the amount of information which is sent to the audit log is controlled. It must be set to log logins.",
      "descriptions": {
        "default": "With the audit_log_policy setting the amount of information which is sent to the audit log is controlled. It must be set to log logins."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.8",
        "cis_level": 1,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "SHOW GLOBAL VARIABLES LIKE 'audit_log_policy';\n  The result must be LOGINS or ALL.",
        "fix": "Set audit_log_policy='ALL' or audit_log_policy='LOGINS' in the MySQL configuration file and activate the setting by restarting the server or executing\n   SET GLOBAL audit_log_policy='ALL'; or SET GLOBAL audit_log_policy='LOGINS';",
        "Default Value": "ALL"
      },
      "code": "control '6.8' do\n  title 'Ensure audit_log_policy is set to log logins (Scored)'\n  desc  'With the audit_log_policy setting the amount of information which is sent to the audit log is controlled. It must be set to log logins.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.8'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"SHOW GLOBAL VARIABLES LIKE 'audit_log_policy';\n  The result must be LOGINS or ALL.\"\n  tag \"fix\": \"Set audit_log_policy='ALL' or audit_log_policy='LOGINS' in the MySQL configuration file and activate the setting by restarting the server or executing\n   SET GLOBAL audit_log_policy='ALL'; or SET GLOBAL audit_log_policy='LOGINS';\"\n  tag \"Default Value\": 'ALL'\n\n  query = %{SELECT @@audit_log_policy;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  audit_log_policy = sql_session.query(query).stdout.strip\n\n  describe.one do\n    describe 'The MySQL audit_log_policy' do\n      subject { audit_log_policy }\n      it { should cmp 'ALL' }\n    end\n    describe 'The MySQL audit_log_policy' do\n      subject { audit_log_policyy }\n      it { should cmp 'LOGINS' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.8.rb",
        "line": 1
      },
      "id": "6.8"
    },
    {
      "title": "Ensure 'repl_slave_priv' Is Not Set to 'Y' for Non-Slave Users (Scored)",
      "desc": "The REPLICATION SLAVE privilege governs whether a given user\n  (in the context of the master server) can request updates that have been made on the master server.",
      "descriptions": {
        "default": "The REPLICATION SLAVE privilege governs whether a given user\n  (in the context of the master server) can request updates that have been made on the master server."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.8",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement to audit this setting:\n      SELECT user, host FROM mysql.user WHERE Repl_slave_priv = 'Y';\n  Ensure only accounts designated for slave users are granted this privilege.",
        "fix": "Perform the following steps to remediate this setting:\n  1. Enumerate the non-slave users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>'' with the non-slave user):\n    REVOKE REPLICATION SLAVE ON *.* FROM <user>;\n  Use the REVOKE statement to remove the SUPER privilege from users who shouldn't have it."
      },
      "code": "control '5.8' do\n  title \"Ensure 'repl_slave_priv' Is Not Set to 'Y' for Non-Slave Users (Scored)\"\n  desc  \"The REPLICATION SLAVE privilege governs whether a given user\n  (in the context of the master server) can request updates that have been made on the master server.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '5.8'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to audit this setting:\n      SELECT user, host FROM mysql.user WHERE Repl_slave_priv = 'Y';\n  Ensure only accounts designated for slave users are granted this privilege.\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\n  1. Enumerate the non-slave users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>'' with the non-slave user):\n    REVOKE REPLICATION SLAVE ON *.* FROM <user>;\n  Use the REVOKE statement to remove the SUPER privilege from users who shouldn't have it.\"\n\n  query = %{select user from mysql.user where Repl_slave_priv = 'Y';}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  mysql_user_repl_slave_priv = sql_session.query(query).stdout.strip.split(\"\\n\")\n\n  if !mysql_user_repl_slave_priv.empty?\n    mysql_user_repl_slave_priv.each do |user|\n      describe \"The mysql user: #{user} with repl_slave_priv\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n  if mysql_user_repl_slave_priv.empty?\n    impact 0.0\n    describe 'There are no mysql users with repl_slave_priv allowed, therefore this control is not applicable' do\n      skip 'There are no mysql users with repl_slave_priv allowed, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/5.8.rb",
        "line": 1
      },
      "id": "5.8"
    },
    {
      "title": "Ensure 'process_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)",
      "desc": "The PROCESS privilege found in the mysql.user table determines whether a given user can see statement execution information for all sessions.",
      "descriptions": {
        "default": "The PROCESS privilege found in the mysql.user table determines whether a given user can see statement execution information for all sessions."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.3",
        "cis_level": 2,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "Execute the following SQL statement to audit this setting:\n    select user, host from mysql.user where Process_priv = 'Y';\n  Ensure only administrative users are returned in the result set.",
        "fix": "Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user:\n    REVOKE PROCESS ON *.* FROM '<user>';"
      },
      "code": "control '5.3' do\n  title \"Ensure 'process_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)\"\n  desc  'The PROCESS privilege found in the mysql.user table determines whether a given user can see statement execution information for all sessions.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '5.3'\n  tag \"cis_level\": 2\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to audit this setting:\n    select user, host from mysql.user where Process_priv = 'Y';\n  Ensure only administrative users are returned in the result set.\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user:\n    REVOKE PROCESS ON *.* FROM '<user>';\"\n  query = %{select user from mysql.user where Process_priv = 'Y';}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  mysql_user_process_priv = sql_session.query(query).stdout.strip.split(\"\\n\")\n\n  if !mysql_user_process_priv.empty?\n    mysql_user_process_priv.each do |user|\n      describe \"The mysql user: #{user} with process_priv\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n  if mysql_user_process_priv.empty?\n    impact 0.0\n    describe 'There are no mysql users with process_priv allowed, therefore this control is not applicable' do\n      skip 'There are no mysql users with process_priv allowed, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/5.3.rb",
        "line": 1
      },
      "id": "5.3"
    },
    {
      "title": "Ensure 'mysqld' Is Not Started with '--skip-grant-tables' (Scored)",
      "desc": "This option causes mysqld to start without using the privilege system.",
      "descriptions": {
        "default": "This option causes mysqld to start without using the privilege system."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.5",
        "cis_level": 1,
        "nist": [
          "CM-7",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Perform the following to determine if the recommended state is in place:\n  • Open the MySQL configuration (e.g. my.cnf) file and search for skip-grant-tables\n  • Ensure skip-grant-tables is set to FALSE",
        "fix": "Perform the following to establish the recommended state:\n  • Open the MySQL configuration (e.g. my.cnf) file and set:\n    skip-grant-tables = FALSE"
      },
      "code": "control '4.5' do\n  title \"Ensure 'mysqld' Is Not Started with '--skip-grant-tables' (Scored)\"\n  desc  'This option causes mysqld to start without using the privilege system.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '4.5'\n  tag \"cis_level\": 1\n  tag \"nist\": ['CM-7', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Perform the following to determine if the recommended state is in place:\n  • Open the MySQL configuration (e.g. my.cnf) file and search for skip-grant-tables\n  • Ensure skip-grant-tables is set to FALSE\"\n  tag \"fix\": \"Perform the following to establish the recommended state:\n  • Open the MySQL configuration (e.g. my.cnf) file and set:\n    skip-grant-tables = FALSE\"\n\n  describe mysql_conf do\n    its('skip-grant-tables') { should cmp 'FALSE' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/4.5.rb",
        "line": 1
      },
      "id": "4.5"
    },
    {
      "title": "Ensure 'super_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)",
      "desc": "The SUPER privilege found in the mysql.user table governs the use of a variety of MySQL features.\n  These features include, CHANGE MASTER TO, KILL, mysql admin kill option, PURGE BINARY LOGS, SET GLOBAL, mysqladmin debug option, logging control, and more.",
      "descriptions": {
        "default": "The SUPER privilege found in the mysql.user table governs the use of a variety of MySQL features.\n  These features include, CHANGE MASTER TO, KILL, mysql admin kill option, PURGE BINARY LOGS, SET GLOBAL, mysqladmin debug option, logging control, and more."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.4",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement to audit this setting:\n    select user, host from mysql.user where Super_priv = 'Y';\n  Ensure only administrative users are returned in the result set.",
        "fix": "Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user:\n    REVOKE SUPER ON *.* FROM '<user>';"
      },
      "code": "control '5.4' do\n  title \"Ensure 'super_priv' Is Not Set to 'Y' for Non-Administrative Users (Scored)\"\n  desc  \"The SUPER privilege found in the mysql.user table governs the use of a variety of MySQL features.\n  These features include, CHANGE MASTER TO, KILL, mysql admin kill option, PURGE BINARY LOGS, SET GLOBAL, mysqladmin debug option, logging control, and more.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '5.4'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to audit this setting:\n    select user, host from mysql.user where Super_priv = 'Y';\n  Ensure only administrative users are returned in the result set.\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\n  1. Enumerate the non-administrative users found in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>' with the non- administrative user:\n    REVOKE SUPER ON *.* FROM '<user>';\"\n  query = %{select user from mysql.user where Super_priv = 'Y';}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  mysql_user_super_priv = sql_session.query(query).stdout.strip.split(\"\\n\")\n\n  if !mysql_user_super_priv.empty?\n    mysql_user_super_priv.each do |user|\n      describe \"The mysql user: #{user} with super_priv\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n  if mysql_user_super_priv.empty?\n    impact 0.0\n    describe 'There are no mysql users with super_priv allowed, therefore this control is not applicable' do\n      skip 'There are no mysql users with super_priv allowed, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/5.4.rb",
        "line": 1
      },
      "id": "5.4"
    },
    {
      "title": "Ensure 'datadir' Has Appropriate Permissions and Ownership (Scored)",
      "desc": "The data directory is the location of the MySQL databases.",
      "descriptions": {
        "default": "The data directory is the location of the MySQL databases."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.1",
        "cis_level": 1,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of datadir\n      show variables where variable_name = 'datadir';\n  • Execute the following command at a terminal prompt\n    ls -l <datadir>/.. | egrep '^d[r|w|x]{3}------ *. *mysql *mysql *d*.*mysql'\n  Lack of output implies a finding.\n  ",
        "fix": "Execute the following commands at a terminal prompt:\n      chmod 700 <datadir>\n      chown mysql:mysql <datadir>"
      },
      "code": "control '3.1' do\n  title \"Ensure 'datadir' Has Appropriate Permissions and Ownership (Scored)\"\n  desc  'The data directory is the location of the MySQL databases.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '3.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of datadir\n      show variables where variable_name = 'datadir';\n  • Execute the following command at a terminal prompt\n    ls -l <datadir>/.. | egrep '^d[r|w|x]{3}------\\s*.\\s*mysql\\s*mysql\\s*\\d*.*mysql'\n  Lack of output implies a finding.\n  \"\n  tag \"fix\": \"Execute the following commands at a terminal prompt:\n      chmod 700 <datadir>\n      chown mysql:mysql <datadir>\"\n\n  query = %{select @@datadir;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  datadir = sql_session.query(query).stdout.strip.split\n\n  describe directory(datadir.to_s) do\n    it { should exist }\n    its('owner') { should eq 'mysql' }\n    its('group') { should eq 'mysql' }\n    its('mode') { should be <= 0700 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/3.1.rb",
        "line": 1
      },
      "id": "3.1"
    },
    {
      "title": "Ensure 'log_error' Has Appropriate Permissions and Ownership (Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions and ownership structure provided by the host and may be accessible by users other than the MySQL user",
      "descriptions": {
        "default": "MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions and ownership structure provided by the host and may be accessible by users other than the MySQL user"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.3",
        "cis_level": 1,
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of log_error\n    show variables like 'log_error';\n  • Execute the following command at a terminal prompt to list all log_error.* files\n    ls <log_error>.*\n  • For each file listed, execute the following command\n    ls -l <log_error> | egrep '^-[r|w]{2}-[r|w]{2}---- *.*$'\n  Lack of output implies a finding.",
        "fix": "Execute the following command for each log file location requiring corrected permissions and ownership:\n    chmod 660 <log file>\n    chown mysql:mysql <log file>"
      },
      "code": "control '3.3' do\n  title \"Ensure 'log_error' Has Appropriate Permissions and Ownership (Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for different purposes.\n  These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions and ownership structure provided by the host and may be accessible by users other than the MySQL user\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '3.3'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-9', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Perform the following steps to assess this recommendation:\n  • Execute the following SQL statement to determine the Value of log_error\n    show variables like 'log_error';\n  • Execute the following command at a terminal prompt to list all log_error.* files\n    ls <log_error>.*\n  • For each file listed, execute the following command\n    ls -l <log_error> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$'\n  Lack of output implies a finding.\"\n  tag \"fix\": \"Execute the following command for each log file location requiring corrected permissions and ownership:\n    chmod 660 <log file>\n    chown mysql:mysql <log file>\"\n  query = %{select @@log_error;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  log_error = sql_session.query(query).stdout.strip.split\n\n  describe directory(log_error.to_s) do\n    it { should exist }\n    its('owner') { should eq 'mysql' }\n    its('group') { should eq 'mysql' }\n    its('mode') { should be <= 0660 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/3.3.rb",
        "line": 1
      },
      "id": "3.3"
    },
    {
      "title": "4.1 Ensure Latest Security Patches Are Applied (Not Scored)",
      "desc": "Periodically, updates to MySQL server are released to resolve bugs, mitigate vulnerabilities, and provide new features.\n  It is recommended that MySQL installations are up to date with the latest security updates",
      "descriptions": {
        "default": "Periodically, updates to MySQL server are released to resolve bugs, mitigate vulnerabilities, and provide new features.\n  It is recommended that MySQL installations are up to date with the latest security updates"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.1",
        "cis_level": 1,
        "nist": [
          "SI-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "\n  Execute the following SQL statement to identify the MySQL server version:\n    SHOW VARIABLES WHERE Variable_name LIKE 'version';\n  Now compare the version with the security announcements from Oracle and/or the OS if the OS packages are used",
        "fix": "Install the latest patches for your version or upgrade to the latest version"
      },
      "code": "control '4.1' do\n  title '4.1 Ensure Latest Security Patches Are Applied (Not Scored)'\n  desc  \"Periodically, updates to MySQL server are released to resolve bugs, mitigate vulnerabilities, and provide new features.\n  It is recommended that MySQL installations are up to date with the latest security updates\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '4.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['SI-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"\n  Execute the following SQL statement to identify the MySQL server version:\n    SHOW VARIABLES WHERE Variable_name LIKE 'version';\n  Now compare the version with the security announcements from Oracle and/or the OS if the OS packages are used\"\n  tag \"fix\": 'Install the latest patches for your version or upgrade to the latest version'\n  query = %{select @@version;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  mysql_version = sql_session.query(query).stdout.strip\n  safe_mysql_version = mysql_version.scan(/\\d\\.*/).join\n  describe \"The mysql version installed: #{mysql_version}\" do\n    subject { safe_mysql_version }\n    it { should cmp >= input('approved_mysql_version') }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/4.1.rb",
        "line": 1
      },
      "id": "4.1"
    },
    {
      "title": "Ensure Plugin Directory Has Appropriate Permissions and Ownership (Scored)",
      "desc": "The plugin directory is the location of the MySQL plugins.\n  Plugins are storage engines or user defined functions (UDFs)",
      "descriptions": {
        "default": "The plugin directory is the location of the MySQL plugins.\n  Plugins are storage engines or user defined functions (UDFs)"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.8",
        "cis_level": 1,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "To assess this recommendation, execute the following SQL statement to discover the Value of plugin_dir:\n  show variables where variable_name = 'plugin_dir';\n\n  Then, execute the following command at a terminal prompt (using the discovered plugin_dir Value) to determine the permissions and ownership.\n    ls -l <plugin_dir Value>/.. | egrep '^drwxr[-w]xr[-w]x[ \t]*[0-9][ \t]*mysql[ \t]*mysql.*plugin.*$'\n  Lack of output implies a finding.\n  NOTE: Permissions are intended to be either 775 or 755",
        "fix": "To remediate these settings, execute the following commands at a terminal prompt using the plugin_dir Value from the audit procedure.\n    chmod 775 <plugin_dir Value> (or use 755)\n    chown mysql:mysql <plugin_dir Value>"
      },
      "code": "control '3.8' do\n  title 'Ensure Plugin Directory Has Appropriate Permissions and Ownership (Scored)'\n  desc  \"The plugin directory is the location of the MySQL plugins.\n  Plugins are storage engines or user defined functions (UDFs)\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '3.8'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"To assess this recommendation, execute the following SQL statement to discover the Value of plugin_dir:\n  show variables where variable_name = 'plugin_dir';\n\n  Then, execute the following command at a terminal prompt (using the discovered plugin_dir Value) to determine the permissions and ownership.\n    ls -l <plugin_dir Value>/.. | egrep '^drwxr[-w]xr[-w]x[ \\t]*[0-9][ \\t]*mysql[ \\t]*mysql.*plugin.*$'\n  Lack of output implies a finding.\n  NOTE: Permissions are intended to be either 775 or 755\"\n  tag \"fix\": \"To remediate these settings, execute the following commands at a terminal prompt using the plugin_dir Value from the audit procedure.\n    chmod 775 <plugin_dir Value> (or use 755)\n    chown mysql:mysql <plugin_dir Value>\"\n  query = %{select @@plugin_dir;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  plugin_dir = sql_session.query(query).stdout.strip.split\n\n  describe directory(plugin_dir.to_s) do\n    it { should exist }\n    its('owner') { should eq 'mysql' }\n    its('group') { should eq 'mysql' }\n    its('mode') { should be <= 0775 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/3.8.rb",
        "line": 1
      },
      "id": "3.8"
    },
    {
      "title": "Ensure 'audit_log_file' has Appropriate Permissions and Ownership (Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for different purposes. These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions and ownership structure provided by the host and may be accessible by users other than the MySQL user",
      "descriptions": {
        "default": "MySQL can operate using a variety of log files, each used for different purposes. These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions and ownership structure provided by the host and may be accessible by users other than the MySQL user"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.9",
        "cis_level": 1,
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "To assess this recommendation, execute the following SQL statement to discover the audit_log_file value:\n    show global variables where variable_name='audit_log_file';\n  NOTE: If you see the audit file name but no path, the default path will be the path assigned to the datadir variable.\n  Then, execute the following command at a terminal prompt (using the discovered audit_log_file value):\n    ls -l <audit_log_file> | egrep '^-rw[-x]rw[-x][-r][-w][-x][ \t]*[0-9][ \t]*mysql[ \t]*mysql.*$'",
        "fix": "Execute the following commands for the audit_log_file discovered in the audit procedure:\n    chmod 660 <audit_log_file>\n    chown mysql:mysql <audit_log_file>"
      },
      "code": "control '3.9' do\n  title \"Ensure 'audit_log_file' has Appropriate Permissions and Ownership (Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for different purposes. These are the binary log, error log, slow query log, relay log, audit log and general log.\n  Because these are files on the host operating system, they are subject to the permissions and ownership structure provided by the host and may be accessible by users other than the MySQL user\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '3.9'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-9', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"To assess this recommendation, execute the following SQL statement to discover the audit_log_file value:\n    show global variables where variable_name='audit_log_file';\n  NOTE: If you see the audit file name but no path, the default path will be the path assigned to the datadir variable.\n  Then, execute the following command at a terminal prompt (using the discovered audit_log_file value):\n    ls -l <audit_log_file> | egrep '^-rw[-x]rw[-x][-r][-w][-x][ \\t]*[0-9][ \\t]*mysql[ \\t]*mysql.*$'\"\n  tag \"fix\": \"Execute the following commands for the audit_log_file discovered in the audit procedure:\n    chmod 660 <audit_log_file>\n    chown mysql:mysql <audit_log_file>\"\n\n  query = %{select @@audit_log_file;}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  audit_log_file = sql_session.query(query).stdout.strip.split\n\n  describe directory(audit_log_file.to_s) do\n    it { should exist }\n    its('owner') { should eq 'mysql' }\n    its('group') { should eq 'mysql' }\n    its('mode') { should be <= 0660 }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/3.9.rb",
        "line": 1
      },
      "id": "3.9"
    },
    {
      "title": "Dedicate Machine Running MySQL (Not Scored)",
      "desc": "It is recommended that MySQL Server software be installed on a dedicated server. This architectural consideration affords flexibility in that the database server can be placed on a separate zone allowing access only from particular hosts and over particular protocols",
      "descriptions": {
        "default": "It is recommended that MySQL Server software be installed on a dedicated server. This architectural consideration affords flexibility in that the database server can be placed on a separate zone allowing access only from particular hosts and over particular protocols"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "2.1",
        "cis_level": 1,
        "nist": [
          "SC-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Verify there are no other roles enabled for the underlying operating system and that no additional applications or services unrelated to the proper operation of the MySQL server software are installed.",
        "fix": "Remove excess applications or services and/or remove unnecessary roles from the underlying operating system"
      },
      "code": "control '2.1' do\n  title 'Dedicate Machine Running MySQL (Not Scored)'\n  desc  'It is recommended that MySQL Server software be installed on a dedicated server. This architectural consideration affords flexibility in that the database server can be placed on a separate zone allowing access only from particular hosts and over particular protocols'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '2.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['SC-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": 'Verify there are no other roles enabled for the underlying operating system and that no additional applications or services unrelated to the proper operation of the MySQL server software are installed.'\n  tag \"fix\": 'Remove excess applications or services and/or remove unnecessary roles from the underlying operating system'\n  describe 'A manual review is required to verify a dedicated machine is running MySQL' do\n    skip 'A manual review is required to verify a dedicated machine is running MySQL'\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/2.1.rb",
        "line": 1
      },
      "id": "2.1"
    },
    {
      "title": "Ensure DML/DDL Grants Are Limited to Specific Databases and Users (Scored)",
      "desc": "DML/DDL includes the set of privileges used to modify or create data structures.\n  This includes INSERT, SELECT, UPDATE, DELETE, DROP, CREATE, and ALTER privileges.",
      "descriptions": {
        "default": "DML/DDL includes the set of privileges used to modify or create data structures.\n  This includes INSERT, SELECT, UPDATE, DELETE, DROP, CREATE, and ALTER privileges."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.9",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "\n  Execute the following SQL statement to audit this setting:\n    SELECT User,Host,Db\n    FROM mysql.db\n    WHERE Select_priv='Y'\n      OR Insert_priv='Y'\n      OR Update_priv='Y'\n      OR Delete_priv='Y'\n      OR Create_priv='Y'\n      OR Drop_priv='Y'\n      OR Alter_priv='Y';\n  Ensure all users returned should have these privileges on the indicated databases.\n  NOTE: Global grants are covered in Recommendation 4.1.",
        "fix": "\n  Perform the following steps to remediate this setting:\n  1. Enumerate the unauthorized users, hosts, and databases returned in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>'' with the unauthorized user,\n  '<host>'' with host name, and '<database>' with the database name):\n    REVOKE SELECT ON <host>.<database> FROM <user>;\n    REVOKE INSERT ON <host>.<database> FROM <user>;\n    REVOKE UPDATE ON <host>.<database> FROM <user>;\n    REVOKE DELETE ON <host>.<database> FROM <user>;\n     REVOKE CREATE ON <host>.<database> FROM <user>;\n     REVOKE DROP ON <host>.<database> FROM <user>;\n     REVOKE ALTER ON <host>.<database> FROM <user>;"
      },
      "code": "control '5.9' do\n  title 'Ensure DML/DDL Grants Are Limited to Specific Databases and Users (Scored)'\n  desc  \"DML/DDL includes the set of privileges used to modify or create data structures.\n  This includes INSERT, SELECT, UPDATE, DELETE, DROP, CREATE, and ALTER privileges.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '5.9'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"\n  Execute the following SQL statement to audit this setting:\n    SELECT User,Host,Db\n    FROM mysql.db\n    WHERE Select_priv='Y'\n      OR Insert_priv='Y'\n      OR Update_priv='Y'\n      OR Delete_priv='Y'\n      OR Create_priv='Y'\n      OR Drop_priv='Y'\n      OR Alter_priv='Y';\n  Ensure all users returned should have these privileges on the indicated databases.\n  NOTE: Global grants are covered in Recommendation 4.1.\"\n  tag \"fix\": \"\n  Perform the following steps to remediate this setting:\n  1. Enumerate the unauthorized users, hosts, and databases returned in the result set of the audit procedure\n  2. For each user, issue the following SQL statement (replace '<user>'' with the unauthorized user,\n  '<host>'' with host name, and '<database>' with the database name):\n    REVOKE SELECT ON <host>.<database> FROM <user>;\n    REVOKE INSERT ON <host>.<database> FROM <user>;\n    REVOKE UPDATE ON <host>.<database> FROM <user>;\n    REVOKE DELETE ON <host>.<database> FROM <user>;\n     REVOKE CREATE ON <host>.<database> FROM <user>;\n     REVOKE DROP ON <host>.<database> FROM <user>;\n     REVOKE ALTER ON <host>.<database> FROM <user>;\"\n  query = %{SELECT User\n    FROM mysql.db\n    WHERE Select_priv='Y'\n      OR Insert_priv='Y'\n      OR Update_priv='Y'\n      OR Delete_priv='Y'\n      OR Create_priv='Y'\n      OR Drop_priv='Y'\n      OR Alter_priv='Y';}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  mysql_user_privs = sql_session.query(query).stdout.strip.split(\"\\n\")\n\n  if !mysql_user_privs.empty?\n    mysql_user_privs.each do |user|\n      describe \"The mysql user: #{user} with privileges to modify or create data structures\" do\n        subject { user }\n        it { should be_in attribute('mysql_users_allowed_modify_or_create') }\n      end\n    end\n  end\n  if mysql_user_privs.empty?\n    impact 0.0\n    describe 'There are no mysql users allowed to modify or create data structures, therefore this control is not applicable' do\n      skip 'There are no mysql users allowed to modify or create data structures, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/5.9.rb",
        "line": 1
      },
      "id": "5.9"
    },
    {
      "title": "Ensure the 'daemon_memcached' Plugin Is Disabled (Scored)",
      "desc": "The InnoDB memcached Plugin allows users to access data stored in InnoDB with the memcached protocol.",
      "descriptions": {
        "default": "The InnoDB memcached Plugin allows users to access data stored in InnoDB with the memcached protocol."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.7",
        "cis_level": 1,
        "nist": [
          "CM-7",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement to assess this recommendation:\n    SELECT * FROM information_schema.plugins WHERE PLUGIN_NAME='daemon_memcached'\n  Ensure that no rows are returned.",
        "fix": "To remediate this setting, issue the following command in the MySQL command-line client:\n    uninstall plugin daemon_memcached;\n  This uninstalls the memcached plugin from the MySQL server.\n  ",
        "Default Value": "disabled"
      },
      "code": "control '4.7' do\n  title \"Ensure the 'daemon_memcached' Plugin Is Disabled (Scored)\"\n  desc  'The InnoDB memcached Plugin allows users to access data stored in InnoDB with the memcached protocol.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '4.7'\n  tag \"cis_level\": 1\n  tag \"nist\": ['CM-7', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to assess this recommendation:\n    SELECT * FROM information_schema.plugins WHERE PLUGIN_NAME='daemon_memcached'\n  Ensure that no rows are returned.\"\n  tag \"fix\": \"To remediate this setting, issue the following command in the MySQL command-line client:\n    uninstall plugin daemon_memcached;\n  This uninstalls the memcached plugin from the MySQL server.\n  \"\n  tag \"Default Value\": 'disabled'\n\n  query = %{SELECT * FROM information_schema.plugins WHERE PLUGIN_NAME='daemon_memcached'}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  daemon_memcached_plugin = sql_session.query(query).stdout.strip\n\n  describe 'The daemon_memcached plugins installed' do\n    subject { daemon_memcached_plugin }\n    it { should be_empty }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/4.7.rb",
        "line": 1
      },
      "id": "4.7"
    },
    {
      "title": "Ensure Only Administrative Users Have Full Database Access (Scored)",
      "desc": "The mysql.user and mysql.db tables list a variety of privileges that can be granted (or denied) to MySQL users.\n  Some of the privileges of concern include: Select_priv, Insert_priv,Update_priv,Delete_priv,Drop_priv,and so on.\n  Typically,these privileges should not be available to every MySQL user and often are reserved for administrative use only.",
      "descriptions": {
        "default": "The mysql.user and mysql.db tables list a variety of privileges that can be granted (or denied) to MySQL users.\n  Some of the privileges of concern include: Select_priv, Insert_priv,Update_priv,Delete_priv,Drop_priv,and so on.\n  Typically,these privileges should not be available to every MySQL user and often are reserved for administrative use only."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.1",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "\n  Execute the following SQL statement(s) to assess this recommendation:\n\n    SELECT user, host\n    FROM mysql.user\n    WHERE (Select_priv = 'Y')\n    OR (Insert_priv = 'Y') OR (Update_priv = 'Y') OR (Delete_priv = 'Y') OR (Create_priv = 'Y') OR (Drop_priv = 'Y');\n\n    SELECT user, host FROM mysql.db WHERE db = 'mysql'\n    AND ((Select_priv = 'Y') OR (Insert_priv = 'Y') OR (Update_priv = 'Y') OR (Delete_priv = 'Y') OR (Create_priv = 'Y')\n    OR (Drop_priv = 'Y'));\n  Ensure all users returned are administrative users.",
        "fix": "Perform the following actions to remediate this setting:\n  1. Enumerate non-administrative users resulting from the audit procedure\n  2. For each non-administrative user, use the REVOKE statement to remove privileges as\n  appropriate"
      },
      "code": "control '5.1' do\n  title 'Ensure Only Administrative Users Have Full Database Access (Scored)'\n  desc  \"The mysql.user and mysql.db tables list a variety of privileges that can be granted (or denied) to MySQL users.\n  Some of the privileges of concern include: Select_priv, Insert_priv,Update_priv,Delete_priv,Drop_priv,and so on.\n  Typically,these privileges should not be available to every MySQL user and often are reserved for administrative use only.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '5.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"\n  Execute the following SQL statement(s) to assess this recommendation:\n\n    SELECT user, host\n    FROM mysql.user\n    WHERE (Select_priv = 'Y')\n    OR (Insert_priv = 'Y') OR (Update_priv = 'Y') OR (Delete_priv = 'Y') OR (Create_priv = 'Y') OR (Drop_priv = 'Y');\n\n    SELECT user, host FROM mysql.db WHERE db = 'mysql'\n    AND ((Select_priv = 'Y') OR (Insert_priv = 'Y') OR (Update_priv = 'Y') OR (Delete_priv = 'Y') OR (Create_priv = 'Y')\n    OR (Drop_priv = 'Y'));\n  Ensure all users returned are administrative users.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n  1. Enumerate non-administrative users resulting from the audit procedure\n  2. For each non-administrative user, use the REVOKE statement to remove privileges as\n  appropriate\"\n  mysql_user_query = %{SELECT user\n    FROM mysql.user\n    WHERE (Select_priv = 'Y')\n    OR (Insert_priv = 'Y') OR (Update_priv = 'Y') OR (Delete_priv = 'Y') OR (Create_priv = 'Y') OR (Drop_priv = 'Y');\n    }\n  mysql_user_db_query = %{SELECT user, host FROM mysql.db WHERE db = 'mysql'\n    AND ((Select_priv = 'Y') OR (Insert_priv = 'Y') OR (Update_priv = 'Y') OR (Delete_priv = 'Y') OR (Create_priv = 'Y')\n    OR (Drop_priv = 'Y'));\n    }\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  mysql_user_privs = sql_session.query(mysql_user_query).stdout.strip.split(\"\\n\")\n  mysql_user_db_privs = sql_session.query(mysql_user_db_query).stdout.strip.split(\"\\n\")\n\n  if !mysql_user_privs.empty?\n    mysql_user_privs.each do |user|\n      describe \"The mysql user: #{user} with privilege access in the mysql.user table\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n  if !mysql_user_db_privs.empty?\n    mysql_user_db_privs.each do |user|\n      describe \"The mysql user: #{user} with privilege access in the mysql.db table\" do\n        subject { user }\n        it { should be_in attribute('mysql_administrative_users') }\n      end\n    end\n  end\n\n  if mysql_user_privs.empty? && mysql_user_db_privs.empty?\n    impact 0.0\n    describe 'There are no mysql users configured with full database access, therefore this control is not applicable' do\n      skip 'There are no mysql users configured with full database access, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/5.1.rb",
        "line": 1
      },
      "id": "5.1"
    },
    {
      "title": "Ensure 'super_priv' Is Not Set to 'Y' for Replication Users (Scored)",
      "desc": "The SUPER privilege found in the mysql.user table governs the use of a variety of MySQL features.\n  These features include, CHANGE MASTER TO, KILL, mysqladmin kill option, PURGE BINARY LOGS, SET GLOBAL,\n  mysqladmin debug option, logging control, and more.",
      "descriptions": {
        "default": "The SUPER privilege found in the mysql.user table governs the use of a variety of MySQL features.\n  These features include, CHANGE MASTER TO, KILL, mysqladmin kill option, PURGE BINARY LOGS, SET GLOBAL,\n  mysqladmin debug option, logging control, and more."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "9.4",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement to audit this setting:\n    select user, host from mysql.user where user='repl' and Super_priv = 'Y';\n  No rows should be returned.\n  NOTE: Substitute your replication user's name for repl in the above query.",
        "fix": "Execute the following steps to remediate this setting:\n  1. Enumerate the replication users found in the result set of the audit procedure\n  2. For each replication user, issue the following SQL statement (replace 'repl' with\n  your replication user's name):\n  REVOKE SUPER ON *.* FROM 'repl'"
      },
      "code": "control '9.4' do\n  title \"Ensure 'super_priv' Is Not Set to 'Y' for Replication Users (Scored)\"\n  desc  \"The SUPER privilege found in the mysql.user table governs the use of a variety of MySQL features.\n  These features include, CHANGE MASTER TO, KILL, mysqladmin kill option, PURGE BINARY LOGS, SET GLOBAL,\n  mysqladmin debug option, logging control, and more.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '9.4'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to audit this setting:\n    select user, host from mysql.user where user='repl' and Super_priv = 'Y';\n  No rows should be returned.\n  NOTE: Substitute your replication user's name for repl in the above query.\"\n  tag \"fix\": \"Execute the following steps to remediate this setting:\n  1. Enumerate the replication users found in the result set of the audit procedure\n  2. For each replication user, issue the following SQL statement (replace 'repl' with\n  your replication user's name):\n  REVOKE SUPER ON *.* FROM 'repl'\"\n  query = \"select user, host from mysql.user where user='repl' and Super_priv = 'Y';\"\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  super_priv = sql_session.query(query).stdout.strip\n  describe 'The replication users with the super_priv not set to Y' do\n    subject { super_priv }\n    it { should be_empty }\n  end\n\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/9.4.rb",
        "line": 1
      },
      "id": "9.4"
    },
    {
      "title": "Ensure Replication Traffic Is Secured (Not Scored)",
      "desc": "The replication traffic between servers should be secured.\n  Security measures should include ensuring the confidentiality and integrity of the traffic,\n  and performing mutual authentication between the servers before performing replication.",
      "descriptions": {
        "default": "The replication traffic between servers should be secured.\n  Security measures should include ensuring the confidentiality and integrity of the traffic,\n  and performing mutual authentication between the servers before performing replication."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "9.1",
        "cis_level": 1,
        "nist": [
          "SC-8",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Check if the replication traffic is using one or more of the following to provide confidentiality and integrity for the traffic, and mutual authentication for the servers:\n    • A private network\n    • A VPN\n    • SSL/TLS\n    • A SSH Tunnel",
        "fix": "Secure the network traffic using one or more technologies to provide confidentiality and integrity for the traffic, and mutual authentication for the servers."
      },
      "code": "control '9.1' do\n  title 'Ensure Replication Traffic Is Secured (Not Scored)'\n  desc  \"The replication traffic between servers should be secured.\n  Security measures should include ensuring the confidentiality and integrity of the traffic,\n  and performing mutual authentication between the servers before performing replication.\n  \"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '9.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['SC-8', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Check if the replication traffic is using one or more of the following to provide confidentiality and integrity for the traffic, and mutual authentication for the servers:\n    • A private network\n    • A VPN\n    • SSL/TLS\n    • A SSH Tunnel\"\n  tag \"fix\": 'Secure the network traffic using one or more technologies to provide confidentiality and integrity for the traffic, and mutual authentication for the servers.'\n\n  describe 'A manual review is required to ensure the replication traffic is secured' do\n    skip 'A manual review is required to ensure the replication traffic is secured'\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/9.1.rb",
        "line": 1
      },
      "id": "9.1"
    },
    {
      "title": "Use Dedicated Least Privileged Account for MySQL Daemon/Service (Scored)",
      "desc": "As with any service installed on a host, it can be provided with its own user context. Providing a dedicated user to the service provides the ability to precisely constrain the service within the larger host context.",
      "descriptions": {
        "default": "As with any service installed on a host, it can be provided with its own user context. Providing a dedicated user to the service provides the ability to precisely constrain the service within the larger host context."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "1.2",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Execute the following command at a terminal prompt to assess this recommendation:\n  ps -ef | egrep '^mysql.*$''\n  If no lines are returned, then this is a finding.\n  NOTE: It is assumed that the MySQL user is mysql. Additionally, you may consider running\n  sudo -l as the MySQL user or to check the sudoers file.",
        "fix": "Create a user which is only used for running MySQL and directly related processes. This user must not have administrative rights to the system."
      },
      "code": "control '1.2' do\n  title 'Use Dedicated Least Privileged Account for MySQL Daemon/Service (Scored)'\n  desc  'As with any service installed on a host, it can be provided with its own user context. Providing a dedicated user to the service provides the ability to precisely constrain the service within the larger host context.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '1.2'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Execute the following command at a terminal prompt to assess this recommendation:\n  ps -ef | egrep '^mysql.*$''\n  If no lines are returned, then this is a finding.\n  NOTE: It is assumed that the MySQL user is mysql. Additionally, you may consider running\n  sudo -l as the MySQL user or to check the sudoers file.\"\n  tag \"fix\": 'Create a user which is only used for running MySQL and directly related processes. This user must not have administrative rights to the system.'\n  describe 'The user runnning the MySQL Daemon/Service' do\n    subject { command(\"ps -ef | egrep '^mysql.*$' | awk {'print $1'}\").stdout.strip }\n    it { should cmp 'mysql' }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/1.2.rb",
        "line": 1
      },
      "id": "1.2"
    },
    {
      "title": "Ensure 'allow-suspicious-udfs' Is Set to 'FALSE' (Scored)",
      "desc": "This option prevents attaching arbitrary shared library functions as user-defined functions by checking for at least one corresponding method named _init, _deinit, _reset, _clear, or _add.",
      "descriptions": {
        "default": "This option prevents attaching arbitrary shared library functions as user-defined functions by checking for at least one corresponding method named _init, _deinit, _reset, _clear, or _add."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.3",
        "cis_level": 2,
        "nist": [
          "CM-7",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "Perform the following to determine if the recommended state is in place:\n  • Ensure --allow-suspicious-udfs is not specified in the the mysqld start up command line.\n  • Ensure allow-suspicious-udfs is set to FALSE in the MySQL configuration.",
        "fix": "Perform the following to establish the recommended state:\n  • Remove --allow-suspicious-udfs from the mysqld start up command line.\n  • Remove allow-suspicious-udfs from the MySQL option file.",
        "Default Value": "FALSE"
      },
      "code": "control '4.3' do\n  title \"Ensure 'allow-suspicious-udfs' Is Set to 'FALSE' (Scored)\"\n  desc  'This option prevents attaching arbitrary shared library functions as user-defined functions by checking for at least one corresponding method named _init, _deinit, _reset, _clear, or _add.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '4.3'\n  tag \"cis_level\": 2\n  tag \"nist\": ['CM-7', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"Perform the following to determine if the recommended state is in place:\n  • Ensure --allow-suspicious-udfs is not specified in the the mysqld start up command line.\n  • Ensure allow-suspicious-udfs is set to FALSE in the MySQL configuration.\"\n  tag \"fix\": \"Perform the following to establish the recommended state:\n  • Remove --allow-suspicious-udfs from the mysqld start up command line.\n  • Remove allow-suspicious-udfs from the MySQL option file.\"\n  tag \"Default Value\": 'FALSE'\n\n  describe mysql_conf do\n    its('allow-suspicious-udfs') { should be_nil }\n  end\n\n  describe command('ps aux | grep mysql') do\n    its('stdout') { should_not match 'allow-suspicious-udfs' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/4.3.rb",
        "line": 1
      },
      "id": "4.3"
    },
    {
      "title": "Ensure the 'test' Database Is Not Installed (Scored)",
      "desc": "The default MySQL installation comes with an unused database called test.\n  It is recommended that the test database be dropped",
      "descriptions": {
        "default": "The default MySQL installation comes with an unused database called test.\n  It is recommended that the test database be dropped"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.2",
        "cis_level": 1,
        "nist": [
          "CM-7",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "\n  Execute the following SQL statement to determine if the test database is present:\n    SHOW DATABASES LIKE 'test';\n  The above SQL statement will return zero rows",
        "fix": "Execute the following SQL statement to drop the test database:\n    DROP DATABASE 'test';\n  Note: mysql_secure_installation performs this operation as well as other security- related activities"
      },
      "code": "control '4.2' do\n  title \"Ensure the 'test' Database Is Not Installed (Scored)\"\n  desc  \"The default MySQL installation comes with an unused database called test.\n  It is recommended that the test database be dropped\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '4.2'\n  tag \"cis_level\": 1\n  tag \"nist\": ['CM-7', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"\n  Execute the following SQL statement to determine if the test database is present:\n    SHOW DATABASES LIKE 'test';\n  The above SQL statement will return zero rows\"\n  tag \"fix\": \"Execute the following SQL statement to drop the test database:\n    DROP DATABASE 'test';\n  Note: mysql_secure_installation performs this operation as well as other security- related activities\"\n\n  query = %{SHOW DATABASES LIKE 'test';}\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  database_present = sql_session.query(query).stdout.strip\n\n  describe 'The check whether the test database is installed' do\n    subject { database_present }\n    it { should be_empty }\n  end\n\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/4.2.rb",
        "line": 1
      },
      "id": "4.2"
    },
    {
      "title": "Ensure 'sql_mode' Contains 'STRICT_ALL_TABLES' (Scored)",
      "desc": "When data changing statements are made (i.e. INSERT, UPDATE), MySQL can handle invalid or missing values differently depending on whether strict SQL mode is enabled.\n  When strict SQL mode is enabled, data may not be truncated or otherwise 'adjusted' to make the data changing statement work",
      "descriptions": {
        "default": "When data changing statements are made (i.e. INSERT, UPDATE), MySQL can handle invalid or missing values differently depending on whether strict SQL mode is enabled.\n  When strict SQL mode is enabled, data may not be truncated or otherwise 'adjusted' to make the data changing statement work"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.9",
        "cis_level": 2,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "To audit for this recommendation execute the following query:\n    SHOW VARIABLES LIKE 'sql_mode';\n  Ensure that STRICT_ALL_TABLES is in the list returned.",
        "fix": "Perform the following actions to remediate this setting:\n    1. Add STRICT_ALL_TABLES to the sql_mode in the server's configuration file"
      },
      "code": "control '4.9' do\n  title \"Ensure 'sql_mode' Contains 'STRICT_ALL_TABLES' (Scored)\"\n  desc  \"When data changing statements are made (i.e. INSERT, UPDATE), MySQL can handle invalid or missing values differently depending on whether strict SQL mode is enabled.\n  When strict SQL mode is enabled, data may not be truncated or otherwise 'adjusted' to make the data changing statement work\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '4.9'\n  tag \"cis_level\": 2\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"To audit for this recommendation execute the following query:\n    SHOW VARIABLES LIKE 'sql_mode';\n  Ensure that STRICT_ALL_TABLES is in the list returned.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n    1. Add STRICT_ALL_TABLES to the sql_mode in the server's configuration file\"\n\n  query = 'SELECT @@sql_mode;'\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n  sql_mode = sql_session.query(query).stdout.strip\n  describe 'The sql_mode' do\n    subject { sql_mode }\n    it { should include 'STRICT_ALL_TABLES' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/4.9.rb",
        "line": 1
      },
      "id": "4.9"
    },
    {
      "title": "Ensure 'ssl_type' Is Set to 'ANY', 'X509', or 'SPECIFIED' for All Remote Users (Scored)",
      "desc": "All network traffic must use SSL/TLS when traveling over untrusted networks.\n  SSL/TLS should be enforced on a per-user basis for users which enter the system through the network.",
      "descriptions": {
        "default": "All network traffic must use SSL/TLS when traveling over untrusted networks.\n  SSL/TLS should be enforced on a per-user basis for users which enter the system through the network."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "8.2",
        "cis_level": 1,
        "nist": [
          "SC-8 (2)",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "\n  Execute the following SQL statements to assess this recommendation:\n    SELECT user, host, ssl_type FROM mysql.user\n    WHERE HOST NOT IN ('::1', '127.0.0.1', 'localhost');\n  Ensure the ssl_type for each user returned is equal to ANY, X509, or SPECIFIED.\n  NOTE: have_openssl is an alias for have_ssl as of MySQL 5.0.38. MySQL can be build with OpenSSL or YaSSL.",
        "fix": "Use the GRANT statement to require the use of SSL:\n  GRANT USAGE ON *.* TO 'my_user'@'app1.example.com' REQUIRE SSL;\n  Note that REQUIRE SSL only enforces SSL. There are options like REQUIRE X509, REQUIRE ISSUER, REQUIRE SUBJECT\n  which can be used to further restrict connection options.",
        "Default Value": "Not enforced (ssl_type is empty)"
      },
      "code": "control '8.2' do\n  title \"Ensure 'ssl_type' Is Set to 'ANY', 'X509', or 'SPECIFIED' for All Remote Users (Scored)\"\n  desc  \"All network traffic must use SSL/TLS when traveling over untrusted networks.\n  SSL/TLS should be enforced on a per-user basis for users which enter the system through the network.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '8.2'\n  tag \"cis_level\": 1\n  tag \"nist\": ['SC-8 (2)', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"\n  Execute the following SQL statements to assess this recommendation:\n    SELECT user, host, ssl_type FROM mysql.user\n    WHERE HOST NOT IN ('::1', '127.0.0.1', 'localhost');\n  Ensure the ssl_type for each user returned is equal to ANY, X509, or SPECIFIED.\n  NOTE: have_openssl is an alias for have_ssl as of MySQL 5.0.38. MySQL can be build with OpenSSL or YaSSL.\"\n  tag \"fix\": \"Use the GRANT statement to require the use of SSL:\n  GRANT USAGE ON *.* TO 'my_user'@'app1.example.com' REQUIRE SSL;\n  Note that REQUIRE SSL only enforces SSL. There are options like REQUIRE X509, REQUIRE ISSUER, REQUIRE SUBJECT\n  which can be used to further restrict connection options.\"\n  tag \"Default Value\": 'Not enforced (ssl_type is empty)'\n\n  query = %{SELECT user FROM mysql.user WHERE HOST NOT IN ('::1', '127.0.0.1', 'localhost');}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  remote_users = sql_session.query(query).stdout.strip.split(\"\\n\")\n\n  remote_users.each do |user|\n\n    query_ssl_type = \"SELECT ssl_type FROM mysql.user\n    WHERE HOST NOT IN ('::1', '127.0.0.1', 'localhost') AND user = '#{user}';\"\n    ssl_type = sql_session.query(query_ssl_type).stdout.strip\n\n    describe.one do\n      describe \"The ssl_type for remote user: #{user}\" do\n        subject { ssl_type }\n        it { should cmp 'ANY' }\n      end\n      describe \"The ssl_type for remote user: #{user}\" do\n        subject { ssl_type }\n        it { should cmp 'X509' }\n      end\n      describe \"The ssl_type for remote user: #{user}\" do\n        subject { ssl_type }\n        it { should cmp 'SPECIFIED' }\n      end\n    end\n  end\n  if remote_users.empty?\n    impact 0.0\n    describe 'There are no mysql remote users, therefore this control is not applicable' do\n      skip 'There are no mysql remote users, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/8.2.rb",
        "line": 1
      },
      "id": "8.2"
    },
    {
      "title": "Ensure 'have_ssl' Is Set to 'YES' (Scored)",
      "desc": "All network traffic must use SSL/TLS when traveling over untrusted networks.",
      "descriptions": {
        "default": "All network traffic must use SSL/TLS when traveling over untrusted networks."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "8.1",
        "cis_level": 1,
        "nist": [
          "SC-8 (2)",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statements to assess this recommendation:\n  SHOW variables WHERE variable_name = 'have_ssl';\n  Ensure the Value returned is YES.\n  NOTE: have_openssl is an alias for have_ssl as of MySQL 5.0.38. MySQL can be build\n  with OpenSSL or YaSSL.",
        "fix": "Follow the procedures as documented in the MySQL 5.6 Reference Manual to setup SSL.",
        "Default Value": "DISABLED"
      },
      "code": "control '8.1' do\n  title \"Ensure 'have_ssl' Is Set to 'YES' (Scored)\"\n  desc  'All network traffic must use SSL/TLS when traveling over untrusted networks.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '8.1'\n  tag \"cis_level\": 1\n  tag \"nist\": ['SC-8 (2)', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statements to assess this recommendation:\n  SHOW variables WHERE variable_name = 'have_ssl';\n  Ensure the Value returned is YES.\n  NOTE: have_openssl is an alias for have_ssl as of MySQL 5.0.38. MySQL can be build\n  with OpenSSL or YaSSL.\"\n  tag \"fix\": 'Follow the procedures as documented in the MySQL 5.6 Reference Manual to setup SSL.'\n  tag \"Default Value\": 'DISABLED'\n\n  query = %{SELECT @@have_ssl;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  have_ssl = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL have_ssl variable' do\n    subject { have_ssl }\n    it { should cmp 'YES' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/8.1.rb",
        "line": 1
      },
      "id": "8.1"
    },
    {
      "title": "Ensure 'log-raw' Is Set to 'OFF' (Scored)",
      "desc": "The log-raw MySQL option determines whether passwords are rewritten by the server so as not to appear in log files as plain text.\n  If log-raw is enabled, then passwords are written to the various log files (general query log, slow query log, and binary log) in plain text.",
      "descriptions": {
        "default": "The log-raw MySQL option determines whether passwords are rewritten by the server so as not to appear in log files as plain text.\n  If log-raw is enabled, then passwords are written to the various log files (general query log, slow query log, and binary log) in plain text."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "6.4",
        "cis_level": 1,
        "nist": [
          "AU-2",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "\n  Perform the following actions to assess this recommendation:\n  • Open the MySQL configuration file (my.cnf)\n  • Ensure the log-raw entry is present\n  • Ensure the log-raw entry is set to OFF",
        "fix": "\n  Perform the following actions to remediate this setting:\n  • Open the MySQL configuration file (my.cnf)\n  • Find the log-raw entry and set it as follows\n    log-raw = OFF",
        "Default Value": "OFF"
      },
      "code": "control '6.4' do\n  title \"Ensure 'log-raw' Is Set to 'OFF' (Scored)\"\n  desc  \"The log-raw MySQL option determines whether passwords are rewritten by the server so as not to appear in log files as plain text.\n  If log-raw is enabled, then passwords are written to the various log files (general query log, slow query log, and binary log) in plain text.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '6.4'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AU-2', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"\n  Perform the following actions to assess this recommendation:\n  • Open the MySQL configuration file (my.cnf)\n  • Ensure the log-raw entry is present\n  • Ensure the log-raw entry is set to OFF\"\n  tag \"fix\": \"\n  Perform the following actions to remediate this setting:\n  • Open the MySQL configuration file (my.cnf)\n  • Find the log-raw entry and set it as follows\n    log-raw = OFF\"\n  tag \"Default Value\": 'OFF'\n\n  describe mysql_conf do\n    its('log-raw') { should cmp 'OFF' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/6.4.rb",
        "line": 1
      },
      "id": "6.4"
    },
    {
      "title": "Ensure '--skip-symbolic-links' Is Enabled (Scored)",
      "desc": "The symbolic-links and skip-symbolic-links options for MySQL determine whether symbolic link support is available.\n  When use of symbolic links are enabled, they have different effects depending on the host platform.\n  When symbolic links are disabled, then symbolic links stored in files or entries in tables are not used by the database.",
      "descriptions": {
        "default": "The symbolic-links and skip-symbolic-links options for MySQL determine whether symbolic link support is available.\n  When use of symbolic links are enabled, they have different effects depending on the host platform.\n  When symbolic links are disabled, then symbolic links stored in files or entries in tables are not used by the database."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.6",
        "cis_level": 1,
        "nist": [
          "CM-7",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement to assess this recommendation:\n    SHOW variables LIKE 'have_symlink';\n  Ensure the Value returned is DISABLED.",
        "fix": "Perform the following actions to remediate this setting:\n  • Open the MySQL configuration file (my.cnf)\n  • Locate skip_symbolic_links in the configuration\n  • Set the skip_symbolic_links to YES\n  NOTE: If skip_symbolic_links does not exist, add it to the configuration file in the mysqld section.\n  "
      },
      "code": "control '4.6' do\n  title \"Ensure '--skip-symbolic-links' Is Enabled (Scored)\"\n  desc  \"The symbolic-links and skip-symbolic-links options for MySQL determine whether symbolic link support is available.\n  When use of symbolic links are enabled, they have different effects depending on the host platform.\n  When symbolic links are disabled, then symbolic links stored in files or entries in tables are not used by the database.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '4.6'\n  tag \"cis_level\": 1\n  tag \"nist\": ['CM-7', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement to assess this recommendation:\n    SHOW variables LIKE 'have_symlink';\n  Ensure the Value returned is DISABLED.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n  • Open the MySQL configuration file (my.cnf)\n  • Locate skip_symbolic_links in the configuration\n  • Set the skip_symbolic_links to YES\n  NOTE: If skip_symbolic_links does not exist, add it to the configuration file in the mysqld section.\n  \"\n\n  describe mysql_conf do\n    its('skip_symbolic_links') { should cmp 'YES' }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/4.6.rb",
        "line": 1
      },
      "id": "4.6"
    },
    {
      "title": "Ensure No Anonymous Accounts Exist (Scored)",
      "desc": "Anonymous accounts are users with empty usernames (''). Anonymous accounts have no passwords, so anyone can use them to connect to the MySQL server.",
      "descriptions": {
        "default": "Anonymous accounts are users with empty usernames (''). Anonymous accounts have no passwords, so anyone can use them to connect to the MySQL server."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.8",
        "cis_level": 2,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 2 - MySQL RDBMS",
        "check": "Execute the following SQL query to identify anonymous accounts:\n  SELECT user,host FROM mysql.user WHERE user = '';\n  The above query will return zero rows if no anonymous accounts are present.",
        "fix": "Perform the following actions to remediate this setting:\n  1. Enumerate the anonymous users returned from executing the audit procedure\n  2. For each anonymous user, DROP or assign them a name\n  NOTE: As an alternative, you may execute the mysql_secure_installation utility.",
        "Default Value": "Using the standard installation script, mysql_install_db, it will create two anonymous accounts:\n  one for the host 'localhost' and the other for the network interface's IP address."
      },
      "code": "control '7.8' do\n  title 'Ensure No Anonymous Accounts Exist (Scored)'\n  desc  \"Anonymous accounts are users with empty usernames (''). Anonymous accounts have no passwords, so anyone can use them to connect to the MySQL server.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '7.8'\n  tag \"cis_level\": 1\n  tag \"cis_level\": 2\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"Profile Applicability\": 'Level 2 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL query to identify anonymous accounts:\n  SELECT user,host FROM mysql.user WHERE user = '';\n  The above query will return zero rows if no anonymous accounts are present.\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\n  1. Enumerate the anonymous users returned from executing the audit procedure\n  2. For each anonymous user, DROP or assign them a name\n  NOTE: As an alternative, you may execute the mysql_secure_installation utility.\"\n  tag \"Default Value\": \"Using the standard installation script, mysql_install_db, it will create two anonymous accounts:\n  one for the host 'localhost' and the other for the network interface's IP address.\"\n\n  query = %{SELECT user,host FROM mysql.user WHERE user = '';}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  anonymous_accounts = sql_session.query(query).stdout.strip\n\n  describe 'The MySQL anonymous accounts that exist' do\n    subject { anonymous_accounts }\n    it { should be_empty }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/7.8.rb",
        "line": 1
      },
      "id": "7.8"
    },
    {
      "title": "Verify that 'MYSQL_PWD' Is Not Set (Scored)",
      "desc": "MySQL can read a default database password from an environment variable called MYSQL_PWD. Avoiding use of this environment variable can better safeguard the confidentiality of MySQL credentials.",
      "descriptions": {
        "default": "MySQL can read a default database password from an environment variable called MYSQL_PWD. Avoiding use of this environment variable can better safeguard the confidentiality of MySQL credentials."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "1.4",
        "cis_level": 1,
        "nist": [
          "IA-5",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "To assess this recommendation, use the /proc filesystem to determine if MYSQL_PWD is currently set for any process\n  grep MYSQL_PWD /proc/*/environ\n  This may return one entry for the process which is executing the grep command.",
        "fix": "Check which users and/or scripts are setting MYSQL_PWD and change them to use a more secure method.",
        "Default Value": "Not set"
      },
      "code": "control '1.4' do\n  title \"Verify that 'MYSQL_PWD' Is Not Set (Scored)\"\n  desc  'MySQL can read a default database password from an environment variable called MYSQL_PWD. Avoiding use of this environment variable can better safeguard the confidentiality of MySQL credentials.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '1.4'\n  tag \"cis_level\": 1\n  tag \"nist\": ['IA-5', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"To assess this recommendation, use the /proc filesystem to determine if MYSQL_PWD is currently set for any process\n  grep MYSQL_PWD /proc/*/environ\n  This may return one entry for the process which is executing the grep command.\"\n  tag \"fix\": 'Check which users and/or scripts are setting MYSQL_PWD and change them to use a more secure method.'\n  tag \"Default Value\": 'Not set'\n\n  describe 'The MYSQL_PWD environment variable' do\n    subject { command('grep MYSQL_PWD /proc/*/environ').stdout.strip }\n    it { should eq '' }\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/1.4.rb",
        "line": 1
      },
      "id": "1.4"
    },
    {
      "title": "Do Not Reuse User Accounts (Not Scored)",
      "desc": "Database user accounts should not be reused for multiple applications or users.",
      "descriptions": {
        "default": "Database user accounts should not be reused for multiple applications or users."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "2.3",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS on Linux",
        "check": "Each user should be linked to one of these\n    • system accounts\n    • a person\n    • an application",
        "fix": "Add/Remove users so that each user is only used for one specific purpose"
      },
      "code": "control '2.3' do\n  title 'Do Not Reuse User Accounts (Not Scored)'\n  desc  'Database user accounts should not be reused for multiple applications or users.'\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '2.3'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS on Linux'\n  tag \"check\": \"Each user should be linked to one of these\n    • system accounts\n    • a person\n    • an application\"\n  tag \"fix\": 'Add/Remove users so that each user is only used for one specific purpose'\n\n  query = 'SELECT User FROM mysql.user;'\n\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  mysql_account_list = sql_session.query(query).stdout.strip.split(\"\\n\")\n  if !mysql_account_list.empty?\n    mysql_account_list.each do |user|\n      describe \"Mysql database user: #{user}\" do\n        subject { user }\n        it { should be_in attribute('mysql_users') }\n      end\n    end\n  else\n    impact 0.0\n    describe 'There are no mysql database users, therefore this control is not applicable' do\n      skip 'There are no mysql database users, therefore this control is not applicable'\n    end\n  end\n  only_if { os.linux? }\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/2.3.rb",
        "line": 1
      },
      "id": "2.3"
    },
    {
      "title": "Ensure 'secure_file_priv' Is Not Empty (Scored)",
      "desc": "The secure_file_priv option restricts to paths used by LOAD DATA INFILE or SELECT local_file.\n  It is recommended that this option be set to a file system location that contains only resources expected to be loaded by MySQL.",
      "descriptions": {
        "default": "The secure_file_priv option restricts to paths used by LOAD DATA INFILE or SELECT local_file.\n  It is recommended that this option be set to a file system location that contains only resources expected to be loaded by MySQL."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "4.8",
        "cis_level": 1,
        "nist": [
          "AC-6",
          "Rev_4"
        ],
        "Profile Applicability": "Level 1 - MySQL RDBMS",
        "check": "Execute the following SQL statement and ensure one row is returned:\n    SHOW GLOBAL VARIABLES WHERE Variable_name = 'secure_file_priv' AND Value<>'';\n  Note: The Value should contain a valid path.",
        "fix": "Add the following line to the [mysqld] section of the MySQL configuration file and restart the MySQL service:\n    secure_file_priv=<path_to_load_directory>\n  ",
        "Default Value": "No value set."
      },
      "code": "control '4.8' do\n  title \"Ensure 'secure_file_priv' Is Not Empty (Scored)\"\n  desc  \"The secure_file_priv option restricts to paths used by LOAD DATA INFILE or SELECT local_file.\n  It is recommended that this option be set to a file system location that contains only resources expected to be loaded by MySQL.\"\n  impact 0.5\n  tag \"severity\": 'medium'\n  tag \"cis_id\": '4.8'\n  tag \"cis_level\": 1\n  tag \"nist\": ['AC-6', 'Rev_4']\n  tag \"Profile Applicability\": 'Level 1 - MySQL RDBMS'\n  tag \"check\": \"Execute the following SQL statement and ensure one row is returned:\n    SHOW GLOBAL VARIABLES WHERE Variable_name = 'secure_file_priv' AND Value<>'';\n  Note: The Value should contain a valid path.\"\n  tag \"fix\": \"Add the following line to the [mysqld] section of the MySQL configuration file and restart the MySQL service:\n    secure_file_priv=<path_to_load_directory>\n  \"\n  tag \"Default Value\": 'No value set.'\n\n  query = %{select @@secure_file_priv;}\n  sql_session = mysql_session(attribute('user'), attribute('password'), attribute('host'), attribute('port'))\n\n  secure_file_priv = sql_session.query(query).stdout.strip\n  describe \"The secure_file_priv variable set to: #{secure_file_priv}\" do\n    subject { secure_file_priv }\n    it { should_not be_empty }\n  end\nend\n",
      "source_location": {
        "ref": "./Oracle MySQL 5.7 CIS/controls/4.8.rb",
        "line": 1
      },
      "id": "4.8"
    }
  ],
  "groups": [
    {
      "title": null,
      "controls": [
        "3.4"
      ],
      "id": "controls/3.4.rb"
    },
    {
      "title": null,
      "controls": [
        "9.5"
      ],
      "id": "controls/9.5.rb"
    },
    {
      "title": null,
      "controls": [
        "1.5"
      ],
      "id": "controls/1.5.rb"
    },
    {
      "title": null,
      "controls": [
        "2.4"
      ],
      "id": "controls/2.4.rb"
    },
    {
      "title": null,
      "controls": [
        "5.2"
      ],
      "id": "controls/5.2.rb"
    },
    {
      "title": null,
      "controls": [
        "6.5"
      ],
      "id": "controls/6.5.rb"
    },
    {
      "title": null,
      "controls": [
        "6.1"
      ],
      "id": "controls/6.1.rb"
    },
    {
      "title": null,
      "controls": [
        "3.7"
      ],
      "id": "controls/3.7.rb"
    },
    {
      "title": null,
      "controls": [
        "6.7"
      ],
      "id": "controls/6.7.rb"
    },
    {
      "title": null,
      "controls": [
        "5.7"
      ],
      "id": "controls/5.7.rb"
    },
    {
      "title": null,
      "controls": [
        "6.3"
      ],
      "id": "controls/6.3.rb"
    },
    {
      "title": null,
      "controls": [
        "9.3"
      ],
      "id": "controls/9.3.rb"
    },
    {
      "title": null,
      "controls": [
        "6.11"
      ],
      "id": "controls/6.11.rb"
    },
    {
      "title": null,
      "controls": [
        "1.1"
      ],
      "id": "controls/1.1.rb"
    },
    {
      "title": null,
      "controls": [
        "7.3"
      ],
      "id": "controls/7.3.rb"
    },
    {
      "title": null,
      "controls": [
        "7.2"
      ],
      "id": "controls/7.2.rb"
    },
    {
      "title": null,
      "controls": [
        "7.7"
      ],
      "id": "controls/7.7.rb"
    },
    {
      "title": null,
      "controls": [
        "7.4"
      ],
      "id": "controls/7.4.rb"
    },
    {
      "title": null,
      "controls": [
        "6.10"
      ],
      "id": "controls/6.10.rb"
    },
    {
      "title": null,
      "controls": [
        "6.9"
      ],
      "id": "controls/6.9.rb"
    },
    {
      "title": null,
      "controls": [
        "5.5"
      ],
      "id": "controls/5.5.rb"
    },
    {
      "title": null,
      "controls": [
        "3.2"
      ],
      "id": "controls/3.2.rb"
    },
    {
      "title": null,
      "controls": [
        "3.5"
      ],
      "id": "controls/3.5.rb"
    },
    {
      "title": null,
      "controls": [
        "6.6"
      ],
      "id": "controls/6.6.rb"
    },
    {
      "title": null,
      "controls": [
        "9.2"
      ],
      "id": "controls/9.2.rb"
    },
    {
      "title": null,
      "controls": [
        "2.2"
      ],
      "id": "controls/2.2.rb"
    },
    {
      "title": null,
      "controls": [
        "6.2"
      ],
      "id": "controls/6.2.rb"
    },
    {
      "title": null,
      "controls": [
        "1.3"
      ],
      "id": "controls/1.3.rb"
    },
    {
      "title": null,
      "controls": [
        "3.6"
      ],
      "id": "controls/3.6.rb"
    },
    {
      "title": null,
      "controls": [
        "7.5"
      ],
      "id": "controls/7.5.rb"
    },
    {
      "title": null,
      "controls": [
        "5.6"
      ],
      "id": "controls/5.6.rb"
    },
    {
      "title": null,
      "controls": [
        "6.12"
      ],
      "id": "controls/6.12.rb"
    },
    {
      "title": null,
      "controls": [
        "4.4"
      ],
      "id": "controls/4.4.rb"
    },
    {
      "title": null,
      "controls": [
        "7.1"
      ],
      "id": "controls/7.1.rb"
    },
    {
      "title": null,
      "controls": [
        "7.6"
      ],
      "id": "controls/7.6.rb"
    },
    {
      "title": null,
      "controls": [
        "6.8"
      ],
      "id": "controls/6.8.rb"
    },
    {
      "title": null,
      "controls": [
        "5.8"
      ],
      "id": "controls/5.8.rb"
    },
    {
      "title": null,
      "controls": [
        "5.3"
      ],
      "id": "controls/5.3.rb"
    },
    {
      "title": null,
      "controls": [
        "4.5"
      ],
      "id": "controls/4.5.rb"
    },
    {
      "title": null,
      "controls": [
        "5.4"
      ],
      "id": "controls/5.4.rb"
    },
    {
      "title": null,
      "controls": [
        "3.1"
      ],
      "id": "controls/3.1.rb"
    },
    {
      "title": null,
      "controls": [
        "3.3"
      ],
      "id": "controls/3.3.rb"
    },
    {
      "title": null,
      "controls": [
        "4.1"
      ],
      "id": "controls/4.1.rb"
    },
    {
      "title": null,
      "controls": [
        "3.8"
      ],
      "id": "controls/3.8.rb"
    },
    {
      "title": null,
      "controls": [
        "3.9"
      ],
      "id": "controls/3.9.rb"
    },
    {
      "title": null,
      "controls": [
        "2.1"
      ],
      "id": "controls/2.1.rb"
    },
    {
      "title": null,
      "controls": [
        "5.9"
      ],
      "id": "controls/5.9.rb"
    },
    {
      "title": null,
      "controls": [
        "4.7"
      ],
      "id": "controls/4.7.rb"
    },
    {
      "title": null,
      "controls": [
        "5.1"
      ],
      "id": "controls/5.1.rb"
    },
    {
      "title": null,
      "controls": [
        "9.4"
      ],
      "id": "controls/9.4.rb"
    },
    {
      "title": null,
      "controls": [
        "9.1"
      ],
      "id": "controls/9.1.rb"
    },
    {
      "title": null,
      "controls": [
        "1.2"
      ],
      "id": "controls/1.2.rb"
    },
    {
      "title": null,
      "controls": [
        "4.3"
      ],
      "id": "controls/4.3.rb"
    },
    {
      "title": null,
      "controls": [
        "4.2"
      ],
      "id": "controls/4.2.rb"
    },
    {
      "title": null,
      "controls": [
        "4.9"
      ],
      "id": "controls/4.9.rb"
    },
    {
      "title": null,
      "controls": [
        "8.2"
      ],
      "id": "controls/8.2.rb"
    },
    {
      "title": null,
      "controls": [
        "8.1"
      ],
      "id": "controls/8.1.rb"
    },
    {
      "title": null,
      "controls": [
        "6.4"
      ],
      "id": "controls/6.4.rb"
    },
    {
      "title": null,
      "controls": [
        "4.6"
      ],
      "id": "controls/4.6.rb"
    },
    {
      "title": null,
      "controls": [
        "7.8"
      ],
      "id": "controls/7.8.rb"
    },
    {
      "title": null,
      "controls": [
        "1.4"
      ],
      "id": "controls/1.4.rb"
    },
    {
      "title": null,
      "controls": [
        "2.3"
      ],
      "id": "controls/2.3.rb"
    },
    {
      "title": null,
      "controls": [
        "4.8"
      ],
      "id": "controls/4.8.rb"
    }
  ],
  "sha256": "68ffdd5ad0010d519deb57fb60cd6e627af25a9914bf93993fa8d2fc6bfdc2dd",
  "status_message": "",
  "status": "loaded",
  "generator": {
    "name": "inspec",
    "version": "4.33.1"
  }
}