{
  "name": "redhat-jboss-enterprise-application-platform-6.3-stig-baseline",
  "title": "redhat-jboss-enterprise-application-platform-6.3-stig-baseline",
  "maintainer": "MITRE InSpec Team",
  "copyright": "MITRE InSpec Team",
  "copyright_email": "inspec@mitre.org",
  "license": "Apache-2.0",
  "summary": "InSpec Validation Profile for JBOSS Wildfly EAP 6.3 STIG",
  "description": "An InSpec profile verifying STIG compliance with JBOSS EAP STIG http://iasecontent.disa.mil/stigs/zip/U_JBoss_EAP_6-3_V1R2_STIG.zip with modifications for Wildfly\n",
  "version": "1.0.2",
  "inspec_version": ">= 4.0",
  "inputs": [],
  "supports": [],
  "controls": [
    {
      "title": "Wildfly must be configured to use an approved TLS version.",
      "desc": "Preventing the disclosure of transmitted information requires that the\napplication server take measures to employ some form of cryptographic mechanism\nin order to protect the information during transmission.  This is usually\nachieved through the use of Transport Layer Security (TLS).\n\n    Wildlfy relies on the underlying SSL implementation running on the OS.  This\ncan be either Java based or OpenSSL.  The SSL protocol setting determines which\nSSL protocol is used.  SSL has known security vulnerabilities, so TLS should be\nused instead.\n\n    If data is transmitted unencrypted, the data then becomes vulnerable to\ndisclosure.  The disclosure may reveal user identifier/password combinations,\nwebsite code revealing business logic, or other user personal information.\n\n    FIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\n    TLS must be enabled, and non-FIPS-approved SSL versions must be disabled.\nNIST SP 800-52 specifies the preferred configurations for government systems.",
      "descriptions": {
        "default": "Preventing the disclosure of transmitted information requires that the\napplication server take measures to employ some form of cryptographic mechanism\nin order to protect the information during transmission.  This is usually\nachieved through the use of Transport Layer Security (TLS).\n\n    Wildlfy relies on the underlying SSL implementation running on the OS.  This\ncan be either Java based or OpenSSL.  The SSL protocol setting determines which\nSSL protocol is used.  SSL has known security vulnerabilities, so TLS should be\nused instead.\n\n    If data is transmitted unencrypted, the data then becomes vulnerable to\ndisclosure.  The disclosure may reveal user identifier/password combinations,\nwebsite code revealing business logic, or other user personal information.\n\n    FIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\n    TLS must be enabled, and non-FIPS-approved SSL versions must be disabled.\nNIST SP 800-52 specifies the preferred configurations for government systems."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000439-AS-000155",
        "gid": "V-62321",
        "rid": "SV-76811r2_rule",
        "stig_id": "JBOS-AS-000650",
        "cci": [
          "CCI-002418"
        ],
        "documentable": false,
        "nist": [
          "SC-8",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Validate that the TLS protocol is used for HTTPS connections.\n  Run the command:\n\n  \"ls /subsystem=web/connector=https/ssl=configuration\"\n\n  If a TLS V1.1 or V1.2 protocol is not returned, this is a finding.",
        "fix": "Reference section 4.6 of the Wildfly Security Guide located\n  on the Red Hat vendor's web site for step-by-step instructions on establishing\n  SSL encryption on Wildfly.\n\n  The overall steps include:\n\n  1. Add an HTTPS connector.\n  2. Configure the SSL encryption certificate and keys.\n  3. Set the protocol to TLS V1.1 or V1.2.",
        "fix_id": "F-68241r1_fix"
      },
      "code": "control 'V-62321' do\n  title \"Wildfly must be configured to use an approved TLS version.\"\n  desc  \"\n      Preventing the disclosure of transmitted information requires that the\n  application server take measures to employ some form of cryptographic mechanism\n  in order to protect the information during transmission.  This is usually\n  achieved through the use of Transport Layer Security (TLS).\n\n      Wildlfy relies on the underlying SSL implementation running on the OS.  This\n  can be either Java based or OpenSSL.  The SSL protocol setting determines which\n  SSL protocol is used.  SSL has known security vulnerabilities, so TLS should be\n  used instead.\n\n      If data is transmitted unencrypted, the data then becomes vulnerable to\n  disclosure.  The disclosure may reveal user identifier/password combinations,\n  website code revealing business logic, or other user personal information.\n\n      FIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\n      TLS must be enabled, and non-FIPS-approved SSL versions must be disabled.\n  NIST SP 800-52 specifies the preferred configurations for government systems.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000439-AS-000155'\n  tag \"gid\": 'V-62321'\n  tag \"rid\": 'SV-76811r2_rule'\n  tag \"stig_id\": 'JBOS-AS-000650'\n  tag \"cci\": ['CCI-002418']\n  tag \"documentable\": false\n  tag \"nist\": ['SC-8', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Validate that the TLS protocol is used for HTTPS connections.\n  Run the command:\n\n  \\\"ls /subsystem=web/connector=https/ssl=configuration\\\"\n\n  If a TLS V1.1 or V1.2 protocol is not returned, this is a finding.\"\n  tag \"fix\": \"Reference section 4.6 of the Wildfly Security Guide located\n  on the Red Hat vendor's web site for step-by-step instructions on establishing\n  SSL encryption on Wildfly.\n\n  The overall steps include:\n\n  1. Add an HTTPS connector.\n  2. Configure the SSL encryption certificate and keys.\n  3. Set the protocol to TLS V1.1 or V1.2.\"\n  tag \"fix_id\": 'F-68241r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly enabled TLS versions' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=undertow/server=default-server/https-listener=https/\").stdout }\n    it { should match(%r{enabled-protocols=TLSv1.[12]}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62321.rb",
        "line": 1
      },
      "id": "V-62321"
    },
    {
      "title": "Wildfly must be configured to use an approved cryptographic algorithm in\n  conjunction with TLS.",
      "desc": "Preventing the disclosure or modification of transmitted information\nrequires that application servers take measures to employ approved cryptography\nin order to protect the information during transmission over the network. This\nis usually achieved through the use of Transport Layer Security (TLS), SSL VPN,\nor IPSec tunnel.\n\n  If data in transit is unencrypted, it is vulnerable to disclosure and\nmodification. If approved cryptographic algorithms are not used, encryption\nstrength cannot be assured.\n\n  FIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\n  TLS must be enabled, and non-FIPS-approved SSL versions must be disabled.\nNIST SP 800-52 specifies the preferred configurations for government systems.",
      "descriptions": {
        "default": "Preventing the disclosure or modification of transmitted information\nrequires that application servers take measures to employ approved cryptography\nin order to protect the information during transmission over the network. This\nis usually achieved through the use of Transport Layer Security (TLS), SSL VPN,\nor IPSec tunnel.\n\n  If data in transit is unencrypted, it is vulnerable to disclosure and\nmodification. If approved cryptographic algorithms are not used, encryption\nstrength cannot be assured.\n\n  FIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\n  TLS must be enabled, and non-FIPS-approved SSL versions must be disabled.\nNIST SP 800-52 specifies the preferred configurations for government systems."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000440-AS-000167",
        "gid": "V-62323",
        "rid": "SV-76813r2_rule",
        "stig_id": "JBOS-AS-000655",
        "cci": [
          "CCI-002421"
        ],
        "documentable": false,
        "nist": [
          "SC-8 (1)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Validate that the TLS protocol is used for HTTPS connections.\n  Run the command:\n\n  \"ls /subsystem=web/connector=https/ssl=configuration\"\n\n  Review the cipher suites.  The following suites are acceptable as per NIST\n  800-52r1 section 3.3.1 - Cipher Suites.  Refer to the NIST document for a\n  complete list of acceptable cipher suites.  The source NIST document and\n  approved encryption algorithms/cipher suites are subject to change and should\n  be referenced.\n\n  AES_128_CBC\n  AES_256_CBC\n  AES_128_GCM\n  AES_128_CCM\n  AES_256_CCM\n\n  If the cipher suites utilized by the TLS server are not approved by NIST as per\n  800-52r1, this is a finding.",
        "fix": "Reference section 4.6 of the Wildfly Security Guide located\n  on the Red Hat vendor's website for step-by-step instructions on establishing\n  SSL encryption on Wildfly.\n\n  The overall steps include:\n\n  1. Add an HTTPS connector.\n  2. Configure the SSL encryption certificate and keys.\n  3. Set the Cipher to an approved algorithm.",
        "fix_id": "F-68243r1_fix"
      },
      "code": "control 'V-62323' do\n  title \"Wildfly must be configured to use an approved cryptographic algorithm in\n  conjunction with TLS.\"\n  desc  \"\n    Preventing the disclosure or modification of transmitted information\n  requires that application servers take measures to employ approved cryptography\n  in order to protect the information during transmission over the network. This\n  is usually achieved through the use of Transport Layer Security (TLS), SSL VPN,\n  or IPSec tunnel.\n\n    If data in transit is unencrypted, it is vulnerable to disclosure and\n  modification. If approved cryptographic algorithms are not used, encryption\n  strength cannot be assured.\n\n    FIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\n    TLS must be enabled, and non-FIPS-approved SSL versions must be disabled.\n  NIST SP 800-52 specifies the preferred configurations for government systems.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000440-AS-000167'\n  tag \"gid\": 'V-62323'\n  tag \"rid\": 'SV-76813r2_rule'\n  tag \"stig_id\": 'JBOS-AS-000655'\n  tag \"cci\": ['CCI-002421']\n  tag \"documentable\": false\n  tag \"nist\": ['SC-8 (1)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Validate that the TLS protocol is used for HTTPS connections.\n  Run the command:\n\n  \\\"ls /subsystem=web/connector=https/ssl=configuration\\\"\n\n  Review the cipher suites.  The following suites are acceptable as per NIST\n  800-52r1 section 3.3.1 - Cipher Suites.  Refer to the NIST document for a\n  complete list of acceptable cipher suites.  The source NIST document and\n  approved encryption algorithms/cipher suites are subject to change and should\n  be referenced.\n\n  AES_128_CBC\n  AES_256_CBC\n  AES_128_GCM\n  AES_128_CCM\n  AES_256_CCM\n\n  If the cipher suites utilized by the TLS server are not approved by NIST as per\n  800-52r1, this is a finding.\"\n  tag \"fix\": \"Reference section 4.6 of the Wildfly Security Guide located\n  on the Red Hat vendor's website for step-by-step instructions on establishing\n  SSL encryption on Wildfly.\n\n  The overall steps include:\n\n  1. Add an HTTPS connector.\n  2. Configure the SSL encryption certificate and keys.\n  3. Set the Cipher to an approved algorithm.\"\n  tag \"fix_id\": 'F-68243r1_fix'\n\n  connect = input('connection')\n\n  cipher_suites = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=undertow/server=default-server/https-listener=https/\").stdout\n  describe.one do\n    describe 'The wildfly cryptographic algorithm used for TLS' do\n      subject { cipher_suites }\n      it { should match(%r{enabled-cipher-suites=(AES_((128)|(256))_CBC)|(AES_((128)|(256))_GCM)|(AES_((128)|(256))_CCM)|(AES_((128)|(256))_CCM)}) }\n    end\n    describe 'The wildfly cryptographic algorithm used for TLS' do\n      subject { cipher_suites }\n      it { should match(%r{enabled-cipher-suites=AES_((128)|(256))_CBC}) }\n    end\n    describe 'The wildfly cryptographic algorithm used for TLS' do\n      subject { cipher_suites }\n      it { should match(%r{enabled-cipher-suites=CBC:AES_128_GCM}) }\n    end\n    describe 'The wildfly cryptographic algorithm used for TLS' do\n      subject { cipher_suites }\n      it { should match(%r{enabled-cipher-suites=AES_((128)|(256))_CCM}) }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62323.rb",
        "line": 1
      },
      "id": "V-62323"
    },
    {
      "title": "Wildlfy must be configured to generate log records for all account\n  creations, modifications, disabling, and termination events.",
      "desc": "The maintenance of user accounts is a key activity within the system to\ndetermine access and privileges.  Through changes to accounts, an attacker can\ncreate an account for persistent access, modify an account to elevate\nprivileges, or terminate/disable an account(s) to cause a DoS for user(s).  To\nbe able to track and investigate these actions, log records must be generated\nfor any account modification functions.\n\n    Application servers either provide a local user store, or they can\nintegrate with enterprise user stores like LDAP.  As such, the application\nserver must be able to generate log records on account creation, modification,\ndisabling, and termination.",
      "descriptions": {
        "default": "The maintenance of user accounts is a key activity within the system to\ndetermine access and privileges.  Through changes to accounts, an attacker can\ncreate an account for persistent access, modify an account to elevate\nprivileges, or terminate/disable an account(s) to cause a DoS for user(s).  To\nbe able to track and investigate these actions, log records must be generated\nfor any account modification functions.\n\n    Application servers either provide a local user store, or they can\nintegrate with enterprise user stores like LDAP.  As such, the application\nserver must be able to generate log records on account creation, modification,\ndisabling, and termination."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000509-AS-000234",
        "gid": "V-62341",
        "rid": "SV-76831r1_rule",
        "stig_id": "JBOS-AS-000720",
        "cci": [
          "CCI-000172"
        ],
        "documentable": false,
        "nist": [
          "AU-12 c",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildlfy server with OS permissions that\n  allow access to Wildlfy.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\n  Connect to the server by typing \"connect\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68261r1_fix"
      },
      "code": "control 'V-62341' do\n  title \"Wildlfy must be configured to generate log records for all account\n  creations, modifications, disabling, and termination events.\"\n  desc  \"\n    The maintenance of user accounts is a key activity within the system to\n  determine access and privileges.  Through changes to accounts, an attacker can\n  create an account for persistent access, modify an account to elevate\n  privileges, or terminate/disable an account(s) to cause a DoS for user(s).  To\n  be able to track and investigate these actions, log records must be generated\n  for any account modification functions.\n\n      Application servers either provide a local user store, or they can\n  integrate with enterprise user stores like LDAP.  As such, the application\n  server must be able to generate log records on account creation, modification,\n  disabling, and termination.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000509-AS-000234'\n  tag \"gid\": 'V-62341'\n  tag \"rid\": 'SV-76831r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000720'\n  tag \"cci\": ['CCI-000172']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-12 c', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildlfy server with OS permissions that\n  allow access to Wildlfy.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \\\"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\n  Connect to the server by typing \\\"connect\\\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68261r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly server setting: generate log records for all account creations, modifications, disabling, and termination events' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62341.rb",
        "line": 1
      },
      "id": "V-62341"
    },
    {
      "title": "Wildfly KeyStore and Truststore passwords must not be stored in clear\n  text.",
      "desc": "Access to the Wildfly Password Vault must be secured, and the password used\nto access must be encrypted.  There is a specific process used to generate the\nencrypted password hash.  This process must be followed in order to store the\npassword in an encrypted format.\n\n    The admin must utilize this process in order to ensure the Keystore\npassword is encrypted.",
      "descriptions": {
        "default": "Access to the Wildfly Password Vault must be secured, and the password used\nto access must be encrypted.  There is a specific process used to generate the\nencrypted password hash.  This process must be followed in order to store the\npassword in an encrypted format.\n\n    The admin must utilize this process in order to ensure the Keystore\npassword is encrypted."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000171-AS-000119",
        "gid": "V-62289",
        "rid": "SV-76779r1_rule",
        "stig_id": "JBOS-AS-000300",
        "cci": [
          "CCI-000196"
        ],
        "documentable": false,
        "nist": [
          "IA-5 (1) (c)",
          "Rev_4"
        ],
        "check": "The default location for the keystore used by the Wildfly vault\n  is the $JBOSS_HOME;/vault/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  If a vault keystore has been created, by default it will be in the file:\n  $JBOSS_HOME;/vault/vault.keystore.  The file stores a single key, with the\n  default alias vault, which will be used to store encrypted strings, such as\n  passwords, for JBoss EAP.\n\n  Have the system admin provide the procedure used to encrypt the keystore\n  password that unlocks the keystore.\n\n  If the system administrator is unable to demonstrate or provide written process\n  documentation on how to encrypt the keystore password, this is a finding.",
        "fix": "Configure the application server to mask the java keystore\n  password as per the procedure described in section 11.13.3 -Password Vault\n  System in the\n  Wildfly-Administration_and_Configuration_Guide-en-US\n  document.",
        "fix_id": "F-68209r1_fix"
      },
      "code": "control 'V-62289' do\n  title \"Wildfly KeyStore and Truststore passwords must not be stored in clear\n  text.\"\n  desc  \"\n    Access to the Wildfly Password Vault must be secured, and the password used\n  to access must be encrypted.  There is a specific process used to generate the\n  encrypted password hash.  This process must be followed in order to store the\n  password in an encrypted format.\n\n      The admin must utilize this process in order to ensure the Keystore\n  password is encrypted.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000171-AS-000119'\n  tag \"gid\": 'V-62289'\n  tag \"rid\": 'SV-76779r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000300'\n  tag \"cci\": ['CCI-000196']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-5 (1) (c)', 'Rev_4']\n  tag \"check\": \"The default location for the keystore used by the Wildfly vault\n  is the $JBOSS_HOME;/vault/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  If a vault keystore has been created, by default it will be in the file:\n  $JBOSS_HOME;/vault/vault.keystore.  The file stores a single key, with the\n  default alias vault, which will be used to store encrypted strings, such as\n  passwords, for JBoss EAP.\n\n  Have the system admin provide the procedure used to encrypt the keystore\n  password that unlocks the keystore.\n\n  If the system administrator is unable to demonstrate or provide written process\n  documentation on how to encrypt the keystore password, this is a finding.\"\n  tag \"fix\": \"Configure the application server to mask the java keystore\n  password as per the procedure described in section 11.13.3 -Password Vault\n  System in the\n  Wildfly-Administration_and_Configuration_Guide-en-US\n  document.\"\n  tag \"fix_id\": 'F-68209r1_fix'\n\n  describe 'A manual review is required to verify that the System Admin utilizes a process to ensure the Keystore password is encrypted' do\n    skip 'A manual review is required to verify that the System Admin utilizes a process to ensure the Keystore password is encrypted'\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62289.rb",
        "line": 1
      },
      "id": "V-62289"
    },
    {
      "title": "The Wildfly server must be configured to utilize syslog logging.",
      "desc": "Information system logging capability is critical for accurate forensic\nanalysis. Log record content that may be necessary to satisfy the requirement\nof this control includes, but is not limited to, time stamps, source and\ndestination IP addresses, user/process identifiers, event descriptions,\napplication-specific events, success/fail indications, filenames involved,\naccess control or flow control rules invoked.\n\n    Off-loading is a common process in information systems with limited log\nstorage capacity.\n\n    Centralized management of log records provides for efficiency in\nmaintenance and management of records, as well as the backup and archiving of\nthose records. Application servers and their related components are required to\noff-load log records onto a different system or media than the system being\nlogged.",
      "descriptions": {
        "default": "Information system logging capability is critical for accurate forensic\nanalysis. Log record content that may be necessary to satisfy the requirement\nof this control includes, but is not limited to, time stamps, source and\ndestination IP addresses, user/process identifiers, event descriptions,\napplication-specific events, success/fail indications, filenames involved,\naccess control or flow control rules invoked.\n\n    Off-loading is a common process in information systems with limited log\nstorage capacity.\n\n    Centralized management of log records provides for efficiency in\nmaintenance and management of records, as well as the backup and archiving of\nthose records. Application servers and their related components are required to\noff-load log records onto a different system or media than the system being\nlogged."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000358-AS-000064",
        "gid": "V-62309",
        "rid": "SV-76799r1_rule",
        "stig_id": "JBOS-AS-000505",
        "cci": [
          "CCI-001851"
        ],
        "documentable": false,
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  Standalone configuration:\n  \"ls /subsystem=logging/syslog-handler=\"\n\n  Domain configuration:\n  \"ls /profile=<specify>/subsystem=logging/syslog-handler=\"\n  Where <specify> = the selected application server profile of; default,full,\n  full-ha or ha.\n\n  If no values are returned, this is a finding.",
        "fix": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  Standalone configuration:\n  \"ls /subsystem=logging/syslog-handler=\"\n\n  Domain configuration:\n  \"ls /profile=default/subsystem=logging/syslog-handler=\"\n\n  If no values are returned, this is a finding.",
        "fix_id": "F-68229r1_fix"
      },
      "code": "control 'V-62309' do\n  title \"The Wildfly server must be configured to utilize syslog logging.\"\n  desc  \"\n    Information system logging capability is critical for accurate forensic\n  analysis. Log record content that may be necessary to satisfy the requirement\n  of this control includes, but is not limited to, time stamps, source and\n  destination IP addresses, user/process identifiers, event descriptions,\n  application-specific events, success/fail indications, filenames involved,\n  access control or flow control rules invoked.\n\n      Off-loading is a common process in information systems with limited log\n  storage capacity.\n\n      Centralized management of log records provides for efficiency in\n  maintenance and management of records, as well as the backup and archiving of\n  those records. Application servers and their related components are required to\n  off-load log records onto a different system or media than the system being\n  logged.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000358-AS-000064'\n  tag \"gid\": 'V-62309'\n  tag \"rid\": 'SV-76799r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000505'\n  tag \"cci\": ['CCI-001851']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-4 (1)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  Standalone configuration:\n  \\\"ls /subsystem=logging/syslog-handler=\\\"\n\n  Domain configuration:\n  \\\"ls /profile=<specify>/subsystem=logging/syslog-handler=\\\"\n  Where <specify> = the selected application server profile of; default,full,\n  full-ha or ha.\n\n  If no values are returned, this is a finding.\"\n  tag \"fix\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  Standalone configuration:\n  \\\"ls /subsystem=logging/syslog-handler=\\\"\n\n  Domain configuration:\n  \\\"ls /profile=default/subsystem=logging/syslog-handler=\\\"\n\n  If no values are returned, this is a finding.\"\n  tag \"fix_id\": 'F-68229r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly server syslog handler' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=logging/syslog-handler=\").stdout }\n    it { should_not eq '' }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62309.rb",
        "line": 1
      },
      "id": "V-62309"
    },
    {
      "title": "HTTPS must be enabled for Wildfly web interfaces.",
      "desc": "Encryption is critical for protection of remote access sessions. If\nencryption is not being used for integrity, malicious users may gain the\nability to modify the application server configuration. The use of cryptography\nfor ensuring integrity of remote access sessions mitigates that risk.\n\n    Application servers utilize a web management interface and scripted\ncommands when allowing remote access. Web access requires the use of TLS, and\nscripted access requires using ssh or some other form of approved cryptography.\nApplication servers must have a capability to enable a secure remote admin\ncapability.\n\n    FIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\n    FIPS 140-2 approved TLS versions must be enabled, and non-FIPS-approved SSL\nversions must be disabled.\n\n    NIST SP 800-52 specifies the preferred configurations for government\nsystems.",
      "descriptions": {
        "default": "Encryption is critical for protection of remote access sessions. If\nencryption is not being used for integrity, malicious users may gain the\nability to modify the application server configuration. The use of cryptography\nfor ensuring integrity of remote access sessions mitigates that risk.\n\n    Application servers utilize a web management interface and scripted\ncommands when allowing remote access. Web access requires the use of TLS, and\nscripted access requires using ssh or some other form of approved cryptography.\nApplication servers must have a capability to enable a secure remote admin\ncapability.\n\n    FIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\n    FIPS 140-2 approved TLS versions must be enabled, and non-FIPS-approved SSL\nversions must be disabled.\n\n    NIST SP 800-52 specifies the preferred configurations for government\nsystems."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000015-AS-000010",
        "gid": "V-62215",
        "rid": "SV-76705r1_rule",
        "stig_id": "JBOS-AS-000015",
        "cci": [
          "CCI-001453"
        ],
        "documentable": false,
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\n\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nReview the web subsystem and ensure that HTTPS is enabled.\nRun the command:\n\nFor a managed domain:\n\"ls /profile=<PROFILE_NAME>/subsystem=web/connector=\"\n\nFor a standalone system:\n\"ls /subsystem=web/connector=\"\n\nIf \"https\" is not returned, this is a finding.",
        "fix": "Follow procedure \"4.4.  Configure the Wildfly Web Server to use\nHTTPS.\"  The detailed procedure is found in the Wildfly Security Guide\navailable at the vendor's site, RedHat.com.  An overview of steps is provided\nhere.\n\n1. Obtain or generate DoD-approved SSL certificates.\n2. Configure the SSL certificate using your certificate values.\n3. Set the SSL protocol to TLS V1.1 or V1.2.",
        "fix_id": "F-68135r1_fix"
      },
      "code": "control 'V-62215' do\n  title \"HTTPS must be enabled for Wildfly web interfaces.\"\n  desc  \"\n    Encryption is critical for protection of remote access sessions. If\nencryption is not being used for integrity, malicious users may gain the\nability to modify the application server configuration. The use of cryptography\nfor ensuring integrity of remote access sessions mitigates that risk.\n\n    Application servers utilize a web management interface and scripted\ncommands when allowing remote access. Web access requires the use of TLS, and\nscripted access requires using ssh or some other form of approved cryptography.\nApplication servers must have a capability to enable a secure remote admin\ncapability.\n\n    FIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\n    FIPS 140-2 approved TLS versions must be enabled, and non-FIPS-approved SSL\nversions must be disabled.\n\n    NIST SP 800-52 specifies the preferred configurations for government\nsystems.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000015-AS-000010'\n  tag \"gid\": 'V-62215'\n  tag \"rid\": 'SV-76705r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000015'\n  tag \"cci\": ['CCI-001453']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-17 (2)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\n\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nReview the web subsystem and ensure that HTTPS is enabled.\nRun the command:\n\nFor a managed domain:\n\\\"ls /profile=<PROFILE_NAME>/subsystem=web/connector=\\\"\n\nFor a standalone system:\n\\\"ls /subsystem=web/connector=\\\"\n\nIf \\\"https\\\" is not returned, this is a finding.\"\n  tag \"fix\": \"Follow procedure \\\"4.4.  Configure the Wildfly Web Server to use\nHTTPS.\\\"  The detailed procedure is found in the Wildfly Security Guide\navailable at the vendor's site, RedHat.com.  An overview of steps is provided\nhere.\n\n1. Obtain or generate DoD-approved SSL certificates.\n2. Configure the SSL certificate using your certificate values.\n3. Set the SSL protocol to TLS V1.1 or V1.2.\"\n  tag \"fix_id\": 'F-68135r1_fix'\n\n  connect = input('connection')\n\n  describe 'HTTPS for Wildfly web interfaces' do\n  subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=undertow/server=default-server/https-listener=https\").stdout }\n    it { should match(%r{enabled=true}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62215.rb",
        "line": 1
      },
      "id": "V-62215"
    },
    {
      "title": "Wildfly log records must be off-loaded onto a different system or system\ncomponent a minimum of every seven days.",
      "desc": "Wildfly logs by default are written to the local file system.  A centralized\nlogging solution like syslog should be used whenever possible; however, any log\ndata stored to the file system needs to be off-loaded.  Wildfly EAP does not\nprovide an automated backup capability.  Instead, reliance is placed on OS or\nthird-party tools to back up or off-load the log files.\n\n    Protection of log data includes assuring log data is not accidentally lost\nor deleted. Off-loading log records to a different system or onto separate\nmedia from the system the application server is actually running on helps to\nassure that, in the event of a catastrophic system failure, the log records\nwill be retained.",
      "descriptions": {
        "default": "Wildfly logs by default are written to the local file system.  A centralized\nlogging solution like syslog should be used whenever possible; however, any log\ndata stored to the file system needs to be off-loaded.  Wildfly EAP does not\nprovide an automated backup capability.  Instead, reliance is placed on OS or\nthird-party tools to back up or off-load the log files.\n\n    Protection of log data includes assuring log data is not accidentally lost\nor deleted. Off-loading log records to a different system or onto separate\nmedia from the system the application server is actually running on helps to\nassure that, in the event of a catastrophic system failure, the log records\nwill be retained."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000125-AS-000084",
        "gid": "V-62257",
        "rid": "SV-76747r1_rule",
        "stig_id": "JBOS-AS-000195",
        "cci": [
          "CCI-001348"
        ],
        "documentable": false,
        "nist": [
          "AU-9 (2)",
          "Rev_4"
        ],
        "check": "Interview the system admin and obtain details on how the log\nfiles are being off-loaded to a different system or media.\n\nIf the log files are not off-loaded a minimum of every 7 days, this is a\nfinding.",
        "fix": "Configure the application server to off-load log records every\nseven days onto a different system or media from the system being logged.",
        "fix_id": "F-68177r1_fix"
      },
      "code": "control 'V-62257' do\n  title \"Wildfly log records must be off-loaded onto a different system or system\ncomponent a minimum of every seven days.\"\n  desc  \"\n    Wildfly logs by default are written to the local file system.  A centralized\nlogging solution like syslog should be used whenever possible; however, any log\ndata stored to the file system needs to be off-loaded.  Wildfly EAP does not\nprovide an automated backup capability.  Instead, reliance is placed on OS or\nthird-party tools to back up or off-load the log files.\n\n    Protection of log data includes assuring log data is not accidentally lost\nor deleted. Off-loading log records to a different system or onto separate\nmedia from the system the application server is actually running on helps to\nassure that, in the event of a catastrophic system failure, the log records\nwill be retained.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000125-AS-000084'\n  tag \"gid\": 'V-62257'\n  tag \"rid\": 'SV-76747r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000195'\n  tag \"cci\": ['CCI-001348']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-9 (2)', 'Rev_4']\n  tag \"check\": \"Interview the system admin and obtain details on how the log\nfiles are being off-loaded to a different system or media.\n\nIf the log files are not off-loaded a minimum of every 7 days, this is a\nfinding.\"\n  tag \"fix\": \"Configure the application server to off-load log records every\nseven days onto a different system or media from the system being logged.\"\n  tag \"fix_id\": 'F-68177r1_fix'\n\n  connect = input('connection')\n  describe \"The wildfly syslog-handler configuration\" do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=logging/syslog-handler=\").stdout }\n    it { should_not eq '' }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62257.rb",
        "line": 1
      },
      "id": "V-62257"
    },
    {
      "title": "Production Wildfly servers must be supported by the vendor.",
      "desc": "The Wildfly product is available as Open Source; however, the Red Hat\n  vendor provides updates, patches and support for the JBoss product.  It is\n  imperative that patches and updates be applied to Wildfly in a timely manner as\n  many attacks against Wildfly focus on unpatched systems.  It is critical that\n  support be obtained and made available.",
      "descriptions": {
        "default": "The Wildfly product is available as Open Source; however, the Red Hat\n  vendor provides updates, patches and support for the JBoss product.  It is\n  imperative that patches and updates be applied to Wildfly in a timely manner as\n  many attacks against Wildfly focus on unpatched systems.  It is critical that\n  support be obtained and made available."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000456-AS-000266",
        "gid": "V-62325",
        "rid": "SV-76815r1_rule",
        "stig_id": "JBOS-AS-000680",
        "cci": [
          "CCI-002605"
        ],
        "documentable": false,
        "nist": [
          "SI-2 c",
          "Rev_4"
        ],
        "check": "Interview the system admin and have them either show documented\n  proof of current support, or have them demonstrate their ability to access the\n  Red Hat Enterprise Support portal.\n\n  Verify Red Hat  support includes coverage for the Wildfly product.\n\n  If there is no current and active support from the vendor, this is a finding.",
        "fix": "Obtain vendor support from Red Hat.",
        "fix_id": "F-68245r1_fix"
      },
      "code": "control 'V-62325' do\n  title \"Production Wildfly servers must be supported by the vendor.\"\n  desc  \"The Wildfly product is available as Open Source; however, the Red Hat\n  vendor provides updates, patches and support for the JBoss product.  It is\n  imperative that patches and updates be applied to Wildfly in a timely manner as\n  many attacks against Wildfly focus on unpatched systems.  It is critical that\n  support be obtained and made available.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000456-AS-000266'\n  tag \"gid\": 'V-62325'\n  tag \"rid\": 'SV-76815r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000680'\n  tag \"cci\": ['CCI-002605']\n  tag \"documentable\": false\n  tag \"nist\": ['SI-2 c', 'Rev_4']\n  tag \"check\": \"Interview the system admin and have them either show documented\n  proof of current support, or have them demonstrate their ability to access the\n  Red Hat Enterprise Support portal.\n\n  Verify Red Hat  support includes coverage for the Wildfly product.\n\n  If there is no current and active support from the vendor, this is a finding.\"\n  tag \"fix\": \"Obtain vendor support from Red Hat.\"\n  tag \"fix_id\": 'F-68245r1_fix'\n  impact 0.0\n  describe \"Wildfly is the open-source, community version of JBoss and does not include RedHat support, therefore this control is not applicable\" do\n    skip \"Wildfly is the open-source, community version of JBoss and does not include RedHat support, therefore this control is not applicable\"\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62325.rb",
        "line": 1
      },
      "id": "V-62325"
    },
    {
      "title": "Any unapproved applications must be removed.",
      "desc": "Extraneous services and applications running on an application server\n  expands the attack surface and increases risk to the application server.\n  Securing any server involves identifying and removing any unnecessary services\n  and, in the case of an application server, unnecessary and/or unapproved\n  applications.",
      "descriptions": {
        "default": "Extraneous services and applications running on an application server\n  expands the attack surface and increases risk to the application server.\n  Securing any server involves identifying and removing any unnecessary services\n  and, in the case of an application server, unnecessary and/or unapproved\n  applications."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000141-AS-000095",
        "gid": "V-62273",
        "rid": "SV-76763r1_rule",
        "stig_id": "JBOS-AS-000250",
        "cci": [
          "CCI-000381"
        ],
        "documentable": false,
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  ls /deployment\n\n  The list of deployed applications is displayed.  Have the system admin identify\n  the applications listed and confirm they are approved applications.\n\n  If the system admin cannot provide documentation proving their authorization\n  for deployed applications, this is a finding.",
        "fix": "Identify, authorize, and document all applications that are\n  deployed to the application server.  Remove unauthorized applications.",
        "fix_id": "F-68193r1_fix"
      },
      "code": "control 'V-62273' do\n  title \"Any unapproved applications must be removed.\"\n  desc  \"Extraneous services and applications running on an application server\n  expands the attack surface and increases risk to the application server.\n  Securing any server involves identifying and removing any unnecessary services\n  and, in the case of an application server, unnecessary and/or unapproved\n  applications.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-AS-000095'\n  tag \"gid\": 'V-62273'\n  tag \"rid\": 'SV-76763r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000250'\n  tag \"cci\": ['CCI-000381']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  ls /deployment\n\n  The list of deployed applications is displayed.  Have the system admin identify\n  the applications listed and confirm they are approved applications.\n\n  If the system admin cannot provide documentation proving their authorization\n  for deployed applications, this is a finding.\"\n  tag \"fix\": \"Identify, authorize, and document all applications that are\n  deployed to the application server.  Remove unauthorized applications.\"\n  tag \"fix_id\": 'F-68193r1_fix' \n\n  connect = input('connection')\n  approved_applications = input('approved_applications')\n\n  applications_deployed = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /deployment\").stdout.strip.split(\"\\n\")\n\n  applications_deployed.each do |app|\n    a = app.strip\n    describe \"The installed wildfly application: #{a}\" do\n      subject {\"#{a}\"}\n      it { should be_in approved_applications }\n    end\n  end\n  if applications_deployed.empty?\n    impact 0.0\n    describe 'There are no applications installed on the wildfly server, therefore this control is Not Applicable' do\n      skip 'There are no applications installed on the wildfly server, therefore this control is Not Applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62273.rb",
        "line": 1
      },
      "id": "V-62273"
    },
    {
      "title": "The Wildfly server must be configured to use individual accounts and not\n  generic or shared accounts.",
      "desc": "To assure individual accountability and prevent unauthorized access,\napplication server users (and any processes acting on behalf of application\nserver users) must be individually identified and authenticated.\n\n    A group authenticator is a generic account used by multiple individuals.\nUse of a group authenticator alone does not uniquely identify individual users.\n\n    Application servers must ensure that individual users are authenticated\nprior to authenticating via role or group authentication. This is to ensure\nthat there is non-repudiation for actions taken.",
      "descriptions": {
        "default": "To assure individual accountability and prevent unauthorized access,\napplication server users (and any processes acting on behalf of application\nserver users) must be individually identified and authenticated.\n\n    A group authenticator is a generic account used by multiple individuals.\nUse of a group authenticator alone does not uniquely identify individual users.\n\n    Application servers must ensure that individual users are authenticated\nprior to authenticating via role or group authentication. This is to ensure\nthat there is non-repudiation for actions taken."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000153-AS-000104",
        "gid": "V-62281",
        "rid": "SV-76771r1_rule",
        "stig_id": "JBOS-AS-000275",
        "cci": [
          "CCI-000770"
        ],
        "documentable": false,
        "nist": [
          "IA-2 (5)",
          "Rev_4"
        ],
        "check": "If the application server management interface is configured to\n  use LDAP authentication this requirement is NA.\n\n  Determine the mode in which the Wildfly server is operating by authenticating to\n  the OS, changing to the $JBOSS_HOME;/bin/ folder and executing the jboss-cli\n  script.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Connect to the server and authenticate.\n  Run the command: \"ls\" and examine the \"launch-type\" setting.\n\n  User account information is stored in the following files for a Wildfly server\n  configured in standalone mode.  The command line flags passed to the\n  \"standalone\" startup script determine the standalone operating mode:\n  $JBOSS_HOME;/standalone/configuration/standalone.xml\n  $JBOSS_HOME;/standalone/configuration/standalone-full.xml\n  $JBOSS_HOME;/standalone/configuration/standalone.-full-ha.xml\n  $JBOSS_HOME;/standalone/configuration/standalone.ha.xml\n\n  For a Managed Domain:\n  $JBOSS_HOME;/domain/configuration/domain.xml.\n\n  Review both files for generic or shared user accounts.\n\n  Open each xml file with a text editor and locate the <management-interfaces>\n  section.\n  Review the <user name = \"xxxxx\"> sub-section where \"xxxxx\" will be a user\n  name.\n\n  Have the system administrator identify the user of each user account.\n\n  If user accounts are not assigned to individual users, this is a finding.",
        "fix": "Configure the application server so required users are\n  individually authenticated by creating individual user accounts.  Utilize an\n  LDAP server that is configured according to DOD policy.",
        "fix_id": "F-68201r1_fix"
      },
      "code": "control 'V-62281' do\n  title \"The Wildfly server must be configured to use individual accounts and not\n  generic or shared accounts.\"\n  desc  \"\n    To assure individual accountability and prevent unauthorized access,\n  application server users (and any processes acting on behalf of application\n  server users) must be individually identified and authenticated.\n\n      A group authenticator is a generic account used by multiple individuals.\n  Use of a group authenticator alone does not uniquely identify individual users.\n\n      Application servers must ensure that individual users are authenticated\n  prior to authenticating via role or group authentication. This is to ensure\n  that there is non-repudiation for actions taken.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000153-AS-000104'\n  tag \"gid\": 'V-62281'\n  tag \"rid\": 'SV-76771r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000275'\n  tag \"cci\": ['CCI-000770']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-2 (5)', 'Rev_4']\n  tag \"check\": \"If the application server management interface is configured to\n  use LDAP authentication this requirement is NA.\n\n  Determine the mode in which the Wildfly server is operating by authenticating to\n  the OS, changing to the $JBOSS_HOME;/bin/ folder and executing the jboss-cli\n  script.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Connect to the server and authenticate.\n  Run the command: \\\"ls\\\" and examine the \\\"launch-type\\\" setting.\n\n  User account information is stored in the following files for a Wildfly server\n  configured in standalone mode.  The command line flags passed to the\n  \\\"standalone\\\" startup script determine the standalone operating mode:\n  $JBOSS_HOME;/standalone/configuration/standalone.xml\n  $JBOSS_HOME;/standalone/configuration/standalone-full.xml\n  $JBOSS_HOME;/standalone/configuration/standalone.-full-ha.xml\n  $JBOSS_HOME;/standalone/configuration/standalone.ha.xml\n\n  For a Managed Domain:\n  $JBOSS_HOME;/domain/configuration/domain.xml.\n\n  Review both files for generic or shared user accounts.\n\n  Open each xml file with a text editor and locate the <management-interfaces>\n  section.\n  Review the <user name = \\\"xxxxx\\\"> sub-section where \\\"xxxxx\\\" will be a user\n  name.\n\n  Have the system administrator identify the user of each user account.\n\n  If user accounts are not assigned to individual users, this is a finding.\"\n  tag \"fix\": \"Configure the application server so required users are\n  individually authenticated by creating individual user accounts.  Utilize an\n  LDAP server that is configured according to DOD policy.\"\n  tag \"fix_id\": 'F-68201r1_fix'\n\n  connect = input('connection')\n  auditor_role_users = input('auditor_role_users')\n  administrator_role_users = input('administrator_role_users')\n  superuser_role_users = input('superuser_role_users')\n  deployer_role_users = input('deployer_role_users')\n  maintainer_role_users = input('maintainer_role_users')\n  monitor_role_users = input('monitor_role_users')\n  operator_role_users = input('operator_role_users')\n\n  auditor_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=Auditor/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n  administrator_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=Administrator/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n  superuser_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=SuperUser/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n  deployer_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=Deployer/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n  maintainer_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=Maintainer/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n  monitor_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=Monitor/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n  operator_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=Operator/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n\n  if !auditor_role.empty?\n    auditor_role.each do |user|\n      describe \"User: #{user} with the auditor role\" do\n        subject { user }\n        it { should be_in auditor_role_users }\n      end\n    end\n  end\n\n  if !administrator_role.empty?\n    administrator_role.each do |user|\n      describe \"User: #{user} with the administrator role\" do\n        subject { user }\n        it { should be_in administrator_role_users }\n      end\n    end\n  end\n\n  if !superuser_role.empty?\n    superuser_role.each do |user|\n      describe \"User: #{user} with the SuperUser role\" do\n        subject { user }\n        it { should be_in superuser_role_users }\n      end\n    end\n  end\n\n  if !deployer_role.empty?\n    deployer_role.each do |user|\n      describe \"User: #{user} with the deployer role\" do\n        subject { user }\n       it { should be_in deployer_role_users }\n      end\n    end\n  end\n\n  if !maintainer_role.empty?\n    maintainer_role.each do |user|\n      describe \"User: #{user} with the maintainer role\" do\n        subject { user }\n        it { should be_in maintainer_role_users }\n      end\n    end\n  end\n\n  if !monitor_role.empty?\n    monitor_role.each do |user|\n      describe \"User: #{user} with the monitor role\" do\n        subject { user }\n        it { should be_in monitor_role_users }\n      end\n    end\n  end\n\n  if !operator_role.empty?\n    operator_role.each do |user|\n      describe \"User: #{user} with the operator role\" do\n        subject { user }\n        it { should be_in operator_role_users }\n      end\n    end\n  end\n  if auditor_role.empty? && administrator_role.empty? && superuser_role.empty? && deployer_role.empty? && maintainer_role.empty && monitor_role.empty && operator_role.empty?\n    impact 0.0\n    desc 'The are no Wildfly accounts with the following roles: auditor, administrator, superuser, deployer, maintainer, monitor, or operator, therefore this control is not applicable'\n    describe 'The are no Wildfly accounts with the following roles: auditor, administrator, superuser, deployer, maintainer, monitor, or operator, therefore this control is not applicable' do\n      skip 'The are no Wildfly accounts with the following roles: auditor, administrator, superuser, deployer, maintainer, monitor, or operator, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62281.rb",
        "line": 1
      },
      "id": "V-62281"
    },
    {
      "title": "Wildfly must utilize encryption when using LDAP for authentication.",
      "desc": "Passwords need to be protected at all times, and encryption is the standard\nmethod for protecting passwords during transmission.\n\n  Application servers have the capability to utilize LDAP directories for\nauthentication. If LDAP connections are not protected during transmission,\nsensitive authentication credentials can be stolen. When the application server\nutilizes LDAP, the LDAP traffic must be encrypted.",
      "descriptions": {
        "default": "Passwords need to be protected at all times, and encryption is the standard\nmethod for protecting passwords during transmission.\n\n  Application servers have the capability to utilize LDAP directories for\nauthentication. If LDAP connections are not protected during transmission,\nsensitive authentication credentials can be stolen. When the application server\nutilizes LDAP, the LDAP traffic must be encrypted."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000172-AS-000121",
        "gid": "V-62293",
        "rid": "SV-76783r1_rule",
        "stig_id": "JBOS-AS-000310",
        "cci": [
          "CCI-000197"
        ],
        "documentable": false,
        "nist": [
          "IA-5 (1) (c)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Run the following command:\n\n  For standalone servers:\n  \"ls\n  /socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=ldap_connection\"\n\n  For managed domain installations:\n  \"ls\n  /socket-binding-group=<PROFILE>/remote-destination-outbound-socket-binding=\"\n\n  The default port for secure LDAP is 636.\n\n  If 636 or secure LDAP protocol is not utilized, this is a finding.",
        "fix": "Follow steps in section 11.8 - Management Interface Security in\n  the\n  JBoss_Enterprise_Application_Platform-6.3-Administration_and_Configuration_Guide-en-US\n  document.\n\n  1. Create an outbound connection to the LDAP server.\n  2. Create an LDAP-enabled security realm.\n  3. Reference the new security domain in the Management Interface.",
        "fix_id": "F-68213r1_fix"
      },
      "code": "control 'V-62293' do\n  title \"Wildfly must utilize encryption when using LDAP for authentication.\"\n  desc  \"\n    Passwords need to be protected at all times, and encryption is the standard\n  method for protecting passwords during transmission.\n\n    Application servers have the capability to utilize LDAP directories for\n  authentication. If LDAP connections are not protected during transmission,\n  sensitive authentication credentials can be stolen. When the application server\n  utilizes LDAP, the LDAP traffic must be encrypted.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000172-AS-000121'\n  tag \"gid\": 'V-62293'\n  tag \"rid\": 'SV-76783r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000310'\n  tag \"cci\": ['CCI-000197']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-5 (1) (c)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Run the following command:\n\n  For standalone servers:\n  \\\"ls\n  /socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=ldap_connection\\\"\n\n  For managed domain installations:\n  \\\"ls\n  /socket-binding-group=<PROFILE>/remote-destination-outbound-socket-binding=\\\"\n\n  The default port for secure LDAP is 636.\n\n  If 636 or secure LDAP protocol is not utilized, this is a finding.\"\n  tag \"fix\": \"Follow steps in section 11.8 - Management Interface Security in\n  the\n  JBoss_Enterprise_Application_Platform-6.3-Administration_and_Configuration_Guide-en-US\n  document.\n\n  1. Create an outbound connection to the LDAP server.\n  2. Create an LDAP-enabled security realm.\n  3. Reference the new security domain in the Management Interface.\"\n  tag \"fix_id\": 'F-68213r1_fix'\n\n  connect = input('connection')\n  ldap = input('ldap')\n\n  if ldap\n    describe 'A manual review is required to ensure wildfly uses encryption when using LDAP for authentication' do\n      skip 'A manual review is required to ensure wildfly uses encryption when using LDAP for authentication'\n    end\n  else\n    describe command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=undertow/server=default-server/https-listener=https\") do\n      its('stdout') { should match(%r{enabled=true}) }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62293.rb",
        "line": 1
      },
      "id": "V-62293"
    },
    {
      "title": "Wildfly Log Formatter must be configured to produce log records that\nestablish the date and time the events occurred.",
      "desc": "Application server logging capability is critical for accurate forensic\nanalysis.  Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct order of the events that occurred is important\nduring forensic analysis.  Events that appear harmless by themselves might be\nflagged as a potential threat when properly viewed in sequence.  By also\nestablishing the event date and time, an event can be properly viewed with an\nenterprise tool to fully see a possible threat in its entirety.\n\n    Without sufficient information establishing when the log event occurred,\ninvestigation into the cause of event is severely hindered.  Log record content\nthat may be necessary to satisfy the requirement of this control includes, but\nis not limited to, time stamps, source and destination IP addresses,\nuser/process identifiers, event descriptions, application-specific events,\nsuccess/fail indications, filenames involved, access control, or flow control\nrules invoked.\n\n    In addition to logging event information, application servers must also log\nthe corresponding dates and times of these events. Examples of event data\ninclude, but are not limited to, Java Virtual Machine (JVM) activity, HTTPD\nactivity, and application server-related system process activity.",
      "descriptions": {
        "default": "Application server logging capability is critical for accurate forensic\nanalysis.  Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct order of the events that occurred is important\nduring forensic analysis.  Events that appear harmless by themselves might be\nflagged as a potential threat when properly viewed in sequence.  By also\nestablishing the event date and time, an event can be properly viewed with an\nenterprise tool to fully see a possible threat in its entirety.\n\n    Without sufficient information establishing when the log event occurred,\ninvestigation into the cause of event is severely hindered.  Log record content\nthat may be necessary to satisfy the requirement of this control includes, but\nis not limited to, time stamps, source and destination IP addresses,\nuser/process identifiers, event descriptions, application-specific events,\nsuccess/fail indications, filenames involved, access control, or flow control\nrules invoked.\n\n    In addition to logging event information, application servers must also log\nthe corresponding dates and times of these events. Examples of event data\ninclude, but are not limited to, Java Virtual Machine (JVM) activity, HTTPD\nactivity, and application server-related system process activity."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000096-AS-000059",
        "gid": "V-62241",
        "rid": "SV-76731r1_rule",
        "stig_id": "JBOS-AS-000115",
        "cci": [
          "CCI-000131"
        ],
        "documentable": false,
        "nist": [
          "AU-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nIf \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\nConnect to the server by typing \"connect\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68161r1_fix"
      },
      "code": "control 'V-62241' do\n  title \"Wildfly Log Formatter must be configured to produce log records that\nestablish the date and time the events occurred.\"\n  desc  \"\n    Application server logging capability is critical for accurate forensic\nanalysis.  Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct order of the events that occurred is important\nduring forensic analysis.  Events that appear harmless by themselves might be\nflagged as a potential threat when properly viewed in sequence.  By also\nestablishing the event date and time, an event can be properly viewed with an\nenterprise tool to fully see a possible threat in its entirety.\n\n    Without sufficient information establishing when the log event occurred,\ninvestigation into the cause of event is severely hindered.  Log record content\nthat may be necessary to satisfy the requirement of this control includes, but\nis not limited to, time stamps, source and destination IP addresses,\nuser/process identifiers, event descriptions, application-specific events,\nsuccess/fail indications, filenames involved, access control, or flow control\nrules invoked.\n\n    In addition to logging event information, application servers must also log\nthe corresponding dates and times of these events. Examples of event data\ninclude, but are not limited to, Java Virtual Machine (JVM) activity, HTTPD\nactivity, and application server-related system process activity.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000096-AS-000059'\n  tag \"gid\": 'V-62241'\n  tag \"rid\": 'SV-76731r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000115'\n  tag \"cci\": ['CCI-000131']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\\\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nIf \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\nConnect to the server by typing \\\"connect\\\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68161r1_fix'\n\n  connect = input('connection')\n\n  describe 'Wildfly Log Formatter produce log records that establish the date and time the events occurred' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62241.rb",
        "line": 1
      },
      "id": "V-62241"
    },
    {
      "title": "Access to Wildfly log files must be restricted to authorized users.",
      "desc": "If the application provides too much information in error logs and\nadministrative messages to the screen, this could lead to compromise. The\nstructure and content of error messages need to be carefully considered by the\norganization and development team. The extent to which the information system\nis able to identify and handle error conditions is guided by organizational\npolicy and operational requirements.\n\n    Application servers must protect the error messages that are created by the\napplication server. All application server users' accounts are used for the\nmanagement of the server and the applications residing on the application\nserver. All accounts are assigned to a certain role with corresponding access\nrights. The application server must restrict access to error messages so only\nauthorized users may view them. Error messages are usually written to logs\ncontained on the file system. The application server will usually create new\nlog files as needed and must take steps to ensure that the proper file\npermissions are utilized when the log files are created.",
      "descriptions": {
        "default": "If the application provides too much information in error logs and\nadministrative messages to the screen, this could lead to compromise. The\nstructure and content of error messages need to be carefully considered by the\norganization and development team. The extent to which the information system\nis able to identify and handle error conditions is guided by organizational\npolicy and operational requirements.\n\n    Application servers must protect the error messages that are created by the\napplication server. All application server users' accounts are used for the\nmanagement of the server and the applications residing on the application\nserver. All accounts are assigned to a certain role with corresponding access\nrights. The application server must restrict access to error messages so only\nauthorized users may view them. Error messages are usually written to logs\ncontained on the file system. The application server will usually create new\nlog files as needed and must take steps to ensure that the proper file\npermissions are utilized when the log files are created."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000267-AS-000170",
        "gid": "V-62301",
        "rid": "SV-76791r1_rule",
        "stig_id": "JBOS-AS-000425",
        "cci": [
          "CCI-001314"
        ],
        "documentable": false,
        "nist": [
          "SI-11 b",
          "Rev_4"
        ],
        "check": "If the Wildfly log folder is installed in the default location\n  and AS-000133-JBOSS-00079 is not a finding, the log folders are protected and\n  this requirement is not a finding.\n\n  By default, Wildlfy installs its log files into a sub-folder of the\n  \"Wildfly\" home folder.\n  Using a UNIX like OS example, the default location for log files is:\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  JBOSS_HOME/standalone/log\n  JBOSS_HOME/domain/log\n\n  For a standalone configuration:\n  JBOSS_HOME/standalone/log/server.log\"  Contains all server log messages,\n  including server startup messages.\n\n  For a domain configuration:\n  JBOSS_HOME/domain/log/hostcontroller.log\n  Host Controller boot log. Contains log messages related to the startup of the\n  host controller.\n\n  JBOSS_HOME/domain/log/processcontroller.log\n  Process controller boot log. Contains log messages related to the startup of\n  the process controller.\n\n  JBOSS_HOME/domain/servers/SERVERNAME/log/server.log\n  The server log for the named server. Contains all log messages for that server,\n  including server startup messages.\n\n  Log on with an OS user account with Wildfly access and permissions.\n\n  Navigate to the \"Wildfly\" folder using the relevant OS commands for\n  either a UNIX like OS or a Windows OS.\n\n  Examine the permissions of the Wildfly logs folders.\n\n  Owner can be full access.\n  Group can be full access.\n  All others must be restricted.\n\n  If the Wildfly log folder is world readable or world writable, this is a\n  finding.",
        "fix": "Configure file permissions on the Wildfly log folder to protect\n  from unauthorized access.",
        "fix_id": "F-68221r1_fix"
      },
      "code": "control 'V-62301' do\n  title \"Access to Wildfly log files must be restricted to authorized users.\"\n  desc  \"\n    If the application provides too much information in error logs and\n  administrative messages to the screen, this could lead to compromise. The\n  structure and content of error messages need to be carefully considered by the\n  organization and development team. The extent to which the information system\n  is able to identify and handle error conditions is guided by organizational\n  policy and operational requirements.\n\n      Application servers must protect the error messages that are created by the\n  application server. All application server users' accounts are used for the\n  management of the server and the applications residing on the application\n  server. All accounts are assigned to a certain role with corresponding access\n  rights. The application server must restrict access to error messages so only\n  authorized users may view them. Error messages are usually written to logs\n  contained on the file system. The application server will usually create new\n  log files as needed and must take steps to ensure that the proper file\n  permissions are utilized when the log files are created.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000267-AS-000170'\n  tag \"gid\": 'V-62301'\n  tag \"rid\": 'SV-76791r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000425'\n  tag \"cci\": ['CCI-001314']\n  tag \"documentable\": false\n  tag \"nist\": ['SI-11 b', 'Rev_4']\n  tag \"check\": \"If the Wildfly log folder is installed in the default location\n  and AS-000133-JBOSS-00079 is not a finding, the log folders are protected and\n  this requirement is not a finding.\n\n  By default, Wildlfy installs its log files into a sub-folder of the\n  \\\"Wildfly\\\" home folder.\n  Using a UNIX like OS example, the default location for log files is:\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  JBOSS_HOME/standalone/log\n  JBOSS_HOME/domain/log\n\n  For a standalone configuration:\n  JBOSS_HOME/standalone/log/server.log\\\"  Contains all server log messages,\n  including server startup messages.\n\n  For a domain configuration:\n  JBOSS_HOME/domain/log/hostcontroller.log\n  Host Controller boot log. Contains log messages related to the startup of the\n  host controller.\n\n  JBOSS_HOME/domain/log/processcontroller.log\n  Process controller boot log. Contains log messages related to the startup of\n  the process controller.\n\n  JBOSS_HOME/domain/servers/SERVERNAME/log/server.log\n  The server log for the named server. Contains all log messages for that server,\n  including server startup messages.\n\n  Log on with an OS user account with Wildfly access and permissions.\n\n  Navigate to the \\\"Wildfly\\\" folder using the relevant OS commands for\n  either a UNIX like OS or a Windows OS.\n\n  Examine the permissions of the Wildfly logs folders.\n\n  Owner can be full access.\n  Group can be full access.\n  All others must be restricted.\n\n  If the Wildfly log folder is world readable or world writable, this is a\n  finding.\"\n  tag \"fix\": \"Configure file permissions on the Wildfly log folder to protect\n  from unauthorized access.\"\n  tag \"fix_id\": 'F-68221r1_fix'\n  describe directory(\"#{ input('jboss_home') }/standalone/log\") do\n    it { should_not be_readable.by 'others' }\n  end\n  describe directory(\"#{ input('jboss_home') }/standalone/log\") do\n    it { should_not be_writable.by 'others' }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62301.rb",
        "line": 1
      },
      "id": "V-62301"
    },
    {
      "title": "Wildfly process owner interactive access must be restricted.",
      "desc": "Wildfly does not require admin rights to operate and should be run as a\n  regular user.  In addition, if the user account was to be compromised and the\n  account was allowed interactive logon rights, this would increase the risk and\n  attack surface against the Wildfly system.  The right to interactively log on to\n  the system using the Wildfly account should be limited according to the OS\n  capabilities.",
      "descriptions": {
        "default": "Wildfly does not require admin rights to operate and should be run as a\n  regular user.  In addition, if the user account was to be compromised and the\n  account was allowed interactive logon rights, this would increase the risk and\n  attack surface against the Wildfly system.  The right to interactively log on to\n  the system using the Wildfly account should be limited according to the OS\n  capabilities."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000141-AS-000095",
        "gid": "V-62261",
        "rid": "SV-76751r1_rule",
        "stig_id": "JBOS-AS-000220",
        "cci": [
          "CCI-000381"
        ],
        "documentable": false,
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "check": "Identify the user account used to run the Wildfly server.  Use\n  relevant OS commands to determine logon rights to the system. This account\n  should not have full shell/interactive access to the system.\n\n  If the user account used to operate Wildfly can log on interactively, this is a\n  finding.",
        "fix": "Use the relevant OS commands to restrict Wildfly user account from\n  interactively logging on to the console of the Wildfly system.\n\n  For Windows systems, use GPO.\n\n  For UNIX like systems using ssh DenyUsers <account id> or follow established\n  procedure for restricting access.",
        "fix_id": "F-68181r1_fix"
      },
      "code": "control 'V-62261' do\n  title \"Wildfly process owner interactive access must be restricted.\"\n  desc  \"Wildfly does not require admin rights to operate and should be run as a\n  regular user.  In addition, if the user account was to be compromised and the\n  account was allowed interactive logon rights, this would increase the risk and\n  attack surface against the Wildfly system.  The right to interactively log on to\n  the system using the Wildfly account should be limited according to the OS\n  capabilities.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000141-AS-000095'\n  tag \"gid\": 'V-62261'\n  tag \"rid\": 'SV-76751r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000220'\n  tag \"cci\": ['CCI-000381']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"check\": \"Identify the user account used to run the Wildfly server.  Use\n  relevant OS commands to determine logon rights to the system. This account\n  should not have full shell/interactive access to the system.\n\n  If the user account used to operate Wildfly can log on interactively, this is a\n  finding.\"\n  tag \"fix\": \"Use the relevant OS commands to restrict Wildfly user account from\n  interactively logging on to the console of the Wildfly system.\n\n  For Windows systems, use GPO.\n\n  For UNIX like systems using ssh DenyUsers <account id> or follow established\n  procedure for restricting access.\"\n  tag \"fix_id\": 'F-68181r1_fix'\n  wildfly_process_owners = command(\"ps -aux | grep wildfly | grep -v 'color=auto wildfly' | grep -v chef | grep -v grep | awk '{print $1}'\").stdout.split(\"\\n\")\n\n  if wildfly_process_owners.empty?\n    impact 0.0\n    describe 'There are no wildfly process owners' do\n      skip 'There are no wildfly process owners, therfore this control is N/A'\n    end\n  end\n\n  if !wildfly_process_owners.empty?\n    wildfly_process_owners.each do |owner|\n      get_shell_bin_false = command(\"awk -F : '$1 == \\\"#{owner}\\\" { print $7}' /etc/passwd\").stdout\n      get_shell_sbin_nologin = command(\"awk -F : '$1 == \\\"#{owner}\\\" { print $7}' /etc/passwd\").stdout\n      get_shell_usr_sbin_nologin = command(\"awk -F : '$1 == \\\"#{owner}\\\" { print $7}' /etc/passwd\").stdout\n\n      describe.one do\n        describe \"The wildfly process owner: #{owner}\\'s shell/interactive access\" do\n          subject { get_shell_bin_false }\n          it { should match(%r{/bin/false}) }\n        end\n        describe \"The wildfly process owner: #{owner}\\'s shell/interactive access\" do\n          subject { get_shell_sbin_nologin }\n          it { should match(%r{/sbin/nologin}) }\n        end\n        describe \"The wildfly process owner: #{owner}\\'s shell/interactive access\" do\n          subject { get_shell_usr_sbin_nologin }\n          it { should match(%r{/usr/sbin/nologin}) }\n        end\n      end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62261.rb",
        "line": 1
      },
      "id": "V-62261"
    },
    {
      "title": "Wildfly must be configured to use DoD PKI-established certificate\n  authorities for verification of the establishment of protected sessions.",
      "desc": "Untrusted Certificate Authorities (CA) can issue certificates, but they may\nbe issued by organizations or individuals that seek to compromise DoD systems\nor by organizations with insufficient security controls. If the CA used for\nverifying the certificate is not a DoD-approved CA, trust of this CA has not\nbeen established.\n\n    The DoD will only accept PKI certificates obtained from a DoD-approved\ninternal or external certificate authority. Reliance on CAs for the\nestablishment of secure sessions includes, for example, the use of SSL/TLS\ncertificates.  The application server must only allow the use of DoD\nPKI-established certificate authorities for verification.",
      "descriptions": {
        "default": "Untrusted Certificate Authorities (CA) can issue certificates, but they may\nbe issued by organizations or individuals that seek to compromise DoD systems\nor by organizations with insufficient security controls. If the CA used for\nverifying the certificate is not a DoD-approved CA, trust of this CA has not\nbeen established.\n\n    The DoD will only accept PKI certificates obtained from a DoD-approved\ninternal or external certificate authority. Reliance on CAs for the\nestablishment of secure sessions includes, for example, the use of SSL/TLS\ncertificates.  The application server must only allow the use of DoD\nPKI-established certificate authorities for verification."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000427-AS-000264",
        "gid": "V-62317",
        "rid": "SV-76807r1_rule",
        "stig_id": "JBOS-AS-000625",
        "cci": [
          "CCI-002470"
        ],
        "documentable": false,
        "nist": [
          "SC-23 (5)",
          "Rev_4"
        ],
        "check": "Locate the cacerts file for the JVM.  This can be done using\n  the appropriate find command for the OS and change to the directory where the\n  cacerts file is located.\n\n  To view the certificates stored within this file, execute the java command\n  \"keytool -list -v -keystore ./cacerts\".\n  Verify that the Certificate Authority (CA) for each certificate is DoD-approved.\n\n  If any certificates have a CA that are not DoD-approved, this is a finding.",
        "fix": "Locate the cacerts file for the JVM.  This can be done using the\n  appropriate find command for the OS and change to the directory where the\n  cacerts file is located.\n\n  Remove the certificates that have a CA that is non-DoD approved, and import DoD\n  CA-approved certificates.",
        "fix_id": "F-68237r1_fix"
      },
      "code": "control 'V-62317' do\n  title \"Wildfly must be configured to use DoD PKI-established certificate\n  authorities for verification of the establishment of protected sessions.\"\n  desc  \"\n    Untrusted Certificate Authorities (CA) can issue certificates, but they may\n  be issued by organizations or individuals that seek to compromise DoD systems\n  or by organizations with insufficient security controls. If the CA used for\n  verifying the certificate is not a DoD-approved CA, trust of this CA has not\n  been established.\n\n      The DoD will only accept PKI certificates obtained from a DoD-approved\n  internal or external certificate authority. Reliance on CAs for the\n  establishment of secure sessions includes, for example, the use of SSL/TLS\n  certificates.  The application server must only allow the use of DoD\n  PKI-established certificate authorities for verification.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000427-AS-000264'\n  tag \"gid\": 'V-62317'\n  tag \"rid\": 'SV-76807r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000625'\n  tag \"cci\": ['CCI-002470']\n  tag \"documentable\": false\n  tag \"nist\": ['SC-23 (5)', 'Rev_4']\n  tag \"check\": \"Locate the cacerts file for the JVM.  This can be done using\n  the appropriate find command for the OS and change to the directory where the\n  cacerts file is located.\n\n  To view the certificates stored within this file, execute the java command\n  \\\"keytool -list -v -keystore ./cacerts\\\".\n  Verify that the Certificate Authority (CA) for each certificate is DoD-approved.\n\n  If any certificates have a CA that are not DoD-approved, this is a finding.\"\n  tag \"fix\": \"Locate the cacerts file for the JVM.  This can be done using the\n  appropriate find command for the OS and change to the directory where the\n  cacerts file is located.\n\n  Remove the certificates that have a CA that is non-DoD approved, and import DoD\n  CA-approved certificates.\"\n  tag \"fix_id\": 'F-68237r1_fix'\n  dod_cn = command(\"keytool -list -v -keystore /usr/lib/jvm/java-1.8.0/jre/lib/security/cacerts\").stdout\n  eca_cn = command(\"keytool -list -v -keystore /usr/lib/jvm/java-1.8.0/jre/lib/security/cacerts\").stdout\n\n  describe.one do\n    describe 'The Wildfly DoD PKI-established certificate' do\n      subject { dod_cn }\n      it { should match(%r{CN=DoD}) }\n    end\n    describe 'The Wildfly DoD PKI-established certificate' do\n      subject { eca_cn }\n      it { should match(%r{CN=ECA}) }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62317.rb",
        "line": 1
      },
      "id": "V-62317"
    },
    {
      "title": "The Wildfly server must generate log records for access and\n  authentication events to the management interface.",
      "desc": "Log records can be generated from various components within the Wildfly\napplication server.  The minimum list of logged events should be those\npertaining to access and authentication events to the management interface as\nwell as system startup and shutdown events.\n\n    By default, Wildfly does not log management interface access but does provide\na default file handler.  This handler needs to be enabled.  Configuring this\nsetting meets several STIG auditing requirements.",
      "descriptions": {
        "default": "Log records can be generated from various components within the Wildfly\napplication server.  The minimum list of logged events should be those\npertaining to access and authentication events to the management interface as\nwell as system startup and shutdown events.\n\n    By default, Wildfly does not log management interface access but does provide\na default file handler.  This handler needs to be enabled.  Configuring this\nsetting meets several STIG auditing requirements."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000089-AS-000050",
        "gid": "V-62231",
        "rid": "SV-76721r1_rule",
        "stig_id": "JBOS-AS-000080",
        "cci": [
          "CCI-000169"
        ],
        "documentable": false,
        "nist": [
          "AU-12 a",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\n  Connect to the server by typing \"connect\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68151r1_fix"
      },
      "code": "control 'V-62231' do\n  title \"The Wildfly server must generate log records for access and\n  authentication events to the management interface.\"\n  desc  \"\n    Log records can be generated from various components within the Wildfly\n  application server.  The minimum list of logged events should be those\n  pertaining to access and authentication events to the management interface as\n  well as system startup and shutdown events.\n\n      By default, Wildfly does not log management interface access but does provide\n  a default file handler.  This handler needs to be enabled.  Configuring this\n  setting meets several STIG auditing requirements.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000089-AS-000050'\n  tag \"gid\": 'V-62231'\n  tag \"rid\": 'SV-76721r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000080'\n  tag \"cci\": ['CCI-000169']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-12 a', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \\\"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\n  Connect to the server by typing \\\"connect\\\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n\n  tag \"fix_id\": 'F-68151r1_fix'\n\n  connect = input('connection')\n\n  describe 'The Wildfly server generate log records for access and authentication events to the management interface.' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62231.rb",
        "line": 1
      },
      "id": "V-62231"
    },
    {
      "title": "LDAP enabled security realm value allow-empty-passwords must be set to\n  false.",
      "desc": "Passwords need to be protected at all times, and encryption is the standard\nmethod for protecting passwords during transmission.  If passwords are not\nencrypted, they can be plainly read (i.e., clear text) and easily compromised.\n\n    Application servers have the capability to utilize either certificates\n(tokens) or user IDs and passwords in order to authenticate. When the\napplication server transmits or receives passwords, the passwords must be\nencrypted.",
      "descriptions": {
        "default": "Passwords need to be protected at all times, and encryption is the standard\nmethod for protecting passwords during transmission.  If passwords are not\nencrypted, they can be plainly read (i.e., clear text) and easily compromised.\n\n    Application servers have the capability to utilize either certificates\n(tokens) or user IDs and passwords in order to authenticate. When the\napplication server transmits or receives passwords, the passwords must be\nencrypted."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000172-AS-000120",
        "gid": "V-62291",
        "rid": "SV-76781r1_rule",
        "stig_id": "JBOS-AS-000305",
        "cci": [
          "CCI-000197"
        ],
        "documentable": false,
        "nist": [
          "IA-5 (1) (c)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  \"ls\n  /core-service=management/security-realm=ldap_security_realm/authentication=ldap\"\n\n  If \"allow-empty-passwords=true\", this is a finding.",
        "fix": "Configure the LDAP Security Realm using default settings that\n  sets \"allow-empty-values\" to false.  LDAP Security Realm creation is\n  described in section 11.9 -Add an LDAP Security Realm in the\n  JBoss_Enterprise_Application_Platform-6.3-Administration_and_Configuration_Guide-en-US\n  document.",
        "fix_id": "F-68211r1_fix"
      },
      "code": "control 'V-62291' do\n  title \"LDAP enabled security realm value allow-empty-passwords must be set to\n  false.\"\n  desc  \"\n    Passwords need to be protected at all times, and encryption is the standard\n  method for protecting passwords during transmission.  If passwords are not\n  encrypted, they can be plainly read (i.e., clear text) and easily compromised.\n\n      Application servers have the capability to utilize either certificates\n  (tokens) or user IDs and passwords in order to authenticate. When the\n  application server transmits or receives passwords, the passwords must be\n  encrypted.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000172-AS-000120'\n  tag \"gid\": 'V-62291'\n  tag \"rid\": 'SV-76781r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000305'\n  tag \"cci\": ['CCI-000197']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-5 (1) (c)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  \\\"ls\n  /core-service=management/security-realm=ldap_security_realm/authentication=ldap\\\"\n\n  If \\\"allow-empty-passwords=true\\\", this is a finding.\"\n  tag \"fix\": \"Configure the LDAP Security Realm using default settings that\n  sets \\\"allow-empty-values\\\" to false.  LDAP Security Realm creation is\n  described in section 11.9 -Add an LDAP Security Realm in the\n  JBoss_Enterprise_Application_Platform-6.3-Administration_and_Configuration_Guide-en-US\n  document.\"\n  tag \"fix_id\": 'F-68211r1_fix'\n\n  connect = input('connection')\n  ldap = input('ldap')\n\n  if ldap\n    describe 'The LDAP enabled security realm value allow-empty-passwords' do\n      subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/security-realm=ldap_security_realm/authentication=ldap\").stdout }\n      it { should_not match(%r{allow-empty-passwords=true}) }\n    end\n  else\n    describe 'Ldap is not being used, control not applicable' do\n      skip 'Ldap is not being used, control not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62291.rb",
        "line": 1
      },
      "id": "V-62291"
    },
    {
      "title": "The Wildfly Password Vault must be used for storing passwords or other\n  sensitive configuration information.",
      "desc": "Wildfly has a Password Vault to encrypt sensitive strings, store\n  them in an encrypted keystore, and decrypt them for applications and\n  verification systems. Plain-text configuration files, such as XML deployment\n  descriptors, need to specify passwords and other sensitive information. Use the\n  Wildfly EAP Password Vault to securely store sensitive strings in plain-text\n  files.",
      "descriptions": {
        "default": "Wildfly has a Password Vault to encrypt sensitive strings, store\n  them in an encrypted keystore, and decrypt them for applications and\n  verification systems. Plain-text configuration files, such as XML deployment\n  descriptors, need to specify passwords and other sensitive information. Use the\n  Wildfly EAP Password Vault to securely store sensitive strings in plain-text\n  files."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000171-AS-000119",
        "gid": "V-62287",
        "rid": "SV-76777r1_rule",
        "stig_id": "JBOS-AS-000295",
        "cci": [
          "CCI-000196"
        ],
        "documentable": false,
        "nist": [
          "IA-5 (1) (c)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  \"ls /core-service=vault\"\n\n  If \"code=undefined\" and \"module=undefined\",\n  this is a finding.",
        "fix": "Configure the application server to use the java keystore and\n  Wildfly vault as per section 11.13.1 -Password Vault System in the\n  Wildfly-Administration_and_Configuration_Guide-en-US\n  document.\n\n  1. Create a java keystore.\n  2. Mask the keystore password and initialize the password vault.\n  3. Configure JBoss to use the password vault.",
        "fix_id": "F-68207r1_fix"
      },
      "code": "control 'V-62287' do\n  title \"The Wildfly Password Vault must be used for storing passwords or other\n  sensitive configuration information.\"\n  desc  \"Wildfly has a Password Vault to encrypt sensitive strings, store\n  them in an encrypted keystore, and decrypt them for applications and\n  verification systems. Plain-text configuration files, such as XML deployment\n  descriptors, need to specify passwords and other sensitive information. Use the\n  Wildfly EAP Password Vault to securely store sensitive strings in plain-text\n  files.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000171-AS-000119'\n  tag \"gid\": 'V-62287'\n  tag \"rid\": 'SV-76777r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000295'\n  tag \"cci\": ['CCI-000196']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-5 (1) (c)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  \\\"ls /core-service=vault\\\"\n\n  If \\\"code=undefined\\\" and \\\"module=undefined\\\",\n  this is a finding.\"\n  tag \"fix\": \"Configure the application server to use the java keystore and\n  Wildfly vault as per section 11.13.1 -Password Vault System in the\n  Wildfly-Administration_and_Configuration_Guide-en-US\n  document.\n\n  1. Create a java keystore.\n  2. Mask the keystore password and initialize the password vault.\n  3. Configure JBoss to use the password vault.\"\n  tag \"fix_id\": 'F-68207r1_fix'\n\n  connect = input('connection')\n\n  code = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=vault\").stdout\n  vault_module = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=vault\").stdout\n  vault_options = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=vault\").stdout\n\n  describe 'The wildfly password vault code' do\n    subject { code }\n    it { should_not match(%r{code=undefined}) }\n  end\n  describe 'The wildfly password vault module' do\n    subject { vault_module }\n    it { should_not match(%r{module=undefined}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62287.rb",
        "line": 1
      },
      "id": "V-62287"
    },
    {
      "title": "The application server must prevent non-privileged users from\n  executing privileged functions to include disabling, circumventing, or altering\n  implemented security safeguards/countermeasures.",
      "desc": "Preventing non-privileged users from executing privileged functions\nmitigates the risk that unauthorized individuals or processes may gain\nunnecessary access to information or privileges.\n\n    Restricting non-privileged users also prevents an attacker who has gained\naccess to a non-privileged account, from elevating privileges, creating\naccounts, and performing system checks and maintenance.",
      "descriptions": {
        "default": "Preventing non-privileged users from executing privileged functions\nmitigates the risk that unauthorized individuals or processes may gain\nunnecessary access to information or privileges.\n\n    Restricting non-privileged users also prevents an attacker who has gained\naccess to a non-privileged account, from elevating privileges, creating\naccounts, and performing system checks and maintenance."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000340-AS-000185",
        "gid": "V-62305",
        "rid": "SV-76795r1_rule",
        "stig_id": "JBOS-AS-000475",
        "cci": [
          "CCI-002235"
        ],
        "documentable": false,
        "nist": [
          "AC-6 (10)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Run the following command:\n\n  For standalone servers:\n  \"ls /core-service=management/access=authorization/\"\n\n  For managed domain installations:\n  \"ls /host=master/core-service=management/access=authorization/\"\n\n  If the \"provider\" attribute is not set to \"rbac\", this is a finding.",
        "fix": "Run the following command.\n  $JBOSS_HOME;/bin/jboss-cli.sh -c -> connect -> cd\n  /core-service=management/access-authorization :write-attribute(name=provider,\n  value=rbac)\n\n  Restart Wildfly.\n\n  Map users to roles by running the following command.  Upper-case words are\n  variables.\n\n  role-mapping=ROLENAME/include=ALIAS:add(name-USERNAME, type=USER ROLE)",
        "fix_id": "F-68225r1_fix"
      },
      "code": "control 'V-62305' do\n  title \"The application server must prevent non-privileged users from\n  executing privileged functions to include disabling, circumventing, or altering\n  implemented security safeguards/countermeasures.\"\n  desc  \"\n    Preventing non-privileged users from executing privileged functions\n  mitigates the risk that unauthorized individuals or processes may gain\n  unnecessary access to information or privileges.\n\n      Restricting non-privileged users also prevents an attacker who has gained\n  access to a non-privileged account, from elevating privileges, creating\n  accounts, and performing system checks and maintenance.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000340-AS-000185'\n  tag \"gid\": 'V-62305'\n  tag \"rid\": 'SV-76795r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000475'\n  tag \"cci\": ['CCI-002235']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-6 (10)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Run the following command:\n\n  For standalone servers:\n  \\\"ls /core-service=management/access=authorization/\\\"\n\n  For managed domain installations:\n  \\\"ls /host=master/core-service=management/access=authorization/\\\"\n\n  If the \\\"provider\\\" attribute is not set to \\\"rbac\\\", this is a finding.\"\n  tag \"fix\": \"Run the following command.\n  $JBOSS_HOME;/bin/jboss-cli.sh -c -> connect -> cd\n  /core-service=management/access-authorization :write-attribute(name=provider,\n  value=rbac)\n\n  Restart Wildfly.\n\n  Map users to roles by running the following command.  Upper-case words are\n  variables.\n\n  role-mapping=ROLENAME/include=ALIAS:add(name-USERNAME, type=USER ROLE)\"\n  tag \"fix_id\": 'F-68225r1_fix'\n\n  connect = input('connection')\n\n  describe \"The wildfly application server's access authorization\" do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/\").stdout }\n    it { should match(%r{provider=rbac}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62305.rb",
        "line": 1
      },
      "id": "V-62305"
    },
    {
      "title": "Welcome Web Application must be disabled.",
      "desc": "The Welcome to Wildfly web page provides a redirect to the Wildfly admin\n  console, which, by default, runs on TCP 9990 as well as redirects to the Online\n  User Guide and Online User Groups hosted at locations on the Internet.  The\n  welcome page is unnecessary and should be disabled or replaced with a valid web\n  page.",
      "descriptions": {
        "default": "The Welcome to Wildfly web page provides a redirect to the Wildfly admin\n  console, which, by default, runs on TCP 9990 as well as redirects to the Online\n  User Guide and Online User Groups hosted at locations on the Internet.  The\n  welcome page is unnecessary and should be disabled or replaced with a valid web\n  page."
      },
      "impact": 0.3,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000141-AS-000095",
        "gid": "V-62271",
        "rid": "SV-76761r1_rule",
        "stig_id": "JBOS-AS-000245",
        "cci": [
          "CCI-000381"
        ],
        "documentable": false,
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "check": "Use a web browser and browse to HTTP://Wildfly SERVER IP\n  ADDRESS:8080\n\n  If the Wildfly Welcome page is displayed, this is a finding.",
        "fix": "Use the Management CLI script JBOSS_HOME/bin/jboss-cli.sh to run\n  the following command. You may need to change the profile to modify a different\n  managed domain profile, or remove the \"/profile=default\" portion of the\n  command for a standalone server.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  \"/profile=default/subsystem=web/virtual-server=default-host:writeattribute(name=enable-welcome-root,value=false)\"\n\n  To configure your web application to use the root context (/) as its URL\n  address, modify the applications jboss-web.xml, which is located in the\n  applications META-INF/ or WEB-INF/ directory. Replace its <context-root>\n  directive with one that looks like the following:\n\n  <jboss-web>\n           <context-root>/</context-root>\n  </jboss-web>",
        "fix_id": "F-68191r1_fix"
      },
      "code": "control 'V-62271' do\n  title \"Welcome Web Application must be disabled.\"\n  desc  \"The Welcome to Wildfly web page provides a redirect to the Wildfly admin\n  console, which, by default, runs on TCP 9990 as well as redirects to the Online\n  User Guide and Online User Groups hosted at locations on the Internet.  The\n  welcome page is unnecessary and should be disabled or replaced with a valid web\n  page.\"\n  impact 0.3\n  tag \"gtitle\": 'SRG-APP-000141-AS-000095'\n  tag \"gid\": 'V-62271'\n  tag \"rid\": 'SV-76761r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000245'\n  tag \"cci\": ['CCI-000381']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"check\": \"Use a web browser and browse to HTTP://Wildfly SERVER IP\n  ADDRESS:8080\n\n  If the Wildfly Welcome page is displayed, this is a finding.\"\n\n\n  tag \"fix\": \"Use the Management CLI script JBOSS_HOME/bin/jboss-cli.sh to run\n  the following command. You may need to change the profile to modify a different\n  managed domain profile, or remove the \\\"/profile=default\\\" portion of the\n  command for a standalone server.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  \\\"/profile=default/subsystem=web/virtual-server=default-host:writeattribute(name=enable-welcome-root,value=false)\\\"\n\n  To configure your web application to use the root context (/) as its URL\n  address, modify the applications jboss-web.xml, which is located in the\n  applications META-INF/ or WEB-INF/ directory. Replace its <context-root>\n  directive with one that looks like the following:\n\n  <jboss-web>\n           <context-root>/</context-root>\n  </jboss-web>\"\n  tag \"fix_id\": 'F-68191r1_fix'\n\n  connect = input('connection')\n  describe 'The wildfly web application' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=undertow/server=default-server/host=default-host/location=\\\\\\/\").stdout }\n    it { should_not match(%r{handler=welcome-content}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62271.rb",
        "line": 1
      },
      "id": "V-62271"
    },
    {
      "title": "The Wildfly Server must be configured to use certificates to\n  authenticate admins.",
      "desc": "Multifactor authentication creates a layered defense and makes it more\ndifficult for an unauthorized person to access the application server.  If one\nfactor is compromised or broken, the attacker still has at least one more\nbarrier to breach before successfully breaking into the target.  Unlike a\nsimple username/password scenario where the attacker could gain access by\nknowing both the username and password without the user knowing his account was\ncompromised, multifactor authentication adds the requirement that the attacker\nmust have something from the user, such as a token, or to biometrically be the\nuser.\n\n    Multifactor authentication is defined as: using two or more factors to\nachieve authentication.\n\n    Factors include:\n    (i) something a user knows (e.g., password/PIN);\n    (ii) something a user has (e.g., cryptographic identification device,\ntoken); or\n    (iii) something a user is (e.g., biometric). A CAC or PKI Hardware Token\nmeets this definition.\n\n    A privileged account is defined as an information system account with\nauthorizations of a privileged user.  These accounts would be capable of\naccessing the web management interface.\n\n    When accessing the application server via a network connection,\nadministrative access to the application server must be PKI Hardware Token\nenabled or a DoD-approved soft certificate.",
      "descriptions": {
        "default": "Multifactor authentication creates a layered defense and makes it more\ndifficult for an unauthorized person to access the application server.  If one\nfactor is compromised or broken, the attacker still has at least one more\nbarrier to breach before successfully breaking into the target.  Unlike a\nsimple username/password scenario where the attacker could gain access by\nknowing both the username and password without the user knowing his account was\ncompromised, multifactor authentication adds the requirement that the attacker\nmust have something from the user, such as a token, or to biometrically be the\nuser.\n\n    Multifactor authentication is defined as: using two or more factors to\nachieve authentication.\n\n    Factors include:\n    (i) something a user knows (e.g., password/PIN);\n    (ii) something a user has (e.g., cryptographic identification device,\ntoken); or\n    (iii) something a user is (e.g., biometric). A CAC or PKI Hardware Token\nmeets this definition.\n\n    A privileged account is defined as an information system account with\nauthorizations of a privileged user.  These accounts would be capable of\naccessing the web management interface.\n\n    When accessing the application server via a network connection,\nadministrative access to the application server must be PKI Hardware Token\nenabled or a DoD-approved soft certificate."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000149-AS-000102",
        "gid": "V-62279",
        "rid": "SV-76769r1_rule",
        "stig_id": "JBOS-AS-000265",
        "cci": [
          "CCI-000765"
        ],
        "documentable": false,
        "nist": [
          "IA-2 (1)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Follow these steps:\n  1. Identify the security realm assigned to the management interfaces by using\n  the following command:\n\n  For standalone systems:\n  \"ls  /core-service=management/management-interface=<INTERFACE-NAME>\"\n\n  For managed domain systems:\n  \"ls\n  /host=master/core-service=management/management-interface=<INTERFACE-NAME>\"\n\n  Document the name of the security-realm associated with each management\n  interface.\n\n  2. Review the security realm using the command:\n\n  For standalone systems:\n  \"ls\n  /core-service=management/security-realm=<SECURITY_REALM_NAME>/authentication\"\n\n  For managed domains:\n  \"ls\n  /host=master/core-service=management/security-realm=<SECURITY_REALM_NAME>/authentication\"\n\n  If the command in step 2 does not return a security realm that uses\n  certificates for authentication, this is a finding.",
        "fix": "Configure the application server to authenticate privileged users\n  via multifactor/certificate-based authentication mechanisms when using network\n  access to the management interface.",
        "fix_id": "F-68199r1_fix"
      },
      "code": "control 'V-62279' do\n  title \"The Wildfly Server must be configured to use certificates to\n  authenticate admins.\"\n  desc  \"\n    Multifactor authentication creates a layered defense and makes it more\n  difficult for an unauthorized person to access the application server.  If one\n  factor is compromised or broken, the attacker still has at least one more\n  barrier to breach before successfully breaking into the target.  Unlike a\n  simple username/password scenario where the attacker could gain access by\n  knowing both the username and password without the user knowing his account was\n  compromised, multifactor authentication adds the requirement that the attacker\n  must have something from the user, such as a token, or to biometrically be the\n  user.\n\n      Multifactor authentication is defined as: using two or more factors to\n  achieve authentication.\n\n      Factors include:\n      (i) something a user knows (e.g., password/PIN);\n      (ii) something a user has (e.g., cryptographic identification device,\n  token); or\n      (iii) something a user is (e.g., biometric). A CAC or PKI Hardware Token\n  meets this definition.\n\n      A privileged account is defined as an information system account with\n  authorizations of a privileged user.  These accounts would be capable of\n  accessing the web management interface.\n\n      When accessing the application server via a network connection,\n  administrative access to the application server must be PKI Hardware Token\n  enabled or a DoD-approved soft certificate.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000149-AS-000102'\n  tag \"gid\": 'V-62279'\n  tag \"rid\": 'SV-76769r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000265'\n  tag \"cci\": ['CCI-000765']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-2 (1)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Follow these steps:\n  1. Identify the security realm assigned to the management interfaces by using\n  the following command:\n\n  For standalone systems:\n  \\\"ls  /core-service=management/management-interface=<INTERFACE-NAME>\\\"\n\n  For managed domain systems:\n  \\\"ls\n  /host=master/core-service=management/management-interface=<INTERFACE-NAME>\\\"\n\n  Document the name of the security-realm associated with each management\n  interface.\n\n  2. Review the security realm using the command:\n\n  For standalone systems:\n  \\\"ls\n  /core-service=management/security-realm=<SECURITY_REALM_NAME>/authentication\\\"\n\n  For managed domains:\n  \\\"ls\n  /host=master/core-service=management/security-realm=<SECURITY_REALM_NAME>/authentication\\\"\n\n  If the command in step 2 does not return a security realm that uses\n  certificates for authentication, this is a finding.\"\n  tag \"fix\": \"Configure the application server to authenticate privileged users\n  via multifactor/certificate-based authentication mechanisms when using network\n  access to the management interface.\"\n  tag \"fix_id\": 'F-68199r1_fix'\n\n  connect = input('connection')\n\n  mgmt_interfaces = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/management-interface=\").stdout.split(\"\\n\")\n\n  mgmt_interfaces.each do |interface|\n\n    security_realms = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/security-realm=\").stdout.split(\"\\n\")\n    security_realms.each do |realm|\n\n      get_authentication = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/security-realm=#{realm}/authentication\").stdout\n      http_enabled = describe command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/management-interface=http-interface\") .stdout\n\n      describe.one do\n        describe \"The wildfly server authentication for security realm #{realm}\" do\n          subject { get_authentication }\n          it { should match /truststore/ }\n        end\n        describe \"The wildfly server authentication for security realm #{realm}\" do\n          subject { http_enabled }\n          it { should  match(%r{console-enabled=false}) }\n        end\n      end\n    end\n  end\n  if mgmt_interfaces.empty?\n    impact 0.0\n    describe 'There are no wildfly management realms, therefore this control is not applicable' do\n      skip 'There are no wildfly management realms, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62279.rb",
        "line": 1
      },
      "id": "V-62279"
    },
    {
      "title": "Users in JBoss Management Security Realms must be in the appropriate role",
      "desc": "Security realms are a series of mappings between users and passwords and\nusers and roles.  There are 2 JBoss security realms provided by default; they\nare \"management realm\" and \"application realm\".\n\n    Management realm stores authentication information for the management API,\nwhich provides functionality for the web-based management console and the\nmanagement command line interface (CLI).\n\n    mgmt-groups.properties stores user to group mapping for the ManagementRealm\nbut only when role-based access controls  (RBAC) is enabled.\n\n    If management users are not in the appropriate role, unauthorized access to\nJBoss resources can occur.",
      "descriptions": {
        "default": "Security realms are a series of mappings between users and passwords and\nusers and roles.  There are 2 JBoss security realms provided by default; they\nare \"management realm\" and \"application realm\".\n\n    Management realm stores authentication information for the management API,\nwhich provides functionality for the web-based management console and the\nmanagement command line interface (CLI).\n\n    mgmt-groups.properties stores user to group mapping for the ManagementRealm\nbut only when role-based access controls  (RBAC) is enabled.\n\n    If management users are not in the appropriate role, unauthorized access to\nJBoss resources can occur."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000033-AS-000024",
        "gid": "V-62219",
        "rid": "SV-76709r1_rule",
        "stig_id": "JBOS-AS-000040",
        "cci": [
          "CCI-000213"
        ],
        "documentable": false,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "check": "Review the mgmt-users.properties file.   Also review the\n<management /> section in the standalone.xml or domain.xml configuration files.\n The relevant xml file will depend on if the Wildfly server is configured in\nstandalone or domain mode.\n\nEnsure all users listed in these files are approved for management access to\nthe JBoss server and are in the appropriate role.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nFor domain configurations:\n$JBOSS_HOME;/domain/configuration/mgmt-users.properties.\n$JBOSS_HOME;/domain/configuration/domain.xml\n\nFor standalone configurations:\n$JBOSS_HOME;/standalone/configuration/mgmt-users.properties.\n$JBOSS_HOME;/standalone/configuration/standalone.xml\n\nIf the users listed are not in the appropriate role, this is a finding.",
        "fix": "Document approved management users and their roles.  Configure\nthe application server to use RBAC and ensure users are placed into the\nappropriate roles.",
        "fix_id": "F-68139r1_fix"
      },
      "code": "control 'V-62219' do\n  title \"Users in JBoss Management Security Realms must be in the appropriate role\"\n  desc  \"\n    Security realms are a series of mappings between users and passwords and\nusers and roles.  There are 2 JBoss security realms provided by default; they\nare \\\"management realm\\\" and \\\"application realm\\\".\n\n    Management realm stores authentication information for the management API,\nwhich provides functionality for the web-based management console and the\nmanagement command line interface (CLI).\n\n    mgmt-groups.properties stores user to group mapping for the ManagementRealm\nbut only when role-based access controls  (RBAC) is enabled.\n\n    If management users are not in the appropriate role, unauthorized access to\nJBoss resources can occur.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000033-AS-000024'\n  tag \"gid\": 'V-62219'\n  tag \"rid\": 'SV-76709r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000040'\n  tag \"cci\": ['CCI-000213']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"check\": \"Review the mgmt-users.properties file.   Also review the\n<management /> section in the standalone.xml or domain.xml configuration files.\n The relevant xml file will depend on if the Wildfly server is configured in\nstandalone or domain mode.\n\nEnsure all users listed in these files are approved for management access to\nthe JBoss server and are in the appropriate role.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nFor domain configurations:\n$JBOSS_HOME;/domain/configuration/mgmt-users.properties.\n$JBOSS_HOME;/domain/configuration/domain.xml\n\nFor standalone configurations:\n$JBOSS_HOME;/standalone/configuration/mgmt-users.properties.\n$JBOSS_HOME;/standalone/configuration/standalone.xml\n\nIf the users listed are not in the appropriate role, this is a finding.\"\n  tag \"fix\": \"Document approved management users and their roles.  Configure\nthe application server to use RBAC and ensure users are placed into the\nappropriate roles.\"\n  tag \"fix_id\": 'F-68139r1_fix'\n\n  connect = input('connection')\n  auditor_role_users = input('auditor_role_users')\n  administrator_role_users = input('administrator_role_users')\n  superuser_role_users = input('superuser_role_users')\n\n  role_mappings = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=\").stdout.strip.split(\" \")\n  auditor_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=Auditor/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n  administrator_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=Administrator/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n  superuser_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/role-mapping=SuperUser/include= | grep -v 'Manage' | grep -v 'core' | grep -v 'access' | grep -v 'mapping' | grep -v 'not found'\").stdout.strip.split(\" \")\n\n  if !auditor_role.empty?\n    auditor_role.each do |user|\n      describe \"#{user}\" do\n        it { should be_in auditor_role_users }\n      end\n    end\n  end\n\n  if !administrator_role.empty?\n    administrator_role.each do |user|\n      describe \"#{user}\" do\n        it { should be_in administrator_role_users }\n      end\n    end\n  end\n\n  if !superuser_role.empty?\n    superuser_role.each do |user|\n     describe \"#{user}\" do\n        it { should be_in superuser_role_users }\n      end\n    end\n  end\n\n  if auditor_role.empty? && administrator_role.empty? && superuser_role.empty?\n    impact 0.0\n    describe 'There are no Wildfly users with the auditor, administrator or superuser roles, therefore this control is not applicable' do\n      skip 'There are no Wildfly users with the auditor, administrator or superuser roles, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62219.rb",
        "line": 1
      },
      "id": "V-62219"
    },
    {
      "title": "The Wildfly server must be configured to restrict access to the web\n  servers private key to authenticated system administrators.",
      "desc": "The cornerstone of the PKI is the private key used to encrypt or digitally\nsign information.\n\n    If the private key is stolen, this will lead to the compromise of the\nauthentication and non-repudiation gained through PKI because the attacker can\nuse the private key to digitally sign documents and can pretend to be the\nauthorized user.\n\n    Both the holders of a digital certificate and the issuing authority must\nprotect the computers, storage devices, or whatever they use to keep the\nprivate keys. Java-based application servers utilize the Java keystore, which\nprovides storage for cryptographic keys and certificates. The keystore is\nusually maintained in a file stored on the file system.",
      "descriptions": {
        "default": "The cornerstone of the PKI is the private key used to encrypt or digitally\nsign information.\n\n    If the private key is stolen, this will lead to the compromise of the\nauthentication and non-repudiation gained through PKI because the attacker can\nuse the private key to digitally sign documents and can pretend to be the\nauthorized user.\n\n    Both the holders of a digital certificate and the issuing authority must\nprotect the computers, storage devices, or whatever they use to keep the\nprivate keys. Java-based application servers utilize the Java keystore, which\nprovides storage for cryptographic keys and certificates. The keystore is\nusually maintained in a file stored on the file system."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000176-AS-000125",
        "gid": "V-62295",
        "rid": "SV-76785r1_rule",
        "stig_id": "JBOS-AS-000320",
        "cci": [
          "CCI-000186"
        ],
        "documentable": false,
        "nist": [
          "IA-5 (2) (b)",
          "Rev_4"
        ],
        "check": "The default location for the keystore used by the Wildfly vault\n  is the $JBOSS_HOME;/vault/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  If a vault keystore has been created, by default it will be in the file:\n  $JBOSS_HOME;/vault/vault.keystore.  The file stores a single key, with the\n  default alias vault, which will be used to store encrypted strings, such as\n  passwords, for Wildfly EAP.\n\n  Browse to the Wildfly vault folder using the relevant OS commands.\n  Review the file permissions and ensure only system administrators and Wildfly\n  users are allowed access.\n\n  Owner can be full access\n  Group can be full access\n  All others must be restricted to execute access or no permission.\n\n  If non-system administrators are allowed to access the $JBOSS_HOME;/vault/\n  folder, this is a finding.",
        "fix": "Configure the application server OS file permissions on the\n  corresponding private key to restrict access to authorized accounts or roles.",
        "fix_id": "F-68215r1_fix"
      },
      "code": "control 'V-62295' do\n  title \"The Wildfly server must be configured to restrict access to the web\n  servers private key to authenticated system administrators.\"\n  desc  \"\n    The cornerstone of the PKI is the private key used to encrypt or digitally\n  sign information.\n\n      If the private key is stolen, this will lead to the compromise of the\n  authentication and non-repudiation gained through PKI because the attacker can\n  use the private key to digitally sign documents and can pretend to be the\n  authorized user.\n\n      Both the holders of a digital certificate and the issuing authority must\n  protect the computers, storage devices, or whatever they use to keep the\n  private keys. Java-based application servers utilize the Java keystore, which\n  provides storage for cryptographic keys and certificates. The keystore is\n  usually maintained in a file stored on the file system.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000176-AS-000125'\n  tag \"gid\": 'V-62295'\n  tag \"rid\": 'SV-76785r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000320'\n  tag \"cci\": ['CCI-000186']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-5 (2) (b)', 'Rev_4']\n  tag \"check\": \"The default location for the keystore used by the Wildfly vault\n  is the $JBOSS_HOME;/vault/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  If a vault keystore has been created, by default it will be in the file:\n  $JBOSS_HOME;/vault/vault.keystore.  The file stores a single key, with the\n  default alias vault, which will be used to store encrypted strings, such as\n  passwords, for Wildfly EAP.\n\n  Browse to the Wildfly vault folder using the relevant OS commands.\n  Review the file permissions and ensure only system administrators and Wildfly\n  users are allowed access.\n\n  Owner can be full access\n  Group can be full access\n  All others must be restricted to execute access or no permission.\n\n  If non-system administrators are allowed to access the $JBOSS_HOME;/vault/\n  folder, this is a finding.\"\n  tag \"fix\": \"Configure the application server OS file permissions on the\n  corresponding private key to restrict access to authorized accounts or roles.\"\n  tag \"fix_id\": 'F-68215r1_fix'\n  describe directory(\"#{ input('jboss_home') }/vault\") do\n    it { should_not be_readable.by('others') }\n  end\n  describe directory(\"#{ input('jboss_home') }/vault\") do\n    it { should_not be_writable.by('others') }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62295.rb",
        "line": 1
      },
      "id": "V-62295"
    },
    {
      "title": "Wildfly must be configured to generate log records when\n  successful/unsuccessful attempts to modify privileges occur.",
      "desc": "Changing privileges of a subject/object may cause a subject/object to\n  gain or lose capabilities.  When successful/unsuccessful changes are made, the\n  event needs to be logged.  By logging the event, the modification or attempted\n  modification can be investigated to determine if it was performed inadvertently\n  or maliciously.",
      "descriptions": {
        "default": "Changing privileges of a subject/object may cause a subject/object to\n  gain or lose capabilities.  When successful/unsuccessful changes are made, the\n  event needs to be logged.  By logging the event, the modification or attempted\n  modification can be investigated to determine if it was performed inadvertently\n  or maliciously."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000495-AS-000220",
        "gid": "V-62329",
        "rid": "SV-76819r1_rule",
        "stig_id": "JBOS-AS-000690",
        "cci": [
          "CCI-000172"
        ],
        "documentable": false,
        "nist": [
          "AU-12 c",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\n  Connect to the server by typing \"connect\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68249r1_fix"
      },
      "code": "control 'V-62329' do\n  title \"Wildfly must be configured to generate log records when\n  successful/unsuccessful attempts to modify privileges occur.\"\n  desc  \"Changing privileges of a subject/object may cause a subject/object to\n  gain or lose capabilities.  When successful/unsuccessful changes are made, the\n  event needs to be logged.  By logging the event, the modification or attempted\n  modification can be investigated to determine if it was performed inadvertently\n  or maliciously.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000495-AS-000220'\n  tag \"gid\": 'V-62329'\n  tag \"rid\": 'SV-76819r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000690'\n  tag \"cci\": ['CCI-000172']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-12 c', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \\\"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\n  Connect to the server by typing \\\"connect\\\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68249r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly setting: generate log records when successful/unsuccessful attempts to modify privileges occur' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62329.rb",
        "line": 1
      },
      "id": "V-62329"
    },
    {
      "title": "The Wildfly server must be configured with Role Based Access Controls.",
      "desc": "By default, the Wildfly server is not configured to utilize role based\naccess controls (RBAC).  RBAC provides the capability to restrict user access\nto their designated management role, thereby limiting access to only the Wildfly\nfunctionality that they are supposed to have.  Without RBAC, the Wildfly server\nis not able to enforce authorized access according to role.",
      "descriptions": {
        "default": "By default, the Wildfly server is not configured to utilize role based\naccess controls (RBAC).  RBAC provides the capability to restrict user access\nto their designated management role, thereby limiting access to only the Wildfly\nfunctionality that they are supposed to have.  Without RBAC, the Wildfly server\nis not able to enforce authorized access according to role."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000033-AS-000024",
        "gid": "V-62227",
        "rid": "SV-76717r1_rule",
        "stig_id": "JBOS-AS-000035",
        "cci": [
          "CCI-000213"
        ],
        "documentable": false,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nRun the following command:\n\nFor standalone servers:\n\"ls /core-service=management/access=authorization/\"\n\nFor managed domain installations:\n\"ls /host=master/core-service=management/access=authorization/\"\n\nIf the \"provider\" attribute is not set to \"rbac\", this is a finding.",
        "fix": "Run the following command.\n$JBOSS_HOME;/bin/jboss-cli.sh -c -> connect -> cd\n/core-service=management/access-authorization :write-attribute(name=provider,\nvalue=rbac)\n\nRestart Wildfly.\n\nMap users to roles by running the following command.  Upper-case words  are\nvariables.\n\nrole-mapping=ROLENAME/include=ALIAS:add(name-USERNAME, type=USER ROLE)",
        "fix_id": "F-68147r1_fix"
      },
      "code": "control 'V-62227' do\n  title \"The Wildfly server must be configured with Role Based Access Controls.\"\n  desc  \"By default, the Wildfly server is not configured to utilize role based\naccess controls (RBAC).  RBAC provides the capability to restrict user access\nto their designated management role, thereby limiting access to only the Wildfly\nfunctionality that they are supposed to have.  Without RBAC, the Wildfly server\nis not able to enforce authorized access according to role.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000033-AS-000024'\n  tag \"gid\": 'V-62227'\n  tag \"rid\": 'SV-76717r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000035'\n  tag \"cci\": ['CCI-000213']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nRun the following command:\n\nFor standalone servers:\n\\\"ls /core-service=management/access=authorization/\\\"\n\nFor managed domain installations:\n\\\"ls /host=master/core-service=management/access=authorization/\\\"\n\nIf the \\\"provider\\\" attribute is not set to \\\"rbac\\\", this is a finding.\"\n  tag \"fix\": \"Run the following command.\n$JBOSS_HOME;/bin/jboss-cli.sh -c -> connect -> cd\n/core-service=management/access-authorization :write-attribute(name=provider,\nvalue=rbac)\n\nRestart Wildfly.\n\nMap users to roles by running the following command.  Upper-case words  are\nvariables.\n\nrole-mapping=ROLENAME/include=ALIAS:add(name-USERNAME, type=USER ROLE)\"\n  tag \"fix_id\": 'F-68147r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly server authorization access' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=authorization/\").stdout }\n    it { should match(%r{provider=rbac}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62227.rb",
        "line": 1
      },
      "id": "V-62227"
    },
    {
      "title": "File permissions must be configured to protect log information from\nunauthorized modification.",
      "desc": "If log data were to become compromised, then competent forensic analysis\nand discovery of the true source of potentially malicious system activity is\ndifficult, if not impossible, to achieve.\n\n    When not configured to use a centralized logging solution like a syslog\nserver, the Wildfly EAP application server writes log data to log files that are\nstored on the OS; appropriate file permissions must be used to restrict\nmodification.\n\n    Log information includes all information (e.g., log records, log settings,\ntransaction logs, and log reports) needed to successfully log information\nsystem activity. Application servers must protect log information from\nunauthorized modification.",
      "descriptions": {
        "default": "If log data were to become compromised, then competent forensic analysis\nand discovery of the true source of potentially malicious system activity is\ndifficult, if not impossible, to achieve.\n\n    When not configured to use a centralized logging solution like a syslog\nserver, the Wildfly EAP application server writes log data to log files that are\nstored on the OS; appropriate file permissions must be used to restrict\nmodification.\n\n    Log information includes all information (e.g., log records, log settings,\ntransaction logs, and log reports) needed to successfully log information\nsystem activity. Application servers must protect log information from\nunauthorized modification."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000119-AS-000079",
        "gid": "V-62253",
        "rid": "SV-76743r1_rule",
        "stig_id": "JBOS-AS-000170",
        "cci": [
          "CCI-000163"
        ],
        "documentable": false,
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "check": "Examine the log file locations and inspect the file\npermissions.  Interview the system admin to determine log file locations. The\ndefault location for the log files is:\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nStandalone configuration:\n$JBOSS_HOME;/standalone/log/\n\nManaged Domain configuration:\n$JBOSS_HOME;/domain/servers/<servername>/log/\n$JBOSS_HOME;/domain/log/\n\nReview the file permissions for the log file directories.  The method used for\nidentifying file permissions will be based upon the OS the EAP server is\ninstalled on.\n\nIdentify all users with file permissions that allow them to modify log files.\n\nRequest documentation from system admin that identifies the users who are\nauthorized to modify log files.\n\nIf unauthorized users are allowed to modify log files, or if documentation that\nidentifies the users who are authorized to modify log files is missing, this is\na finding.",
        "fix": "Configure the OS file permissions on the application server to\nprotect log information from unauthorized modification.",
        "fix_id": "F-68173r1_fix"
      },
      "code": "control 'V-62253' do\n  title \"File permissions must be configured to protect log information from\nunauthorized modification.\"\n  desc  \"\n    If log data were to become compromised, then competent forensic analysis\nand discovery of the true source of potentially malicious system activity is\ndifficult, if not impossible, to achieve.\n\n    When not configured to use a centralized logging solution like a syslog\nserver, the Wildfly EAP application server writes log data to log files that are\nstored on the OS; appropriate file permissions must be used to restrict\nmodification.\n\n    Log information includes all information (e.g., log records, log settings,\ntransaction logs, and log reports) needed to successfully log information\nsystem activity. Application servers must protect log information from\nunauthorized modification.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000119-AS-000079'\n  tag \"gid\": 'V-62253'\n  tag \"rid\": 'SV-76743r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000170'\n  tag \"cci\": ['CCI-000163']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-9', 'Rev_4']\n  tag \"check\": \"Examine the log file locations and inspect the file\npermissions.  Interview the system admin to determine log file locations. The\ndefault location for the log files is:\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nStandalone configuration:\n$JBOSS_HOME;/standalone/log/\n\nManaged Domain configuration:\n$JBOSS_HOME;/domain/servers/<servername>/log/\n$JBOSS_HOME;/domain/log/\n\nReview the file permissions for the log file directories.  The method used for\nidentifying file permissions will be based upon the OS the EAP server is\ninstalled on.\n\nIdentify all users with file permissions that allow them to modify log files.\n\nRequest documentation from system admin that identifies the users who are\nauthorized to modify log files.\n\nIf unauthorized users are allowed to modify log files, or if documentation that\nidentifies the users who are authorized to modify log files is missing, this is\na finding.\"\n  tag \"fix\": \"Configure the OS file permissions on the application server to\nprotect log information from unauthorized modification.\"\n  tag \"fix_id\": 'F-68173r1_fix'\n\n  wildfly_group = input('wildfly_group')\n  wildly_owner = input('wildly_owner')\n  describe directory(\"#{ input('jboss_home') }/standalone/log\") do\n    its('owner') { should eq \"#{wildly_owner}\" }\n    its('group') { should eq \"#{wildfly_group}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62253.rb",
        "line": 1
      },
      "id": "V-62253"
    },
    {
      "title": "Production Wildfly servers must not allow automatic application\n  deployment.",
      "desc": "When dealing with access restrictions pertaining to change control, it\nshould be noted that any changes to the software and/or application server\nconfiguration can potentially have significant effects on the overall security\nof the system.\n\n    Access restrictions for changes also include application software libraries.\n\n    If the application server provides automatic code deployment capability,\n(where updates to applications hosted on the application server are\nautomatically performed, usually by the developers' IDE tool), it must also\nprovide a capability to restrict the use of automatic application deployment.\nAutomatic code deployments are allowable in a development environment, but not\nin production.",
      "descriptions": {
        "default": "When dealing with access restrictions pertaining to change control, it\nshould be noted that any changes to the software and/or application server\nconfiguration can potentially have significant effects on the overall security\nof the system.\n\n    Access restrictions for changes also include application software libraries.\n\n    If the application server provides automatic code deployment capability,\n(where updates to applications hosted on the application server are\nautomatically performed, usually by the developers' IDE tool), it must also\nprovide a capability to restrict the use of automatic application deployment.\nAutomatic code deployments are allowable in a development environment, but not\nin production."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000380-AS-000088",
        "gid": "V-62311",
        "rid": "SV-76801r1_rule",
        "stig_id": "JBOS-AS-000545",
        "cci": [
          "CCI-001813"
        ],
        "documentable": false,
        "nist": [
          "CM-5 (1)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  ls /subsystem=deployment-scanner/scanner=default\n\n  If \"scan-enabled\"=true, this is a finding.",
        "fix": "Determine the JBoss server configuration as being either\n  standalone or domain.\n\n  Launch the relevant jboss-cli management interface substituting standalone or\n  domain for <CONFIG>\n\n  $JBOSS_HOME;/<CONFIG>/bin/jboss-cli\n\n  connect to the server and run the command:\n\n  /subsystem=deployment-scanner/scanner=default:write-attribute(name=scan-enabled,value=false)",
        "fix_id": "F-68231r1_fix"
      },
      "code": "control 'V-62311' do\n  title \"Production Wildfly servers must not allow automatic application\n  deployment.\"\n  desc  \"\n    When dealing with access restrictions pertaining to change control, it\n  should be noted that any changes to the software and/or application server\n  configuration can potentially have significant effects on the overall security\n  of the system.\n\n      Access restrictions for changes also include application software libraries.\n\n      If the application server provides automatic code deployment capability,\n  (where updates to applications hosted on the application server are\n  automatically performed, usually by the developers' IDE tool), it must also\n  provide a capability to restrict the use of automatic application deployment.\n  Automatic code deployments are allowable in a development environment, but not\n  in production.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000380-AS-000088'\n  tag \"gid\": 'V-62311'\n  tag \"rid\": 'SV-76801r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000545'\n  tag \"cci\": ['CCI-001813']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-5 (1)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  ls /subsystem=deployment-scanner/scanner=default\n\n  If \\\"scan-enabled\\\"=true, this is a finding.\"\n  tag \"fix\": \"Determine the JBoss server configuration as being either\n  standalone or domain.\n\n  Launch the relevant jboss-cli management interface substituting standalone or\n  domain for <CONFIG>\n\n  $JBOSS_HOME;/<CONFIG>/bin/jboss-cli\n\n  connect to the server and run the command:\n\n  /subsystem=deployment-scanner/scanner=default:write-attribute(name=scan-enabled,value=false)\"\n  tag \"fix_id\": 'F-68231r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly application deployment scanner' do\n  subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=deployment-scanner/scanner=default\").stdout }\n    it { should_not match(%r{scan-enabled=true}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62311.rb",
        "line": 1
      },
      "id": "V-62311"
    },
    {
      "title": "Wildfly must be configured to record the IP address and port information\nused by management interface network traffic.",
      "desc": "Application server logging capability is critical for accurate forensic\nanalysis.  Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct source, e.g., source IP, of the events is\nimportant during forensic analysis.  Correctly determining the source will add\ninformation to the overall reconstruction of the loggable event.  By\ndetermining the source of the event correctly, analysis of the enterprise can\nbe undertaken to determine if the event compromised other assets within the\nenterprise.\n\n    Without sufficient information establishing the source of the logged event,\ninvestigation into the cause of event is severely hindered.  Log record content\nthat may be necessary to satisfy the requirement of this control includes, but\nis not limited to, time stamps, source and destination IP addresses,\nuser/process identifiers, event descriptions, application-specific events,\nsuccess/fail indications, filenames involved, access control, or flow control\nrules invoked.",
      "descriptions": {
        "default": "Application server logging capability is critical for accurate forensic\nanalysis.  Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct source, e.g., source IP, of the events is\nimportant during forensic analysis.  Correctly determining the source will add\ninformation to the overall reconstruction of the loggable event.  By\ndetermining the source of the event correctly, analysis of the enterprise can\nbe undertaken to determine if the event compromised other assets within the\nenterprise.\n\n    Without sufficient information establishing the source of the logged event,\ninvestigation into the cause of event is severely hindered.  Log record content\nthat may be necessary to satisfy the requirement of this control includes, but\nis not limited to, time stamps, source and destination IP addresses,\nuser/process identifiers, event descriptions, application-specific events,\nsuccess/fail indications, filenames involved, access control, or flow control\nrules invoked."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000098-AS-000061",
        "gid": "V-62245",
        "rid": "SV-76735r1_rule",
        "stig_id": "JBOS-AS-000125",
        "cci": [
          "CCI-000133"
        ],
        "documentable": false,
        "nist": [
          "AU-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nIf \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\nConnect to the server by typing \"connect\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68165r1_fix"
      },
      "code": "control 'V-62245' do\n  title \"Wildfly must be configured to record the IP address and port information\nused by management interface network traffic.\"\n  desc  \"\n    Application server logging capability is critical for accurate forensic\nanalysis.  Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct source, e.g., source IP, of the events is\nimportant during forensic analysis.  Correctly determining the source will add\ninformation to the overall reconstruction of the loggable event.  By\ndetermining the source of the event correctly, analysis of the enterprise can\nbe undertaken to determine if the event compromised other assets within the\nenterprise.\n\n    Without sufficient information establishing the source of the logged event,\ninvestigation into the cause of event is severely hindered.  Log record content\nthat may be necessary to satisfy the requirement of this control includes, but\nis not limited to, time stamps, source and destination IP addresses,\nuser/process identifiers, event descriptions, application-specific events,\nsuccess/fail indications, filenames involved, access control, or flow control\nrules invoked.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000098-AS-000061'\n  tag \"gid\": 'V-62245'\n  tag \"rid\": 'SV-76735r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000125'\n  tag \"cci\": ['CCI-000133']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\\\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nIf \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\nConnect to the server by typing \\\"connect\\\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68165r1_fix'\n\n  connect = input('connection')\n\n  describe 'Wildfly record the IP address and port information used by management interface network traffic.' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62245.rb",
        "line": 1
      },
      "id": "V-62245"
    },
    {
      "title": "The JRE installed on the Wildfly server must be kept up to date.",
      "desc": "The Wildfly product is available as Open Source; however, the Red Hat\n  vendor provides updates, patches and support for the Wildfly product.  It is\n  imperative that patches and updates be applied to Wildfly in a timely manner as\n  many attacks against Wildfly focus on unpatched systems.  It is critical that\n  support be obtained and made available.",
      "descriptions": {
        "default": "The Wildfly product is available as Open Source; however, the Red Hat\n  vendor provides updates, patches and support for the Wildfly product.  It is\n  imperative that patches and updates be applied to Wildfly in a timely manner as\n  many attacks against Wildfly focus on unpatched systems.  It is critical that\n  support be obtained and made available."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000456-AS-000266",
        "gid": "V-62327",
        "rid": "SV-76817r1_rule",
        "stig_id": "JBOS-AS-000685",
        "cci": [
          "CCI-002605"
        ],
        "documentable": false,
        "nist": [
          "SI-2 c",
          "Rev_4"
        ],
        "check": "Interview the system admin and obtain details on their patch\n  management processes as it relates to the OS and the Application Server.\n\n  If there is no active, documented patch management process in use for these\n  components, this is a finding.",
        "fix": "Configure the operating system and the application server to use\n  a patch management system or process that ensures security-relevant updates are\n  installed within the time period directed by the ISSM.",
        "fix_id": "F-68247r1_fix"
      },
      "code": "control 'V-62327' do\n  title \"The JRE installed on the Wildfly server must be kept up to date.\"\n  desc  \"The Wildfly product is available as Open Source; however, the Red Hat\n  vendor provides updates, patches and support for the Wildfly product.  It is\n  imperative that patches and updates be applied to Wildfly in a timely manner as\n  many attacks against Wildfly focus on unpatched systems.  It is critical that\n  support be obtained and made available.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000456-AS-000266'\n  tag \"gid\": 'V-62327'\n  tag \"rid\": 'SV-76817r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000685'\n  tag \"cci\": ['CCI-002605']\n  tag \"documentable\": false\n  tag \"nist\": ['SI-2 c', 'Rev_4']\n  tag \"check\": \"Interview the system admin and obtain details on their patch\n  management processes as it relates to the OS and the Application Server.\n\n  If there is no active, documented patch management process in use for these\n  components, this is a finding.\"\n  tag \"fix\": \"Configure the operating system and the application server to use\n  a patch management system or process that ensures security-relevant updates are\n  installed within the time period directed by the ISSM.\"\n  tag \"fix_id\": 'F-68247r1_fix'\n  describe.one do\n    describe package('java-1.7.0-openjdk') do\n      its('version') { should cmp >= '1.7.0.171' }\n    end\n    describe package('java-1.8.0-openjdk') do\n      its('version') { should cmp >= '1.8.0.161' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62327.rb",
        "line": 1
      },
      "id": "V-62327"
    },
    {
      "title": "The Wildfly server must be configured to log all admin activity.",
      "desc": "In order to be able to provide a forensic history of activity, the\napplication server must ensure users who are granted a privileged role or those\nwho utilize a separate distinct account when accessing privileged functions or\ndata have their actions logged.\n\n    If privileged activity is not logged, no forensic logs can be used to\nestablish accountability for privileged actions that occur on the system.",
      "descriptions": {
        "default": "In order to be able to provide a forensic history of activity, the\napplication server must ensure users who are granted a privileged role or those\nwho utilize a separate distinct account when accessing privileged functions or\ndata have their actions logged.\n\n    If privileged activity is not logged, no forensic logs can be used to\nestablish accountability for privileged actions that occur on the system."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000343-AS-000030",
        "gid": "V-62307",
        "rid": "SV-76797r1_rule",
        "stig_id": "JBOS-AS-000480",
        "cci": [
          "CCI-002234"
        ],
        "documentable": false,
        "nist": [
          "AC-6 (9)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script.\nConnect to the server and authenticate.\nRun the command:\n\n/core-service=management/access=audit:read-resource(recursive=true)\n\nUnder the \"logger\" => {audit-log} section of the returned response:\nIf \"enabled\" => false, this is a finding",
        "fix": "Launch the jboss-cli management interface substituting standalone\nor domain for <CONFIG> based upon the server installation.\n\n$JBOSS_HOME;/<CONFIG>/bin/jboss-cli\n\nconnect to the server and run the following command:\n\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)",
        "fix_id": "F-68227r1_fix"
      },
      "code": "control 'V-62307' do\n  title \"The Wildfly server must be configured to log all admin activity.\"\n  desc  \"\n    In order to be able to provide a forensic history of activity, the\napplication server must ensure users who are granted a privileged role or those\nwho utilize a separate distinct account when accessing privileged functions or\ndata have their actions logged.\n\n    If privileged activity is not logged, no forensic logs can be used to\nestablish accountability for privileged actions that occur on the system.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000343-AS-000030'\n  tag \"gid\": 'V-62307'\n  tag \"rid\": 'SV-76797r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000480'\n  tag \"cci\": ['CCI-002234']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-6 (9)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script.\nConnect to the server and authenticate.\nRun the command:\n\n/core-service=management/access=audit:read-resource(recursive=true)\n\nUnder the \\\"logger\\\" => {audit-log} section of the returned response:\nIf \\\"enabled\\\" => false, this is a finding\"\n  tag \"fix\": \"Launch the jboss-cli management interface substituting standalone\nor domain for <CONFIG> based upon the server installation.\n\n$JBOSS_HOME;/<CONFIG>/bin/jboss-cli\n\nconnect to the server and run the following command:\n\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n  tag \"fix_id\": 'F-68227r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly server setting to log all admin activity' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62307.rb",
        "line": 1
      },
      "id": "V-62307"
    },
    {
      "title": "HTTP management session traffic must be encrypted.",
      "desc": "Types of management interfaces utilized by the Wildfly EAP application server\ninclude web-based HTTP interfaces as well as command line-based management\ninterfaces.  In the event remote HTTP management is required, the access must\nbe via HTTPS.\n\n    This requirement is in conjunction with the requirement to isolate all\nmanagement access to a restricted network.",
      "descriptions": {
        "default": "Types of management interfaces utilized by the Wildfly EAP application server\ninclude web-based HTTP interfaces as well as command line-based management\ninterfaces.  In the event remote HTTP management is required, the access must\nbe via HTTPS.\n\n    This requirement is in conjunction with the requirement to isolate all\nmanagement access to a restricted network."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000014-AS-000009",
        "gid": "V-62073",
        "rid": "SV-76563r1_rule",
        "stig_id": "JBOS-AS-000010",
        "cci": [
          "CCI-000068"
        ],
        "documentable": false,
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly. Using the relevant OS commands and syntax, cd to the\n$JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nRun the jboss-cli script. Connect to the server and authenticate.\n\nFor a standalone configuration run the following command:\n\"ls /core-service=management/management-interface=http-interface\"\n\nIf \"secure-socket-binding\"=undefined, this is a finding.\n\nFor a domain configuration run the following command:\n\"ls /host=master/core-service=management/management-interface=http-interface\"\n\nIf \"secure-port\" is undefined, this is a finding.",
        "fix": "Follow the specific instructions in the Red Hat Security Guide\nfor EAP version 6.3 to configure the management console for HTTPS.\n\nThis involves the following steps.\n1. Create a keystore in JKS format.\n2. Ensure the management console binds to HTTPS.\n3. Create a new Security Realm.\n4. Configure Management Interface to use new security realm.\n5. Configure the management console to use the keystore.\n6. Restart the EAP server.",
        "fix_id": "F-67993r1_fix"
      },
      "code": "control 'V-62073' do\n  title \"HTTP management session traffic must be encrypted.\"\n  desc  \"\n    Types of management interfaces utilized by the Wildfly EAP application server\ninclude web-based HTTP interfaces as well as command line-based management\ninterfaces.  In the event remote HTTP management is required, the access must\nbe via HTTPS.\n\n    This requirement is in conjunction with the requirement to isolate all\nmanagement access to a restricted network.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000014-AS-000009'\n  tag \"gid\": 'V-62073'\n  tag \"rid\": 'SV-76563r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000010'\n  tag \"cci\": ['CCI-000068']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-17 (2)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly. Using the relevant OS commands and syntax, cd to the\n$JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nRun the jboss-cli script. Connect to the server and authenticate.\n\nFor a standalone configuration run the following command:\n\\\"ls /core-service=management/management-interface=http-interface\\\"\n\nIf \\\"secure-socket-binding\\\"=undefined, this is a finding.\n\nFor a domain configuration run the following command:\n\\\"ls /host=master/core-service=management/management-interface=http-interface\\\"\n\nIf \\\"secure-port\\\" is undefined, this is a finding.\"\n  tag \"fix\": \"Follow the specific instructions in the Red Hat Security Guide\nfor EAP version 6.3 to configure the management console for HTTPS.\n\nThis involves the following steps.\n1. Create a keystore in JKS format.\n2. Ensure the management console binds to HTTPS.\n3. Create a new Security Realm.\n4. Configure Management Interface to use new security realm.\n5. Configure the management console to use the keystore.\n6. Restart the EAP server.\"\n  tag \"fix_id\": 'F-67993r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly HTTP management session traffic configuration' do\n  subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/management-interface=http-interface\").stdout }\n    it { should_not match /secure-socket-binding=undefined/ }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62073.rb",
        "line": 1
      },
      "id": "V-62073"
    },
    {
      "title": "The Wildfly server, when hosting mission critical applications, must be\n  in a high-availability (HA) cluster.",
      "desc": "A MAC I system is a system that handles data vital to the\n  organization's operational readiness or effectiveness of deployed or\n  contingency forces.  A MAC I system must maintain the highest level of\n  integrity and availability.  By HA clustering the application server, the\n  hosted application and data are given a platform that is load-balanced and\n  provides high availability.",
      "descriptions": {
        "default": "A MAC I system is a system that handles data vital to the\n  organization's operational readiness or effectiveness of deployed or\n  contingency forces.  A MAC I system must maintain the highest level of\n  integrity and availability.  By HA clustering the application server, the\n  hosted application and data are given a platform that is load-balanced and\n  provides high availability."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000435-AS-000069",
        "gid": "V-62319",
        "rid": "SV-76809r1_rule",
        "stig_id": "JBOS-AS-000640",
        "cci": [
          "CCI-002385"
        ],
        "documentable": false,
        "nist": [
          "SC-5",
          "Rev_4"
        ],
        "check": "Interview the system admin and determine if the applications\n  hosted on the application server are mission critical and require load\n  balancing (LB) or high availability (HA).\n\n  If the applications do not require LB or HA, this requirement is NA.\n\n  If the documentation shows the LB or HA services are being provided by another\n  system other than the application server, this requirement is NA.\n\n  If applications require LB or HA, request documentation from the system admin\n  that identifies what type of LB or HA configuration has been implemented on the\n  application server.\n\n  Ask the system admin to identify the components that require protection.  Some\n  options are included here as an example.  Bear in mind the examples provided\n  are not complete and absolute and are only provided as examples.  The\n  components being made redundant or HA by the application server will vary based\n  upon application availability requirements.\n\n  Examples are:\n  Instances of the Application Server\n  Web Applications\n  Stateful, stateless and entity Enterprise Java Beans (EJBs)\n  Single Sign On (SSO) mechanisms\n  Distributed Cache\n  HTTP sessions\n  JMS and Message Services.\n\n  If the hosted application requirements specify LB or HA and the Wildfly server\n  has not been configured to offer HA or LB, this is a finding.",
        "fix": "Configure the application server to provide LB or HA services for\n  the hosted application.",
        "fix_id": "F-68239r1_fix"
      },
      "code": "control 'V-62319' do\n  title \"The Wildfly server, when hosting mission critical applications, must be\n  in a high-availability (HA) cluster.\"\n  desc  \"A MAC I system is a system that handles data vital to the\n  organization's operational readiness or effectiveness of deployed or\n  contingency forces.  A MAC I system must maintain the highest level of\n  integrity and availability.  By HA clustering the application server, the\n  hosted application and data are given a platform that is load-balanced and\n  provides high availability.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000435-AS-000069'\n  tag \"gid\": 'V-62319'\n  tag \"rid\": 'SV-76809r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000640'\n  tag \"cci\": ['CCI-002385']\n  tag \"documentable\": false\n  tag \"nist\": ['SC-5', 'Rev_4']\n  tag \"check\": \"Interview the system admin and determine if the applications\n  hosted on the application server are mission critical and require load\n  balancing (LB) or high availability (HA).\n\n  If the applications do not require LB or HA, this requirement is NA.\n\n  If the documentation shows the LB or HA services are being provided by another\n  system other than the application server, this requirement is NA.\n\n  If applications require LB or HA, request documentation from the system admin\n  that identifies what type of LB or HA configuration has been implemented on the\n  application server.\n\n  Ask the system admin to identify the components that require protection.  Some\n  options are included here as an example.  Bear in mind the examples provided\n  are not complete and absolute and are only provided as examples.  The\n  components being made redundant or HA by the application server will vary based\n  upon application availability requirements.\n\n  Examples are:\n  Instances of the Application Server\n  Web Applications\n  Stateful, stateless and entity Enterprise Java Beans (EJBs)\n  Single Sign On (SSO) mechanisms\n  Distributed Cache\n  HTTP sessions\n  JMS and Message Services.\n\n  If the hosted application requirements specify LB or HA and the Wildfly server\n  has not been configured to offer HA or LB, this is a finding.\"\n  tag \"fix\": \"Configure the application server to provide LB or HA services for\n  the hosted application.\"\n  tag \"fix_id\": 'F-68239r1_fix'\n\n  high_availability = input('high_availability')\n\n  describe 'The wildfly configuration file used' do\n      subject { command ('ps -ef | grep wildfly | grep -v grep | grep -v chef').stdout }\n      it { should match /[\\w\\b\\D\\d\\W]* -c=standalone-full.ha.xml [\\w\\b\\D\\d\\W]*/ }\n\n      before do\n      skip if high_availability == false\n  end\n\n    end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62319.rb",
        "line": 1
      },
      "id": "V-62319"
    },
    {
      "title": "Wildfly must be configured to generate log records when concurrent\n  logons from different workstations occur to the application server management\n  interface.",
      "desc": "Concurrent logons from different systems could possibly indicate a\ncompromised account.  When concurrent logons are made from different\nworkstations to the management interface, a log record needs to be generated.\nThis configuration setting provides forensic evidence that allows the system\nadministrator to investigate access to the system and determine if the\nduplicate access was authorized or not.\n\n    Wildfly provides a multitude of different log formats, and API calls that log\naccess to the system.  If the default format and location is not used, the\nsystem admin must provide the configuration documentation and settings that\nshow that this requirement is being met.",
      "descriptions": {
        "default": "Concurrent logons from different systems could possibly indicate a\ncompromised account.  When concurrent logons are made from different\nworkstations to the management interface, a log record needs to be generated.\nThis configuration setting provides forensic evidence that allows the system\nadministrator to investigate access to the system and determine if the\nduplicate access was authorized or not.\n\n    Wildfly provides a multitude of different log formats, and API calls that log\naccess to the system.  If the default format and location is not used, the\nsystem admin must provide the configuration documentation and settings that\nshow that this requirement is being met."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000506-AS-000231",
        "gid": "V-62339",
        "rid": "SV-76829r1_rule",
        "stig_id": "JBOS-AS-000715",
        "cci": [
          "CCI-000172"
        ],
        "documentable": false,
        "nist": [
          "AU-12 c",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\n  Connect to the server by typing \"connect\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68259r1_fix"
      },
      "code": "control 'V-62339' do\n  title \"Wildfly must be configured to generate log records when concurrent\n  logons from different workstations occur to the application server management\n  interface.\"\n  desc  \"\n    Concurrent logons from different systems could possibly indicate a\n  compromised account.  When concurrent logons are made from different\n  workstations to the management interface, a log record needs to be generated.\n  This configuration setting provides forensic evidence that allows the system\n  administrator to investigate access to the system and determine if the\n  duplicate access was authorized or not.\n\n      Wildfly provides a multitude of different log formats, and API calls that log\n  access to the system.  If the default format and location is not used, the\n  system admin must provide the configuration documentation and settings that\n  show that this requirement is being met.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000506-AS-000231'\n  tag \"gid\": 'V-62339'\n  tag \"rid\": 'SV-76829r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000715'\n  tag \"cci\": ['CCI-000172']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-12 c', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \\\"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\n  Connect to the server by typing \\\"connect\\\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68259r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly server setting: generate log records when concurrent\n  logons from different workstations occur to the application server management interface' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62339.rb",
        "line": 1
      },
      "id": "V-62339"
    },
    {
      "title": "File permissions must be configured to protect log information from\nunauthorized deletion.",
      "desc": "If log data were to become compromised, then competent forensic analysis\nand discovery of the true source of potentially malicious system activity is\ndifficult, if not impossible, to achieve.\n\n    When not configured to use a centralized logging solution like a syslog\nserver, the Wildfly EAP application server writes log data to log files that are\nstored on the OS, appropriate file permissions must be used to restrict\ndeletion.\n\n    Logon formation includes all information (e.g., log records, log settings,\ntransaction logs, and log reports) needed to successfully log information\nsystem activity. Application servers must protect log information from\nunauthorized deletion.",
      "descriptions": {
        "default": "If log data were to become compromised, then competent forensic analysis\nand discovery of the true source of potentially malicious system activity is\ndifficult, if not impossible, to achieve.\n\n    When not configured to use a centralized logging solution like a syslog\nserver, the Wildfly EAP application server writes log data to log files that are\nstored on the OS, appropriate file permissions must be used to restrict\ndeletion.\n\n    Logon formation includes all information (e.g., log records, log settings,\ntransaction logs, and log reports) needed to successfully log information\nsystem activity. Application servers must protect log information from\nunauthorized deletion."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000120-AS-000080",
        "gid": "V-62255",
        "rid": "SV-76745r1_rule",
        "stig_id": "JBOS-AS-000175",
        "cci": [
          "CCI-000164"
        ],
        "documentable": false,
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "check": "Examine the log file locations and inspect the file\npermissions.  Interview the system admin to determine log file locations. The\ndefault location for the log files is:\n\nStandalone configuration:\n$JBOSS_HOME;/standalone/log/\n\nManaged Domain configuration:\n$JBOSS_HOME;/domain/servers/<servername>/log/\n$JBOSS_HOME;/domain/log/\n\nReview the file permissions for the log file directories.  The method used for\nidentifying file permissions will be based upon the OS the EAP server is\ninstalled on.\n\nIdentify all users with file permissions that allow them to delete log files.\n\nRequest documentation from system admin that identifies the users who are\nauthorized to delete log files.\n\nIf unauthorized users are allowed to delete log files, or if documentation that\nidentifies the users who are authorized to delete log files is missing, this is\na finding.",
        "fix": "Configure the OS file permissions on the application server to\nprotect log information from unauthorized deletion.",
        "fix_id": "F-68175r1_fix"
      },
      "code": "control 'V-62255' do\n  title \"File permissions must be configured to protect log information from\nunauthorized deletion.\"\n  desc  \"\n    If log data were to become compromised, then competent forensic analysis\nand discovery of the true source of potentially malicious system activity is\ndifficult, if not impossible, to achieve.\n\n    When not configured to use a centralized logging solution like a syslog\nserver, the Wildfly EAP application server writes log data to log files that are\nstored on the OS, appropriate file permissions must be used to restrict\ndeletion.\n\n    Logon formation includes all information (e.g., log records, log settings,\ntransaction logs, and log reports) needed to successfully log information\nsystem activity. Application servers must protect log information from\nunauthorized deletion.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000120-AS-000080'\n  tag \"gid\": 'V-62255'\n  tag \"rid\": 'SV-76745r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000175'\n  tag \"cci\": ['CCI-000164']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-9', 'Rev_4']\n  tag \"check\": \"Examine the log file locations and inspect the file\npermissions.  Interview the system admin to determine log file locations. The\ndefault location for the log files is:\n\nStandalone configuration:\n$JBOSS_HOME;/standalone/log/\n\nManaged Domain configuration:\n$JBOSS_HOME;/domain/servers/<servername>/log/\n$JBOSS_HOME;/domain/log/\n\nReview the file permissions for the log file directories.  The method used for\nidentifying file permissions will be based upon the OS the EAP server is\ninstalled on.\n\nIdentify all users with file permissions that allow them to delete log files.\n\nRequest documentation from system admin that identifies the users who are\nauthorized to delete log files.\n\nIf unauthorized users are allowed to delete log files, or if documentation that\nidentifies the users who are authorized to delete log files is missing, this is\na finding.\"\n  tag \"fix\": \"Configure the OS file permissions on the application server to\nprotect log information from unauthorized deletion.\"\n  tag \"fix_id\": 'F-68175r1_fix'\n\n  wildfly_group = input('wildfly_group')\n  wildly_owner = input('wildly_owner')\n  describe directory(\"#{ input('jboss_home') }/standalone/log\") do\n    its('owner') { should eq \"#{wildly_owner}\" }\n    its('group') { should eq \"#{wildfly_group}\" }\n     # use proper mode matcher be_more_permissive_than\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62255.rb",
        "line": 1
      },
      "id": "V-62255"
    },
    {
      "title": "Java permissions must be set for hosted applications.",
      "desc": "The Java Security Manager is a java class that manages the external\nboundary of the Java Virtual Machine (JVM) sandbox, controlling how code\nexecuting within the JVM can interact with resources outside the JVM.\n\n  The JVM requires a security policy in order to restrict application access.\n A properly configured security policy will define what rights the application\nhas to the underlying system.  For example, rights to make changes to files on\nthe host system or to initiate network sockets in order to connect to another\nsystem.",
      "descriptions": {
        "default": "The Java Security Manager is a java class that manages the external\nboundary of the Java Virtual Machine (JVM) sandbox, controlling how code\nexecuting within the JVM can interact with resources outside the JVM.\n\n  The JVM requires a security policy in order to restrict application access.\n A properly configured security policy will define what rights the application\nhas to the underlying system.  For example, rights to make changes to files on\nthe host system or to initiate network sockets in order to connect to another\nsystem."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000033-AS-000024",
        "gid": "V-62217",
        "rid": "SV-76707r1_rule",
        "stig_id": "JBOS-AS-000025",
        "cci": [
          "CCI-000213"
        ],
        "documentable": false,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "check": "Obtain documentation from the admin that identifies the\n  applications hosted on the JBoss server as well as the corresponding rights the\n  application requires.  For example, if the application requires network socket\n  permissions and file write permissions, those requirements should be documented.\n\n  1. Identify the Wildfly installation as either domain or standalone and review\n  the relevant configuration file.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  For domain installs: JBOSS_HOME/bin/domain.conf\n  For standalone installs: JBOSS_HOME/bin/standalone.conf\n\n  2. Identify the location and name of the security policy by reading the\n  JAVA_OPTS flag -Djava.security.policy=<file name> where <file name> will\n  indicate name and location of security policy.  If the application uses a\n  policy URL, obtain URL and policy file from system admin.\n\n  3. Review security policy and ensure hosted applications have the appropriate\n  restrictions placed on them as per documented application functionality\n  requirements.\n\n  If the security policy does not restrict application access to host resources\n  as per documented requirements, this is a finding.",
        "fix": "Configure the Java security manager to enforce access\n  restrictions to the host system resources in accordance with application design\n  and resource requirements.",
        "fix_id": "F-68137r1_fix"
      },
      "code": "control 'V-62217' do\n  title \"Java permissions must be set for hosted applications.\"\n  desc  \"\n    The Java Security Manager is a java class that manages the external\n  boundary of the Java Virtual Machine (JVM) sandbox, controlling how code\n  executing within the JVM can interact with resources outside the JVM.\n\n    The JVM requires a security policy in order to restrict application access.\n   A properly configured security policy will define what rights the application\n  has to the underlying system.  For example, rights to make changes to files on\n  the host system or to initiate network sockets in order to connect to another\n  system.\n  \"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000033-AS-000024'\n  tag \"gid\": 'V-62217'\n  tag \"rid\": 'SV-76707r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000025'\n  tag \"cci\": ['CCI-000213']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"check\": \"Obtain documentation from the admin that identifies the\n  applications hosted on the JBoss server as well as the corresponding rights the\n  application requires.  For example, if the application requires network socket\n  permissions and file write permissions, those requirements should be documented.\n\n  1. Identify the Wildfly installation as either domain or standalone and review\n  the relevant configuration file.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  For domain installs: JBOSS_HOME/bin/domain.conf\n  For standalone installs: JBOSS_HOME/bin/standalone.conf\n\n  2. Identify the location and name of the security policy by reading the\n  JAVA_OPTS flag -Djava.security.policy=<file name> where <file name> will\n  indicate name and location of security policy.  If the application uses a\n  policy URL, obtain URL and policy file from system admin.\n\n  3. Review security policy and ensure hosted applications have the appropriate\n  restrictions placed on them as per documented application functionality\n  requirements.\n\n  If the security policy does not restrict application access to host resources\n  as per documented requirements, this is a finding.\"\n  tag \"fix\": \"Configure the Java security manager to enforce access\n  restrictions to the host system resources in accordance with application design\n  and resource requirements.\"\n  tag \"fix_id\": 'F-68137r1_fix'\n  describe.one do\n    describe file(\"#{ input('jboss_home') }/bin/standalone.conf\") do\n      its('content') { should match(%r{JAVA_OPTS=\"\\$JAVA_OPTS -Djavax.security.policy=\\/usr\\/lib\\/jvm\\/java\\-1.8.0\\/jre\\/lib\\/security\\/java.policy\"}) }\n    end\n    describe file(\"#{ input('jboss_home') }/bin/standalone.conf\") do\n      its('content') { should match(%r{JAVA_OPTS=\"\\$JAVA_OPTS -Djava.security.manager -Djava.security.policy==%JBOSS_HOME\\\\lib\\\\security\\\\java.policy.policy -Djboss.home.dir=%JBOSS_HOME% -Djboss.modules.policy-permissions=true\"}) }\n    end\n    describe parse_config_file(\"#{ input('jboss_home') }/bin/standalone.conf\") do\n      its('SECMGR') { should match(%r{\"true\"}) }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62217.rb",
        "line": 1
      },
      "id": "V-62217"
    },
    {
      "title": "Wildfly management interfaces must be secured.",
      "desc": "Wildfly utilizes the concept of security realms to secure the management\ninterfaces used for Wildfly server administration.  If the security realm\nattribute is omitted or removed from the management interface definition,\naccess to that interface is no longer secure.  The Wildfly management interfaces\nmust be secured.",
      "descriptions": {
        "default": "Wildfly utilizes the concept of security realms to secure the management\ninterfaces used for Wildfly server administration.  If the security realm\nattribute is omitted or removed from the management interface definition,\naccess to that interface is no longer secure.  The Wildfly management interfaces\nmust be secured."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000033-AS-000024",
        "gid": "V-62229",
        "rid": "SV-76719r1_rule",
        "stig_id": "JBOS-AS-000075",
        "cci": [
          "CCI-000213"
        ],
        "documentable": false,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nIdentify the management interfaces.  To identity the management interfaces, run\nthe following command:\n\nFor standalone servers:\n\"ls /core-service=management/management-interface=\"\n\nFor managed domain installations:\n\"ls /host=HOST_NAME/core-service=management/management-interface=\"\n\nBy default, Wildfly provides two management interfaces; they are named\n\"NATIVE-INTERFACE\" and \"HTTP-INTERFACE\".  The system may or may not have\nboth interfaces enabled.  For each management interface listed as a result of\nthe previous command, append the name of the management interface to the end of\nthe following command.\n\nFor a standalone system:\n\n\"ls /core-service=management/management-interface=<MANAGEMENT INTERFACE NAME>\"\n\nFor a managed domain:\n\n\"ls /host=HOST_NAME/core-service=management/management-interface=<MANAGEMENT\nINTERFACE NAME>\"\n\nIf the \"security-realm=\" attribute is not associated with a management realm,\nthis is a finding.",
        "fix": "Identify the security realm used for management of the system.\nBy default, this is called \"Management Realm\".\n\nIf a management security realm is not already available, reference the Wildfly\nsystem administration guide for instructions on how to create a\nsecurity realm for management purposes.  Create the management realm, and\nassign authentication and authorization access restrictions to the management\nrealm.\n\nAssign the management interfaces to the management realm.",
        "fix_id": "F-68149r1_fix"
      },
      "code": "control 'V-62229' do\n  title \"Wildfly management interfaces must be secured.\"\n  desc  \"Wildfly utilizes the concept of security realms to secure the management\ninterfaces used for Wildfly server administration.  If the security realm\nattribute is omitted or removed from the management interface definition,\naccess to that interface is no longer secure.  The Wildfly management interfaces\nmust be secured.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000033-AS-000024'\n  tag \"gid\": 'V-62229'\n  tag \"rid\": 'SV-76719r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000075'\n  tag \"cci\": ['CCI-000213']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nIdentify the management interfaces.  To identity the management interfaces, run\nthe following command:\n\nFor standalone servers:\n\\\"ls /core-service=management/management-interface=\\\"\n\nFor managed domain installations:\n\\\"ls /host=HOST_NAME/core-service=management/management-interface=\\\"\n\nBy default, Wildfly provides two management interfaces; they are named\n\\\"NATIVE-INTERFACE\\\" and \\\"HTTP-INTERFACE\\\".  The system may or may not have\nboth interfaces enabled.  For each management interface listed as a result of\nthe previous command, append the name of the management interface to the end of\nthe following command.\n\nFor a standalone system:\n\n\\\"ls /core-service=management/management-interface=<MANAGEMENT INTERFACE NAME>\\\"\n\nFor a managed domain:\n\n\\\"ls /host=HOST_NAME/core-service=management/management-interface=<MANAGEMENT\nINTERFACE NAME>\\\"\n\nIf the \\\"security-realm=\\\" attribute is not associated with a management realm,\nthis is a finding.\"\n  tag \"fix\": \"Identify the security realm used for management of the system.\nBy default, this is called \\\"Management Realm\\\".\n\nIf a management security realm is not already available, reference the Wildfly\nsystem administration guide for instructions on how to create a\nsecurity realm for management purposes.  Create the management realm, and\nassign authentication and authorization access restrictions to the management\nrealm.\n\nAssign the management interfaces to the management realm.\"\n  tag \"fix_id\": 'F-68149r1_fix'\n\n  connect = input('connection')\n\n  mgmt_interfaces = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\ /core-service=management/management-interface=\").stdout.split(\"\\n\")\n\n  mgmt_interfaces.each do |interface|\n    describe \"Wildfly management interface: #{interface}\" do\n      subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/management-interface=#{interface}\").stdout }\n      it { should match(%r{security-realm=ManagementRealm}) }\n    end\n  end\n  if mgmt_interfaces.empty?\n    impact 0.0\n    describe 'There are no wildfly management interfaces, therefore this control is Not Applicable' do\n      skip 'There are no wildfly management interfaces, therefore this control is Not Applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62229.rb",
        "line": 1
      },
      "id": "V-62229"
    },
    {
      "title": "Wildfly must be configured to generate log records for privileged\n  activities.",
      "desc": "Without generating log records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Privileged activities would occur through the management interface.  This\ninterface can be web-based or can be command line utilities.  Whichever method\nis utilized by the application server, these activities must be logged.",
      "descriptions": {
        "default": "Without generating log records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Privileged activities would occur through the management interface.  This\ninterface can be web-based or can be command line utilities.  Whichever method\nis utilized by the application server, these activities must be logged."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000504-AS-000229",
        "gid": "V-62335",
        "rid": "SV-76825r1_rule",
        "stig_id": "JBOS-AS-000705",
        "cci": [
          "CCI-000172"
        ],
        "documentable": false,
        "nist": [
          "AU-12 c",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\n  Connect to the server by typing \"connect\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68255r1_fix"
      },
      "code": "control 'V-62335' do\n  title \"Wildfly must be configured to generate log records for privileged\n  activities.\"\n  desc  \"\n    Without generating log records that are specific to the security and\n  mission needs of the organization, it would be difficult to establish,\n  correlate, and investigate the events relating to an incident or identify those\n  responsible for one.\n\n      Privileged activities would occur through the management interface.  This\n  interface can be web-based or can be command line utilities.  Whichever method\n  is utilized by the application server, these activities must be logged.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000504-AS-000229'\n  tag \"gid\": 'V-62335'\n  tag \"rid\": 'SV-76825r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000705'\n  tag \"cci\": ['CCI-000172']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-12 c', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \\\"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\n  Connect to the server by typing \\\"connect\\\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68255r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly server setting: generate log records for privileged activities' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62335.rb",
        "line": 1
      },
      "id": "V-62335"
    },
    {
      "title": "Wildfly must be configured to initiate session logging upon startup.",
      "desc": "Session logging activities are developed, integrated, and used in\nconsultation with legal counsel in accordance with applicable federal laws,\nExecutive Orders, directives, policies, or regulations.",
      "descriptions": {
        "default": "Session logging activities are developed, integrated, and used in\nconsultation with legal counsel in accordance with applicable federal laws,\nExecutive Orders, directives, policies, or regulations."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000092-AS-000053",
        "gid": "V-62235",
        "rid": "SV-76725r1_rule",
        "stig_id": "JBOS-AS-000095",
        "cci": [
          "CCI-001464"
        ],
        "documentable": false,
        "nist": [
          "AU-14 (1)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nIf \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\nConnect to the server by typing \"connect\", authenticate as a user in the\nSuperuser role and run the following command:\n\nFor a Managed Domain configuration:\n\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68155r1_fix"
      },
      "code": "control 'V-62235' do\n  title \"Wildfly must be configured to initiate session logging upon startup.\"\n  desc  \"Session logging activities are developed, integrated, and used in\nconsultation with legal counsel in accordance with applicable federal laws,\nExecutive Orders, directives, policies, or regulations.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000092-AS-000053'\n  tag \"gid\": 'V-62235'\n  tag \"rid\": 'SV-76725r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000095'\n  tag \"cci\": ['CCI-001464']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-14 (1)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\\\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nIf \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\nConnect to the server by typing \\\"connect\\\", authenticate as a user in the\nSuperuser role and run the following command:\n\nFor a Managed Domain configuration:\n\\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68155r1_fix'\n\n  connect = input('connection')\n\n  describe 'Wildfly initiate session logging upon startup' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62235.rb",
        "line": 1
      },
      "id": "V-62235"
    },
    {
      "title": "Wildfly must be configured to generate log records when\n  successful/unsuccessful attempts to delete privileges occur.",
      "desc": "Deleting privileges of a subject/object may cause a subject/object to\n  gain or lose capabilities.  When successful and unsuccessful privilege\n  deletions are made, the events need to be logged.  By logging the event, the\n  modification or attempted modification can be investigated to determine if it\n  was performed inadvertently or maliciously.",
      "descriptions": {
        "default": "Deleting privileges of a subject/object may cause a subject/object to\n  gain or lose capabilities.  When successful and unsuccessful privilege\n  deletions are made, the events need to be logged.  By logging the event, the\n  modification or attempted modification can be investigated to determine if it\n  was performed inadvertently or maliciously."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000499-AS-000224",
        "gid": "V-62331",
        "rid": "SV-76821r1_rule",
        "stig_id": "JBOS-AS-000695",
        "cci": [
          "CCI-000172"
        ],
        "documentable": false,
        "nist": [
          "AU-12 c",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\n  Connect to the server by typing \"connect\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68251r1_fix"
      },
      "code": "control 'V-62331' do\n  title \"Wildfly must be configured to generate log records when\n  successful/unsuccessful attempts to delete privileges occur.\"\n  desc  \"Deleting privileges of a subject/object may cause a subject/object to\n  gain or lose capabilities.  When successful and unsuccessful privilege\n  deletions are made, the events need to be logged.  By logging the event, the\n  modification or attempted modification can be investigated to determine if it\n  was performed inadvertently or maliciously.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000499-AS-000224'\n  tag \"gid\": 'V-62331'\n  tag \"rid\": 'SV-76821r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000695'\n  tag \"cci\": ['CCI-000172']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-12 c', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \\\"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\n  Connect to the server by typing \\\"connect\\\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68251r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly setting: generate log records when successful/unsuccessful attempts to delete privileges occur' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62331.rb",
        "line": 1
      },
      "id": "V-62331"
    },
    {
      "title": "Wildfly file permissions must be configured to protect the\n  confidentiality and integrity of application files.",
      "desc": "The Wildfly EAP Application Server is a Java-based AS.  It is installed on\nthe OS file system and depends upon file system access controls to protect\napplication data at rest.  The file permissions set on the Wildfly EAP home\nfolder must be configured so as to limit access to only authorized people and\nprocesses.  The account used for operating the Wildfly server and any designated\nadministrative or operational accounts are the only accounts that should have\naccess.\n\n    When data is written to digital media such as hard drives, mobile\ncomputers, external/removable hard drives, personal digital assistants,\nflash/thumb drives, etc., there is risk of data loss and data compromise.\nSteps must be taken to ensure data stored on the device is protected.",
      "descriptions": {
        "default": "The Wildfly EAP Application Server is a Java-based AS.  It is installed on\nthe OS file system and depends upon file system access controls to protect\napplication data at rest.  The file permissions set on the Wildfly EAP home\nfolder must be configured so as to limit access to only authorized people and\nprocesses.  The account used for operating the Wildfly server and any designated\nadministrative or operational accounts are the only accounts that should have\naccess.\n\n    When data is written to digital media such as hard drives, mobile\ncomputers, external/removable hard drives, personal digital assistants,\nflash/thumb drives, etc., there is risk of data loss and data compromise.\nSteps must be taken to ensure data stored on the device is protected."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000231-AS-000133",
        "gid": "V-62299",
        "rid": "SV-76789r1_rule",
        "stig_id": "JBOS-AS-000400",
        "cci": [
          "CCI-001199"
        ],
        "documentable": false,
        "nist": [
          "SC-28",
          "Rev_4"
        ],
        "check": "By default, Wildfly installs its files into a folder called\n  \"wildfly\".   This folder by default is stored within the home folder of\n  the Wildfly user account.  The installation process, however, allows for the\n  override of default values to obtain folder and user account information from\n  the system admin.\n\n  Log on with a user account with Wildfly access and permissions.\n\n  Navigate to the \"Wildfly\" folder using the relevant OS commands for\n  either a UNIX-like OS or a Windows OS.\n\n  Examine the permissions of the Wildfly folder.\n\n  Owner can be full access.\n  Group can be full access.\n  All others must be restricted to execute access or no permission.\n\n  If the Wildfly folder is world readable or world writable, this is a finding.",
        "fix": "Configure file permissions on the Wildfly folder to protect from\n  unauthorized access.",
        "fix_id": "F-68219r1_fix"
      },
      "code": "control 'V-62299' do\n  title \"Wildfly file permissions must be configured to protect the\n  confidentiality and integrity of application files.\"\n  desc  \"\n    The Wildfly EAP Application Server is a Java-based AS.  It is installed on\n  the OS file system and depends upon file system access controls to protect\n  application data at rest.  The file permissions set on the Wildfly EAP home\n  folder must be configured so as to limit access to only authorized people and\n  processes.  The account used for operating the Wildfly server and any designated\n  administrative or operational accounts are the only accounts that should have\n  access.\n\n      When data is written to digital media such as hard drives, mobile\n  computers, external/removable hard drives, personal digital assistants,\n  flash/thumb drives, etc., there is risk of data loss and data compromise.\n  Steps must be taken to ensure data stored on the device is protected.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000231-AS-000133'\n  tag \"gid\": 'V-62299'\n  tag \"rid\": 'SV-76789r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000400'\n  tag \"cci\": ['CCI-001199']\n  tag \"documentable\": false\n  tag \"nist\": ['SC-28', 'Rev_4']\n  tag \"check\": \"By default, Wildfly installs its files into a folder called\n  \\\"wildfly\\\".   This folder by default is stored within the home folder of\n  the Wildfly user account.  The installation process, however, allows for the\n  override of default values to obtain folder and user account information from\n  the system admin.\n\n  Log on with a user account with Wildfly access and permissions.\n\n  Navigate to the \\\"Wildfly\\\" folder using the relevant OS commands for\n  either a UNIX-like OS or a Windows OS.\n\n  Examine the permissions of the Wildfly folder.\n\n  Owner can be full access.\n  Group can be full access.\n  All others must be restricted to execute access or no permission.\n\n  If the Wildfly folder is world readable or world writable, this is a finding.\"\n  tag \"fix\": \"Configure file permissions on the Wildfly folder to protect from\n  unauthorized access.\"\n  tag \"fix_id\": 'F-68219r1_fix'\n  describe directory(\"#{ input('jboss_home') }/\") do\n    it { should_not be_readable.by('others') }\n  end\n  describe directory(\"#{ input('jboss_home') }/\") do\n    it { should_not be_writable.by('others') }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62299.rb",
        "line": 1
      },
      "id": "V-62299"
    },
    {
      "title": "Wildfly must be configured to produce log records containing information\nto establish what type of events occurred.",
      "desc": "Information system logging capability is critical for accurate forensic\nanalysis.  Without being able to establish what type of event occurred, it\nwould be difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible.\n\n    Log record content that may be necessary to satisfy the requirement of this\ncontrol includes time stamps, source and destination addresses, user/process\nidentifiers, event descriptions, success/fail indications, filenames involved,\nand access control or flow control rules invoked.\n\n    Application servers must log all relevant log data that pertains to the\napplication server.  Examples of relevant data include, but are not limited to,\nJava Virtual Machine (JVM) activity, HTTPD/Web server activity, and application\nserver-related system process activity.",
      "descriptions": {
        "default": "Information system logging capability is critical for accurate forensic\nanalysis.  Without being able to establish what type of event occurred, it\nwould be difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible.\n\n    Log record content that may be necessary to satisfy the requirement of this\ncontrol includes time stamps, source and destination addresses, user/process\nidentifiers, event descriptions, success/fail indications, filenames involved,\nand access control or flow control rules invoked.\n\n    Application servers must log all relevant log data that pertains to the\napplication server.  Examples of relevant data include, but are not limited to,\nJava Virtual Machine (JVM) activity, HTTPD/Web server activity, and application\nserver-related system process activity."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000095-AS-000056",
        "gid": "V-62239",
        "rid": "SV-76729r1_rule",
        "stig_id": "JBOS-AS-000110",
        "cci": [
          "CCI-000130"
        ],
        "documentable": false,
        "nist": [
          "AU-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nIf \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\nConnect to the server by typing \"connect\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68159r1_fix"
      },
      "code": "control 'V-62239' do\n  title \"Wildfly must be configured to produce log records containing information\nto establish what type of events occurred.\"\n  desc  \"\n    Information system logging capability is critical for accurate forensic\nanalysis.  Without being able to establish what type of event occurred, it\nwould be difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible.\n\n    Log record content that may be necessary to satisfy the requirement of this\ncontrol includes time stamps, source and destination addresses, user/process\nidentifiers, event descriptions, success/fail indications, filenames involved,\nand access control or flow control rules invoked.\n\n    Application servers must log all relevant log data that pertains to the\napplication server.  Examples of relevant data include, but are not limited to,\nJava Virtual Machine (JVM) activity, HTTPD/Web server activity, and application\nserver-related system process activity.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000095-AS-000056'\n  tag \"gid\": 'V-62239'\n  tag \"rid\": 'SV-76729r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000110'\n  tag \"cci\": ['CCI-000130']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\\\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nIf \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\nConnect to the server by typing \\\"connect\\\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68159r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly server setting: produce log records containing information to establish what type of events occurred' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62239.rb",
        "line": 1
      },
      "id": "V-62239"
    },
    {
      "title": "Silent Authentication must be removed from the Default Management\nSecurity Realm.",
      "desc": "Silent Authentication is a configuration setting that allows local OS\nusers access to the Wildfly server and a wide range of operations without\nspecifically authenticating on an individual user basis.  By default $localuser\nis a Superuser. This introduces an integrity and availability vulnerability and\nviolates best practice requirements regarding accountability.",
      "descriptions": {
        "default": "Silent Authentication is a configuration setting that allows local OS\nusers access to the Wildfly server and a wide range of operations without\nspecifically authenticating on an individual user basis.  By default $localuser\nis a Superuser. This introduces an integrity and availability vulnerability and\nviolates best practice requirements regarding accountability."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000033-AS-000024",
        "gid": "V-62223",
        "rid": "SV-76713r1_rule",
        "stig_id": "JBOS-AS-000050",
        "cci": [
          "CCI-000213"
        ],
        "documentable": false,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nVerify that Silent Authentication has been removed from the default Management\nsecurity realm.\nRun the following command.\n\nFor standalone servers run the following command:\n\"ls /core-service=management/securityrealm=ManagementRealm/authentication\"\n\nFor managed domain installations run the following command:\n\"ls\n/host=HOST_NAME/core-service=management/securityrealm=ManagementRealm/authentication\"\n\nIf \"local\" is returned, this is a finding.",
        "fix": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nRemove the local element from the Management Realm.\nFor standalone servers run the following command:\n/core-service=management/securityrealm=\nManagementRealm/authentication=local:remove\n\nFor managed domain installations run the following command:\n/host=HOST_NAME/core-service=management/securityrealm=\nManagementRealm/authentication=local:remove",
        "fix_id": "F-68143r1_fix"
      },
      "code": "control 'V-62223' do\n  title \"Silent Authentication must be removed from the Default Management\nSecurity Realm.\"\n  desc  \"Silent Authentication is a configuration setting that allows local OS\nusers access to the Wildfly server and a wide range of operations without\nspecifically authenticating on an individual user basis.  By default $localuser\nis a Superuser. This introduces an integrity and availability vulnerability and\nviolates best practice requirements regarding accountability.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000033-AS-000024'\n  tag \"gid\": 'V-62223'\n  tag \"rid\": 'SV-76713r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000050'\n  tag \"cci\": ['CCI-000213']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nVerify that Silent Authentication has been removed from the default Management\nsecurity realm.\nRun the following command.\n\nFor standalone servers run the following command:\n\\\"ls /core-service=management/securityrealm=ManagementRealm/authentication\\\"\n\nFor managed domain installations run the following command:\n\\\"ls\n/host=HOST_NAME/core-service=management/securityrealm=ManagementRealm/authentication\\\"\n\nIf \\\"local\\\" is returned, this is a finding.\"\n  tag \"fix\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nRemove the local element from the Management Realm.\nFor standalone servers run the following command:\n/core-service=management/securityrealm=\nManagementRealm/authentication=local:remove\n\nFor managed domain installations run the following command:\n/host=HOST_NAME/core-service=management/securityrealm=\nManagementRealm/authentication=local:remove\"\n  tag \"fix_id\": 'F-68143r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly default management security realm silent authentication' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/security-realm=ManagementRealm/authentication\").stdout }\n    it { should_not match(%r{local}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62223.rb",
        "line": 1
      },
      "id": "V-62223"
    },
    {
      "title": "Wildfly must be configured to log the IP address of the remote system\n  connecting to the Wildfly system/cluster.",
      "desc": "Information system logging capability is critical for accurate forensic\nanalysis.  Without being able to establish what type of event occurred, it\nwould be difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible.\n\n    Log record content that may be necessary to satisfy the requirement of this\ncontrol includes time stamps, source and destination addresses, user/process\nidentifiers, event descriptions, success/fail indications, filenames involved,\nand access control or flow control rules invoked.\n\n    Application servers must log all relevant log data that pertains to the\napplication server.  Examples of relevant data include, but are not limited to,\nJava Virtual Machine (JVM) activity, HTTPD/Web server activity, and application\nserver-related system process activity.",
      "descriptions": {
        "default": "Information system logging capability is critical for accurate forensic\nanalysis.  Without being able to establish what type of event occurred, it\nwould be difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible.\n\n    Log record content that may be necessary to satisfy the requirement of this\ncontrol includes time stamps, source and destination addresses, user/process\nidentifiers, event descriptions, success/fail indications, filenames involved,\nand access control or flow control rules invoked.\n\n    Application servers must log all relevant log data that pertains to the\napplication server.  Examples of relevant data include, but are not limited to,\nJava Virtual Machine (JVM) activity, HTTPD/Web server activity, and application\nserver-related system process activity."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000095-AS-000056",
        "gid": "V-62237",
        "rid": "SV-76727r1_rule",
        "stig_id": "JBOS-AS-000105",
        "cci": [
          "CCI-000130"
        ],
        "documentable": false,
        "nist": [
          "AU-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildlfy server with OS permissions that\n  allow access to Wildlfy.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\nConnect to the server by typing \"connect\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68157r1_fix"
      },
      "code": "control 'V-62237' do\n  title \"Wildfly must be configured to log the IP address of the remote system\n  connecting to the Wildfly system/cluster.\"\n  desc  \"\n    Information system logging capability is critical for accurate forensic\n  analysis.  Without being able to establish what type of event occurred, it\n  would be difficult to establish, correlate, and investigate the events relating\n  to an incident or identify those responsible.\n\n      Log record content that may be necessary to satisfy the requirement of this\n  control includes time stamps, source and destination addresses, user/process\n  identifiers, event descriptions, success/fail indications, filenames involved,\n  and access control or flow control rules invoked.\n\n      Application servers must log all relevant log data that pertains to the\n  application server.  Examples of relevant data include, but are not limited to,\n  Java Virtual Machine (JVM) activity, HTTPD/Web server activity, and application\n  server-related system process activity.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000095-AS-000056'\n  tag \"gid\": 'V-62237'\n  tag \"rid\": 'SV-76727r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000105'\n  tag \"cci\": ['CCI-000130']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildlfy server with OS permissions that\n  allow access to Wildlfy.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \\\"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\nConnect to the server by typing \\\"connect\\\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68157r1_fix'\n\n  connect = input('connection')\n\n  describe 'Wildfly log the IP address of the remote system connecting to the Wildfly system/cluster' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62237.rb",
        "line": 1
      },
      "id": "V-62237"
    },
    {
      "title": "Wildfly application and management ports must be approved by the PPSM\nCAL.",
      "desc": "Some networking protocols may not meet organizational security requirements\nto protect data and components.\n\n    Application servers natively host a number of various features, such as\nmanagement interfaces, httpd servers and message queues. These features all run\non TCPIP ports. This creates the potential that the vendor may choose to\nutilize port numbers or network services that have been deemed unusable by the\norganization. The application server must have the capability to both\nreconfigure and disable the assigned ports without adversely impacting\napplication server operation capabilities. For a list of approved ports and\nprotocols, reference the DoD ports and protocols website at\nhttps://powhatan.iiie.disa.mil/ports/cal.html.",
      "descriptions": {
        "default": "Some networking protocols may not meet organizational security requirements\nto protect data and components.\n\n    Application servers natively host a number of various features, such as\nmanagement interfaces, httpd servers and message queues. These features all run\non TCPIP ports. This creates the potential that the vendor may choose to\nutilize port numbers or network services that have been deemed unusable by the\norganization. The application server must have the capability to both\nreconfigure and disable the assigned ports without adversely impacting\napplication server operation capabilities. For a list of approved ports and\nprotocols, reference the DoD ports and protocols website at\nhttps://powhatan.iiie.disa.mil/ports/cal.html."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000142-AS-000014",
        "gid": "V-62275",
        "rid": "SV-76765r1_rule",
        "stig_id": "JBOS-AS-000255",
        "cci": [
          "CCI-000382"
        ],
        "documentable": false,
        "nist": [
          "CM-7 b",
          "Rev_4"
        ],
        "check": "Open the EAP web console by pointing a web browser to\nHTTPS://<Servername>:9443 or HTTP://<Servername>:9990\n\nLog on to the admin console using admin credentials\nSelect the \"Configuration\" tab\nExpand the \"General Configuration\" sub system by clicking on the +\nSelect \"Socket Binding\"\nSelect the \"View\" option next to \"standard-sockets\"\nSelect \"Inbound\"\n\nReview the configured ports and determine if they are all approved by the PPSM\nCAL.\n\nIf all the ports are not approved by the PPSM CAL, this is a finding.",
        "fix": "Open the EAP web console by pointing a web browser to\nHTTPS://<Servername>:9990\n\nLog on to the admin console using admin credentials\nSelect the \"Configuration\" tab\nExpand the \"General Configuration\" sub system by clicking on the +\nSelect \"Socket Binding\"\nSelect the \"View\" option next to \"standard-sockets\"\nSelect \"Inbound\"\n\nSelect the port that needs to be reconfigured and select \"Edit\".",
        "fix_id": "F-68195r1_fix"
      },
      "code": "control 'V-62275' do\n  title \"Wildfly application and management ports must be approved by the PPSM\nCAL.\"\n  desc  \"\n    Some networking protocols may not meet organizational security requirements\nto protect data and components.\n\n    Application servers natively host a number of various features, such as\nmanagement interfaces, httpd servers and message queues. These features all run\non TCPIP ports. This creates the potential that the vendor may choose to\nutilize port numbers or network services that have been deemed unusable by the\norganization. The application server must have the capability to both\nreconfigure and disable the assigned ports without adversely impacting\napplication server operation capabilities. For a list of approved ports and\nprotocols, reference the DoD ports and protocols website at\nhttps://powhatan.iiie.disa.mil/ports/cal.html.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000142-AS-000014'\n  tag \"gid\": 'V-62275'\n  tag \"rid\": 'SV-76765r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000255'\n  tag \"cci\": ['CCI-000382']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-7 b', 'Rev_4']\n  tag \"check\": \"Open the EAP web console by pointing a web browser to\nHTTPS://<Servername>:9443 or HTTP://<Servername>:9990\n\nLog on to the admin console using admin credentials\nSelect the \\\"Configuration\\\" tab\nExpand the \\\"General Configuration\\\" sub system by clicking on the +\nSelect \\\"Socket Binding\\\"\nSelect the \\\"View\\\" option next to \\\"standard-sockets\\\"\nSelect \\\"Inbound\\\"\n\nReview the configured ports and determine if they are all approved by the PPSM\nCAL.\n\nIf all the ports are not approved by the PPSM CAL, this is a finding.\"\n  tag \"fix\": \"Open the EAP web console by pointing a web browser to\nHTTPS://<Servername>:9990\n\nLog on to the admin console using admin credentials\nSelect the \\\"Configuration\\\" tab\nExpand the \\\"General Configuration\\\" sub system by clicking on the +\nSelect \\\"Socket Binding\\\"\nSelect the \\\"View\\\" option next to \\\"standard-sockets\\\"\nSelect \\\"Inbound\\\"\n\nSelect the port that needs to be reconfigured and select \\\"Edit\\\".\"\n  tag \"fix_id\": 'F-68195r1_fix'\n\n  wildfly_ports = input('wildfly_ports')\n\n  wildfly_ports.each do |port|\n    describe file(\"#{ input('jboss_home') }/standalone/configuration/standalone.xml\") do\n      its('content') { should include port }\n    end\n    describe file(\"#{ input('jboss_home') }/standalone/configuration/standalone.xml\") do\n      it { should exist}\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62275.rb",
        "line": 1
      },
      "id": "V-62275"
    },
    {
      "title": "The Wildfly server must be configured to bind the management interfaces\n  to only management networks.",
      "desc": "Wildfly provides multiple interfaces for accessing the system.  By\n  default, these are called \"public\" and \"management\".  Allowing\n  non-management traffic to access the Wildfly management interface increases the\n  chances of a security compromise.  The Wildfly server must be configured to bind\n  the management interface to a network that controls access.  This is usually a\n  network that has been designated as a management network and has restricted\n  access.  Similarly, the public interface must be bound to a network that is not\n  on the same segment as the management interface.",
      "descriptions": {
        "default": "Wildfly provides multiple interfaces for accessing the system.  By\n  default, these are called \"public\" and \"management\".  Allowing\n  non-management traffic to access the Wildfly management interface increases the\n  chances of a security compromise.  The Wildfly server must be configured to bind\n  the management interface to a network that controls access.  This is usually a\n  network that has been designated as a management network and has restricted\n  access.  Similarly, the public interface must be bound to a network that is not\n  on the same segment as the management interface."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000158-AS-000108",
        "gid": "V-62283",
        "rid": "SV-76773r1_rule",
        "stig_id": "JBOS-AS-000285",
        "cci": [
          "CCI-000778"
        ],
        "documentable": false,
        "nist": [
          "IA-3",
          "Rev_4"
        ],
        "check": "Obtain documentation and network drawings from system admin\n  that shows the network interfaces on the Wildfly server and the networks they are\n  configured for.\n\n  If a management network is not used, you may substitute localhost/127.0.0.1 for\n  management address.  If localhost/127.0.0.1 is used for management interface,\n  this is not a finding.\n\n  From the Wildfly server open the web-based admin console by pointing a browser to\n  HTTP://127.0.0.1:9990.\n  Log on to the management console with admin credentials.\n  Select \"RUNTIME\".\n  Expand STATUS by clicking on +.\n  Expand PLATFORM by clicking on +.\n  In the \"Environment\" tab, click the > arrow until you see the\n  \"jboss.bind.properties\" and the \"jboss.bind.properties.management\" values.\n\n  If the jboss.bind.properties and the jboss.bind.properties.management do not\n  have different IP network addresses assigned, this is a finding.\n\n  Review the network documentation.  If access to the management IP address is\n  not restricted, this is a finding.",
        "fix": "Refer to the Wildfly EAP Installation guide for\n  detailed instructions on how to start JBoss as a service.\n\n  Use the following command line parameters to assign the management interface to\n  a specific management network.\n\n  These command line flags must be added both when starting JBoss as a service\n  and when starting from the command line.\n\n  Substitute your actual network address for the 10.x.x.x addresses provided as\n  an example below.\n\n  For a standalone configuration:\n  JBOSS_HOME/bin/standalone.sh -bmanagement=10.2.2.1 -b 10.1.1.1\n\n  JBOSS_HOME/bin/domain.sh -bmanagement=10.2.2.1 -b 10.1.1.1\n\n  If a management network is not available, you may substitute\n  localhost/127.0.0.1 for management address.  This will force you to manage the\n  Wildfly server from the local host.",
        "fix_id": "F-68203r1_fix"
      },
      "code": "control 'V-62283' do\n  title \"The Wildfly server must be configured to bind the management interfaces\n  to only management networks.\"\n  desc  \"Wildfly provides multiple interfaces for accessing the system.  By\n  default, these are called \\\"public\\\" and \\\"management\\\".  Allowing\n  non-management traffic to access the Wildfly management interface increases the\n  chances of a security compromise.  The Wildfly server must be configured to bind\n  the management interface to a network that controls access.  This is usually a\n  network that has been designated as a management network and has restricted\n  access.  Similarly, the public interface must be bound to a network that is not\n  on the same segment as the management interface.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000158-AS-000108'\n  tag \"gid\": 'V-62283'\n  tag \"rid\": 'SV-76773r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000285'\n  tag \"cci\": ['CCI-000778']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-3', 'Rev_4']\n  tag \"check\": \"Obtain documentation and network drawings from system admin\n  that shows the network interfaces on the Wildfly server and the networks they are\n  configured for.\n\n  If a management network is not used, you may substitute localhost/127.0.0.1 for\n  management address.  If localhost/127.0.0.1 is used for management interface,\n  this is not a finding.\n\n  From the Wildfly server open the web-based admin console by pointing a browser to\n  HTTP://127.0.0.1:9990.\n  Log on to the management console with admin credentials.\n  Select \\\"RUNTIME\\\".\n  Expand STATUS by clicking on +.\n  Expand PLATFORM by clicking on +.\n  In the \\\"Environment\\\" tab, click the > arrow until you see the\n  \\\"jboss.bind.properties\\\" and the \\\"jboss.bind.properties.management\\\" values.\n\n  If the jboss.bind.properties and the jboss.bind.properties.management do not\n  have different IP network addresses assigned, this is a finding.\n\n  Review the network documentation.  If access to the management IP address is\n  not restricted, this is a finding.\"\n  tag \"fix\": \"Refer to the Wildfly EAP Installation guide for\n  detailed instructions on how to start JBoss as a service.\n\n  Use the following command line parameters to assign the management interface to\n  a specific management network.\n\n  These command line flags must be added both when starting JBoss as a service\n  and when starting from the command line.\n\n  Substitute your actual network address for the 10.x.x.x addresses provided as\n  an example below.\n\n  For a standalone configuration:\n  JBOSS_HOME/bin/standalone.sh -bmanagement=10.2.2.1 -b 10.1.1.1\n\n  JBOSS_HOME/bin/domain.sh -bmanagement=10.2.2.1 -b 10.1.1.1\n\n  If a management network is not available, you may substitute\n  localhost/127.0.0.1 for management address.  This will force you to manage the\n  Wildfly server from the local host.\"\n  tag \"fix_id\": 'F-68203r1_fix'\n\n  bind_mgmt_address = command(\"grep jboss.bind.address.management #{ input('jboss_home') }/standalone/configuration/standalone.xml | awk -F'=' '{print $2}' \").stdout\n  public_bind_address = command(\"grep jboss.bind.address #{ input('jboss_home') }/standalone/configuration/standalone.xml | grep -v management | awk -F'=' '{print $2}' \").stdout\n\n  bind_mgmt_address = command(\"grep jboss.bind.address.management #{ input('jboss_home') }/standalone/configuration/standalone.xml | awk -F'=' '{print $2}' \").stdout\n  public_bind_address = command(\"grep jboss.bind.address #{ input('jboss_home') }/standalone/configuration/standalone.xml | grep -v management | awk -F'=' '{print $2}' \").stdout\n\n  describe 'The wildfly bind address' do\n    subject { bind_mgmt_address }\n    it { should_not eq public_bind_address }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62283.rb",
        "line": 1
      },
      "id": "V-62283"
    },
    {
      "title": "Google Analytics must be disabled in EAP Console.",
      "desc": "The Google Analytics feature aims to help Red Hat EAP team understand how\ncustomers are using the console and which parts of the console matter the most\nto the customers. This information will, in turn, help the team to adapt the\nconsole design, features, and content to the immediate needs of the customers.\n\n  Sending analytical data to the vendor introduces risk of unauthorized data\nexfiltration.  This capability must be disabled.",
      "descriptions": {
        "default": "The Google Analytics feature aims to help Red Hat EAP team understand how\ncustomers are using the console and which parts of the console matter the most\nto the customers. This information will, in turn, help the team to adapt the\nconsole design, features, and content to the immediate needs of the customers.\n\n  Sending analytical data to the vendor introduces risk of unauthorized data\nexfiltration.  This capability must be disabled."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000141-AS-000095",
        "gid": "V-62263",
        "rid": "SV-76753r1_rule",
        "stig_id": "JBOS-AS-000225",
        "cci": [
          "CCI-000381"
        ],
        "documentable": false,
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "check": "Open the EAP web console by pointing a web browser to\n  HTTPS://<SERVERNAME>:9443 or HTTP://<SERVERNAME>:9990\n\n  Log on to the admin console using admin credentials.\n  On the bottom right-hand side of the screen, select \"Settings\".\n\n  If the \"Enable Data Usage Collection\" box is checked, this is a finding.",
        "fix": "Using the EAP web console, log on using admin credentials.\n  On the bottom right-hand side of the screen, select \"Settings\",\n  uncheck the \"Enable Data Usage Collection\" box, and save the configuration.",
        "fix_id": "F-68183r1_fix"
      },
      "code": "control 'V-62263' do\n  title \"Google Analytics must be disabled in EAP Console.\"\n  desc  \"\n    The Google Analytics feature aims to help Red Hat EAP team understand how\n  customers are using the console and which parts of the console matter the most\n  to the customers. This information will, in turn, help the team to adapt the\n  console design, features, and content to the immediate needs of the customers.\n\n    Sending analytical data to the vendor introduces risk of unauthorized data\n  exfiltration.  This capability must be disabled.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-AS-000095'\n  tag \"gid\": 'V-62263'\n  tag \"rid\": 'SV-76753r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000225'\n  tag \"cci\": ['CCI-000381']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"check\": \"Open the EAP web console by pointing a web browser to\n  HTTPS://<SERVERNAME>:9443 or HTTP://<SERVERNAME>:9990\n\n  Log on to the admin console using admin credentials.\n  On the bottom right-hand side of the screen, select \\\"Settings\\\".\n\n  If the \\\"Enable Data Usage Collection\\\" box is checked, this is a finding.\"\n  tag \"fix\": \"Using the EAP web console, log on using admin credentials.\n  On the bottom right-hand side of the screen, select \\\"Settings\\\",\n  uncheck the \\\"Enable Data Usage Collection\\\" box, and save the configuration.\"\n  tag \"fix_id\": 'F-68183r1_fix'\n  describe 'A manual review is required to ensure Google Analytics is disable in the EAP console' do\n    skip 'A manual review is required to ensure Google Analytics is disable in the EAP console'\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62263.rb",
        "line": 1
      },
      "id": "V-62263"
    },
    {
      "title": "Network access to HTTP management must be disabled on domain-enabled\n  application servers not designated as the domain controller.",
      "desc": "When configuring Wildfly application servers into a domain configuration,\nHTTP management capabilities are not required on domain member servers as\nmanagement is done via the server that has been designated as the domain\ncontroller.\n\n    Leaving HTTP management capabilities enabled on domain member servers\nincreases the attack surfaces; therefore, management services on domain member\nservers must be disabled and management services performed via the domain\ncontroller.",
      "descriptions": {
        "default": "When configuring Wildfly application servers into a domain configuration,\nHTTP management capabilities are not required on domain member servers as\nmanagement is done via the server that has been designated as the domain\ncontroller.\n\n    Leaving HTTP management capabilities enabled on domain member servers\nincreases the attack surfaces; therefore, management services on domain member\nservers must be disabled and management services performed via the domain\ncontroller."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000316-AS-000199",
        "gid": "V-62303",
        "rid": "SV-76793r1_rule",
        "stig_id": "JBOS-AS-000470",
        "cci": [
          "CCI-002322"
        ],
        "documentable": false,
        "nist": [
          "AC-17 (9)",
          "Rev_4"
        ],
        "check": "Log on to each of the Wildfly domain member servers.\n\n  Note: Sites that manage systems using the Wildfly Operations Network client\n  require HTTP interface access.  It is acceptable that the management console\n  alone be disabled rather than disabling the entire interface itself.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the $JBOSS_HOME;/bin/jboss-cli command line interface utility and connect\n  to the Wildfly server.\n  Run the following command:\n  ls /core-service=management/management-interface=httpinterface/\n\n  If \"console-enabled=true\", this is a finding.",
        "fix": "Run the $JBOSS_HOME;/bin/jboss-cli command line interface\n  utility.\n  Connect to the Wildfly server and run the following command.\n  /core-service=management/management-interface=httpinterface/:write-attribute(name=console-enabled,value=false)\n\n  Successful command execution returns\n  {\"outcome\" => \"success\"}, and future attempts to access the management\n  console via web browser at <SERVERNAME>:9990 will result in no access to the\n  admin console.",
        "fix_id": "F-68223r1_fix"
      },
      "code": "control 'V-62303' do\n  title \"Network access to HTTP management must be disabled on domain-enabled\n  application servers not designated as the domain controller.\"\n  desc  \"\n    When configuring Wildfly application servers into a domain configuration,\n  HTTP management capabilities are not required on domain member servers as\n  management is done via the server that has been designated as the domain\n  controller.\n\n      Leaving HTTP management capabilities enabled on domain member servers\n  increases the attack surfaces; therefore, management services on domain member\n  servers must be disabled and management services performed via the domain\n  controller.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000316-AS-000199'\n  tag \"gid\": 'V-62303'\n  tag \"rid\": 'SV-76793r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000470'\n  tag \"cci\": ['CCI-002322']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-17 (9)', 'Rev_4']\n  tag \"check\": \"Log on to each of the Wildfly domain member servers.\n\n  Note: Sites that manage systems using the Wildfly Operations Network client\n  require HTTP interface access.  It is acceptable that the management console\n  alone be disabled rather than disabling the entire interface itself.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the $JBOSS_HOME;/bin/jboss-cli command line interface utility and connect\n  to the Wildfly server.\n  Run the following command:\n  ls /core-service=management/management-interface=httpinterface/\n\n  If \\\"console-enabled=true\\\", this is a finding.\"\n  tag \"fix\": \"Run the $JBOSS_HOME;/bin/jboss-cli command line interface\n  utility.\n  Connect to the Wildfly server and run the following command.\n  /core-service=management/management-interface=httpinterface/:write-attribute(name=console-enabled,value=false)\n\n  Successful command execution returns\n  {\\\"outcome\\\" => \\\"success\\\"}, and future attempts to access the management\n  console via web browser at <SERVERNAME>:9990 will result in no access to the\n  admin console.\"\n  tag \"fix_id\": 'F-68223r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly HTTP management interface' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/management-interface=http-interface\").stdout }\n    it { should_not include 'console-enabled=true' }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62303.rb",
        "line": 1
      },
      "id": "V-62303"
    },
    {
      "title": "The Wildfly server must separate hosted application functionality from\n  application server management functionality.",
      "desc": "The application server consists of the management interface and hosted\napplications.  By separating the management interface from hosted applications,\nthe user must authenticate as a privileged user to the management interface\nbefore being presented with management functionality.  This prevents\nnon-privileged users from having visibility to functions not available to the\nuser.  By limiting visibility, a compromised non-privileged account does not\noffer information to the attacker or functionality and information needed to\nfurther the attack on the application server.\n\n    Wildfly is designed to operate with separate application and management\ninterfaces.\n    The Wildfly server is started via a script.  To start the JBoss server in\ndomain mode, the admin will execute the $JBOSS_HOME;/bin/domain.sh or\ndomain.bat script.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\n    To start the Wildfly server in standalone mode, the admin will execute\n$JBOSS_HOME;/bin/standalone.bat or standalone.sh.\n\n    Command line flags are used to specify which network address is used for\nmanagement and which address is used for public/application access.",
      "descriptions": {
        "default": "The application server consists of the management interface and hosted\napplications.  By separating the management interface from hosted applications,\nthe user must authenticate as a privileged user to the management interface\nbefore being presented with management functionality.  This prevents\nnon-privileged users from having visibility to functions not available to the\nuser.  By limiting visibility, a compromised non-privileged account does not\noffer information to the attacker or functionality and information needed to\nfurther the attack on the application server.\n\n    Wildfly is designed to operate with separate application and management\ninterfaces.\n    The Wildfly server is started via a script.  To start the JBoss server in\ndomain mode, the admin will execute the $JBOSS_HOME;/bin/domain.sh or\ndomain.bat script.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\n    To start the Wildfly server in standalone mode, the admin will execute\n$JBOSS_HOME;/bin/standalone.bat or standalone.sh.\n\n    Command line flags are used to specify which network address is used for\nmanagement and which address is used for public/application access."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000211-AS-000146",
        "gid": "V-62297",
        "rid": "SV-76787r1_rule",
        "stig_id": "JBOS-AS-000355",
        "cci": [
          "CCI-001082"
        ],
        "documentable": false,
        "nist": [
          "SC-2",
          "Rev_4"
        ],
        "check": "If Wildfly is not started with separate management and public\n  interfaces, this is a finding.\n\n  Review the network design documents to identify the IP address space for the\n  management network.\n\n  Use relevant OS commands and administrative techniques to determine how the\n  system administrator starts the JBoss server.  This includes interviewing the\n  system admin, using the \"ps -ef|grep\" command for UNIX like systems or\n  checking command line flags and properties on batch scripts for Windows\n  systems.\n\n\n\n  The \"-b\" flag specifies the public address space.\n  The \"-bmanagement\" flag specifies the management address space.\n\n  Example:\n  $JBOSS_HOME;/bin/standalone.sh -bmanagement 10.10.10.35 -b 192.168.10.25\n\n  If Wildfly is not started with separate management and public interfaces, this is\n  a finding.",
        "fix": "Start the application server with a -bmanagement and a -b flag so\n  that admin management functionality and hosted applications are separated.\n\n  Refer to section 4.9 in the Wildfly Installation Guide for specific\n  instructions on how to start the Wildfly server as a service.",
        "fix_id": "F-68217r1_fix"
      },
      "code": "control 'V-62297' do\n  title \"The Wildfly server must separate hosted application functionality from\n  application server management functionality.\"\n  desc  \"\n      The application server consists of the management interface and hosted\n  applications.  By separating the management interface from hosted applications,\n  the user must authenticate as a privileged user to the management interface\n  before being presented with management functionality.  This prevents\n  non-privileged users from having visibility to functions not available to the\n  user.  By limiting visibility, a compromised non-privileged account does not\n  offer information to the attacker or functionality and information needed to\n  further the attack on the application server.\n\n      Wildfly is designed to operate with separate application and management\n  interfaces.\n      The Wildfly server is started via a script.  To start the JBoss server in\n  domain mode, the admin will execute the $JBOSS_HOME;/bin/domain.sh or\n  domain.bat script.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n      To start the Wildfly server in standalone mode, the admin will execute\n  $JBOSS_HOME;/bin/standalone.bat or standalone.sh.\n\n      Command line flags are used to specify which network address is used for\n  management and which address is used for public/application access.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000211-AS-000146'\n  tag \"gid\": 'V-62297'\n  tag \"rid\": 'SV-76787r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000355'\n  tag \"cci\": ['CCI-001082']\n  tag \"documentable\": false\n  tag \"nist\": ['SC-2', 'Rev_4']\n  tag \"check\": \"If Wildfly is not started with separate management and public\n  interfaces, this is a finding.\n\n  Review the network design documents to identify the IP address space for the\n  management network.\n\n  Use relevant OS commands and administrative techniques to determine how the\n  system administrator starts the JBoss server.  This includes interviewing the\n  system admin, using the \\\"ps -ef|grep\\\" command for UNIX like systems or\n  checking command line flags and properties on batch scripts for Windows\n  systems.\n\n\n\n  The \\\"-b\\\" flag specifies the public address space.\n  The \\\"-bmanagement\\\" flag specifies the management address space.\n\n  Example:\n  $JBOSS_HOME;/bin/standalone.sh -bmanagement 10.10.10.35 -b 192.168.10.25\n\n  If Wildfly is not started with separate management and public interfaces, this is\n  a finding.\"\n  tag \"fix\": \"Start the application server with a -bmanagement and a -b flag so\n  that admin management functionality and hosted applications are separated.\n\n  Refer to section 4.9 in the Wildfly Installation Guide for specific\n  instructions on how to start the Wildfly server as a service.\"\n  tag \"fix_id\": 'F-68217r1_fix'\n  bind_mgmt_address = command(\"grep jboss.bind.address.management #{ input('jboss_home') }/standalone/configuration/standalone.xml | awk -F'=' '{print $2}' \").stdout\n  public_bind_address = command(\"grep jboss.bind.address #{ input('jboss_home') }/standalone/configuration/standalone.xml | grep -v management | awk -F'=' '{print $2}' \").stdout\n  describe 'The wildfly bind management address' do\n    subject { bind_mgmt_address }\n    it { should_not eq public_bind_address }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62297.rb",
        "line": 1
      },
      "id": "V-62297"
    },
    {
      "title": "Wildfly servers must be configured to roll over and transfer logs on a\n  minimum weekly basis.",
      "desc": "Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.  Protecting log data is important during a\nforensic investigation to ensure investigators can track and understand what\nmay have occurred.  Off-loading should be set up as a scheduled task but can be\nconfigured to be run manually, if other processes during the off-loading are\nmanual.\n\n    Off-loading is a common process in information systems with limited log\nstorage capacity.",
      "descriptions": {
        "default": "Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.  Protecting log data is important during a\nforensic investigation to ensure investigators can track and understand what\nmay have occurred.  Off-loading should be set up as a scheduled task but can be\nconfigured to be run manually, if other processes during the off-loading are\nmanual.\n\n    Off-loading is a common process in information systems with limited log\nstorage capacity."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000515-AS-000203",
        "gid": "V-62345",
        "rid": "SV-76835r1_rule",
        "stig_id": "JBOS-AS-000735",
        "cci": [
          "CCI-001851"
        ],
        "documentable": false,
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ],
        "check": "If the Wildfly server is configured to use a Syslog Handler, this\n  is not a finding.\n\n  Log on to the OS of the Wildfly server with OS permissions that allow access to\n  Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Determine if there is a periodic rotating file handler.\n\n  For a domain configuration run the following command; where <SERVERNAME> is a\n  variable for all of the servers in the domain.  Usually \"server-one\",\n  \"server-two\", etc.:\n\n  \"ls\n  /host=master/server=<SERVERNAME>/subsystem=logging/periodic-rotating-file-handler=\"\n\n  For a standalone configuration run the command:\n  \"ls /subsystem=logging/periodic-rotating-file-handler=\"\n\n  If the command does not return \"FILE\", this is a finding.\n\n  Review the $JBOSS_HOME;/standalone/log folder for the existence of rotated\n  logs, and ask the admin to demonstrate how rotated logs are packaged and\n  transferred to another system on at least a weekly basis.",
        "fix": "Open the web-based management interface by opening a browser and\n  pointing it to HTTPS://<EAP_SERVER>:9990/\n\n  Authenticate as a user with Admin rights.\n  Navigate to the \"Configuration\" tab.\n  Expand + Subsystems.\n  Expand + Core.\n  Select \"Logging\".\n  Select the \"Handler\" tab.\n  Select  \"Periodic\".\n\n  If a periodic file handler does not exist, reference Wildfly admin guide for\n  instructions on how to create a file handler that will rotate logs on a daily\n  basis.\n  Create scripts that package and off-load log data at least weekly.",
        "fix_id": "F-68265r1_fix"
      },
      "code": "control 'V-62345' do\n  title \"Wildfly servers must be configured to roll over and transfer logs on a\n  minimum weekly basis.\"\n  desc  \"\n    Information stored in one location is vulnerable to accidental or\n  incidental deletion or alteration.  Protecting log data is important during a\n  forensic investigation to ensure investigators can track and understand what\n  may have occurred.  Off-loading should be set up as a scheduled task but can be\n  configured to be run manually, if other processes during the off-loading are\n  manual.\n\n      Off-loading is a common process in information systems with limited log\n  storage capacity.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000515-AS-000203'\n  tag \"gid\": 'V-62345'\n  tag \"rid\": 'SV-76835r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000735'\n  tag \"cci\": ['CCI-001851']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-4 (1)', 'Rev_4']\n  tag \"check\": \"If the Wildfly server is configured to use a Syslog Handler, this\n  is not a finding.\n\n  Log on to the OS of the Wildfly server with OS permissions that allow access to\n  Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  Determine if there is a periodic rotating file handler.\n\n  For a domain configuration run the following command; where <SERVERNAME> is a\n  variable for all of the servers in the domain.  Usually \\\"server-one\\\",\n  \\\"server-two\\\", etc.:\n\n  \\\"ls\n  /host=master/server=<SERVERNAME>/subsystem=logging/periodic-rotating-file-handler=\\\"\n\n  For a standalone configuration run the command:\n  \\\"ls /subsystem=logging/periodic-rotating-file-handler=\\\"\n\n  If the command does not return \\\"FILE\\\", this is a finding.\n\n  Review the $JBOSS_HOME;/standalone/log folder for the existence of rotated\n  logs, and ask the admin to demonstrate how rotated logs are packaged and\n  transferred to another system on at least a weekly basis.\"\n  tag \"fix\": \"Open the web-based management interface by opening a browser and\n  pointing it to HTTPS://<EAP_SERVER>:9990/\n\n  Authenticate as a user with Admin rights.\n  Navigate to the \\\"Configuration\\\" tab.\n  Expand + Subsystems.\n  Expand + Core.\n  Select \\\"Logging\\\".\n  Select the \\\"Handler\\\" tab.\n  Select  \\\"Periodic\\\".\n\n  If a periodic file handler does not exist, reference Wildfly admin guide for\n  instructions on how to create a file handler that will rotate logs on a daily\n  basis.\n  Create scripts that package and off-load log data at least weekly.\"\n  tag \"fix_id\": 'F-68265r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly periodic roating file handler setting' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ subsystem=logging/periodic-rotating-file-handler=\").stdout }\n    it { should match(%r{FILE}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62345.rb",
        "line": 1
      },
      "id": "V-62345"
    },
    {
      "title": "Wildfly must be configured to allow only the ISSM (or individuals or\nroles appointed by the ISSM) to select which loggable events are to be logged.",
      "desc": "The Wildfly server must be configured to select which personnel are assigned\nthe role of selecting which loggable events are to be logged.\n    In Wildfly, the role designated for selecting auditable events is the\n\"Auditor\" role.\n    The personnel or roles that can select loggable events are only the ISSM\n(or individuals or roles appointed by the ISSM).",
      "descriptions": {
        "default": "The Wildfly server must be configured to select which personnel are assigned\nthe role of selecting which loggable events are to be logged.\n    In Wildfly, the role designated for selecting auditable events is the\n\"Auditor\" role.\n    The personnel or roles that can select loggable events are only the ISSM\n(or individuals or roles appointed by the ISSM)."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000090-AS-000051",
        "gid": "V-62233",
        "rid": "SV-76723r1_rule",
        "stig_id": "JBOS-AS-000085",
        "cci": [
          "CCI-000171"
        ],
        "documentable": false,
        "nist": [
          "AU-12 b",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=authorization/role-mapping=Auditor/include=\"\n\nFor a Standalone configuration:\n\"ls\n/core-service=management/access=authorization/role-mapping=Auditor/include=\"\n\nIf the list of users in the Auditors group is not approved by the ISSM, this is\na finding.",
        "fix": "Obtain documented approvals from ISSM, and assign the appropriate\npersonnel into the \"Auditor\" role.",
        "fix_id": "F-68153r1_fix"
      },
      "code": "control 'V-62233' do\n  title \"Wildfly must be configured to allow only the ISSM (or individuals or\nroles appointed by the ISSM) to select which loggable events are to be logged.\"\n  desc  \"\n    The Wildfly server must be configured to select which personnel are assigned\nthe role of selecting which loggable events are to be logged.\n    In Wildfly, the role designated for selecting auditable events is the\n\\\"Auditor\\\" role.\n    The personnel or roles that can select loggable events are only the ISSM\n(or individuals or roles appointed by the ISSM).\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000090-AS-000051'\n  tag \"gid\": 'V-62233'\n  tag \"rid\": 'SV-76723r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000085'\n  tag \"cci\": ['CCI-000171']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-12 b', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\\\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=authorization/role-mapping=Auditor/include=\\\"\n\nFor a Standalone configuration:\n\\\"ls\n/core-service=management/access=authorization/role-mapping=Auditor/include=\\\"\n\nIf the list of users in the Auditors group is not approved by the ISSM, this is\na finding.\"\n  tag \"fix\": \"Obtain documented approvals from ISSM, and assign the appropriate\npersonnel into the \\\"Auditor\\\" role.\"\n  tag \"fix_id\": 'F-68153r1_fix'\n\n  connect = input('connection')\n  auditor_role_users = input('auditor_role_users')\n\n  auditor_role = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\ /core-service=management/access=authorization/role-mapping=Auditor/include=\").stdout.split(\"\\n\")\n\n  auditor_role.each do |user|\n    a = user.strip\n    describe \"#{a}\" do\n      it { should be_in auditor_role_users }\n    end\n  end\n  if auditor_role.empty?\n    impact 0.0\n    describe 'There are no wildfly users with the auditor role, therefore this control is not applicable' do\n      skip 'There are no wildfly users with the auditor role, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62233.rb",
        "line": 1
      },
      "id": "V-62233"
    },
    {
      "title": "Wildfly process owner execution permissions must be limited.",
      "desc": "Wildfly EAP application server can be run as the OS admin, which is not\n  advised.  Running the application server with admin privileges increases the\n  attack surface by granting the application server more rights than it requires\n  in order to operate.  If the server is compromised, the attacker will have the\n  same rights as the application server, which in that case would be admin\n  rights.  The Wildfly EAP server must not be run as the admin user.",
      "descriptions": {
        "default": "Wildfly EAP application server can be run as the OS admin, which is not\n  advised.  Running the application server with admin privileges increases the\n  attack surface by granting the application server more rights than it requires\n  in order to operate.  If the server is compromised, the attacker will have the\n  same rights as the application server, which in that case would be admin\n  rights.  The Wildfly EAP server must not be run as the admin user."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000141-AS-000095",
        "gid": "V-62265",
        "rid": "SV-76755r1_rule",
        "stig_id": "JBOS-AS-000230",
        "cci": [
          "CCI-000381"
        ],
        "documentable": false,
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "check": "The script that is used to start Wildfly determines the mode in\n  which Wildfly will operate, which will be in either in standalone mode or domain\n  mode.  Both scripts are installed by default in the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  In addition to running the Wildfly server as an interactive script launched from\n  the command line, Wildfly can also be started as a service.\n\n  The scripts used to start Wildfly are:\n  Red Hat:\n  standalone.sh\n  domain.sh\n\n  Windows:\n  standalone.bat\n  domain.bat\n\n  Use the relevant OS commands to determine JBoss ownership.\n\n  When running as a process:\n  Red Hat: \"ps -ef|grep -i jboss\".\n  Windows: \"services.msc\".\n\n  Search for the Wildfly process, which by default is named \"Wildfly\".\n\n  If the user account used to launch the Wildfly script or start the Wildfly process\n  has admin rights on the system, this is a finding.",
        "fix": "Run the JBoss server with non-admin rights.",
        "fix_id": "F-68185r1_fix"
      },
      "code": "control 'V-62265' do\n  title \"Wildfly process owner execution permissions must be limited.\"\n  desc  \"Wildfly EAP application server can be run as the OS admin, which is not\n  advised.  Running the application server with admin privileges increases the\n  attack surface by granting the application server more rights than it requires\n  in order to operate.  If the server is compromised, the attacker will have the\n  same rights as the application server, which in that case would be admin\n  rights.  The Wildfly EAP server must not be run as the admin user.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000141-AS-000095'\n  tag \"gid\": 'V-62265'\n  tag \"rid\": 'SV-76755r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000230'\n  tag \"cci\": ['CCI-000381']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"check\": \"The script that is used to start Wildfly determines the mode in\n  which Wildfly will operate, which will be in either in standalone mode or domain\n  mode.  Both scripts are installed by default in the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  In addition to running the Wildfly server as an interactive script launched from\n  the command line, Wildfly can also be started as a service.\n\n  The scripts used to start Wildfly are:\n  Red Hat:\n  standalone.sh\n  domain.sh\n\n  Windows:\n  standalone.bat\n  domain.bat\n\n  Use the relevant OS commands to determine JBoss ownership.\n\n  When running as a process:\n  Red Hat: \\\"ps -ef|grep -i jboss\\\".\n  Windows: \\\"services.msc\\\".\n\n  Search for the Wildfly process, which by default is named \\\"Wildfly\\\".\n\n  If the user account used to launch the Wildfly script or start the Wildfly process\n  has admin rights on the system, this is a finding.\"\n  tag \"fix\": \"Run the JBoss server with non-admin rights.\"\n  tag \"fix_id\": 'F-68185r1_fix'\n\n  user = command(\"ps -ef | grep #{input('jboss_process_name')} | grep -v inspec | grep -v grep | awk '{print $1}'|uniq\").stdout.split(\"\\n\")\n\n  describe 'The wildly process owner' do\n    subject { command(\"ps -ef | grep #{input('jboss_process_name')} | grep -v inspec | grep -v grep | awk '{print $1}'|uniq\").stdout }\n    it { should_not match(%r{root}) }\n  end\n\n  user.each do |users|\n    group = command(\"id -gn #{users} \").stdout.split(\"\\n\")\n\n     group.each do |group|\n\n       describe \"The wildfly process owner: #{users}\\'s group\" do\n       subject { group }\n         it { should_not eq 'root' }\n       end\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62265.rb",
        "line": 1
      },
      "id": "V-62265"
    },
    {
      "title": "The Wildlfy server must be configured to use DoD- or CNSS-approved PKI\n  Class 3 or Class 4 certificates.",
      "desc": "Class 3 PKI certificates are used for servers and software signing\n  rather than for identifying individuals. Class 4 certificates are used for\n  business-to-business transactions. Utilizing unapproved certificates not issued\n  or approved by DoD or CNS creates an integrity risk. The application server\n  must utilize approved DoD or CNS Class 3 or Class 4 certificates for software\n  signing and business-to-business transactions.",
      "descriptions": {
        "default": "Class 3 PKI certificates are used for servers and software signing\n  rather than for identifying individuals. Class 4 certificates are used for\n  business-to-business transactions. Utilizing unapproved certificates not issued\n  or approved by DoD or CNS creates an integrity risk. The application server\n  must utilize approved DoD or CNS Class 3 or Class 4 certificates for software\n  signing and business-to-business transactions."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000514-AS-000137",
        "gid": "V-62343",
        "rid": "SV-76833r1_rule",
        "stig_id": "JBOS-AS-000730",
        "cci": [
          "CCI-002450"
        ],
        "documentable": false,
        "nist": [
          "SC-13",
          "Rev_4"
        ],
        "check": "Interview the administrator to determine if Wildlfy is using\n  certificates for PKI.  If Wildlfy is not performing any PKI functions, this\n  finding is NA.\n\n  The CA certs are usually stored in a file called cacerts located in the\n  directory $JAVA_HOME/lib/security.  If the file is not in this location, use a\n  search command to locate the file, or ask the administrator where the\n  certificate store is located.\n\n  Open a dos shell or terminal window and change to the location of the\n  certificate store.  To view the certificates within the certificate store, run\n  the command (in this example, the keystore file is cacerts.): keytool -list -v\n  -keystore ./cacerts\n\n  Locate the \"OU\" field for each certificate within the keystore.  The field\n  should contain either \"DoD\" or \"CNSS\" as the Organizational Unit (OU).\n\n  If the OU does not show that the certificates are DoD or CNSS supplied, this is\n  a finding.",
        "fix": "Configure the application server to use DoD- or CNSS-approved\n  Class 3 or Class 4 PKI certificates.",
        "fix_id": "F-68263r1_fix"
      },
      "code": "control 'V-62343' do\n  title \"The Wildlfy server must be configured to use DoD- or CNSS-approved PKI\n  Class 3 or Class 4 certificates.\"\n  desc  \"Class 3 PKI certificates are used for servers and software signing\n  rather than for identifying individuals. Class 4 certificates are used for\n  business-to-business transactions. Utilizing unapproved certificates not issued\n  or approved by DoD or CNS creates an integrity risk. The application server\n  must utilize approved DoD or CNS Class 3 or Class 4 certificates for software\n  signing and business-to-business transactions.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000514-AS-000137'\n  tag \"gid\": 'V-62343'\n  tag \"rid\": 'SV-76833r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000730'\n  tag \"cci\": ['CCI-002450']\n  tag \"documentable\": false\n  tag \"nist\": ['SC-13', 'Rev_4']\n  tag \"check\": \"Interview the administrator to determine if Wildlfy is using\n  certificates for PKI.  If Wildlfy is not performing any PKI functions, this\n  finding is NA.\n\n  The CA certs are usually stored in a file called cacerts located in the\n  directory $JAVA_HOME/lib/security.  If the file is not in this location, use a\n  search command to locate the file, or ask the administrator where the\n  certificate store is located.\n\n  Open a dos shell or terminal window and change to the location of the\n  certificate store.  To view the certificates within the certificate store, run\n  the command (in this example, the keystore file is cacerts.): keytool -list -v\n  -keystore ./cacerts\n\n  Locate the \\\"OU\\\" field for each certificate within the keystore.  The field\n  should contain either \\\"DoD\\\" or \\\"CNSS\\\" as the Organizational Unit (OU).\n\n  If the OU does not show that the certificates are DoD or CNSS supplied, this is\n  a finding.\"\n  tag \"fix\": \"Configure the application server to use DoD- or CNSS-approved\n  Class 3 or Class 4 PKI certificates.\"\n  tag \"fix_id\": 'F-68263r1_fix'\n\n  java_cert = input('java_cert')\n\n  certs = command(\"keytool -list -v -keystore #{java_cert}\").stdout\n  describe.one do\n    describe 'The wildfly server PKI certificate' do\n      subject { certs }\n      it { should match(%r{OU=DoD}) }\n    end\n    describe 'The wildfly server PKI certificate' do\n      subject { certs }\n      it { should match(%r{OU=CNSS}) }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62343.rb",
        "line": 1
      },
      "id": "V-62343"
    },
    {
      "title": "Remote access to JMX subsystem must be disabled.",
      "desc": "The JMX subsystem allows you to trigger JDK and application management\n  operations remotely.  In a managed domain configuration, the JMX subsystem is\n  removed by default. For a standalone configuration, it is enabled by default\n  and must be removed.",
      "descriptions": {
        "default": "The JMX subsystem allows you to trigger JDK and application management\n  operations remotely.  In a managed domain configuration, the JMX subsystem is\n  removed by default. For a standalone configuration, it is enabled by default\n  and must be removed."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000141-AS-000095",
        "gid": "V-62269",
        "rid": "SV-76759r1_rule",
        "stig_id": "JBOS-AS-000240",
        "cci": [
          "CCI-000381"
        ],
        "documentable": false,
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n\n  For a Managed Domain configuration, you must check each profile name:\n\n  For each PROFILE NAME, run the command:\n  \"ls /profile=<PROFILE NAME>/subsystem=jmx/remoting-connector\"\n\n  For a Standalone configuration:\n  \"ls /subsystem=jmx/remoting-connector\"\n\n  If \"jmx\" is returned, this is a finding.",
        "fix": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n\n  For a Managed Domain configuration you must check each profile name:\n\n  For each PROFILE NAME, run the command:\n  \"/profile=<PROFILE NAME>/subsystem=jmx/remoting-connector=jmx:remove\"\n\n  For a Standalone configuration:\n  \"/subsystem=jmx/remoting-connector=jmx:remove\"",
        "fix_id": "F-68189r1_fix"
      },
      "code": "control 'V-62269' do\n  title \"Remote access to JMX subsystem must be disabled.\"\n  desc  \"The JMX subsystem allows you to trigger JDK and application management\n  operations remotely.  In a managed domain configuration, the JMX subsystem is\n  removed by default. For a standalone configuration, it is enabled by default\n  and must be removed.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-AS-000095'\n  tag \"gid\": 'V-62269'\n  tag \"rid\": 'SV-76759r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000240'\n  tag \"cci\": ['CCI-000381']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n\n  For a Managed Domain configuration, you must check each profile name:\n\n  For each PROFILE NAME, run the command:\n  \\\"ls /profile=<PROFILE NAME>/subsystem=jmx/remoting-connector\\\"\n\n  For a Standalone configuration:\n  \\\"ls /subsystem=jmx/remoting-connector\\\"\n\n  If \\\"jmx\\\" is returned, this is a finding.\"\n  tag \"fix\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n\n  For a Managed Domain configuration you must check each profile name:\n\n  For each PROFILE NAME, run the command:\n  \\\"/profile=<PROFILE NAME>/subsystem=jmx/remoting-connector=jmx:remove\\\"\n\n  For a Standalone configuration:\n  \\\"/subsystem=jmx/remoting-connector=jmx:remove\\\"\"\n  tag \"fix_id\": 'F-68189r1_fix'\n\n  connect = input('connection')\n  describe 'The wildfly remote access' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=jmx/remoting-connector\").stdout }\n    it { should_not match(%r{jmx}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62269.rb",
        "line": 1
      },
      "id": "V-62269"
    },
    {
      "title": "Wildlfy must be configured to generate log records that show starting\n  and ending times for access to the application server management interface.",
      "desc": "Determining when a user has accessed the management interface is important\nto determine the timeline of events when a security incident occurs.\nGenerating these events, especially if the management interface is accessed via\na stateless protocol like HTTP, the log events will be generated when the user\nperforms a logon (start) and when the user performs a logoff (end).  Without\nthese events, the user and later investigators cannot determine the sequence of\nevents and therefore cannot determine what may have happened and by whom it may\nhave been done.\n\n    The generation of start and end times within log events allows the user to\nperform their due diligence in the event of a security breach.",
      "descriptions": {
        "default": "Determining when a user has accessed the management interface is important\nto determine the timeline of events when a security incident occurs.\nGenerating these events, especially if the management interface is accessed via\na stateless protocol like HTTP, the log events will be generated when the user\nperforms a logon (start) and when the user performs a logoff (end).  Without\nthese events, the user and later investigators cannot determine the sequence of\nevents and therefore cannot determine what may have happened and by whom it may\nhave been done.\n\n    The generation of start and end times within log events allows the user to\nperform their due diligence in the event of a security breach."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000505-AS-000230",
        "gid": "V-62337",
        "rid": "SV-76827r1_rule",
        "stig_id": "JBOS-AS-000710",
        "cci": [
          "CCI-000172"
        ],
        "documentable": false,
        "nist": [
          "AU-12 c",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildlfy server with OS permissions that\n  allow access to Wildlfy.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\n  Connect to the server by typing \"connect\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68257r1_fix"
      },
      "code": "control 'V-62337' do\n  title \"Wildlfy must be configured to generate log records that show starting\n  and ending times for access to the application server management interface.\"\n  desc  \"\n    Determining when a user has accessed the management interface is important\n  to determine the timeline of events when a security incident occurs.\n  Generating these events, especially if the management interface is accessed via\n  a stateless protocol like HTTP, the log events will be generated when the user\n  performs a logon (start) and when the user performs a logoff (end).  Without\n  these events, the user and later investigators cannot determine the sequence of\n  events and therefore cannot determine what may have happened and by whom it may\n  have been done.\n\n      The generation of start and end times within log events allows the user to\n  perform their due diligence in the event of a security breach.\n    \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000505-AS-000230'\n  tag \"gid\": 'V-62337'\n  tag \"rid\": 'SV-76827r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000710'\n  tag \"cci\": ['CCI-000172']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-12 c', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildlfy server with OS permissions that\n  allow access to Wildlfy.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \\\"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\n  Connect to the server by typing \\\"connect\\\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68257r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly server setting: generate log records that show starting and ending times for access to the application server management interface' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62337.rb",
        "line": 1
      },
      "id": "V-62337"
    },
    {
      "title": "The application server must produce log records that contain\nsufficient information to establish the outcome of events.",
      "desc": "Information system logging capability is critical for accurate forensic\nanalysis. Log record content that may be necessary to satisfy the requirement\nof this control includes, but is not limited to, time stamps, source and\ndestination IP addresses, user/process identifiers, event descriptions,\napplication-specific events, success/fail indications, filenames involved,\naccess control or flow control rules invoked.\n\n    Success and failure indicators ascertain the outcome of a particular\napplication server event or function. As such, they also provide a means to\nmeasure the impact of an event and help authorized personnel to determine the\nappropriate response.  Event outcome may also include event-specific results\n(e.g., the security state of the information system after the event occurred).",
      "descriptions": {
        "default": "Information system logging capability is critical for accurate forensic\nanalysis. Log record content that may be necessary to satisfy the requirement\nof this control includes, but is not limited to, time stamps, source and\ndestination IP addresses, user/process identifiers, event descriptions,\napplication-specific events, success/fail indications, filenames involved,\naccess control or flow control rules invoked.\n\n    Success and failure indicators ascertain the outcome of a particular\napplication server event or function. As such, they also provide a means to\nmeasure the impact of an event and help authorized personnel to determine the\nappropriate response.  Event outcome may also include event-specific results\n(e.g., the security state of the information system after the event occurred)."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000099-AS-000062",
        "gid": "V-62247",
        "rid": "SV-76737r1_rule",
        "stig_id": "JBOS-AS-000130",
        "cci": [
          "CCI-000134"
        ],
        "documentable": false,
        "nist": [
          "AU-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the wildfly server with OS permissions that\nallow access to Wildfly.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nIf \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\nConnect to the server by typing \"connect\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\nFor a Standalone configuration:\n\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68167r1_fix"
      },
      "code": "control 'V-62247' do\n  title \"The application server must produce log records that contain\nsufficient information to establish the outcome of events.\"\n  desc  \"\n    Information system logging capability is critical for accurate forensic\nanalysis. Log record content that may be necessary to satisfy the requirement\nof this control includes, but is not limited to, time stamps, source and\ndestination IP addresses, user/process identifiers, event descriptions,\napplication-specific events, success/fail indications, filenames involved,\naccess control or flow control rules invoked.\n\n    Success and failure indicators ascertain the outcome of a particular\napplication server event or function. As such, they also provide a means to\nmeasure the impact of an event and help authorized personnel to determine the\nappropriate response.  Event outcome may also include event-specific results\n(e.g., the security state of the information system after the event occurred).\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000099-AS-000062'\n  tag \"gid\": 'V-62247'\n  tag \"rid\": 'SV-76737r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000130'\n  tag \"cci\": ['CCI-000134']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the wildfly server with OS permissions that\nallow access to Wildfly.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script to start the Command Line Interface (CLI).\nConnect to the server and authenticate.\nRun the command:\n\nFor a Managed Domain configuration:\n\\\"ls\nhost=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"ls\n/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nIf \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\nConnect to the server by typing \\\"connect\\\", authenticate as a user in the\nSuperuser role, and run the following command:\n\nFor a Managed Domain configuration:\n\\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\nFor a Standalone configuration:\n\\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68167r1_fix'\n\n  connect = input('connection')\n\n  describe 'The application server produce log records that contain sufficient information to establish the outcome of events' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62247.rb",
        "line": 1
      },
      "id": "V-62247"
    },
    {
      "title": "mgmt-users.properties file permissions must be set to allow access to\nauthorized users only.",
      "desc": "The mgmt-users.properties file contains the password hashes of all\nusers who are in a management role and must be protected.  Application servers\nhave the ability to specify that the hosted applications utilize shared\nlibraries. The application server must have a capability to divide roles based\nupon duties wherein one project user (such as a developer) cannot modify the\nshared library code of another project user. The application server must also\nbe able to specify that non-privileged users cannot modify any shared library\ncode at all.",
      "descriptions": {
        "default": "The mgmt-users.properties file contains the password hashes of all\nusers who are in a management role and must be protected.  Application servers\nhave the ability to specify that the hosted applications utilize shared\nlibraries. The application server must have a capability to divide roles based\nupon duties wherein one project user (such as a developer) cannot modify the\nshared library code of another project user. The application server must also\nbe able to specify that non-privileged users cannot modify any shared library\ncode at all."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000133-AS-000092",
        "gid": "V-62259",
        "rid": "SV-76749r1_rule",
        "stig_id": "JBOS-AS-000210",
        "cci": [
          "CCI-001499"
        ],
        "documentable": false,
        "nist": [
          "CM-5 (6)",
          "Rev_4"
        ],
        "check": "The mgmt-users.properties files are located in the standalone\nor domain configuration folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\n$JBOSS_HOME;/domain/configuration/mgmt-users.properties.\n$JBOSS_HOME;/standalone/configuration/mgmt-users.properties.\n\nIdentify users who have access to the files using relevant OS commands.\n\nObtain documentation from system admin identifying authorized users.\n\nOwner can be full access.\nGroup can be full access.\nAll others must have execute permissions only.\n\nIf the file permissions are not configured so as to restrict access to only\nauthorized users, or if documentation that identifies authorized users is\nmissing, this is a finding.",
        "fix": "Configure the file permissions to allow access to authorized\nusers only.\nOwner can be full access.\nGroup can be full access.\nAll others must have execute permissions only.",
        "fix_id": "F-68179r1_fix"
      },
      "code": "control 'V-62259' do\n  title \"mgmt-users.properties file permissions must be set to allow access to\nauthorized users only.\"\n  desc  \"The mgmt-users.properties file contains the password hashes of all\nusers who are in a management role and must be protected.  Application servers\nhave the ability to specify that the hosted applications utilize shared\nlibraries. The application server must have a capability to divide roles based\nupon duties wherein one project user (such as a developer) cannot modify the\nshared library code of another project user. The application server must also\nbe able to specify that non-privileged users cannot modify any shared library\ncode at all.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000133-AS-000092'\n  tag \"gid\": 'V-62259'\n  tag \"rid\": 'SV-76749r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000210'\n  tag \"cci\": ['CCI-001499']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-5 (6)', 'Rev_4']\n  tag \"check\": \"The mgmt-users.properties files are located in the standalone\nor domain configuration folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\n$JBOSS_HOME;/domain/configuration/mgmt-users.properties.\n$JBOSS_HOME;/standalone/configuration/mgmt-users.properties.\n\nIdentify users who have access to the files using relevant OS commands.\n\nObtain documentation from system admin identifying authorized users.\n\nOwner can be full access.\nGroup can be full access.\nAll others must have execute permissions only.\n\nIf the file permissions are not configured so as to restrict access to only\nauthorized users, or if documentation that identifies authorized users is\nmissing, this is a finding.\"\n  tag \"fix\": \"Configure the file permissions to allow access to authorized\nusers only.\nOwner can be full access.\nGroup can be full access.\nAll others must have execute permissions only.\"\n  tag \"fix_id\": 'F-68179r1_fix'\n  describe file(\"#{ input('jboss_home') }/standalone/configuration/mgmt-users.properties\") do\n    it { should_not be_readable.by('others') }\n  end\n  describe file(\"#{ input('jboss_home') }/standalone/configuration/mgmt-users.properties\") do\n    it { should_not be_writable.by('others') }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62259.rb",
        "line": 1
      },
      "id": "V-62259"
    },
    {
      "title": "Production Wildfly servers must log when successful application\n  deployments occur.",
      "desc": "Without logging the enforcement of access restrictions against changes to\nthe application server configuration, it will be difficult to identify\nattempted attacks, and a log trail will not be available for forensic\ninvestigation for after-the-fact actions.  Configuration changes may occur to\nany of the modules within the application server through the management\ninterface, but logging of actions to the configuration of a module outside the\napplication server is not logged.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Log items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact.",
      "descriptions": {
        "default": "Without logging the enforcement of access restrictions against changes to\nthe application server configuration, it will be difficult to identify\nattempted attacks, and a log trail will not be available for forensic\ninvestigation for after-the-fact actions.  Configuration changes may occur to\nany of the modules within the application server through the management\ninterface, but logging of actions to the configuration of a module outside the\napplication server is not logged.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Log items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000381-AS-000089",
        "gid": "V-62315",
        "rid": "SV-76805r1_rule",
        "stig_id": "JBOS-AS-000555",
        "cci": [
          "CCI-001814"
        ],
        "documentable": false,
        "nist": [
          "CM-5 (1)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  ls /core-service=management/access=audit/logger=audit-log\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface substituting standalone\n  or domain for <CONFIG> based upon the server installation.\n\n  $JBOSS_HOME;/<CONFIG>/bin/jboss-cli\n\n  connect to the server and run the following command:\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)",
        "fix_id": "F-68235r1_fix"
      },
      "code": "control 'V-62315' do\n  title \"Production Wildfly servers must log when successful application\n  deployments occur.\"\n  desc  \"\n    Without logging the enforcement of access restrictions against changes to\n  the application server configuration, it will be difficult to identify\n  attempted attacks, and a log trail will not be available for forensic\n  investigation for after-the-fact actions.  Configuration changes may occur to\n  any of the modules within the application server through the management\n  interface, but logging of actions to the configuration of a module outside the\n  application server is not logged.\n\n      Enforcement actions are the methods or mechanisms used to prevent\n  unauthorized changes to configuration settings. Enforcement action methods may\n  be as simple as denying access to a file based on the application of file\n  permissions (access restriction). Log items may consist of lists of actions\n  blocked by access restrictions or changes identified after the fact.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000381-AS-000089'\n  tag \"gid\": 'V-62315'\n  tag \"rid\": 'SV-76805r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000555'\n  tag \"cci\": ['CCI-001814']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-5 (1)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  ls /core-service=management/access=audit/logger=audit-log\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface substituting standalone\n  or domain for <CONFIG> based upon the server installation.\n\n  $JBOSS_HOME;/<CONFIG>/bin/jboss-cli\n\n  connect to the server and run the following command:\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n  tag \"fix_id\": 'F-68235r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly server setting: log when successful application deployments occur' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62315.rb",
        "line": 1
      },
      "id": "V-62315"
    },
    {
      "title": "The Java Security Manager must be enabled for the wildfly application\nserver.",
      "desc": "The Java Security Manager is a java class that manages the external\nboundary of the Java Virtual Machine (JVM) sandbox, controlling how code\nexecuting within the JVM can interact with resources outside the JVM.\n\n    The Java Security Manager uses a security policy to determine whether a\ngiven action will be\n    permitted or denied.\n\n    To protect the host system, the Wildfly application server must be run within\nthe Java Security Manager.",
      "descriptions": {
        "default": "The Java Security Manager is a java class that manages the external\nboundary of the Java Virtual Machine (JVM) sandbox, controlling how code\nexecuting within the JVM can interact with resources outside the JVM.\n\n    The Java Security Manager uses a security policy to determine whether a\ngiven action will be\n    permitted or denied.\n\n    To protect the host system, the Wildfly application server must be run within\nthe Java Security Manager."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000033-AS-000024",
        "gid": "V-62225",
        "rid": "SV-76715r1_rule",
        "stig_id": "JBOS-AS-000030",
        "cci": [
          "CCI-000213"
        ],
        "documentable": false,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "check": "To determine if the Java Security Manager is enabled for Wildfly,\nyou must examine the startup commands.  Wildfly can be configured to run in\neither \"domain\" or a \"standalone\" mode.  JBOSS_HOME is the variable home\ndirectory for the Wildfly installation.  Use relevant OS commands to navigate the\nfile system.\n\nA. For a managed domain installation, review the domain.conf and\ndomain.conf.bat files:\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nJBOSS_HOME/bin/domain.conf\nJBOSS_HOME/bin/domain.conf.bat\n\nIn domain.conf file, ensure there is a JAVA_OPTS flag that loads the Java\nSecurity Manager as well as a relevant Java Security policy.   The following is\nan example:\n\nJAVA_OPTS=\"$JAVA_OPTS -Djava.security.manager\n-Djava.security.policy==$PWD/server.policy -Djboss.home.dir=/path/to/JBOSS_HOME\n-Djboss.modules.policy-permissions=true\"\n\nIn domain.conf.bat file, ensure JAVA_OPTS flag is set.  The following is an\nexample:\n\nset \"JAVA_OPTS=%JAVA_OPTS% -Djava.security.manager\n-Djava.security.policy==/path/to/server.policy\n-Djboss.home.dir=/path/to/JBOSS_HOME -Djboss.modules.policy-permissions=true\"\n\nB. For a standalone installation, review the standalone.conf and\nstandalone.conf.bat files:\n\nJBOSS_HOME/bin/standalone.conf\nJBOSS_HOME/bin/standalone.conf.bat\n\nIn the standalone.conf file, ensure the JAVA_OPTS flag is set.  The following\nis an example:\n\nJAVA_OPTS=\"$JAVA_OPTS -Djava.security.manager\n-Djava.security.policy==$PWD/server.policy -Djboss.home.dir=$JBOSS_HOME\n-Djboss.modules.policy-permissions=true\"\n\nIn the standalone.conf.bat file, ensure the JAVA_OPTS flag is set.  The\nfollowing is an example:\n\nset \"JAVA_OPTS=%JAVA_OPTS% -Djava.security.manager\n-Djava.security.policy==/path/to/server.policy -Djboss.home.dir=%JBOSS_HOME%\n-Djboss.modules.policy-permissions=true\"\n\nIf the security manager is not enabled and a security policy not defined, this\nis a finding.",
        "fix": "For a domain installation:\nEnable the respective JAVA_OPTS flag in both the domain.conf and the\ndomain.conf.bat files.\n\nFor a standalone installation:\nEnable the respective JAVA_OPTS flag in both the standalone.conf and the\nstandalone.conf.bat files.",
        "fix_id": "F-68145r1_fix"
      },
      "code": "control 'V-62225' do\n  title \"The Java Security Manager must be enabled for the wildfly application\nserver.\"\n  desc  \"\n    The Java Security Manager is a java class that manages the external\nboundary of the Java Virtual Machine (JVM) sandbox, controlling how code\nexecuting within the JVM can interact with resources outside the JVM.\n\n    The Java Security Manager uses a security policy to determine whether a\ngiven action will be\n    permitted or denied.\n\n    To protect the host system, the Wildfly application server must be run within\nthe Java Security Manager.\n  \"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000033-AS-000024'\n  tag \"gid\": 'V-62225'\n  tag \"rid\": 'SV-76715r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000030'\n  tag \"cci\": ['CCI-000213']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"check\": \"To determine if the Java Security Manager is enabled for Wildfly,\nyou must examine the startup commands.  Wildfly can be configured to run in\neither \\\"domain\\\" or a \\\"standalone\\\" mode.  JBOSS_HOME is the variable home\ndirectory for the Wildfly installation.  Use relevant OS commands to navigate the\nfile system.\n\nA. For a managed domain installation, review the domain.conf and\ndomain.conf.bat files:\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nJBOSS_HOME/bin/domain.conf\nJBOSS_HOME/bin/domain.conf.bat\n\nIn domain.conf file, ensure there is a JAVA_OPTS flag that loads the Java\nSecurity Manager as well as a relevant Java Security policy.   The following is\nan example:\n\nJAVA_OPTS=\\\"$JAVA_OPTS -Djava.security.manager\n-Djava.security.policy==$PWD/server.policy -Djboss.home.dir=/path/to/JBOSS_HOME\n-Djboss.modules.policy-permissions=true\\\"\n\nIn domain.conf.bat file, ensure JAVA_OPTS flag is set.  The following is an\nexample:\n\nset \\\"JAVA_OPTS=%JAVA_OPTS% -Djava.security.manager\n-Djava.security.policy==/path/to/server.policy\n-Djboss.home.dir=/path/to/JBOSS_HOME -Djboss.modules.policy-permissions=true\\\"\n\nB. For a standalone installation, review the standalone.conf and\nstandalone.conf.bat files:\n\nJBOSS_HOME/bin/standalone.conf\nJBOSS_HOME/bin/standalone.conf.bat\n\nIn the standalone.conf file, ensure the JAVA_OPTS flag is set.  The following\nis an example:\n\nJAVA_OPTS=\\\"$JAVA_OPTS -Djava.security.manager\n-Djava.security.policy==$PWD/server.policy -Djboss.home.dir=$JBOSS_HOME\n-Djboss.modules.policy-permissions=true\\\"\n\nIn the standalone.conf.bat file, ensure the JAVA_OPTS flag is set.  The\nfollowing is an example:\n\nset \\\"JAVA_OPTS=%JAVA_OPTS% -Djava.security.manager\n-Djava.security.policy==/path/to/server.policy -Djboss.home.dir=%JBOSS_HOME%\n-Djboss.modules.policy-permissions=true\\\"\n\nIf the security manager is not enabled and a security policy not defined, this\nis a finding.\"\n  tag \"fix\": \"For a domain installation:\nEnable the respective JAVA_OPTS flag in both the domain.conf and the\ndomain.conf.bat files.\n\nFor a standalone installation:\nEnable the respective JAVA_OPTS flag in both the standalone.conf and the\nstandalone.conf.bat files.\"\n  tag \"fix_id\": 'F-68145r1_fix'\n\n  connect = input('connection')\n\n  describe file(\"#{ input('jboss_home') }/bin/standalone.conf\") do\n    its('content') { should_not match(%r{#JAVA_OPTS}) }\n  end\n  describe.one do\n    describe file(\"#{ input('jboss_home') }/bin/standalone.conf\") do\n      its('content') { should_not match(%r{JAVA_OPTS=\\s*}) }\n    end\n    describe file(\"#{ input('jboss_home') }/bin/standalone.conf\") do\n      its('content') { should_not match(%r{JAVA_OPTS=\"\\s*\"\\s*}) }\n    end\n    describe parse_config_file(\"#{ input('jboss_home') }/bin/standalone.conf\") do\n      its('SECMGR') { should match(%r{\"true\"}) }\n    end\n  end\n\n  describe.one do\n    describe file(\"#{ input('jboss_home') }/bin/standalone.conf.bat\") do\n      its('content') { should_not match(%r{#set\\s*\"JAVA_OPTS=\\s*}) }\n    end\n    describe file(\"#{ input('jboss_home') }/bin/standalone.conf.bat\") do\n      its('content') { should_not match(%r{set\\s*\"JAVA_OPTS=\\s*}) }\n    end\n    describe file(\"#{ input('jboss_home') }/bin/standalone.conf.bat\") do\n      its('content') { should include 'set \"SECMGR=true\"' }\n      its('content') { should_not include 'rem set \"SECMGR=true\"' }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62225.rb",
        "line": 1
      },
      "id": "V-62225"
    },
    {
      "title": "Wildfly management Interfaces must be integrated with a centralized\n  authentication mechanism that is configured to manage accounts according to DoD\n  policy.",
      "desc": "Wildfly EAP provides a security realm called ManagementRealm.  By default,\nthis realm uses the mgmt-users.properties file for authentication.  Using\nfile-based authentication does not allow the Wildfly server to be in compliance\nwith a wide range of user management requirements such as automatic disabling\nof inactive accounts as per DoD policy.  To address this issue, the management\ninterfaces used to manage the JBoss server must be associated with a security\nrealm that provides centralized authentication management.  Examples are AD or\nLDAP.\n\n    Management of user identifiers is not applicable to shared information\nsystem accounts (e.g., guest and anonymous accounts). It is commonly the case\nthat a user account is the name of an information system account associated\nwith an individual.",
      "descriptions": {
        "default": "Wildfly EAP provides a security realm called ManagementRealm.  By default,\nthis realm uses the mgmt-users.properties file for authentication.  Using\nfile-based authentication does not allow the Wildfly server to be in compliance\nwith a wide range of user management requirements such as automatic disabling\nof inactive accounts as per DoD policy.  To address this issue, the management\ninterfaces used to manage the JBoss server must be associated with a security\nrealm that provides centralized authentication management.  Examples are AD or\nLDAP.\n\n    Management of user identifiers is not applicable to shared information\nsystem accounts (e.g., guest and anonymous accounts). It is commonly the case\nthat a user account is the name of an information system account associated\nwith an individual."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000163-AS-000111",
        "gid": "V-62285",
        "rid": "SV-76775r1_rule",
        "stig_id": "JBOS-AS-000290",
        "cci": [
          "CCI-000795"
        ],
        "documentable": false,
        "nist": [
          "IA-4 e",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Obtain the list of management interfaces by running the command:\n  \"ls /core-service=management/management-interface\"\n\n  Identify the security realm used by each management interface configuration by\n  running the command:\n  \"ls /core-service=management/management-interface=<MANAGEMENT-INTERFACE-NAME>\"\n\n  Determine if the security realm assigned to the management interface uses LDAP\n  for authentication by running the command:\n  \"ls\n  /core-service=management/security-realm=<SECURITY_REALM_NAME>/authentication\"\n\n  If  the security realm assigned to the management interface does not utilize\n  LDAP for authentication, this is a finding.",
        "fix": "Follow steps in section 11.8 - Management Interface Security in\n  the\n  Wildfly-Administration_and_Configuration_Guide-en-US\n  document.\n\n  1. Create an outbound connection to the LDAP server.\n  2. Create an LDAP-enabled security realm.\n  3. Reference the new security domain in the Management Interface.",
        "fix_id": "F-68205r1_fix"
      },
      "code": "control 'V-62285' do\n  title \"Wildfly management Interfaces must be integrated with a centralized\n  authentication mechanism that is configured to manage accounts according to DoD\n  policy.\"\n  desc  \"\n    Wildfly EAP provides a security realm called ManagementRealm.  By default,\n  this realm uses the mgmt-users.properties file for authentication.  Using\n  file-based authentication does not allow the Wildfly server to be in compliance\n  with a wide range of user management requirements such as automatic disabling\n  of inactive accounts as per DoD policy.  To address this issue, the management\n  interfaces used to manage the JBoss server must be associated with a security\n  realm that provides centralized authentication management.  Examples are AD or\n  LDAP.\n\n      Management of user identifiers is not applicable to shared information\n  system accounts (e.g., guest and anonymous accounts). It is commonly the case\n  that a user account is the name of an information system account associated\n  with an individual.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000163-AS-000111'\n  tag \"gid\": 'V-62285'\n  tag \"rid\": 'SV-76775r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000290'\n  tag \"cci\": ['CCI-000795']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-4 e', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Obtain the list of management interfaces by running the command:\n  \\\"ls /core-service=management/management-interface\\\"\n\n  Identify the security realm used by each management interface configuration by\n  running the command:\n  \\\"ls /core-service=management/management-interface=<MANAGEMENT-INTERFACE-NAME>\\\"\n\n  Determine if the security realm assigned to the management interface uses LDAP\n  for authentication by running the command:\n  \\\"ls\n  /core-service=management/security-realm=<SECURITY_REALM_NAME>/authentication\\\"\n\n  If  the security realm assigned to the management interface does not utilize\n  LDAP for authentication, this is a finding.\"\n  tag \"fix\": \"Follow steps in section 11.8 - Management Interface Security in\n  the\n  Wildfly-Administration_and_Configuration_Guide-en-US\n  document.\n\n  1. Create an outbound connection to the LDAP server.\n  2. Create an LDAP-enabled security realm.\n  3. Reference the new security domain in the Management Interface.\"\n  tag \"fix_id\": 'F-68205r1_fix'\n\n  ldap = input('ldap')\n  connect = input('connection')\n\n  management_interfaces = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/management-interface=\").stdout.split(\"\\n\")\n\n  management_interfaces.each do |interface|\n\n    security_realms = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/security-realm=\").stdout.split(\"\\n\")\n    security_realms.each do |realm|\n      describe \"The security realm #{realm} authentication mechanism\" do\n        subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect}  --commands=ls\\\\ /core-service=management/security-realm=#{realm}/authentication\").stdout }\n        it { should match /ldap/ }\n      end\n    end\n  end\n  if management_interfaces.empty?\n    impact 0.0\n    describe 'The are no Wildfly accounts with the following roles: auditor, administrator, superuser, deployer, maintainer, monitor, or operator, therefore this control is not applicable' do\n      skip 'The are no Wildfly accounts with the following roles: auditor, administrator, superuser, deployer, maintainer, monitor, or operator, therefore this control is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62285.rb",
        "line": 1
      },
      "id": "V-62285"
    },
    {
      "title": "File permissions must be configured to protect log information from\nany type of unauthorized read access.",
      "desc": "If log data were to become compromised, then competent forensic analysis\nand discovery of the true source of potentially malicious system activity is\ndifficult, if not impossible, to achieve.\n\n    When not configured to use a centralized logging solution like a syslog\nserver, the Wildfly EAP application server writes log data to log files that are\nstored on the OS; appropriate file permissions must be used to restrict access.\n\n    Log information includes all information (e.g., log records, log settings,\ntransaction logs, and log reports) needed to successfully log information\nsystem activity. Application servers must protect log information from\nunauthorized access.",
      "descriptions": {
        "default": "If log data were to become compromised, then competent forensic analysis\nand discovery of the true source of potentially malicious system activity is\ndifficult, if not impossible, to achieve.\n\n    When not configured to use a centralized logging solution like a syslog\nserver, the Wildfly EAP application server writes log data to log files that are\nstored on the OS; appropriate file permissions must be used to restrict access.\n\n    Log information includes all information (e.g., log records, log settings,\ntransaction logs, and log reports) needed to successfully log information\nsystem activity. Application servers must protect log information from\nunauthorized access."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000118-AS-000078",
        "gid": "V-62251",
        "rid": "SV-76741r1_rule",
        "stig_id": "JBOS-AS-000165",
        "cci": [
          "CCI-000162"
        ],
        "documentable": false,
        "nist": [
          "AU-9",
          "Rev_4"
        ],
        "check": "Examine the log file locations and inspect the file\npermissions.  Interview the system admin to determine log file locations. The\ndefault location for the log files is:\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nStandalone configuration:\n$JBOSS_HOME;/standalone/log/\n\nManaged Domain configuration:\n$JBOSS_HOME;/domain/servers/<servername>/log/\n$JBOSS_HOME;/domain/log/\n\nReview the file permissions for the log file directories.  The method used for\nidentifying file permissions will be based upon the OS the EAP server is\ninstalled on.\n\nIdentify all users with file permissions that allow them to read log files.\n\nRequest documentation from system admin that identifies the users who are\nauthorized to read log files.\n\nIf unauthorized users are allowed to read log files, or if documentation that\nidentifies the users who are authorized to read log files is missing, this is a\nfinding.",
        "fix": "Configure the OS file permissions on the application server to\nprotect log information from unauthorized read access.",
        "fix_id": "F-68171r1_fix"
      },
      "code": "control 'V-62251' do\n  title \"File permissions must be configured to protect log information from\nany type of unauthorized read access.\"\n  desc  \"\n    If log data were to become compromised, then competent forensic analysis\nand discovery of the true source of potentially malicious system activity is\ndifficult, if not impossible, to achieve.\n\n    When not configured to use a centralized logging solution like a syslog\nserver, the Wildfly EAP application server writes log data to log files that are\nstored on the OS; appropriate file permissions must be used to restrict access.\n\n    Log information includes all information (e.g., log records, log settings,\ntransaction logs, and log reports) needed to successfully log information\nsystem activity. Application servers must protect log information from\nunauthorized access.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000118-AS-000078'\n  tag \"gid\": 'V-62251'\n  tag \"rid\": 'SV-76741r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000165'\n  tag \"cci\": ['CCI-000162']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-9', 'Rev_4']\n  tag \"check\": \"Examine the log file locations and inspect the file\npermissions.  Interview the system admin to determine log file locations. The\ndefault location for the log files is:\n\nThe $JBOSS_HOME default is /opt/bin/widfly\n\nStandalone configuration:\n$JBOSS_HOME;/standalone/log/\n\nManaged Domain configuration:\n$JBOSS_HOME;/domain/servers/<servername>/log/\n$JBOSS_HOME;/domain/log/\n\nReview the file permissions for the log file directories.  The method used for\nidentifying file permissions will be based upon the OS the EAP server is\ninstalled on.\n\nIdentify all users with file permissions that allow them to read log files.\n\nRequest documentation from system admin that identifies the users who are\nauthorized to read log files.\n\nIf unauthorized users are allowed to read log files, or if documentation that\nidentifies the users who are authorized to read log files is missing, this is a\nfinding.\"\n  tag \"fix\": \"Configure the OS file permissions on the application server to\nprotect log information from unauthorized read access.\"\n  tag \"fix_id\": 'F-68171r1_fix'\n\n  wildfly_group = input('wildfly_group')\n  wildly_owner = input('wildly_owner')\n  describe directory(\"#{ input('jboss_home') }/standalone/log\") do\n    its('owner') { should eq \"#{wildly_owner}\" }\n    its('group') { should eq \"#{wildfly_group}\" }\n    its('mode') { should cmp '0750' }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62251.rb",
        "line": 1
      },
      "id": "V-62251"
    },
    {
      "title": "Silent Authentication must be removed from the Default Application\nSecurity Realm.",
      "desc": "Silent Authentication is a configuration setting that allows local OS\nusers access to the Wildfly server and a wide range of operations without\nspecifically authenticating on an individual user basis.  By default $localuser\nis a Superuser. This introduces an integrity and availability vulnerability and\nviolates best practice requirements regarding accountability.",
      "descriptions": {
        "default": "Silent Authentication is a configuration setting that allows local OS\nusers access to the Wildfly server and a wide range of operations without\nspecifically authenticating on an individual user basis.  By default $localuser\nis a Superuser. This introduces an integrity and availability vulnerability and\nviolates best practice requirements regarding accountability."
      },
      "impact": 0.7,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000033-AS-000024",
        "gid": "V-62221",
        "rid": "SV-76711r1_rule",
        "stig_id": "JBOS-AS-000045",
        "cci": [
          "CCI-000213"
        ],
        "documentable": false,
        "nist": [
          "AC-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nVerify that Silent Authentication has been removed from the default Application\nsecurity realm.\nRun the following command.\n\nFor standalone servers, run the following command:\n\"ls /core-service=management/securityrealm=ApplicationRealm/authentication\"\n\nFor managed domain installations, run the following command:\n\"ls\n/host=HOST_NAME/core-service=management/securityrealm=ApplicationRealm/authentication\"\n\nIf \"local\" is returned, this is a finding.",
        "fix": "Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nRemove the local element from the Application Realm.\nFor standalone servers, run the following command:\n/core-service=management/securityrealm=\nApplicationRealm/authentication=local:remove\n\nFor managed domain installations, run the following command:\n/host=HOST_NAME/core-service=management/securityrealm=\nApplicationRealm/authentication=local:remove",
        "fix_id": "F-68141r1_fix"
      },
      "code": "control 'V-62221' do\n  title \"Silent Authentication must be removed from the Default Application\nSecurity Realm.\"\n  desc  \"Silent Authentication is a configuration setting that allows local OS\nusers access to the Wildfly server and a wide range of operations without\nspecifically authenticating on an individual user basis.  By default $localuser\nis a Superuser. This introduces an integrity and availability vulnerability and\nviolates best practice requirements regarding accountability.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000033-AS-000024'\n  tag \"gid\": 'V-62221'\n  tag \"rid\": 'SV-76711r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000045'\n  tag \"cci\": ['CCI-000213']\n  tag \"documentable\": false\n  tag \"nist\": ['AC-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\nThe $JBOSS_HOME default is /opt/bin/widfly\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nVerify that Silent Authentication has been removed from the default Application\nsecurity realm.\nRun the following command.\n\nFor standalone servers, run the following command:\n\\\"ls /core-service=management/securityrealm=ApplicationRealm/authentication\\\"\n\nFor managed domain installations, run the following command:\n\\\"ls\n/host=HOST_NAME/core-service=management/securityrealm=ApplicationRealm/authentication\\\"\n\nIf \\\"local\\\" is returned, this is a finding.\"\n  tag \"fix\": \"Log on to the OS of the Wildfly server with OS permissions that\nallow access to Wildfly.\nUsing the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\nRun the jboss-cli script.\nConnect to the server and authenticate.\n\nRemove the local element from the Application Realm.\nFor standalone servers, run the following command:\n/core-service=management/securityrealm=\nApplicationRealm/authentication=local:remove\n\nFor managed domain installations, run the following command:\n/host=HOST_NAME/core-service=management/securityrealm=\nApplicationRealm/authentication=local:remove\"\n  tag \"fix_id\": 'F-68141r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly default application security realm silent authentication' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/security-realm=ApplicationRealm/authentication\").stdout }\n    it { should_not match(%r{local}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62221.rb",
        "line": 1
      },
      "id": "V-62221"
    },
    {
      "title": "Wildfly must be configured to generate log records when\n  successful/unsuccessful logon attempts occur.",
      "desc": "Logging the access to the application server allows the system\nadministrators to monitor user accounts.  By logging successful/unsuccessful\nlogons, the system administrator can determine if an account is compromised\n(e.g., frequent logons) or is in the process of being compromised (e.g.,\nfrequent failed logons) and can take actions to thwart the attack.\n\n    Logging successful logons can also be used to determine accounts that are\nno longer in use.",
      "descriptions": {
        "default": "Logging the access to the application server allows the system\nadministrators to monitor user accounts.  By logging successful/unsuccessful\nlogons, the system administrator can determine if an account is compromised\n(e.g., frequent logons) or is in the process of being compromised (e.g.,\nfrequent failed logons) and can take actions to thwart the attack.\n\n    Logging successful logons can also be used to determine accounts that are\nno longer in use."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000503-AS-000228",
        "gid": "V-62333",
        "rid": "SV-76823r1_rule",
        "stig_id": "JBOS-AS-000700",
        "cci": [
          "CCI-000172"
        ],
        "documentable": false,
        "nist": [
          "AU-12 c",
          "Rev_4"
        ],
        "check": "Log on to the OS of the JBoss server with OS permissions that\n  allow access to JBoss.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface.\n  Connect to the server by typing \"connect\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n\n  For a Standalone configuration:\n  \"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"",
        "fix_id": "F-68253r1_fix"
      },
      "code": "control 'V-62333' do\n  title \"Wildfly must be configured to generate log records when\n  successful/unsuccessful logon attempts occur.\"\n  desc  \"\n    Logging the access to the application server allows the system\n  administrators to monitor user accounts.  By logging successful/unsuccessful\n  logons, the system administrator can determine if an account is compromised\n  (e.g., frequent logons) or is in the process of being compromised (e.g.,\n  frequent failed logons) and can take actions to thwart the attack.\n\n      Logging successful logons can also be used to determine accounts that are\n  no longer in use.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000503-AS-000228'\n  tag \"gid\": 'V-62333'\n  tag \"rid\": 'SV-76823r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000700'\n  tag \"cci\": ['CCI-000172']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-12 c', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the JBoss server with OS permissions that\n  allow access to JBoss.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n  Run the command:\n\n  For a Managed Domain configuration:\n  \\\"ls\n  host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"ls\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface.\n  Connect to the server by typing \\\"connect\\\", authenticate as a user in the\n  Superuser role, and run the following command:\n\n  For a Managed Domain configuration:\n  \\\"host=master/server/<SERVERNAME>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\n\n  For a Standalone configuration:\n  \\\"/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\\\"\"\n  tag \"fix_id\": 'F-68253r1_fix'\n\n  connect = input('connection')\n\n  describe 'The wildfly setting: generate log records when successful/unsuccessful logon attempts occur' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62333.rb",
        "line": 1
      },
      "id": "V-62333"
    },
    {
      "title": "The Wildfly Server must be configured to utilize a centralized\n  authentication mechanism such as AD or LDAP.",
      "desc": "To assure accountability and prevent unauthorized access, application\nserver users must be uniquely identified and authenticated.  This is typically\naccomplished via the use of a user store that is either local (OS-based) or\ncentralized (Active Directory/LDAP) in nature.  It should be noted that Wildfly\ndoes not specifically mention Active Directory since AD is LDAP aware.\n\n    To ensure accountability and prevent unauthorized access, the JBoss Server\nmust be configured to utilize a centralized authentication mechanism.",
      "descriptions": {
        "default": "To assure accountability and prevent unauthorized access, application\nserver users must be uniquely identified and authenticated.  This is typically\naccomplished via the use of a user store that is either local (OS-based) or\ncentralized (Active Directory/LDAP) in nature.  It should be noted that Wildfly\ndoes not specifically mention Active Directory since AD is LDAP aware.\n\n    To ensure accountability and prevent unauthorized access, the JBoss Server\nmust be configured to utilize a centralized authentication mechanism."
      },
      "impact": 0,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000148-AS-000101",
        "gid": "V-62277",
        "rid": "SV-76767r1_rule",
        "stig_id": "JBOS-AS-000260",
        "cci": [
          "CCI-000764"
        ],
        "documentable": false,
        "nist": [
          "IA-2",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  To obtain the list of security realms run the command:\n  \"ls /core-service=management/security-realm=\"\n\n  Review each security realm using the command:\n  \"ls\n  /core-service=management/security-realm=<SECURITY_REALM_NAME>/authentication\"\n\n  If this command does not return a security realm that uses LDAP for\n  authentication, this is a finding.",
        "fix": "Follow steps in section 11.8 - Management Interface Security in\n  the\n  Wildfly_Enterprise_Application_Administration_and_Configuration_Guide-en-US\n  document.\n\n  1. Create an outbound connection to the LDAP server.\n  2. Create an LDAP-enabled security realm.\n  3. Reference the new security domain in the Management Interface.",
        "fix_id": "F-68197r1_fix"
      },
      "code": "control 'V-62277' do\n  title \"The Wildfly Server must be configured to utilize a centralized\n  authentication mechanism such as AD or LDAP.\"\n  desc  \"\n    To assure accountability and prevent unauthorized access, application\n  server users must be uniquely identified and authenticated.  This is typically\n  accomplished via the use of a user store that is either local (OS-based) or\n  centralized (Active Directory/LDAP) in nature.  It should be noted that Wildfly\n  does not specifically mention Active Directory since AD is LDAP aware.\n\n      To ensure accountability and prevent unauthorized access, the JBoss Server\n  must be configured to utilize a centralized authentication mechanism.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000148-AS-000101'\n  tag \"gid\": 'V-62277'\n  tag \"rid\": 'SV-76767r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000260'\n  tag \"cci\": ['CCI-000764']\n  tag \"documentable\": false\n  tag \"nist\": ['IA-2', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n\n  To obtain the list of security realms run the command:\n  \\\"ls /core-service=management/security-realm=\\\"\n\n  Review each security realm using the command:\n  \\\"ls\n  /core-service=management/security-realm=<SECURITY_REALM_NAME>/authentication\\\"\n\n  If this command does not return a security realm that uses LDAP for\n  authentication, this is a finding.\"\n  tag \"fix\": \"Follow steps in section 11.8 - Management Interface Security in\n  the\n  Wildfly_Enterprise_Application_Administration_and_Configuration_Guide-en-US\n  document.\n\n  1. Create an outbound connection to the LDAP server.\n  2. Create an LDAP-enabled security realm.\n  3. Reference the new security domain in the Management Interface.\"\n  tag \"fix_id\": 'F-68197r1_fix'\n\n  connect = input('connection')\n\n  get_security_realms = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/security-realm=\").stdout.split(\"\\n\")\n\n  get_security_realms.each do |security_realm|\n    describe \"The security realm #{security_realm} authentication mechanism\" do\n      subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/security-realm=#{security_realm}/authentication\").stdout }\n      it { should include 'ldap' }\n    end\n  end\n  if get_security_realms.empty?\n    impact 0.0\n    describe 'There are no wildfly security realms configured, therefore this controls is not applicable' do\n      skip 'There are no wildfly security realms configured, therefore this controls is not applicable'\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62277.rb",
        "line": 1
      },
      "id": "V-62277"
    },
    {
      "title": "Wildfly must be configured to produce log records that establish which\nhosted application triggered the events.",
      "desc": "Application server logging capability is critical for accurate forensic\nanalysis.  Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    By default, no web logging is enabled in Wildfly.  Logging can be configured\nper web application or by virtual server.  If web application logging is not\nset up, application activity will not be logged.\n\n    Ascertaining the correct location or process within the application server\nwhere the events occurred is important during forensic analysis.  To determine\nwhere an event occurred, the log data must contain data containing the\napplication identity.",
      "descriptions": {
        "default": "Application server logging capability is critical for accurate forensic\nanalysis.  Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    By default, no web logging is enabled in Wildfly.  Logging can be configured\nper web application or by virtual server.  If web application logging is not\nset up, application activity will not be logged.\n\n    Ascertaining the correct location or process within the application server\nwhere the events occurred is important during forensic analysis.  To determine\nwhere an event occurred, the log data must contain data containing the\napplication identity."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000097-AS-000060",
        "gid": "V-62243",
        "rid": "SV-76733r1_rule",
        "stig_id": "JBOS-AS-000120",
        "cci": [
          "CCI-000132"
        ],
        "documentable": false,
        "nist": [
          "AU-3",
          "Rev_4"
        ],
        "check": "Application logs are a configurable variable.  Interview the\nsystem admin, and have them identify the applications that are running on the\napplication server.  Have the system admin identify the log files/location\nwhere application activity is stored.\n\nReview the log files to ensure each application is uniquely identified within\nthe logs or each application has its own unique log file.\n\nGenerate application activity by either authenticating to the application or\ngenerating an auditable event, and ensure the application activity is recorded\nin the log file.  Recently time stamped application events are suitable\nevidence of compliance.\n\nIf the log records do not indicate which application hosted on the application\nserver generated the event, or if no events are recorded related to application\nactivity, this is a finding.",
        "fix": "Configure log formatter to audit application activity so\nindividual application activity can be identified.",
        "fix_id": "F-68163r1_fix"
      },
      "code": "control 'V-62243' do\n  title \"Wildfly must be configured to produce log records that establish which\nhosted application triggered the events.\"\n  desc  \"\n    Application server logging capability is critical for accurate forensic\nanalysis.  Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    By default, no web logging is enabled in Wildfly.  Logging can be configured\nper web application or by virtual server.  If web application logging is not\nset up, application activity will not be logged.\n\n    Ascertaining the correct location or process within the application server\nwhere the events occurred is important during forensic analysis.  To determine\nwhere an event occurred, the log data must contain data containing the\napplication identity.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000097-AS-000060'\n  tag \"gid\": 'V-62243'\n  tag \"rid\": 'SV-76733r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000120'\n  tag \"cci\": ['CCI-000132']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"check\": \"Application logs are a configurable variable.  Interview the\nsystem admin, and have them identify the applications that are running on the\napplication server.  Have the system admin identify the log files/location\nwhere application activity is stored.\n\nReview the log files to ensure each application is uniquely identified within\nthe logs or each application has its own unique log file.\n\nGenerate application activity by either authenticating to the application or\ngenerating an auditable event, and ensure the application activity is recorded\nin the log file.  Recently time stamped application events are suitable\nevidence of compliance.\n\nIf the log records do not indicate which application hosted on the application\nserver generated the event, or if no events are recorded related to application\nactivity, this is a finding.\"\n  tag \"fix\": \"Configure log formatter to audit application activity so\nindividual application activity can be identified.\"\n  tag \"fix_id\": 'F-68163r1_fix'\n  file = command('find / -name \"log4j.properties\" 2>/dev/null | grep -v example').stdout\n\n  if (input('disable_slow_controls'))\n    describe \"This control is a long running control and is disabled, for full accredidation you need to enable this control.\" do\n      skip \"This control is a long running control and is disabled, for full accredidation you need to enable this control.\"\n    end\n  else\n    describe 'The number of log4j.properties files found' do\n      subject { command('find / -name \"log4j.properties\" 2>/dev/null | grep -v example | wc -l').stdout }\n      it { should_not match /0/ }\n    end\n\n    describe 'The number of words in the log4j.properties file' do\n      subject { command(\"wc -c #{file}\").stdout }\n      it { should_not match /0/ }\n    end\n  end\nend",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62243.rb",
        "line": 1
      },
      "id": "V-62243"
    },
    {
      "title": "Wildfly ROOT logger must be configured to utilize the appropriate\n  logging level.",
      "desc": "Information system logging capability is critical for accurate forensic\nanalysis. Log record content that may be necessary to satisfy the requirement\nof this control includes: time stamps, source and destination addresses,\nuser/process identifiers, event descriptions, success/fail indications,\nfilenames involved, and access control or flow control rules invoked.\n\n    The Wildfly application server ROOT logger captures all messages not captured\nby a log category and sends them to a log handler (FILE, CONSOLE, SYSLOG,\nETC.).  By default, the ROOT logger level is set to INFO, which is a value of\n800.  This will capture most events adequately.  Any level numerically higher\nthan INFO (> 800) records less data and may result in an insufficient amount of\ninformation being logged by the ROOT logger.  This can result in failed\nforensic investigations.  The ROOT logger level must be INFO level or lower to\nprovide adequate log information.",
      "descriptions": {
        "default": "Information system logging capability is critical for accurate forensic\nanalysis. Log record content that may be necessary to satisfy the requirement\nof this control includes: time stamps, source and destination addresses,\nuser/process identifiers, event descriptions, success/fail indications,\nfilenames involved, and access control or flow control rules invoked.\n\n    The Wildfly application server ROOT logger captures all messages not captured\nby a log category and sends them to a log handler (FILE, CONSOLE, SYSLOG,\nETC.).  By default, the ROOT logger level is set to INFO, which is a value of\n800.  This will capture most events adequately.  Any level numerically higher\nthan INFO (> 800) records less data and may result in an insufficient amount of\ninformation being logged by the ROOT logger.  This can result in failed\nforensic investigations.  The ROOT logger level must be INFO level or lower to\nprovide adequate log information."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000100-AS-000063",
        "gid": "V-62249",
        "rid": "SV-76739r1_rule",
        "stig_id": "JBOS-AS-000135",
        "cci": [
          "CCI-001487"
        ],
        "documentable": false,
        "nist": [
          "AU-3",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n\n  The PROFILE NAMEs included with a Managed Domain Wildfly configuration are:\n  \"default\", \"full\", \"full-ha\" or \"ha\"\n  For a Managed Domain configuration, you must check each profile name:\n\n  For each PROFILE NAME, run the command:\n  \"ls /profile=<PROFILE NAME>/subsystem=logging/root-logger=ROOT\"\n\n  If ROOT logger \"level\" is not set to INFO, DEBUG or TRACE\n  This is a finding for each <PROFILE NAME> (default, full, full-ha and ha)\n\n  For a Standalone configuration:\n  \"ls /subsystem=logging/root-logger=ROOT\"\n\n  If \"level\" not = INFO, DEBUG or TRACE, this is a finding.",
        "fix": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n\n  The PROFILE NAMEs included with a Managed Domain Wildfly configuration are:\n  \"default\", \"full\", \"full-ha\" or \"ha\"\n  For a Managed Domain configuration, you must check each profile name:\n\n  For each PROFILE NAME, run the command:\n  \"/profile=<PROFILE\n  NAME>/subsystem=logging/root-logger=ROOT:write-attribute(name=level,value=INFO)\"\n\n  For a Standalone configuration:\n  \"/subsystem=logging/root-logger=ROOT:write-attribute(name=level,value=INFO)\"",
        "fix_id": "F-68169r1_fix"
      },
      "code": "control 'V-62249' do\n  title \"Wildfly ROOT logger must be configured to utilize the appropriate\n  logging level.\"\n  desc  \"\n    Information system logging capability is critical for accurate forensic\n  analysis. Log record content that may be necessary to satisfy the requirement\n  of this control includes: time stamps, source and destination addresses,\n  user/process identifiers, event descriptions, success/fail indications,\n  filenames involved, and access control or flow control rules invoked.\n\n      The Wildfly application server ROOT logger captures all messages not captured\n  by a log category and sends them to a log handler (FILE, CONSOLE, SYSLOG,\n  ETC.).  By default, the ROOT logger level is set to INFO, which is a value of\n  800.  This will capture most events adequately.  Any level numerically higher\n  than INFO (> 800) records less data and may result in an insufficient amount of\n  information being logged by the ROOT logger.  This can result in failed\n  forensic investigations.  The ROOT logger level must be INFO level or lower to\n  provide adequate log information.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000100-AS-000063'\n  tag \"gid\": 'V-62249'\n  tag \"rid\": 'SV-76739r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000135'\n  tag \"cci\": ['CCI-001487']\n  tag \"documentable\": false\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n\n  The PROFILE NAMEs included with a Managed Domain Wildfly configuration are:\n  \\\"default\\\", \\\"full\\\", \\\"full-ha\\\" or \\\"ha\\\"\n  For a Managed Domain configuration, you must check each profile name:\n\n  For each PROFILE NAME, run the command:\n  \\\"ls /profile=<PROFILE NAME>/subsystem=logging/root-logger=ROOT\\\"\n\n  If ROOT logger \\\"level\\\" is not set to INFO, DEBUG or TRACE\n  This is a finding for each <PROFILE NAME> (default, full, full-ha and ha)\n\n  For a Standalone configuration:\n  \\\"ls /subsystem=logging/root-logger=ROOT\\\"\n\n  If \\\"level\\\" not = INFO, DEBUG or TRACE, this is a finding.\"\n  tag \"fix\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n  Run the jboss-cli script to start the Command Line Interface (CLI).\n  Connect to the server and authenticate.\n\n  The PROFILE NAMEs included with a Managed Domain Wildfly configuration are:\n  \\\"default\\\", \\\"full\\\", \\\"full-ha\\\" or \\\"ha\\\"\n  For a Managed Domain configuration, you must check each profile name:\n\n  For each PROFILE NAME, run the command:\n  \\\"/profile=<PROFILE\n  NAME>/subsystem=logging/root-logger=ROOT:write-attribute(name=level,value=INFO)\\\"\n\n  For a Standalone configuration:\n  \\\"/subsystem=logging/root-logger=ROOT:write-attribute(name=level,value=INFO)\\\"\"\n  tag \"fix_id\": 'F-68169r1_fix'\n\n  connect = input('connection')\n\n  get_logging_level = command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /subsystem=logging/root-logger=ROOT\").stdout\n\n  describe.one do\n    describe 'The wildfly root logger level' do\n      subject { get_logging_level }\n      it { should match(%r{level=INFO}) }\n    end\n    describe 'The wildfly root logger level' do\n      subject { get_logging_level }\n      it { should match(%r{level=DEBUG}) }\n    end\n    describe 'The wildfly root logger level' do\n      subject { get_logging_level }\n      it { should match(%r{level=TRACE}) }\n    end\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62249.rb",
        "line": 1
      },
      "id": "V-62249"
    },
    {
      "title": "Wildfly QuickStarts must be removed.",
      "desc": "Wildfly QuickStarts are demo applications that can be deployed quickly.\nDemo applications are not written with security in mind and often open new\nattack vectors.  QuickStarts must be removed.",
      "descriptions": {
        "default": "Wildfly QuickStarts are demo applications that can be deployed quickly.\nDemo applications are not written with security in mind and often open new\nattack vectors.  QuickStarts must be removed."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000141-AS-000095",
        "gid": "V-62267",
        "rid": "SV-76757r1_rule",
        "stig_id": "JBOS-AS-000235",
        "cci": [
          "CCI-000381"
        ],
        "documentable": false,
        "nist": [
          "CM-7 a",
          "Rev_4"
        ],
        "check": "Examine the $JBOSS_HOME; folder.  If a\n  wildfly quickstarts folder exits, this is a finding.",
        "fix": "Delete the QuickStarts folder.",
        "fix_id": "F-68187r1_fix"
      },
      "code": "control 'V-62267' do\n  title \"Wildfly QuickStarts must be removed.\"\n  desc  \"Wildfly QuickStarts are demo applications that can be deployed quickly.\nDemo applications are not written with security in mind and often open new\nattack vectors.  QuickStarts must be removed.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-AS-000095'\n  tag \"gid\": 'V-62267'\n  tag \"rid\": 'SV-76757r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000235'\n  tag \"cci\": ['CCI-000381']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"check\": \"Examine the $JBOSS_HOME; folder.  If a\n  wildfly quickstarts folder exits, this is a finding.\"\n  tag \"fix\": \"Delete the QuickStarts folder.\"\n  tag \"fix_id\": 'F-68187r1_fix'\n  describe 'The wildfly quickstart files found' do\n    subject { command(\"find #{ input('jboss_home') }/ -type d | grep quickstarts\").stdout }\n    it { should match(%r{}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62267.rb",
        "line": 1
      },
      "id": "V-62267"
    },
    {
      "title": "Production Wildfly servers must log when failed application deployments\n  occur.",
      "desc": "Without logging the enforcement of access restrictions against changes to\nthe application server configuration, it will be difficult to identify\nattempted attacks, and a log trail will not be available for forensic\ninvestigation for after-the-fact actions.  Configuration changes may occur to\nany of the modules within the application server through the management\ninterface, but logging of actions to the configuration of a module outside the\napplication server is not logged.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Log items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact.",
      "descriptions": {
        "default": "Without logging the enforcement of access restrictions against changes to\nthe application server configuration, it will be difficult to identify\nattempted attacks, and a log trail will not be available for forensic\ninvestigation for after-the-fact actions.  Configuration changes may occur to\nany of the modules within the application server through the management\ninterface, but logging of actions to the configuration of a module outside the\napplication server is not logged.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Log items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "gtitle": "SRG-APP-000381-AS-000089",
        "gid": "V-62313",
        "rid": "SV-76803r1_rule",
        "stig_id": "JBOS-AS-000550",
        "cci": [
          "CCI-001814"
        ],
        "documentable": false,
        "nist": [
          "CM-5 (1)",
          "Rev_4"
        ],
        "check": "Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  ls /core-service=management/access=audit/logger=audit-log\n\n  If \"enabled\" = false, this is a finding.",
        "fix": "Launch the jboss-cli management interface substituting standalone\n  or domain for <CONFIG> based upon the server installation.\n\n  $JBOSS_HOME;/<CONFIG>/bin/jboss-cli\n\n  connect to the server and run the following command:\n\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)",
        "fix_id": "F-68233r1_fix"
      },
      "code": "control 'V-62313' do\n  title \"Production Wildfly servers must log when failed application deployments\n  occur.\"\n  desc  \"\n  Without logging the enforcement of access restrictions against changes to\n  the application server configuration, it will be difficult to identify\n  attempted attacks, and a log trail will not be available for forensic\n  investigation for after-the-fact actions.  Configuration changes may occur to\n  any of the modules within the application server through the management\n  interface, but logging of actions to the configuration of a module outside the\n  application server is not logged.\n\n      Enforcement actions are the methods or mechanisms used to prevent\n  unauthorized changes to configuration settings. Enforcement action methods may\n  be as simple as denying access to a file based on the application of file\n  permissions (access restriction). Log items may consist of lists of actions\n  blocked by access restrictions or changes identified after the fact.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000381-AS-000089'\n  tag \"gid\": 'V-62313'\n  tag \"rid\": 'SV-76803r1_rule'\n  tag \"stig_id\": 'JBOS-AS-000550'\n  tag \"cci\": ['CCI-001814']\n  tag \"documentable\": false\n  tag \"nist\": ['CM-5 (1)', 'Rev_4']\n  tag \"check\": \"Log on to the OS of the Wildfly server with OS permissions that\n  allow access to Wildfly.\n  Using the relevant OS commands and syntax, cd to the $JBOSS_HOME;/bin/ folder.\n\n  The $JBOSS_HOME default is /opt/bin/widfly\n\n  Run the jboss-cli script.\n  Connect to the server and authenticate.\n  Run the command:\n\n  ls /core-service=management/access=audit/logger=audit-log\n\n  If \\\"enabled\\\" = false, this is a finding.\"\n  tag \"fix\": \"Launch the jboss-cli management interface substituting standalone\n  or domain for <CONFIG> based upon the server installation.\n\n  $JBOSS_HOME;/<CONFIG>/bin/jboss-cli\n\n  connect to the server and run the following command:\n\n  /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)\"\n  tag \"fix_id\": 'F-68233r1_fix'\n\n  connect = input('connection')\n\n  describe 'The Wildfly server setting: log when failed application deployments occur' do\n    subject { command(\"/bin/sh #{ input('jboss_home') }/bin/jboss-cli.sh #{connect} --commands=ls\\\\ /core-service=management/access=audit/logger=audit-log\").stdout }\n    it { should_not match(%r{enabled=false}) }\n  end\nend\n",
      "source_location": {
        "ref": "./Red Hat Jboss EAP 6.3 STIG/controls/V-62313.rb",
        "line": 1
      },
      "id": "V-62313"
    }
  ],
  "groups": [
    {
      "title": null,
      "controls": [
        "V-62321"
      ],
      "id": "controls/V-62321.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62323"
      ],
      "id": "controls/V-62323.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62341"
      ],
      "id": "controls/V-62341.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62289"
      ],
      "id": "controls/V-62289.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62309"
      ],
      "id": "controls/V-62309.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62215"
      ],
      "id": "controls/V-62215.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62257"
      ],
      "id": "controls/V-62257.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62325"
      ],
      "id": "controls/V-62325.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62273"
      ],
      "id": "controls/V-62273.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62281"
      ],
      "id": "controls/V-62281.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62293"
      ],
      "id": "controls/V-62293.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62241"
      ],
      "id": "controls/V-62241.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62301"
      ],
      "id": "controls/V-62301.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62261"
      ],
      "id": "controls/V-62261.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62317"
      ],
      "id": "controls/V-62317.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62231"
      ],
      "id": "controls/V-62231.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62291"
      ],
      "id": "controls/V-62291.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62287"
      ],
      "id": "controls/V-62287.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62305"
      ],
      "id": "controls/V-62305.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62271"
      ],
      "id": "controls/V-62271.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62279"
      ],
      "id": "controls/V-62279.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62219"
      ],
      "id": "controls/V-62219.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62295"
      ],
      "id": "controls/V-62295.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62329"
      ],
      "id": "controls/V-62329.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62227"
      ],
      "id": "controls/V-62227.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62253"
      ],
      "id": "controls/V-62253.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62311"
      ],
      "id": "controls/V-62311.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62245"
      ],
      "id": "controls/V-62245.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62327"
      ],
      "id": "controls/V-62327.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62307"
      ],
      "id": "controls/V-62307.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62073"
      ],
      "id": "controls/V-62073.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62319"
      ],
      "id": "controls/V-62319.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62339"
      ],
      "id": "controls/V-62339.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62255"
      ],
      "id": "controls/V-62255.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62217"
      ],
      "id": "controls/V-62217.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62229"
      ],
      "id": "controls/V-62229.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62335"
      ],
      "id": "controls/V-62335.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62235"
      ],
      "id": "controls/V-62235.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62331"
      ],
      "id": "controls/V-62331.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62299"
      ],
      "id": "controls/V-62299.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62239"
      ],
      "id": "controls/V-62239.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62223"
      ],
      "id": "controls/V-62223.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62237"
      ],
      "id": "controls/V-62237.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62275"
      ],
      "id": "controls/V-62275.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62283"
      ],
      "id": "controls/V-62283.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62263"
      ],
      "id": "controls/V-62263.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62303"
      ],
      "id": "controls/V-62303.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62297"
      ],
      "id": "controls/V-62297.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62345"
      ],
      "id": "controls/V-62345.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62233"
      ],
      "id": "controls/V-62233.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62265"
      ],
      "id": "controls/V-62265.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62343"
      ],
      "id": "controls/V-62343.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62269"
      ],
      "id": "controls/V-62269.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62337"
      ],
      "id": "controls/V-62337.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62247"
      ],
      "id": "controls/V-62247.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62259"
      ],
      "id": "controls/V-62259.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62315"
      ],
      "id": "controls/V-62315.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62225"
      ],
      "id": "controls/V-62225.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62285"
      ],
      "id": "controls/V-62285.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62251"
      ],
      "id": "controls/V-62251.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62221"
      ],
      "id": "controls/V-62221.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62333"
      ],
      "id": "controls/V-62333.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62277"
      ],
      "id": "controls/V-62277.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62243"
      ],
      "id": "controls/V-62243.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62249"
      ],
      "id": "controls/V-62249.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62267"
      ],
      "id": "controls/V-62267.rb"
    },
    {
      "title": null,
      "controls": [
        "V-62313"
      ],
      "id": "controls/V-62313.rb"
    }
  ],
  "sha256": "b9afbc3bc88efdb3027487daf658d017a2d314e53000b42e11e52953c12e2243",
  "status_message": "",
  "status": "loaded",
  "generator": {
    "name": "inspec",
    "version": "4.33.1"
  }
}