<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{exportType}} Report</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/tw-elements/dist/css/tw-elements.min.css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
      .bg-success {
        --tw-bg-opacity: 1;
        background-color: rgb(76 176 79 / var(--tw-bg-opacity));
      }
      .bg-danger {
        --tw-bg-opacity: 1;
        background-color: rgb(243 67 53 / var(--tw-bg-opacity));
      }
      .bg-info {
        --tw-bg-opacity: 1;
        background-color: rgb(3 169 244 / var(--tw-bg-opacity));
      }
      .bg-warning {
        --tw-bg-opacity: 1;
        background-color: rgb(254 153 0 / var(--tw-bg-opacity));
      }
      .bg-error {
        --tw-bg-opacity: 1;
        background-color: rgb(121 134 203 / var(--tw-bg-opacity));
      }
      .bg-compliance-yellow {
        --tw-bg-opacity: 1;
        background-color: rgb(255 235 59 / var(--tw-bg-opacity));
      }
      .bg-compliance-orange {
        --tw-bg-opacity: 1;
        background-color: rgb(255 87 34 / var(--tw-bg-opacity));
      }
    </style>
  </head>

  <body>
    <!-- Stickied navbar -->
    <nav class="d-flex sticky top-0 z-10 bg-gray-100 px-3 py-3 print:hidden">
      <!-- Heimdall report -->
      <a href="#" class="px-3 py-2 text-lg font-medium">Heimdall Report</a>
      <!-- Profile info link -->
      <a href="#profileInfo" class="px-3 py-2 text-sm" aria-current="page"
        >Profile Info</a
      >
      <!-- Control sets dropdown menu -->
      {{#showControlSets}}
      <div class="inline-block" data-te-dropdown-ref>
        <!-- Button def -->
        <button
          type="button"
          class="inline-flex px-3 py-2 text-sm"
          data-te-dropdown-toggle-ref
          href="#controlSetsList"
          role="button"
          aria-controls="controlSetsList"
          aria-expanded="false"
          aria-label="Toggle navigation dropdown"
        >
          Control Sets
          <svg
            class="-mr-1 h-5 w-5 text-gray-400"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              fill-rule="evenodd"
              d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
              clip-rule="evenodd"
            />
          </svg>
        </button>
        <!-- Menu def -->
        <div
          class="z-10 mt-2 hidden w-56 bg-white py-1 shadow-lg [&[data-te-dropdown-show]]:block"
          id="controlSetsList"
          data-te-dropdown-menu-ref
          aria-labelledby="controlSetsList"
        >
          <ul>
            <!-- Generate links for every control set -->
            {{#controlSets}}
            <li>
              <a
                href="#{{fileID}}"
                data-te-dropdown-item-ref
                class="block px-4 py-2 text-sm"
                >{{filename}}</a
              >
            </li>
            {{/controlSets}}
          </ul>
        </div>
      </div>
      <!-- Toggle control set accordion collapse state -->
      <button
        class="px-3 py-2 text-sm"
        type="button"
        data-te-collapse-init
        data-te-target=".multi-collapse-outer"
        aria-expanded="true"
        aria-controls="control-accordion-body"
      >
        Collapse/Expand Result Sets
      </button>
      <!-- Toggle control accordion collapse state -->
      <button
        class="px-3 py-2 text-sm"
        type="button"
        data-te-collapse-init
        data-te-target=".multi-collapse-inner"
        aria-expanded="true"
        aria-controls="control-accordion-body"
      >
        Collapse/Expand Results
      </button>
      {{/showControlSets}}
    </nav>

    <!-- Profile info card -->
    <div class="px-4 py-6" id="profileInfo">
      <div
        class="max-w-full rounded-xl border border-gray-300 bg-gray-100 px-4 py-2 print:border-black print:bg-white"
      >
        <h5 class="mb-2 text-xl"><strong>Profile Info</strong></h5>
        <div class="grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4">
          <!-- Generate an info report for every profile -->
          {{#files}}
          <div class="mx-2 my-2 break-words">
            <span>
              <strong>Filename:</strong> {{filename}}
              <br />
              <strong>Tool Version:</strong> {{toolVersion}}
              <br />
              <strong>Platform:</strong> {{platform}}
              <br />
              <strong>Duration:</strong> {{duration}}
            </span>
          </div>
          {{/files}}
        </div>
      </div>
    </div>

    <!-- Profile status card -->
    <div class="px-4 pb-6">
      <div
        class="max-w-full rounded-xl border border-gray-300 bg-gray-100 px-4 py-2 print:border-black print:bg-white"
      >
        <h5 class="mb-2 text-xl"><strong>Profile Status</strong></h5>
        <div class="grid grid-flow-row xl:grid-flow-col justify-between">
          <!-- Status counts -->
          <div class="px-2 py-2">
            <strong>Count</strong>
            <div class="pt-1">
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.circleCheck}}}</div>
                Passed: {{statistics.passed}} ({{statistics.passedTests}}
                individual checks passed)
              </div>
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.circleCross}}}</div>
                Failed: {{statistics.failed}}
                ({{statistics.passingTestsFailedControl}} individual checks
                passed, {{statistics.failedTests}} failed out of
                {{statistics.totalTests}} total checks)
              </div>
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.circleMinus}}}</div>
                Not Applicable: {{statistics.notApplicable}}
              </div>
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.circleAlert}}}</div>
                Not Reviewed: {{statistics.notReviewed}}
              </div>
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.triangleAlert}}}</div>
                Profile Error: {{statistics.profileError}}
              </div>
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.squareEqual}}}</div>
                Total: {{statistics.totalControls}}
              </div>
            </div>
          </div>

          <!-- Severity report -->
          <div class="px-2 py-2">
            <strong>Severity</strong>
            <div class="grid grid-cols-2 pt-1 gap-x-2">
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.circleLow}}}</div>
                Low: {{severity.low}}
              </div>
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.circleMedium}}}</div>
                Medium: {{severity.medium}}
              </div>
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.circleHigh}}}</div>
                High: {{severity.high}}
              </div>
              <div class="flex">
                <div class="pr-1 print:hidden">{{{icons.circleCritical}}}</div>
                Critical: {{severity.critical}}
              </div>
            </div>
          </div>

          <!-- Compliance level -->
          <div class="w-64 px-2 py-2">
            <strong>Compliance</strong>
            <p
              class="my-1 rounded-full bg-{{compliance.color}} text-center text-4xl print:bg-white print:text-2xl"
            >
              {{compliance.level}}
            </p>
            [Passed/(Passed + Failed + Not Reviewed + Profile Error) * 100]
          </div>
        </div>
      </div>
    </div>

    <!-- Control section -->
    <!-- If empty, then this should be an executive report HTML export type -->
    <!-- If not such export type, error has occurred -->
    {{#showControlSets}} {{#controlSets}}
    <!-- Control set accordion -->
    <!-- Generate a control set accordion for every control set -->
    <span id="{{fileID}}"></span>
    <!-- Outer accordion -->
    <div
      class="mx-2 rounded-t-xl border border-neutral-200 bg-white print:hidden"
    >
      <h2 class="mb-0">
        <!-- Button def -->
        <button
          class="[&:not([data-te-collapse-collapsed])]:text-blue-900 group relative flex w-full items-center rounded-t-xl border-0 bg-white px-5 py-4 text-left text-base text-neutral-800 transition [overflow-anchor:none] hover:z-[2] focus:z-[3] focus:outline-none [&:not([data-te-collapse-collapsed])]:bg-blue-200 [&:not([data-te-collapse-collapsed])]:[box-shadow:inset_0_-1px_0_rgba(229,231,235)]"
          type="button"
          data-te-collapse-init
          data-te-target="#collapseable-{{fileID}}"
          aria-expanded="true"
          aria-controls="collapseable-{{fileID}}"
        >
          {{filename}}
          <span
            class="-mr-1 ml-auto h-5 w-5 shrink-0 rotate-[-180deg] fill-[#336dec] transition-transform duration-200 ease-in-out group-[[data-te-collapse-collapsed]]:mr-0 group-[[data-te-collapse-collapsed]]:rotate-0 group-[[data-te-collapse-collapsed]]:fill-[#212529] motion-reduce:transition-none"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19.5 8.25l-7.5 7.5-7.5-7.5"
              />
            </svg>
          </span>
        </button>
      </h2>

      <!-- Inner accordion -->
      <!-- Accordion body def -->
      <div
        id="collapseable-{{fileID}}"
        class="my-4 multi-collapse-outer"
        data-te-collapse-item
        data-te-collapse-show
      >
        <!-- Control header -->
        <div class="mx-4 bg-gray-100 rounded-t-xl border border-neutral-200">
          <div class="flex w-full shrink mx-6 my-4">
            <div class="hidden sm:block w-32">Status</div>
            <div class="sm:block w-28 md:pl-3">ID</div>
            <div class="hidden sm:block w-20 md:pl-6 lg:pl-11">Severity</div>
            <div class="sm:block w-1/2 pl-6 sm:pl-1 md:pl-10 lg:pl-16">
              Title
            </div>
            <div class="hidden lg:block lg:w-36 xl:w-52 pl-6">
              800-53 Controls & CCIs
            </div>
          </div>
        </div>

        <!-- Generate a control accordion for every control -->
        {{#controls}}
        <div class="mx-4 rounded-t-xl border border-neutral-200 bg-white">
          <h2 class="mb-0">
            <!-- Button def -->
            <button
              class="[&:not([data-te-collapse-collapsed])]:text-blue-900 bg-blue group relative flex w-full items-center rounded-t-xl border-0 px-5 py-4 text-left text-base text-neutral-800 transition [overflow-anchor:none] hover:z-[2] focus:z-[3] focus:outline-none [&:not([data-te-collapse-collapsed])]:bg-blue-200 [&:not([data-te-collapse-collapsed])]:[box-shadow:inset_0_-1px_0_rgba(229,231,235)]"
              type="button"
              data-te-collapse-init
              data-te-target="#control-accordion-body-{{controlID}}"
              aria-expanded="true"
              aria-controls="control-accordion-body-{{controlID}}"
            >
              <!-- Small breakpoint -->
              <div class="grid grid-cols-1 gap-y-2 sm:hidden">
                <!-- Control ID -->
                <div class="w-32">
                  <span>{{hdf.wraps.id}}</span>
                </div>
                <div>
                  <!-- Control status indicator -->
                  <span
                    class="bg-{{controlStatus.color}} rounded px-2 py-1 text-black"
                    >{{controlStatus.status}}</span
                  >
                </div>
                <div>
                  <!-- Control severity indicator -->
                  <span
                    class="bg-{{controlSeverity.color}} rounded px-2 py-1 text-black"
                    >{{controlSeverity.severity}}</span
                  >
                </div>
                {{#controlTags}}
                <div class="w-16">
                  <span class="bg-gray-100 rounded px-2 py-1 text-black"
                    >{{.}}</span
                  >
                </div>
                {{/controlTags}}
              </div>

              <!-- Greater breakpoints -->
              <!-- Control status indicator -->
              <div class="w-36 hidden sm:block">
                <span
                  class="bg-{{controlStatus.color}} rounded px-2 py-1 text-black"
                  >{{controlStatus.status}}</span
                >
              </div>
              <!-- Control ID -->
              <div class="w-32 lg:w-36 hidden sm:grid grid-cols-1 gap-y-2">
                <span class="pr-4 break-all">{{hdf.wraps.id}}</span>
                <!-- NIST & CCI controls; appear once past large breakpoint -->
                {{#controlTags}}
                <div class="lg:hidden w-16">
                  <span class="bg-gray-100 rounded px-2 py-1 text-black"
                    >{{.}}</span
                  >
                </div>
                {{/controlTags}}
              </div>
              <!-- Control severity indicator -->
              <div class="w-20 hidden sm:block">
                <span
                  class="bg-{{controlSeverity.color}} rounded px-2 py-1 text-black"
                  >{{controlSeverity.severity}}</span
                >
              </div>
              <!-- Control title -->
              <span class="pl-4 pr-4 w-1/2 break-words"
                >{{hdf.wraps.title}}</span
              >
              <!-- Control tags -->
              <div
                class="hidden lg:grid grid-cols-1 xl:grid-cols-2 gap-x-6 gap-y-2"
              >
                {{#controlTags}}
                <div class="w-16">
                  <span class="bg-gray-100 rounded px-2 py-1 text-black"
                    >{{.}}</span
                  >
                </div>
                {{/controlTags}}
              </div>

              <span
                class="-mr-1 ml-auto h-5 w-5 shrink-0 rotate-[-180deg] fill-[#336dec] transition-transform duration-200 ease-in-out group-[[data-te-collapse-collapsed]]:mr-0 group-[[data-te-collapse-collapsed]]:rotate-0 group-[[data-te-collapse-collapsed]]:fill-[#212529] motion-reduce:transition-none"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="h-6 w-6"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                  />
                </svg>
              </span>
            </button>
          </h2>

          <!-- Accordion body def -->
          <div
            id="control-accordion-body-{{controlID}}"
            class="px-5 py-4 multi-collapse-inner"
            data-te-collapse-item
            data-te-collapse-show
            aria-labelledby="control-accordion-header-{{controlID}}"
          >
            <!-- Control description -->
            {{data.desc}}
            <hr class="my-3" />

            <!-- Control tables -->
            <div>
              <!-- Tests -->
              <h5 class="text-lg"><strong>Test Results</strong></h5>
              <table
                class="table min-w-full text-left"
                aria-describedby="Control test description and result"
              >
                <thead>
                  <th>Status</th>
                  <th>Test</th>
                  <th>Result</th>
                </thead>
                <tbody>
                  <!-- Generate all available test results -->
                  {{#hdf.segments}}
                  <tr class="border-b odd:bg-gray-100 even:bg-white">
                    <td>{{status}}</td>
                    <td>{{code_desc}}</td>
                    <td>{{message}}</td>
                  </tr>
                  {{/hdf.segments}}
                </tbody>
              </table>
              <hr class="my-3" />

              <!-- Details -->
              <h5 class="text-lg"><strong>Control Details</strong></h5>
              <table
                class="table min-w-full text-left"
                aria-describedby="Control details"
              >
                <thead>
                  <th>Name</th>
                  <th>Value</th>
                </thead>
                <tbody>
                  <!-- Generate all control details -->
                  {{#details}}
                  <tr class="border-b odd:bg-gray-100 even:bg-white">
                    <td>{{name}}</td>
                    <td>{{value}}</td>
                  </tr>
                  {{/details}}
                </tbody>
              </table>
            </div>
            <hr class="my-3" />

            <!-- Control code block -->
            {{#showCode}}
            <code class="whitespace-pre-wrap text-sm text-red-700"
              >{{full_code}}</code
            >
            {{/showCode}}
          </div>
        </div>
        {{/controls}}
      </div>
    </div>

    <!-- Control set print report -->
    <div class="hidden print:block">
      <!-- File name -->
      <div class="rounded-t-xl border border-black px-3 py-2">{{filename}}</div>
      <!-- Generate a control report for every control -->
      {{#controls}}
      <div class="border border-black px-2 py-2">
        <div class="flex items-center py-1">
          <!-- Control status indicator -->
          <span class="rounded border border-black px-2 py-1"
            >{{controlStatus.status}}</span
          >
          <!-- Control ID -->
          <span class="pl-4 pr-4">{{hdf.wraps.id}}</span>
          <!-- Control severity indicator -->
          <span class="rounded border border-black px-2 py-1"
            >{{controlSeverity.severity}}</span
          >
          <!-- Control title -->
          <span class="pl-4 pr-4">{{hdf.wraps.title}}</span>
        </div>
        <hr class="my-1" />

        <!-- Control description -->
        {{data.desc}}
        <hr class="my-1" />

        <!-- Control tables -->
        <div>
          <!-- Tests -->
          <h5 class="py-1 text-lg"><strong>Test Results</strong></h5>
          <table
            class="table min-w-full text-left"
            aria-describedby="Control test description and result"
          >
            <thead>
              <th>Status</th>
              <th>Test</th>
              <th>Result</th>
            </thead>
            <tbody>
              <!-- Generate all available test results -->
              {{#hdf.segments}}
              <tr class="border-b odd:bg-gray-100 even:bg-white">
                <td>{{status}}</td>
                <td>{{code_desc}}</td>
                <td>{{message}}</td>
              </tr>
              {{/hdf.segments}}
            </tbody>
          </table>

          <!-- Details -->
          <h5 class="py-1 text-lg"><strong>Control Details</strong></h5>
          <table
            class="table min-w-full text-left"
            aria-describedby="Control details"
          >
            <thead>
              <th>Name</th>
              <th>Value</th>
            </thead>
            <tbody>
              <!-- Generate all control details -->
              {{#details}}
              <tr class="border-b odd:bg-gray-100 even:bg-white">
                <td>{{name}}</td>
                <td>{{value}}</td>
              </tr>
              {{/details}}
            </tbody>
          </table>
        </div>

        <!-- Control code block -->
        {{#showCode}}
        <code class="whitespace-pre-wrap text-sm text-black"
          >{{full_code}}</code
        >
        {{/showCode}}
      </div>
      {{/controls}}
    </div>
    {{/controlSets}} {{/showControlSets}}

    <script src="https://cdn.jsdelivr.net/npm/tw-elements/dist/js/tw-elements.umd.min.js"></script>
  </body>
</html>
