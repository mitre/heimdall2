<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{exportType}} Report</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/tw-elements/dist/css/tw-elements.min.css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
      .bg-success {
        --tw-bg-opacity: 1;
        background-color: rgb(76 176 79 / var(--tw-bg-opacity));
      }
      .bg-danger {
        --tw-bg-opacity: 1;
        background-color: rgb(243 67 53 / var(--tw-bg-opacity));
      }
      .bg-info {
        --tw-bg-opacity: 1;
        background-color: rgb(3 169 244 / var(--tw-bg-opacity));
      }
      .bg-warning {
        --tw-bg-opacity: 1;
        background-color: rgb(254 153 0 / var(--tw-bg-opacity));
      }
      .bg-error {
        --tw-bg-opacity: 1;
        background-color: rgb(121 134 203 / var(--tw-bg-opacity));
      }
    </style>
  </head>

  <body>
    <nav
      class="d-flex sticky top-0 z-10 bg-gray-100 px-3 py-3 text-black print:hidden"
    >
      <a href="#" class="px-3 py-2 text-lg font-medium">Heimdall Report</a>
      <a
        href="#"
        class="px-3 py-2 text-sm font-medium hover:bg-gray-500 hover:text-white"
        aria-current="page"
        >Profile Info</a
      >
      <div class="relative inline-block" data-te-dropdown-ref>
        <button
          type="button"
          class="inline-flex px-3 py-2 text-sm font-medium hover:bg-gray-500 hover:text-white"
          data-te-dropdown-toggle-ref
          href="#navbarSupportedContent"
          role="button"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          Control Sets
          <svg
            class="-mr-1 h-5 w-5 text-gray-400"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              fill-rule="evenodd"
              d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
              clip-rule="evenodd"
            />
          </svg>
        </button>
        {{#showControlSets}}
        <div
          class="absolute z-10 mt-2 hidden w-56 origin-top-right bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none [&[data-te-dropdown-show]]:block"
          id="navbarSupportedContent"
          data-te-dropdown-menu-ref
          aria-labelledby="navbarDropdown"
        >
          <ul>
            {{#controlSets}}
            <li>
              <a
                href="#{{fileID}}"
                data-te-dropdown-item-ref
                class="block px-4 py-2 text-sm text-gray-700"
                >{{filename}}</a
              >
            </li>
            {{/controlSets}}
          </ul>
        </div>
        {{/showControlSets}}
      </div>
    </nav>

    <div class="px-4 py-6">
      <div
        class="max-w-full rounded-xl border border-gray-300 bg-gray-100 px-4 py-2 print:border-black print:bg-white"
      >
        <h5 class="mb-2 text-xl">Profile info</h5>
        <div class="grid grid-cols-4 sm:gap-x-8 print:grid-cols-1">
          {{#files}}
          <div class="my-2">
            <span>Filename: <strong>{{filename}}</strong></span
            ><br />
            <span>Tool Version: <strong>{{toolVersion}}</strong></span
            ><br />
            <span>Platform: <strong>{{platform}}</strong></span
            ><br />
            <span>Duration: <strong>{{duration}}</strong></span
            ><br />
          </div>
          {{/files}}
        </div>
      </div>
    </div>

    <div class="flex flex-wrap justify-evenly gap-x-8 gap-y-6 pb-6">
      <div
        class="bg-success h-32 w-96 rounded-xl print:border print:border-black"
      >
        <div class="px-6 py-4">
          <div class="flex text-lg font-bold">
            <div class="print:hidden">{{{icons.circleCheck}}}</div>
            <span class="pl-2 print:pl-0">Passed: {{statistics.passed}}</span>
          </div>
          <p class="my-2">
            {{statistics.passedTests}} individual checks passed
          </p>
        </div>
      </div>

      <div
        class="bg-danger h-32 w-96 rounded-xl print:border print:border-black"
      >
        <div class="px-6 py-4">
          <div class="flex text-lg font-bold">
            <div class="print:hidden">{{{icons.circleCross}}}</div>
            <span class="pl-2 print:pl-0">Failed: {{statistics.failed}}</span>
          </div>
          <p class="my-2">
            {{statistics.passingTestsFailedControl}} individual checks passed,
            {{statistics.failed}} failed out of {{statistics.totalTests}} total
            checks
          </p>
        </div>
      </div>

      <div class="bg-info h-32 w-96 rounded-xl print:border print:border-black">
        <div class="px-6 py-4">
          <div class="flex text-lg font-bold">
            <div class="print:hidden">{{{icons.circleMinus}}}</div>
            <span class="pl-2 print:pl-0"
              >Not Applicable: {{statistics.notApplicable}}</span
            >
          </div>
          <p class="my-2">System exception or absent component</p>
        </div>
      </div>

      <div
        class="bg-warning h-32 w-96 rounded-xl print:border print:border-black"
      >
        <div class="px-6 py-4">
          <div class="flex text-lg font-bold">
            <div class="print:hidden">{{{icons.circleAlert}}}</div>
            <span class="pl-2 print:pl-0"
              >Not Reviewed: {{statistics.notReviewed}}</span
            >
          </div>
          <p class="my-2">Can only be tested manually at this time</p>
        </div>
      </div>

      <div
        class="bg-error h-32 w-96 rounded-xl print:border print:border-black"
      >
        <div class="px-6 py-4">
          <div class="flex text-lg font-bold">
            <div class="print:hidden">{{{icons.triangleAlert}}}</div>
            <span class="pl-2 print:pl-0"
              >Profile Error: {{statistics.profileError}}</span
            >
          </div>
          <p class="my-2">
            Errors running test - check profile run privileges or check with the
            author of profile
          </p>
        </div>
      </div>
      <div
        class="bg-slate-300 h-32 w-96 rounded-xl print:border print:border-black"
      >
        <div class="px-6 py-4">
          <div class="flex text-lg font-bold">
            <span>Total Controls: {{statistics.totalControls}}</span>
          </div>
          <p class="my-2">
            {{statistics.totalControls}} total controls containing
            {{statistics.totalTests}} total tests
          </p>
        </div>
      </div>

      <div
        class="bg-slate-300 h-32 w-96 rounded-xl print:border print:border-black"
      >
        <div class="px-6 py-4">
          <div class="flex text-lg font-bold">
            <span>Severity Count</span>
          </div>
          <div class="my-2 columns-2 justify-evenly gap-y-2">
            <div class="flex">
              <div class="print:hidden">{{{icons.circleLow}}}</div>
              <p class="pl-2 print:pl-0">Low: {{severity.low}}</p>
            </div>
            <div class="flex">
              <div class="print:hidden">{{{icons.circleMedium}}}</div>
              <p class="pl-2 print:pl-0">Medium: {{severity.medium}}</p>
            </div>
            <div class="flex">
              <div class="print:hidden">{{{icons.circleHigh}}}</div>
              <p class="pl-2 print:pl-0">High: {{severity.high}}</p>
            </div>
            <div class="flex">
              <div class="print:hidden">{{{icons.circleCritical}}}</div>
              <p class="pl-2 print:pl-0">Critical: {{severity.critical}}</p>
            </div>
          </div>
        </div>
      </div>

      <div
        class="bg-slate-300 h-32 w-96 rounded-xl print:border print:border-black"
      >
        <div class="px-6 py-4">
          <div class="flex text-lg font-bold">
            <span>Compliance Level: {{compliance}}</span>
          </div>
          <p class="my-2">
            [Passed/(Passed + Failed + Not Reviewed + Profile Error) * 100]
          </p>
        </div>
      </div>
    </div>

    {{#showControlSets}} {{#controlSets}}
    <span id="{{fileID}}"></span>
    <div
      class="mx-2 rounded-t-xl border border-neutral-200 bg-white print:border-black"
      id="accordion-{{fileID}}"
    >
      <h2 class="mb-0" id="header-{{fileID}}">
        <button
          class="[&:not([data-te-collapse-collapsed])]:text-primary group relative flex w-full items-center rounded-t-xl border-0 bg-white px-5 py-4 text-left text-base text-neutral-800 transition [overflow-anchor:none] hover:z-[2] focus:z-[3] focus:outline-none [&:not([data-te-collapse-collapsed])]:bg-blue-200 [&:not([data-te-collapse-collapsed])]:[box-shadow:inset_0_-1px_0_rgba(229,231,235)] print:[&:not([data-te-collapse-collapsed])]:text-black"
          type="button"
          data-te-collapse-init
          data-te-target="#collapseable-{{fileID}}"
          aria-expanded="true"
          aria-controls="collapseable-{{fileID}}"
        >
          {{filename}}
          <span
            class="-mr-1 ml-auto h-5 w-5 shrink-0 rotate-[-180deg] fill-[#336dec] transition-transform duration-200 ease-in-out group-[[data-te-collapse-collapsed]]:mr-0 group-[[data-te-collapse-collapsed]]:rotate-0 group-[[data-te-collapse-collapsed]]:fill-[#212529] motion-reduce:transition-none"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19.5 8.25l-7.5 7.5-7.5-7.5"
              />
            </svg>
          </span>
        </button>
      </h2>

      <div
        id="collapseable-{{fileID}}"
        class="!visible my-4"
        data-te-collapse-item
        data-te-collapse-show
      >
        {{#controls}}
        <div
          class="mx-4 rounded-t-xl border border-neutral-200 bg-white print:border-black"
          id="accordion-{{hdf.wraps.id}}"
        >
          <h2 class="mb-0" id="control-accordion-header-{{hdf.wraps.id}}">
            <button
              class="[&:not([data-te-collapse-collapsed])]:text-primary bg-blue group relative flex w-full items-center rounded-t-xl border-0 px-5 py-4 text-left text-base text-neutral-800 transition [overflow-anchor:none] hover:z-[2] focus:z-[3] focus:outline-none [&:not([data-te-collapse-collapsed])]:bg-blue-200 [&:not([data-te-collapse-collapsed])]:[box-shadow:inset_0_-1px_0_rgba(229,231,235)] print:[&:not([data-te-collapse-collapsed])]:text-black"
              type="button"
              data-te-collapse-init
              data-te-target="#control-accordion-body-{{hdf.wraps.id}}"
              aria-expanded="true"
              aria-controls="control-accordion-body-{{hdf.wraps.id}}"
            >
              {{#controlStatus.isPassed}}
              <span
                class="rounded bg-success text-black px-2 py-1 print:border print:border-black"
                >{{controlStatus.status}}</span
              >
              {{/controlStatus.isPassed}} {{#controlStatus.isFailed}}
              <span
                class="rounded bg-danger text-black px-2 py-1 print:border print:border-black"
                >{{controlStatus.status}}</span
              >
              {{/controlStatus.isFailed}} {{#controlStatus.isNotApplicable}}
              <span
                class="rounded bg-info text-black px-2 py-1 print:border print:border-black"
                >{{controlStatus.status}}</span
              >
              {{/controlStatus.isNotApplicable}}
              {{#controlStatus.isNotReviewed}}
              <span
                class="rounded bg-warning text-black px-2 py-1 print:border print:border-black"
                >{{controlStatus.status}}</span
              >
              {{/controlStatus.isNotReviewed}} {{#controlStatus.isProfileError}}
              <span
                class="rounded bg-error text-black px-2 py-1 print:border print:border-black"
                >{{controlStatus.status}}</span
              >
              {{/controlStatus.isProfileError}}
              <span class="pl-4">{{hdf.wraps.id}} - {{hdf.wraps.title}}</span>
              <span
                class="-mr-1 ml-auto h-5 w-5 shrink-0 rotate-[-180deg] fill-[#336dec] transition-transform duration-200 ease-in-out group-[[data-te-collapse-collapsed]]:mr-0 group-[[data-te-collapse-collapsed]]:rotate-0 group-[[data-te-collapse-collapsed]]:fill-[#212529] motion-reduce:transition-none"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="h-6 w-6"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                  />
                </svg>
              </span>
            </button>
          </h2>
          <div
            id="control-accordion-body-{{hdf.wraps.id}}"
            class="!visible px-5 py-4"
            data-te-collapse-item
            data-te-collapse-show
            aria-labelledby="control-accordion-header-{{hdf.wraps.id}}"
          >
            {{data.desc}}
            <hr class="my-3" />
            <div>
              <h5 class="text-lg"><strong>Test Results</strong></h5>
              <table
                class="table min-w-full text-left"
                id="testResultsTable"
                aria-describedby="Control test description and result"
              >
                <thead>
                  <th>Status</th>
                  <th>Test</th>
                  <th>Result</th>
                </thead>
                <tbody>
                  {{#hdf.segments}}
                  <tr class="border-b odd:bg-gray-100 even:bg-white">
                    <td>{{status}}</td>
                    <td>{{code_desc}}</td>
                    <td>{{message}}</td>
                  </tr>
                  {{/hdf.segments}}
                </tbody>
                <tbody id="controlTestResultTableBody"></tbody>
              </table>

              <hr class="my-3" />

              <h5 class="text-lg"><strong>Control Details</strong></h5>
              <table
                class="table min-w-full text-left"
                id="controlDetailsTable"
                aria-describedby="Control details"
              >
                <thead>
                  <th>Name</th>
                  <th>Value</th>
                </thead>
                <tbody>
                  {{#details}}
                  <tr class="border-b odd:bg-gray-100 even:bg-white">
                    <td>{{name}}</td>
                    <td>{{value}}</td>
                  </tr>
                  {{/details}}
                </tbody>
              </table>
            </div>

            <hr class="my-3" />

            {{#showCode}}
            <code class="whitespace-pre-wrap text-sm print:text-black"
              >{{full_code}}</code
            >
            {{/showCode}}
          </div>
        </div>
        {{/controls}}
      </div>
    </div>
    {{/controlSets}} {{/showControlSets}}
    <script src="https://cdn.jsdelivr.net/npm/tw-elements/dist/js/tw-elements.umd.min.js"></script>
  </body>
</html>
