{"platform":{"name":"windows_server_2012_r2_standard_evaluation","release":"6.3.9600"},"profiles":[{"name":"cms-ars3.1-high-microsoft-iis-8.5-site-overlay","version":"0.1.0","sha256":"10346dee43d578f70e80a7d1beb8ad3021e78736d289cd96d99bea98dfa928f2","title":"cms-ars3.1-high-microsoft-iis-8.5-site-overlay","maintainer":"CMS InSpec Dev Team","summary":"CMS ARS3.1 Overlay against IIS Site DISA STIG InSpec Profile","license":"Apache-2.0","copyright":"(c) 2018 The MITRE Corporation","copyright_email":"inspec@mitre.org","supports":[],"attributes":[{"name":"public_server","options":{"description":"Specify if the server being reviewed is a public IIS 8.5 web server","type":"boolean","value":false}},{"name":"private_server","options":{"description":"Specify if the server being reviewed is a private IIS 8.5 web server","type":"boolean","value":false}},{"name":"non_production_server","options":{"description":"Specify if the server being reviewed is a non-production website","type":"boolean","value":false}},{"name":"black_listed_extensions","options":{"description":"List of Request Filtering black listed extensions","type":"array","value":[]}},{"name":"site_name","options":{"description":"Name of IIS site","type":"array","value":["tt","Default"]}},{"name":"http_ip","options":{"description":"IP address used for http","type":"array","value":["10.0.2.15","0.0.0.0"]}},{"name":"http_hostname","options":{"description":"IP address used for https","type":"array","value":["local","l"]}},{"name":"https_ip","options":{"description":"IP address used for https","type":"array","value":["10.0.2.15","0.0.0.0"]}},{"name":"https_hostname","options":{"description":"Hostname used for https","type":"array","value":["localhttps","localhttps2"]}},{"name":"log_directory","options":{"description":"Path of IIS log directory","type":"string","value":"C:\\inetpub\\logs\\LogFiles"}}],"depends":[{"name":"microsoft-iis-8.5-site-stig-baseline","path":"../microsoft-iis-8.5-site-stig-baseline","status":"loaded"}],"groups":[{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76773.rb","controls":["V-76773"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76775.rb","controls":["V-76775"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76777.rb","controls":["V-76777"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76779.rb","controls":["V-76779"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76781.rb","controls":["V-76781"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76783.rb","controls":["V-76783"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76785.rb","controls":["V-76785"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76787.rb","controls":["V-76787"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76789.rb","controls":["V-76789"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76791.rb","controls":["V-76791"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76795.rb","controls":["V-76795"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76797.rb","controls":["V-76797"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76799.rb","controls":["V-76799"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76801.rb","controls":["V-76801"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76803.rb","controls":["V-76803"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76805.rb","controls":["V-76805"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76807.rb","controls":["V-76807"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76809.rb","controls":["V-76809"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76811.rb","controls":["V-76811"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76813.rb","controls":["V-76813"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76815.rb","controls":["V-76815"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76817.rb","controls":["V-76817"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76819.rb","controls":["V-76819"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76821.rb","controls":["V-76821"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76823.rb","controls":["V-76823"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76825.rb","controls":["V-76825"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76827.rb","controls":["V-76827"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76829.rb","controls":["V-76829"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76831.rb","controls":["V-76831"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76835.rb","controls":["V-76835"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76837.rb","controls":["V-76837"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76839.rb","controls":["V-76839"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76841.rb","controls":["V-76841"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76843.rb","controls":["V-76843"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76845.rb","controls":["V-76845"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76847.rb","controls":["V-76847"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76849.rb","controls":["V-76849"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76851.rb","controls":["V-76851"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76855.rb","controls":["V-76855"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76859.rb","controls":["V-76859"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76861.rb","controls":["V-76861"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76865.rb","controls":["V-76865"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76867.rb","controls":["V-76867"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76869.rb","controls":["V-76869"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76871.rb","controls":["V-76871"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76873.rb","controls":["V-76873"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76875.rb","controls":["V-76875"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76877.rb","controls":["V-76877"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76879.rb","controls":["V-76879"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76881.rb","controls":["V-76881"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76885.rb","controls":["V-76885"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76887.rb","controls":["V-76887"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76889.rb","controls":["V-76889"]},{"id":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76891.rb","controls":["V-76891"]}],"controls":[{"id":"V-76773","title":"The IIS 8.5 websites MaxConnections setting must be configured to\n  limit the number of allowed simultaneous session requests.","desc":"Resource exhaustion can occur when an unlimited number of concurrent\n  requests are allowed on a website, facilitating a Denial of Service attack.\n  Mitigating this kind of attack will include limiting the number of concurrent\n  HTTP/HTTPS requests per IP address and may include, where feasible, limiting\n  parameter values associated with keepalive (i.e., a parameter used to limit the\n  amount of time a connection may be inactive).","descriptions":[{"label":"default","data":"Resource exhaustion can occur when an unlimited number of concurrent\n  requests are allowed on a website, facilitating a Denial of Service attack.\n  Mitigating this kind of attack will include limiting the number of concurrent\n  HTTP/HTTPS requests per IP address and may include, where feasible, limiting\n  parameter values associated with keepalive (i.e., a parameter used to limit the\n  amount of time a connection may be inactive)."},{"label":"check","data":"Access the IIS 8.5 IIS Manager.\n    \n    Click the IIS 8.5 server.\n\n    Select \"Configuration Editor\" under the \"Management\" section.\n\n    From the \"Section:\" drop-down list at the top of the configuration editor, \n    locate \"system.applicationHost/sites\".\n\n    Expand \"siteDefaults\".\n    Expand \"limits\".\n\n    Review the results and verify the value is \"1\" for the \"maxconnections\" \n    parameter.\n\n    If the maxconnections parameter is set a value other than \"1\", this \n    is a finding."},{"label":"fix","data":"Access the IIS 8.5 IIS Manager.\n\n         Click the IIS 8.5 server.\n\n         Select \"Configuration Editor\" under the \"Management\" section.\n\n         From the \"Section:\" drop-down list at the top of the configuration \n         editor, locate \"system.applicationHost/sites\".\n\n         Expand \"siteDefaults\".\n         Expand \"limits\".\n\n         Set the \"maxconnections\" parameter to \"1\"."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000001-WSR-000001","gid":"V-76773","rid":"SV-91469r1_rule","stig_id":"IISW-SI-000200","fix_id":"F-83469r1_fix","cci":["CCI-000054"],"nist":["AC-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Access the IIS 8.5 IIS Manager.\n\n  Click the IIS 8.5 server.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.applicationHost/sites\".\n\n  Expand \"siteDefaults\".\n  Expand \"limits\".\n\n  Review the results and verify the value is greater than zero for the\n  \"maxconnections\" parameter.\n\n  If the maxconnections parameter is set to zero, this is a finding.","fix":"Access the IIS 8.5 IIS Manager.\n\n  Click the IIS 8.5 server.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.applicationHost/sites\".\n\n  Expand \"siteDefaults\".\n  Expand \"limits\".\n\n  Set the \"maxconnections\" parameter to a value greater than zero."},"code":"  control 'V-76773' do\n    desc 'check', 'Access the IIS 8.5 IIS Manager.\n    \n    Click the IIS 8.5 server.\n\n    Select \"Configuration Editor\" under the \"Management\" section.\n\n    From the \"Section:\" drop-down list at the top of the configuration editor, \n    locate \"system.applicationHost/sites\".\n\n    Expand \"siteDefaults\".\n    Expand \"limits\".\n\n    Review the results and verify the value is \"1\" for the \"maxconnections\" \n    parameter.\n\n    If the maxconnections parameter is set a value other than \"1\", this \n    is a finding.'\n    desc 'fix', 'Access the IIS 8.5 IIS Manager.\n\n         Click the IIS 8.5 server.\n\n         Select \"Configuration Editor\" under the \"Management\" section.\n\n         From the \"Section:\" drop-down list at the top of the configuration \n         editor, locate \"system.applicationHost/sites\".\n\n         Expand \"siteDefaults\".\n         Expand \"limits\".\n\n         Set the \"maxconnections\" parameter to \"1\".'\n    describe 'IIS Configuration' do\n      subject { json(command: 'Get-WebConfigurationProperty \n                -Filter system.applicationHost/sites -name * | \n                select -   expand siteDefaults | select -expand limits | \n                ConvertTo-Json ') }\n      its('maxBandwidth') { should eq 1 }\n    end\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76773.rb"},"results":[]},{"id":"V-76775","title":"The IIS 8.5 website session state must be enabled.","desc":"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and web server will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.","descriptions":[{"label":"default","data":"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and web server will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000001-WSR-000002","gid":"V-76775","rid":"SV-91471r1_rule","stig_id":"IISW-SI-000201","fix_id":"F-83471r1_fix","cci":["CCI-000054"],"nist":["AC-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \"ASP.NET\" section, select \"Session State\".\n\n  Under \"Session State Mode Settings\", verify the \"In Process\" mode is\n  selected.\n\n  If the \"Session State Mode Settings\" is set to \"In Process\", this is not a\n  finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Verify the \"mode\" reflects \"InProc\".\n\n  If the \"mode\" is not set to \"InProc\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \"ASP.NET\" section, select \"Session State\".\n\n  Under \"Session State Mode Settings\", verify the \"In Process\" mode is\n  selected.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76775' do\n  title 'The IIS 8.5 website session state must be enabled.'\n  desc  \"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and web server will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000001-WSR-000002'\n  tag \"gid\": 'V-76775'\n  tag \"rid\": 'SV-91471r1_rule'\n  tag \"stig_id\": 'IISW-SI-000201'\n  tag \"fix_id\": 'F-83471r1_fix'\n  tag \"cci\": ['CCI-000054']\n  tag \"nist\": ['AC-10', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \\\"ASP.NET\\\" section, select \\\"Session State\\\".\n\n  Under \\\"Session State Mode Settings\\\", verify the \\\"In Process\\\" mode is\n  selected.\n\n  If the \\\"Session State Mode Settings\\\" is set to \\\"In Process\\\", this is not a\n  finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Verify the \\\"mode\\\" reflects \\\"InProc\\\".\n\n  If the \\\"mode\\\" is not set to \\\"InProc\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \\\"ASP.NET\\\" section, select \\\"Session State\\\".\n\n  Under \\\"Session State Mode Settings\\\", verify the \\\"In Process\\\" mode is\n  selected.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.web/sessionState 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState setting for Site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('mode') { should cmp 'InProc' }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76775.rb"},"results":[]},{"id":"V-76777","title":"The IIS 8.5 website session state cookie settings must be configured\n  to Use Cookies mode.","desc":"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and website will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.\n\n      Cookies associate session information with client information for the\n  duration of a user’s connection to a website. Using cookies is a more efficient\n  way to track session state than any of the methods that do not use cookies\n  because cookies do not require any redirection.","descriptions":[{"label":"default","data":"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and website will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.\n\n      Cookies associate session information with client information for the\n  duration of a user’s connection to a website. Using cookies is a more efficient\n  way to track session state than any of the methods that do not use cookies\n  because cookies do not require any redirection."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000001-WSR-000002","gid":"V-76777","rid":"SV-91473r2_rule","stig_id":"IISW-SI-000202","fix_id":"F-83473r2_fix","cci":["CCI-000054"],"nist":["AC-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \"ASP.NET\" section, select \"Session State\".\n\n  Under \"Cookie Settings\", verify the \"Use Cookies\" mode is selected from the\n  \"Mode:\" drop-down list.\n\n  If the \"Use Cookies\" mode is selected, this is not a finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Verify the \"cookieless\" is set to \"UseCookies\".\n\n  If the \"cookieless\" is not set to \"UseCookies\", this is a finding","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the ASP.NET section, select \"Session State\".\n\n  Under \"Cookie Settings\", select the \"Use Cookies\" from the \"Mode:\"\n  drop-dowssn list.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76777' do\n  title \"The IIS 8.5 website session state cookie settings must be configured\n  to Use Cookies mode.\"\n  desc  \"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and website will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.\n\n      Cookies associate session information with client information for the\n  duration of a user’s connection to a website. Using cookies is a more efficient\n  way to track session state than any of the methods that do not use cookies\n  because cookies do not require any redirection.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000001-WSR-000002'\n  tag \"gid\": 'V-76777'\n  tag \"rid\": 'SV-91473r2_rule'\n  tag \"stig_id\": 'IISW-SI-000202'\n  tag \"fix_id\": 'F-83473r2_fix'\n  tag \"cci\": ['CCI-000054']\n  tag \"nist\": ['AC-10', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \\\"ASP.NET\\\" section, select \\\"Session State\\\".\n\n  Under \\\"Cookie Settings\\\", verify the \\\"Use Cookies\\\" mode is selected from the\n  \\\"Mode:\\\" drop-down list.\n\n  If the \\\"Use Cookies\\\" mode is selected, this is not a finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Verify the \\\"cookieless\\\" is set to \\\"UseCookies\\\".\n\n  If the \\\"cookieless\\\" is not set to \\\"UseCookies\\\", this is a finding\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the ASP.NET section, select \\\"Session State\\\".\n\n  Under \\\"Cookie Settings\\\", select the \\\"Use Cookies\\\" from the \\\"Mode:\\\"\n  drop-dowssn list.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.web/sessionState 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('cookieless') { should cmp 'UseCookies' }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76777.rb"},"results":[]},{"id":"V-76779","title":"A private IIS 8.5 website must only accept Secure Socket Layer\n  connections.","desc":"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems.","descriptions":[{"label":"default","data":"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000014-WSR-000006","gid":"V-76779","rid":"SV-91475r1_rule","stig_id":"IISW-SI-000203","fix_id":"F-83475r1_fix","cci":["CCI-000068"],"nist":["AC-17 (2)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Verify \"Require SSL\" check box is selected.\n\n  If the \"Require SSL\" check box is not selected, this is a finding.","fix":"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Select \"Require SSL\" check box.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76779' do\n  title \"A private IIS 8.5 website must only accept Secure Socket Layer\n  connections.\"\n  desc \"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000014-WSR-000006'\n  tag \"gid\": 'V-76779'\n  tag \"rid\": 'SV-91475r1_rule'\n  tag \"stig_id\": 'IISW-SI-000203'\n  tag \"fix_id\": 'F-83475r1_fix'\n  tag \"cci\": ['CCI-000068']\n  tag \"nist\": ['AC-17 (2)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Verify \\\"Require SSL\\\" check box is selected.\n\n  If the \\\"Require SSL\\\" check box is not selected, this is a finding.\"\n  tag \"fix\": \"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Select \\\"Require SSL\\\" check box.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.webServer/security/access 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('sslFlags') { should include 'Ssl' }\n    end\n  end\n\n  if attribute('public_server')\n    impact 0.0\n    desc 'The server being reviewed is a public IIS 8.5 web\n    server, hence this control is Not Applicable.'\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76779.rb"},"results":[]},{"id":"V-76781","title":"A public IIS 8.5 website must only accept Secure Socket Layer\n  connections when authentication is required.","desc":"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems.","descriptions":[{"label":"default","data":"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000014-WSR-000006","gid":"V-76781","rid":"SV-91477r1_rule","stig_id":"IISW-SI-000204","fix_id":"F-83477r1_fix","cci":["CCI-000068"],"nist":["AC-17 (2)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the server being reviewed is a private IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Verify \"Require SSL\" check box is selected.\n\n  If the \"Require SSL\" check box is not selected, this is a finding.","fix":"Note: If the server being reviewed is a private IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Select \"Require SSL\" check box.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76781' do\n  title \"A public IIS 8.5 website must only accept Secure Socket Layer\n  connections when authentication is required.\"\n  desc \"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000014-WSR-000006'\n  tag \"gid\": 'V-76781'\n  tag \"rid\": 'SV-91477r1_rule'\n  tag \"stig_id\": 'IISW-SI-000204'\n  tag \"fix_id\": 'F-83477r1_fix'\n  tag \"cci\": ['CCI-000068']\n  tag \"nist\": ['AC-17 (2)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: If the server being reviewed is a private IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Verify \\\"Require SSL\\\" check box is selected.\n\n  If the \\\"Require SSL\\\" check box is not selected, this is a finding.\"\n  tag \"fix\": \"Note: If the server being reviewed is a private IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Select \\\"Require SSL\\\" check box.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.webServer/security/access 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('sslFlags') { should include 'Ssl' }\n    end\n  end\n\n  if attribute('private_server')\n    impact 0.0\n    desc 'The server being reviewed is a private IIS 8.5 web\n    server, hence this control is Not Applicable.'\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76781.rb"},"results":[]},{"id":"V-76783","title":"The enhanced logging for each IIS 8.5 website must be enabled and\n  capture, record, and log all content related to a user session.","desc":"Log files are a critical component to the successful management \n         of an IS used within the CMS. By generating log files with useful \n         information web administrators can leverage them in the event of a \n         disaster, malicious attack, or other site-specific needs.\n\n         Ascertaining the correct order of the events that occurred is \n         important during forensic analysis. Events that appear harmless by \n         themselves might be flagged as a potential threat when properly viewed \n         in sequence. By also establishing the event date and time, an event \n         can be properly viewed with an enterprise tool to fully see a possible \n         threat in its entirety.\n\n         Without sufficient information establishing when the log event occurred, \n         investigation into the cause of event is severely hindered. Log record \n         content that may be necessary to satisfy the requirement of this control \n         includes, but is not limited to, time stamps, source and destination IP \n         addresses, user/process identifiers, event descriptions, \n         application-specific events, success/fail indications, file names involved, \n         access control, or flow control rules invoked.\n\n         Satisfies: SRG-APP-000092-WSR-000055, SRG-APP-000093-WSR-000053","descriptions":[{"label":"default","data":"Log files are a critical component to the successful management \n         of an IS used within the CMS. By generating log files with useful \n         information web administrators can leverage them in the event of a \n         disaster, malicious attack, or other site-specific needs.\n\n         Ascertaining the correct order of the events that occurred is \n         important during forensic analysis. Events that appear harmless by \n         themselves might be flagged as a potential threat when properly viewed \n         in sequence. By also establishing the event date and time, an event \n         can be properly viewed with an enterprise tool to fully see a possible \n         threat in its entirety.\n\n         Without sufficient information establishing when the log event occurred, \n         investigation into the cause of event is severely hindered. Log record \n         content that may be necessary to satisfy the requirement of this control \n         includes, but is not limited to, time stamps, source and destination IP \n         addresses, user/process identifiers, event descriptions, \n         application-specific events, success/fail indications, file names involved, \n         access control, or flow control rules invoked.\n\n         Satisfies: SRG-APP-000092-WSR-000055, SRG-APP-000093-WSR-000053"},{"label":"caveat","data":"AU-14 is not listed in ARS, but the ARS AU-3 clearly implies the\n         need for these fields in event records. As a result, the associated NIST \n          control has been changed to AU-3."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000092-WSR-000055","satisfies":["SRG-APP-000092-WSR-000055","SRG-APP-000093-WSR-000053"],"gid":"V-76783","rid":"SV-91479r1_rule","stig_id":"IISW-SI-000205","fix_id":"F-83479r1_fix","cci":["CCI-001487"],"nist":["AU-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Under Format select \"W3C\".\n\n  Click Select Fields, verify at a minimum the following fields are checked:\n  Date, Time, Client IP Address, User Name, Method, URI Query, Protocol Status,\n  and Referrer.\n\n  If the \"W3C\" is not selected as the logging format OR any of the required\n  fields are not selected, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Under Format select \"W3C\".\n\n  Select the following fields: Date, Time, Client IP Address, User Name, Method,\n  URI Query, Protocol Status, and Referrer.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"  control 'V-76783' do\n    desc 'Log files are a critical component to the successful management \n         of an IS used within the CMS. By generating log files with useful \n         information web administrators can leverage them in the event of a \n         disaster, malicious attack, or other site-specific needs.\n\n         Ascertaining the correct order of the events that occurred is \n         important during forensic analysis. Events that appear harmless by \n         themselves might be flagged as a potential threat when properly viewed \n         in sequence. By also establishing the event date and time, an event \n         can be properly viewed with an enterprise tool to fully see a possible \n         threat in its entirety.\n\n         Without sufficient information establishing when the log event occurred, \n         investigation into the cause of event is severely hindered. Log record \n         content that may be necessary to satisfy the requirement of this control \n         includes, but is not limited to, time stamps, source and destination IP \n         addresses, user/process identifiers, event descriptions, \n         application-specific events, success/fail indications, file names involved, \n         access control, or flow control rules invoked.\n\n         Satisfies: SRG-APP-000092-WSR-000055, SRG-APP-000093-WSR-000053'\n    tag \"cci\": ['CCI-001487']\n    tag \"nist\": ['AU-3', 'Rev_4']\n    desc 'caveat', 'AU-14 is not listed in ARS, but the ARS AU-3 clearly implies the\n         need for these fields in event records. As a result, the associated NIST \n          control has been changed to AU-3.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76783.rb"},"results":[]},{"id":"V-76785","title":"Both the log file and Event Tracing for Windows (ETW) for each IIS 8.5\n  website must be enabled.","desc":"Internet Information Services (IIS) on Windows Server 2012 provides\n  basic logging capabilities. However, because IIS takes some time to flush logs\n  to disk, administrators do not have access to logging information in real-time.\n  In addition, text-based log files can be difficult and time-consuming to\n  process.\n\n      In IIS 8.5, the administrator has the option of sending logging information\n  to Event Tracing for Windows (ETW). This option gives the administrator the\n  ability to use standard query tools, or create custom tools, for viewing\n  real-time logging information in ETW. This provides a significant advantage\n  over parsing text-based log files that are not updated in real time.","descriptions":[{"label":"default","data":"Internet Information Services (IIS) on Windows Server 2012 provides\n  basic logging capabilities. However, because IIS takes some time to flush logs\n  to disk, administrators do not have access to logging information in real-time.\n  In addition, text-based log files can be difficult and time-consuming to\n  process.\n\n      In IIS 8.5, the administrator has the option of sending logging information\n  to Event Tracing for Windows (ETW). This option gives the administrator the\n  ability to use standard query tools, or create custom tools, for viewing\n  real-time logging information in ETW. This provides a significant advantage\n  over parsing text-based log files that are not updated in real time."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000092-WSR-000055","satisfies":["SRG-APP-000092-WSR-000055","SRG-APP-000108-WSR-000166"],"gid":"V-76785","rid":"SV-91481r1_rule","stig_id":"IISW-SI-000206","fix_id":"F-83481r1_fix","cci":["CCI-000139","CCI-001464"],"nist":["AU-5 a","AU-14 (1)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Under Log Event Destination, verify the \"Both log file and ETW event\" radio\n  button is selected.\n\n  If the \"Both log file and ETW event\" radio button is not selected, this is a\n  finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Under Log Event Destination, select the \"Both log file and ETW event\" radio\n  button.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76785' do\n  title \"Both the log file and Event Tracing for Windows (ETW) for each IIS 8.5\n  website must be enabled.\"\n  desc  \"Internet Information Services (IIS) on Windows Server 2012 provides\n  basic logging capabilities. However, because IIS takes some time to flush logs\n  to disk, administrators do not have access to logging information in real-time.\n  In addition, text-based log files can be difficult and time-consuming to\n  process.\n\n      In IIS 8.5, the administrator has the option of sending logging information\n  to Event Tracing for Windows (ETW). This option gives the administrator the\n  ability to use standard query tools, or create custom tools, for viewing\n  real-time logging information in ETW. This provides a significant advantage\n  over parsing text-based log files that are not updated in real time.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000092-WSR-000055'\n  tag \"satisfies\": ['SRG-APP-000092-WSR-000055', 'SRG-APP-000108-WSR-000166']\n  tag \"gid\": 'V-76785'\n  tag \"rid\": 'SV-91481r1_rule'\n  tag \"stig_id\": 'IISW-SI-000206'\n  tag \"fix_id\": 'F-83481r1_fix'\n  tag \"cci\": ['CCI-000139', 'CCI-001464']\n  tag \"nist\": ['AU-5 a', 'AU-14 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Under Log Event Destination, verify the \\\"Both log file and ETW event\\\" radio\n  button is selected.\n\n  If the \\\"Both log file and ETW event\\\" radio button is not selected, this is a\n  finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Under Log Event Destination, select the \\\"Both log file and ETW event\\\" radio\n  button.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  iis_modules = command('Get-WebConfiguration  system.webServer/globalModules/*').stdout.strip\n\n  describe 'IIS Module for ETW (Tracing) should be installed; Installed modules' do\n    subject { iis_modules }\n    it { should include 'UriCacheModule' }\n  end\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_logging_configuration = json(command: %(Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter 'System.Applicationhost/Sites/site[@name=\"#{site_name}\"]/logfile'  -Name * | ConvertTo-Json))\n\n    describe \"IIS Logging configuration for Site :'#{site_name}'\" do\n      subject { iis_logging_configuration }\n      its('logTargetW3C') { should include 'File' }\n      its('logTargetW3C') { should include 'ETW' }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76785.rb"},"results":[]},{"id":"V-76787","title":"An IIS 8.5 website behind a load balancer or proxy server, must\nproduce log records containing the source client IP and destination\ninformation.","desc":"Web server logging capability is critical for accurate forensic\nanalysis. Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct source, e.g. source IP, of the events is important\nduring forensic analysis. Correctly determining the source of events will add\ninformation to the overall reconstruction of the logable event. By determining\nthe source of the event correctly, analysis of the enterprise can be undertaken\nto determine if events tied to the source occurred in other areas within the\nenterprise.\n\n    A web server behind a load balancer or proxy server, when not configured\ncorrectly, will record the load balancer or proxy server as the source of every\nlogable event. When looking at the information forensically, this information\nis not helpful in the investigation of events. The web server must record with\neach event the client source of the event.","descriptions":[{"label":"default","data":"Web server logging capability is critical for accurate forensic\nanalysis. Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct source, e.g. source IP, of the events is important\nduring forensic analysis. Correctly determining the source of events will add\ninformation to the overall reconstruction of the logable event. By determining\nthe source of the event correctly, analysis of the enterprise can be undertaken\nto determine if events tied to the source occurred in other areas within the\nenterprise.\n\n    A web server behind a load balancer or proxy server, when not configured\ncorrectly, will record the load balancer or proxy server as the source of every\nlogable event. When looking at the information forensically, this information\nis not helpful in the investigation of events. The web server must record with\neach event the client source of the event."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000098-WSR-000060","gid":"V-76787","rid":"SV-91483r1_rule","stig_id":"IISW-SI-000208","fix_id":"F-83483r1_fix","cci":["CCI-000133"],"nist":["AU-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Interview the System Administrator to review the configuration\n  of the IIS 8.5 architecture and determine if inbound web traffic is passed\n  through a proxy.\n\n  If the IIS 8.5 is receiving inbound web traffic through a proxy, the audit logs\n  must be reviewed to determine if correct source information is being passed\n  through by the proxy server.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Click on \"View log file\" button.\n\n  When log file is displaced, review source IP information in log entries and\n  verify entries do not reflect the IP address of the proxy server.\n\n  If the log entries in the log file(s) reflect the IP address of the proxy\n  server as the source, this is a finding.\n\n  If the website is not behind a load balancer or proxy server, this is\n  Not Applicable.\n  ","fix":"Access the proxy server through which inbound web traffic is\n  passed and configure settings to pass web traffic to the IIS 8.5 web server\n  transparently."},"code":"control 'V-76787' do\n  title \"An IIS 8.5 website behind a load balancer or proxy server, must\nproduce log records containing the source client IP and destination\ninformation.\"\n  desc  \"Web server logging capability is critical for accurate forensic\nanalysis. Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct source, e.g. source IP, of the events is important\nduring forensic analysis. Correctly determining the source of events will add\ninformation to the overall reconstruction of the logable event. By determining\nthe source of the event correctly, analysis of the enterprise can be undertaken\nto determine if events tied to the source occurred in other areas within the\nenterprise.\n\n    A web server behind a load balancer or proxy server, when not configured\ncorrectly, will record the load balancer or proxy server as the source of every\nlogable event. When looking at the information forensically, this information\nis not helpful in the investigation of events. The web server must record with\neach event the client source of the event.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000098-WSR-000060'\n  tag \"gid\": 'V-76787'\n  tag \"rid\": 'SV-91483r1_rule'\n  tag \"stig_id\": 'IISW-SI-000208'\n  tag \"fix_id\": 'F-83483r1_fix'\n  tag \"cci\": ['CCI-000133']\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Interview the System Administrator to review the configuration\n  of the IIS 8.5 architecture and determine if inbound web traffic is passed\n  through a proxy.\n\n  If the IIS 8.5 is receiving inbound web traffic through a proxy, the audit logs\n  must be reviewed to determine if correct source information is being passed\n  through by the proxy server.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Click on \\\"View log file\\\" button.\n\n  When log file is displaced, review source IP information in log entries and\n  verify entries do not reflect the IP address of the proxy server.\n\n  If the log entries in the log file(s) reflect the IP address of the proxy\n  server as the source, this is a finding.\n\n  If the website is not behind a load balancer or proxy server, this is\n  Not Applicable.\n  \"\n  tag \"fix\": \"Access the proxy server through which inbound web traffic is\n  passed and configure settings to pass web traffic to the IIS 8.5 web server\n  transparently.\"\n\n  describe 'Manual review of IIS Logs is required ' do\n    skip 'Manually review to confirm  Client IP accurately identifies the client\n    and not proxy server ( if used north of IIS )'\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76787.rb"},"results":[]},{"id":"V-76789","title":"The IIS 8.5 website must produce log records that contain sufficient\n  information to establish the outcome (success or failure) of IIS 8.5 website\n  events.","desc":"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Ascertaining the success or failure of an event is important during\n  forensic analysis. Correctly determining the outcome will add information to\n  the overall reconstruction of the logable event. By determining the success or\n  failure of the event correctly, analysis of the enterprise can be undertaken to\n  determine if events tied to the event occurred in other areas within the\n  enterprise.\n\n      Without sufficient information establishing the success or failure of the\n  logged event, investigation into the cause of event is severely hindered. The\n  success or failure also provides a means to measure the impact of an event and\n  help authorized personnel to determine the appropriate response. Log record\n  content that may be necessary to satisfy the requirement of this control\n  includes, but is not limited to, time stamps, source and destination IP\n  addresses, user/process identifiers, event descriptions, application-specific\n  events, success/fail indications, file names involved, access control, or flow\n  control rules invoked.","descriptions":[{"label":"default","data":"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Ascertaining the success or failure of an event is important during\n  forensic analysis. Correctly determining the outcome will add information to\n  the overall reconstruction of the logable event. By determining the success or\n  failure of the event correctly, analysis of the enterprise can be undertaken to\n  determine if events tied to the event occurred in other areas within the\n  enterprise.\n\n      Without sufficient information establishing the success or failure of the\n  logged event, investigation into the cause of event is severely hindered. The\n  success or failure also provides a means to measure the impact of an event and\n  help authorized personnel to determine the appropriate response. Log record\n  content that may be necessary to satisfy the requirement of this control\n  includes, but is not limited to, time stamps, source and destination IP\n  addresses, user/process identifiers, event descriptions, application-specific\n  events, success/fail indications, file names involved, access control, or flow\n  control rules invoked."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000099-WSR-000061","gid":"V-76789","rid":"SV-91485r1_rule","stig_id":"IISW-SI-000209","fix_id":"F-83485r1_fix","cci":["CCI-000134"],"nist":["AU-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Select the website being reviewed.\n\n  Under \"IIS\", double-click the \"Logging\" icon.\n\n  Verify the \"Format:\" under \"Log File\" is configured to \"W3C\".\n\n  Select the \"Fields\" button.\n\n  Under \"Custom Fields\", verify the following fields are selected:\n\n  Request Header >> Connection\n\n  Request Header >> Warning\n\n  Server Variable >> HTTP_CONNECTION\n\n  If any of the above fields are not selected, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Select the website being reviewed.\n\n  Under \"IIS\", double-click the \"Logging\" icon.\n\n  Configure the \"Format:\" under \"Log File\" to \"W3C\".\n\n  Select the \"Fields\" button.\n\n  Under \"Custom Fields\", select the following fields:\n\n  Request Header >> Connection\n\n  Request Header >> Warning\n\n  Server Variable >> HTTP_CONNECTION\n\n  Click \"OK\".\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76789' do\n  title \"The IIS 8.5 website must produce log records that contain sufficient\n  information to establish the outcome (success or failure) of IIS 8.5 website\n  events.\"\n  desc \"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Ascertaining the success or failure of an event is important during\n  forensic analysis. Correctly determining the outcome will add information to\n  the overall reconstruction of the logable event. By determining the success or\n  failure of the event correctly, analysis of the enterprise can be undertaken to\n  determine if events tied to the event occurred in other areas within the\n  enterprise.\n\n      Without sufficient information establishing the success or failure of the\n  logged event, investigation into the cause of event is severely hindered. The\n  success or failure also provides a means to measure the impact of an event and\n  help authorized personnel to determine the appropriate response. Log record\n  content that may be necessary to satisfy the requirement of this control\n  includes, but is not limited to, time stamps, source and destination IP\n  addresses, user/process identifiers, event descriptions, application-specific\n  events, success/fail indications, file names involved, access control, or flow\n  control rules invoked.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000099-WSR-000061'\n  tag \"gid\": 'V-76789'\n  tag \"rid\": 'SV-91485r1_rule'\n  tag \"stig_id\": 'IISW-SI-000209'\n  tag \"fix_id\": 'F-83485r1_fix'\n  tag \"cci\": ['CCI-000134']\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Select the website being reviewed.\n\n  Under \\\"IIS\\\", double-click the \\\"Logging\\\" icon.\n\n  Verify the \\\"Format:\\\" under \\\"Log File\\\" is configured to \\\"W3C\\\".\n\n  Select the \\\"Fields\\\" button.\n\n  Under \\\"Custom Fields\\\", verify the following fields are selected:\n\n  Request Header >> Connection\n\n  Request Header >> Warning\n\n  Server Variable >> HTTP_CONNECTION\n\n  If any of the above fields are not selected, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Select the website being reviewed.\n\n  Under \\\"IIS\\\", double-click the \\\"Logging\\\" icon.\n\n  Configure the \\\"Format:\\\" under \\\"Log File\\\" to \\\"W3C\\\".\n\n  Select the \\\"Fields\\\" button.\n\n  Under \\\"Custom Fields\\\", select the following fields:\n\n  Request Header >> Connection\n\n  Request Header >> Warning\n\n  Server Variable >> HTTP_CONNECTION\n\n  Click \\\"OK\\\".\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_logging_configuration = json(command: %(Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter 'System.Applicationhost/Sites/site[@name=\"#{site_name}\"]/logfile'  -Name * | ConvertTo-Json))\n\n    describe \"IIS Logging configuration for Site :'#{site_name}'\" do\n      subject { iis_logging_configuration }\n      its('logFormat') { should cmp 'W3C' }\n    end\n  end\n\n  custom_field_configuration = []\n  site_names.each do |site_name|\n    custom_field_configuration = command(\"Get-WebConfiguration -filter \\\"system.applicationHost/sites/site[@name=\\'#{site_name}\\']/logFile/customFields/*\\\"\").stdout.strip\n    describe \"IIS Custom Fields Logging configuration for Site :'#{site_name}'\" do\n      subject { custom_field_configuration }\n      it { should match /sourceName\\s+:\\s+Connection\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+Warning\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+HTTP_CONNECTION\\s+sourceType\\s+:\\s+ServerVariable/ }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76789.rb"},"results":[]},{"id":"V-76791","title":"The IIS 8.5 website must produce log records containing sufficient\n  information to establish the identity of any user/subject or process associated\n  with an event.","desc":"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Determining user accounts, processes running on behalf of the user, and\n  running process identifiers also enable a better understanding of the overall\n  event. User tool identification is also helpful to determine if events are\n  related to overall user access or specific client tools.\n\n      Log record content that may be necessary to satisfy the requirement of this\n  control includes: time stamps, source and destination addresses, user/process\n  identifiers, event descriptions, success/fail indications, file names involved,\n  and access control or flow control rules invoked.","descriptions":[{"label":"default","data":"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Determining user accounts, processes running on behalf of the user, and\n  running process identifiers also enable a better understanding of the overall\n  event. User tool identification is also helpful to determine if events are\n  related to overall user access or specific client tools.\n\n      Log record content that may be necessary to satisfy the requirement of this\n  control includes: time stamps, source and destination addresses, user/process\n  identifiers, event descriptions, success/fail indications, file names involved,\n  and access control or flow control rules invoked."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000100-WSR-000064","gid":"V-76791","rid":"SV-91487r1_rule","stig_id":"IISW-SI-000210","fix_id":"F-83487r1_fix","cci":["CCI-001487"],"nist":["AU-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Under \"IIS\", double-click the \"Logging\" icon.\n\n  Verify the \"Format:\" under \"Log File\" is configured to \"W3C\".\n\n  Select the \"Fields\" button.\n\n  Under \"Standard Fields\", verify \"User Agent\", \"User Name\" and\n  \"Referrer\" are selected.\n\n  Under \"Custom Fields\", verify the following fields have been configured:\n\n  Server Variable >> HTTP_USER_AGENT\n\n  Request Header >> User-Agent\n\n  Request Header >> Authorization\n\n  Response Header >> Content-Type\n\n  If any of the above fields are not selected, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \"IIS\", double-click the \"Logging\" icon.\n\n  Configure the \"Format:\" under \"Log File\" to \"W3C\".\n\n  Select the \"Fields\" button.\n\n  Under \"Standard Fields\", select \"User Agent\", \"User Name\" and\n  \"Referrer\".\n\n  Under \"Custom Fields\", select the following fields:\n\n  Server Variable >> HTTP_USER_AGENT\n\n  Request Header >> User-Agent\n\n  Request Header >> Authorization\n\n  Response Header >> Content-Type\n\n  Click \"OK\".\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76791' do\n  title \"The IIS 8.5 website must produce log records containing sufficient\n  information to establish the identity of any user/subject or process associated\n  with an event.\"\n  desc \"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Determining user accounts, processes running on behalf of the user, and\n  running process identifiers also enable a better understanding of the overall\n  event. User tool identification is also helpful to determine if events are\n  related to overall user access or specific client tools.\n\n      Log record content that may be necessary to satisfy the requirement of this\n  control includes: time stamps, source and destination addresses, user/process\n  identifiers, event descriptions, success/fail indications, file names involved,\n  and access control or flow control rules invoked.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000100-WSR-000064'\n  tag \"gid\": 'V-76791'\n  tag \"rid\": 'SV-91487r1_rule'\n  tag \"stig_id\": 'IISW-SI-000210'\n  tag \"fix_id\": 'F-83487r1_fix'\n  tag \"cci\": ['CCI-001487']\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Under \\\"IIS\\\", double-click the \\\"Logging\\\" icon.\n\n  Verify the \\\"Format:\\\" under \\\"Log File\\\" is configured to \\\"W3C\\\".\n\n  Select the \\\"Fields\\\" button.\n\n  Under \\\"Standard Fields\\\", verify \\\"User Agent\\\", \\\"User Name\\\" and\n  \\\"Referrer\\\" are selected.\n\n  Under \\\"Custom Fields\\\", verify the following fields have been configured:\n\n  Server Variable >> HTTP_USER_AGENT\n\n  Request Header >> User-Agent\n\n  Request Header >> Authorization\n\n  Response Header >> Content-Type\n\n  If any of the above fields are not selected, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \\\"IIS\\\", double-click the \\\"Logging\\\" icon.\n\n  Configure the \\\"Format:\\\" under \\\"Log File\\\" to \\\"W3C\\\".\n\n  Select the \\\"Fields\\\" button.\n\n  Under \\\"Standard Fields\\\", select \\\"User Agent\\\", \\\"User Name\\\" and\n  \\\"Referrer\\\".\n\n  Under \\\"Custom Fields\\\", select the following fields:\n\n  Server Variable >> HTTP_USER_AGENT\n\n  Request Header >> User-Agent\n\n  Request Header >> Authorization\n\n  Response Header >> Content-Type\n\n  Click \\\"OK\\\".\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_logging_configuration = json(command: %(Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter 'System.Applicationhost/Sites/site[@name=\"#{site_name}\"]/logfile'  -Name * | ConvertTo-Json))\n\n    describe \"IIS Logging configuration for Site :'#{site_name}'\" do\n      subject { iis_logging_configuration }\n      its('logFormat') { should cmp 'W3C' }\n      its('logExtFileFlags') { should include 'UserName' }\n      its('logExtFileFlags') { should include 'UserAgent' }\n      its('logExtFileFlags') { should include 'Referer' }\n    end\n  end\n\n  site_names.each do |site_name|\n    custom_field_configuration = command(\"Get-WebConfiguration -filter \\\"system.applicationHost/sites/site[@name=\\'#{site_name}\\']/logFile/customFields/*\\\"\").stdout.strip\n    describe \"IIS Custom Fields Logging configuration for Site :'#{site_name}'\" do\n      subject { custom_field_configuration }\n      it { should match /sourceName\\s+:\\s+User-Agent\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+Authorization\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+Content-Type\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+HTTP_USER_AGENT\\s+sourceType\\s+:\\s+ServerVariable/ }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76791.rb"},"results":[]},{"id":"V-76795","title":"The log information from the IIS 8.5 website must be protected from\n  unauthorized modification or deletion.","desc":"A major tool in exploring the website use, attempted use, unusual\n  conditions, and problems are the access and error logs. In the event of a\n  security incident, these logs can provide the SA and the web manager with\n  valuable information. Failure to protect log files could enable an attacker to\n  modify the log file data or falsify events to mask an attacker's activity.","descriptions":[{"label":"default","data":"A major tool in exploring the website use, attempted use, unusual\n  conditions, and problems are the access and error logs. In the event of a\n  security incident, these logs can provide the SA and the web manager with\n  valuable information. Failure to protect log files could enable an attacker to\n  modify the log file data or falsify events to mask an attacker's activity."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000120-WSR-000070","gid":"V-76795","rid":"SV-91491r2_rule","stig_id":"IISW-SI-000213","fix_id":"F-83491r1_fix","cci":["CCI-000163","CCI-000164"],"nist":["AU-9","AU-9","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Click \"Browse\" and navigate to the directory where the log files are stored.\n\n  Right-click the log file name to review and click Properties.\n\n  Click the Security tab; verify only authorized groups are listed, if others\n  are listed, this is a finding.\n\n  Note: The log file should be restricted as follows:\n\n  SYSTEM, Auditors group: Full\n  SA, web managers: Read\n  ","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Click \"Browse\" and navigate to the directory where the log files are stored.\n\n  Right-click the log file name to review and click Properties.\n\n  Click the Security tab.\n\n  Set the log file permissions for the appropriate group."},"code":"control 'V-76795' do\n  title \"The log information from the IIS 8.5 website must be protected from\n  unauthorized modification or deletion.\"\n  desc \"A major tool in exploring the website use, attempted use, unusual\n  conditions, and problems are the access and error logs. In the event of a\n  security incident, these logs can provide the SA and the web manager with\n  valuable information. Failure to protect log files could enable an attacker to\n  modify the log file data or falsify events to mask an attacker's activity.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000120-WSR-000070'\n  tag \"gid\": 'V-76795'\n  tag \"rid\": 'SV-91491r2_rule'\n  tag \"stig_id\": 'IISW-SI-000213'\n  tag \"fix_id\": 'F-83491r1_fix'\n  tag \"cci\": ['CCI-000163', 'CCI-000164']\n  tag \"nist\": ['AU-9', 'AU-9', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Click \\\"Browse\\\" and navigate to the directory where the log files are stored.\n\n  Right-click the log file name to review and click Properties.\n\n  Click the Security tab; verify only authorized groups are listed, if others\n  are listed, this is a finding.\n\n  Note: The log file should be restricted as follows:\n\n  SYSTEM, Auditors group: Full\n  SA, web managers: Read\n  \"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Click \\\"Browse\\\" and navigate to the directory where the log files are stored.\n\n  Right-click the log file name to review and click Properties.\n\n  Click the Security tab.\n\n  Set the log file permissions for the appropriate group.\"\n\n  get_log_directory = command(\"Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter 'system.applicationHost/sites/*/logFile' -name * | select -expand directory\").stdout.strip.split(\"\\r\\n\")\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  get_log_directory.zip(get_names).each do |log_dir, names|\n    system_drive = command('$env:SystemDrive').stdout.strip\n\n    dirs = log_dir.gsub(/%SystemDrive%/, system_drive.to_s)\n\n    describe \"IIS site #{names} log file directory #{dirs}\" do\n      subject { file(dirs.to_s) }\n      it { should be_allowed('read', by_user: 'BUILTIN\\\\Administrators') }\n      it { should be_allowed('full-control', by_user: 'NT AUTHORITY\\\\SYSTEM') }\n      it { should be_allowed('full-control', by_user: 'NT SERVICE\\\\TrustedInstaller') }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76795.rb"},"results":[]},{"id":"V-76797","title":"The IIS 8.5 website must have Multipurpose Internet Mail Extensions\n  (MIME) that invoke OS shell programs disabled.","desc":"Controlling what a user of a hosted application can access is part of\n  the security posture of the web server. Any time a user can access more\n  functionality than is needed for the operation of the hosted application poses\n  a security issue. A user with too much access can view information that is not\n  needed for the user's job role, or the user could use the function in an\n  unintentional manner.\n\n      A MIME tells the web server what type of program various file types and\n  extensions are and what external utilities or programs are needed to execute\n  the file type.\n\n      A shell is a program that serves as the basic interface between the user\n  and the operating system, so hosted application users must not have access to\n  these programs. Shell programs may execute shell escapes and can then perform\n  unauthorized activities that could damage the security posture of the web\n  server.","descriptions":[{"label":"default","data":"Controlling what a user of a hosted application can access is part of\n  the security posture of the web server. Any time a user can access more\n  functionality than is needed for the operation of the hosted application poses\n  a security issue. A user with too much access can view information that is not\n  needed for the user's job role, or the user could use the function in an\n  unintentional manner.\n\n      A MIME tells the web server what type of program various file types and\n  extensions are and what external utilities or programs are needed to execute\n  the file type.\n\n      A shell is a program that serves as the basic interface between the user\n  and the operating system, so hosted application users must not have access to\n  these programs. Shell programs may execute shell escapes and can then perform\n  unauthorized activities that could damage the security posture of the web\n  server."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000081","gid":"V-76797","rid":"SV-91493r1_rule","stig_id":"IISW-SI-000214","fix_id":"F-83493r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the IIS 8.5 site.\n\n  Under IIS, double-click the “MIME Types” icon.\n\n  From the \"Group by:\" drop-down list, select \"Content Type\".\n\n  From the list of extensions under \"Application\", verify MIME types for OS\n  shell program extensions have been removed, to include at a minimum, the\n  following extensions:\n\n  .exe\n  .dll\n  .com\n  .bat\n  .csh\n\n  If any OS shell MIME types are configured, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the IIS 8.5 site.\n\n  Under IIS, double-click the MIME Types icon.\n\n  From the \"Group by:\" drop-down list, select \"Content Type\".\n\n  From the list of extensions under \"Application\", remove MIME types for OS\n  shell program extensions, to include at a minimum, the following extensions:\n\n  .exe\n  .dll\n  .com\n  .bat\n  .csh\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76797' do\n  title \"The IIS 8.5 website must have Multipurpose Internet Mail Extensions\n  (MIME) that invoke OS shell programs disabled.\"\n  desc \"Controlling what a user of a hosted application can access is part of\n  the security posture of the web server. Any time a user can access more\n  functionality than is needed for the operation of the hosted application poses\n  a security issue. A user with too much access can view information that is not\n  needed for the user's job role, or the user could use the function in an\n  unintentional manner.\n\n      A MIME tells the web server what type of program various file types and\n  extensions are and what external utilities or programs are needed to execute\n  the file type.\n\n      A shell is a program that serves as the basic interface between the user\n  and the operating system, so hosted application users must not have access to\n  these programs. Shell programs may execute shell escapes and can then perform\n  unauthorized activities that could damage the security posture of the web\n  server.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000081'\n  tag \"gid\": 'V-76797'\n  tag \"rid\": 'SV-91493r1_rule'\n  tag \"stig_id\": 'IISW-SI-000214'\n  tag \"fix_id\": 'F-83493r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the IIS 8.5 site.\n\n  Under IIS, double-click the “MIME Types” icon.\n\n  From the \\\"Group by:\\\" drop-down list, select \\\"Content Type\\\".\n\n  From the list of extensions under \\\"Application\\\", verify MIME types for OS\n  shell program extensions have been removed, to include at a minimum, the\n  following extensions:\n\n  .exe\n  .dll\n  .com\n  .bat\n  .csh\n\n  If any OS shell MIME types are configured, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the IIS 8.5 site.\n\n  Under IIS, double-click the MIME Types icon.\n\n  From the \\\"Group by:\\\" drop-down list, select \\\"Content Type\\\".\n\n  From the list of extensions under \\\"Application\\\", remove MIME types for OS\n  shell program extensions, to include at a minimum, the following extensions:\n\n  .exe\n  .dll\n  .com\n  .bat\n  .csh\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  get_names = command(\"Get-Website | select name | findstr /r /v '^$' | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_names.each do |names|\n    n = names.strip\n    exe_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.exe'}\").stdout\n    dll_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.dll'}\").stdout\n\n    com_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.com'}\").stdout\n\n    bat_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.bat'}\").stdout\n\n    csh_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.csh'}\").stdout\n\n    describe \"The IIS Site: #{n} MIME .exe files found\" do\n      subject { exe_files }\n      it { should be_empty }\n    end\n    describe \"The IIS Site: #{n}  MIME .dll files found\" do\n      subject { dll_files }\n      it { should be_empty }\n    end\n    describe \"The IIS Site: #{n} MIME .com files found\" do\n      subject { com_files }\n      it { should be_empty }\n    end\n    describe \"The IIS Site: #{n} .bat files found\" do\n      subject { bat_files }\n      it { should be_empty }\n    end\n    describe \"The IIS Site: #{n} MIME .csh files found\" do\n      subject { csh_files }\n      it { should be_empty }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76797.rb"},"results":[]},{"id":"V-76799","title":"Mappings to unused and vulnerable scripts on the IIS 8.5 website must\n  be removed.","desc":"IIS 8.5 will either allow or deny script execution based on file\n  extension. The ability to control script execution is controlled through two\n  features with IIS 8.5, Request Filtering and \"Handler Mappings\".\n\n      For \"Handler Mappings\", the ISSO must document and approve all allowable\n  file extensions the website allows (white list) and denies (black list) by the\n  website. The white list and black list will be compared to the \"Handler\n  Mappings\" in IIS 8. \"Handler Mappings\" at the site level take precedence\n  over \"Handler Mappings\" at the server level.","descriptions":[{"label":"default","data":"IIS 8.5 will either allow or deny script execution based on file\n  extension. The ability to control script execution is controlled through two\n  features with IIS 8.5, Request Filtering and \"Handler Mappings\".\n\n      For \"Handler Mappings\", the ISSO must document and approve all allowable\n  file extensions the website allows (white list) and denies (black list) by the\n  website. The white list and black list will be compared to the \"Handler\n  Mappings\" in IIS 8. \"Handler Mappings\" at the site level take precedence\n  over \"Handler Mappings\" at the server level."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000082","gid":"V-76799","rid":"SV-91495r1_rule","stig_id":"IISW-SI-000215","fix_id":"F-83495r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"For \"Handler Mappings\", the ISSO must document and approve\n  all allowable scripts the website allows (white list) and denies (black list)\n  by the website. The white list and black list will be compared to the \"Handler\n  Mappings\" in IIS 8.5. \"Handler Mappings\" at the site level take precedence\n  over \"Handler Mappings\" at the server level.\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \"Handler Mappings\".\n\n  If any script file extensions from the black list are enabled, this is a\n  finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \"Handler Mappings\".\n\n  Remove any script file extensions listed on the black list that are enabled.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76799' do\n  title \"Mappings to unused and vulnerable scripts on the IIS 8.5 website must\n  be removed.\"\n  desc \"IIS 8.5 will either allow or deny script execution based on file\n  extension. The ability to control script execution is controlled through two\n  features with IIS 8.5, Request Filtering and \\\"Handler Mappings\\\".\n\n      For \\\"Handler Mappings\\\", the ISSO must document and approve all allowable\n  file extensions the website allows (white list) and denies (black list) by the\n  website. The white list and black list will be compared to the \\\"Handler\n  Mappings\\\" in IIS 8. \\\"Handler Mappings\\\" at the site level take precedence\n  over \\\"Handler Mappings\\\" at the server level.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000082'\n  tag \"gid\": 'V-76799'\n  tag \"rid\": 'SV-91495r1_rule'\n  tag \"stig_id\": 'IISW-SI-000215'\n  tag \"fix_id\": 'F-83495r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For \\\"Handler Mappings\\\", the ISSO must document and approve\n  all allowable scripts the website allows (white list) and denies (black list)\n  by the website. The white list and black list will be compared to the \\\"Handler\n  Mappings\\\" in IIS 8.5. \\\"Handler Mappings\\\" at the site level take precedence\n  over \\\"Handler Mappings\\\" at the server level.\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\"Handler Mappings\\\".\n\n  If any script file extensions from the black list are enabled, this is a\n  finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\"Handler Mappings\\\".\n\n  Remove any script file extensions listed on the black list that are enabled.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  describe 'Manually review the Handler Mappings' do\n    skip 'Manually review site Handler Mappings configuration; If any script file\n    extensions from the black list are enabled, this is a finding.\"'\n  end\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76799.rb"},"results":[]},{"id":"V-76801","title":"The IIS 8.5 website must have resource mappings set to disable the\nserving of certain file types.","desc":"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    The web server must only allow hosted application file types to be served\nto a user and all other types must be disabled.","descriptions":[{"label":"default","data":"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    The web server must only allow hosted application file types to be served\nto a user and all other types must be disabled."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000083","gid":"V-76801","rid":"SV-91497r1_rule","stig_id":"IISW-SI-000216","fix_id":"F-83497r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"For \"Handler Mappings\", the ISSO must document and approve\n  all allowable file extensions the website allows (white list) and denies (black\n  list) by the website. The white list and black list will be compared to the\n  \"Handler Mappings\" in IIS 8.5. \"Handler Mappings\" at the site level take\n  precedence over \"Handler Mappings\" at the server level.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click \"Request Filtering\".\n\n  If any file name extensions from the black list have \"Allowed\" set to\n  \"True\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \"Request Filtering\".\n\n  For any file name extensions from the black list which have \"Allowed\" set to\n  \"True\", remove the file name extension.\n\n  Select \"Deny File Name Extension\" from the \"Actions\" pane.\n\n  Add each file name extension from the black list.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76801' do\n  title \"The IIS 8.5 website must have resource mappings set to disable the\nserving of certain file types.\"\n  desc  \"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    The web server must only allow hosted application file types to be served\nto a user and all other types must be disabled.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000083'\n  tag \"gid\": 'V-76801'\n  tag \"rid\": 'SV-91497r1_rule'\n  tag \"stig_id\": 'IISW-SI-000216'\n  tag \"fix_id\": 'F-83497r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For \\\"Handler Mappings\\\", the ISSO must document and approve\n  all allowable file extensions the website allows (white list) and denies (black\n  list) by the website. The white list and black list will be compared to the\n  \\\"Handler Mappings\\\" in IIS 8.5. \\\"Handler Mappings\\\" at the site level take\n  precedence over \\\"Handler Mappings\\\" at the server level.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click \\\"Request Filtering\\\".\n\n  If any file name extensions from the black list have \\\"Allowed\\\" set to\n  \\\"True\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\"Request Filtering\\\".\n\n  For any file name extensions from the black list which have \\\"Allowed\\\" set to\n  \\\"True\\\", remove the file name extension.\n\n  Select \\\"Deny File Name Extension\\\" from the \\\"Actions\\\" pane.\n\n  Add each file name extension from the black list.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n  black_listed_extensions = attribute('black_listed_extensions')\n\n  site_names.each do |site_name|\n    extensions = command(\"Get-WebConfigurationProperty -Filter /system.webserver/security/requestFiltering/fileExtensions 'IIS:\\\\Sites\\\\#{site_name}'  -Name Collection | where {$_.allowed -eq $true}| select -expand fileExtension\").stdout.split\n\n    describe \"Allowed Request Filtering extensions should not be in black listed extensions; #{extensions}\" do\n      subject { extensions }\n      it { should_not be_in black_listed_extensions }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76801.rb"},"results":[]},{"id":"V-76803","title":"The IIS 8.5 website must have Web Distributed Authoring and Versioning\n  (WebDAV) disabled.","desc":"A web server can be installed with functionality that, just by its\n  nature, is not secure. Web Distributed Authoring (WebDAV) is an extension to\n  the HTTP protocol that, when developed, was meant to allow users to create,\n  change, and move documents on a server, typically a web server or web share.\n  Allowing this functionality, development, and deployment is much easier for web\n  authors.\n\n      WebDAV is not widely used and has serious security concerns because it may\n  allow clients to modify unauthorized files on the web server.","descriptions":[{"label":"default","data":"A web server can be installed with functionality that, just by its\n  nature, is not secure. Web Distributed Authoring (WebDAV) is an extension to\n  the HTTP protocol that, when developed, was meant to allow users to create,\n  change, and move documents on a server, typically a web server or web share.\n  Allowing this functionality, development, and deployment is much easier for web\n  authors.\n\n      WebDAV is not widely used and has serious security concerns because it may\n  allow clients to modify unauthorized files on the web server."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000085","gid":"V-76803","rid":"SV-91499r1_rule","stig_id":"IISW-SI-000217","fix_id":"F-83499r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Select the IIS 8.5 website.\n\n  Review the features listed under the \"IIS\" section.\n\n  If the \"WebDAV Authoring Rules\" icon exists, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access Server Manager on the IIS 8.5 website.\n\n  Select the Local Server.\n\n  Click on \"Manage\".\n\n  Select \"Add Roles and Features\".\n\n  Click \"Next\" on the \"Before you begin\" dialog box.\n\n  Select \"Role-based or feature-based installation\" on the \"Installation\n  Type\" dialog box and click on \"Next\".\n\n  Select the IIS 8.5 web server on the \"Server Selection\" dialog box.\n\n  From the \"Windows Features\" dialog box, navigate to \"World Wide Web\n  Services\" >> \"Common HTTP Features\".\n\n  De-select \"WebDAV Publishing\" and click \"Next\" to complete removing the\n  WebDAV Publishing feature from the IIS 8.5 web server.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76803' do\n  title \"The IIS 8.5 website must have Web Distributed Authoring and Versioning\n  (WebDAV) disabled.\"\n  desc \"A web server can be installed with functionality that, just by its\n  nature, is not secure. Web Distributed Authoring (WebDAV) is an extension to\n  the HTTP protocol that, when developed, was meant to allow users to create,\n  change, and move documents on a server, typically a web server or web share.\n  Allowing this functionality, development, and deployment is much easier for web\n  authors.\n\n      WebDAV is not widely used and has serious security concerns because it may\n  allow clients to modify unauthorized files on the web server.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000085'\n  tag \"gid\": 'V-76803'\n  tag \"rid\": 'SV-91499r1_rule'\n  tag \"stig_id\": 'IISW-SI-000217'\n  tag \"fix_id\": 'F-83499r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Select the IIS 8.5 website.\n\n  Review the features listed under the \\\"IIS\\\" section.\n\n  If the \\\"WebDAV Authoring Rules\\\" icon exists, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access Server Manager on the IIS 8.5 website.\n\n  Select the Local Server.\n\n  Click on \\\"Manage\\\".\n\n  Select \\\"Add Roles and Features\\\".\n\n  Click \\\"Next\\\" on the \\\"Before you begin\\\" dialog box.\n\n  Select \\\"Role-based or feature-based installation\\\" on the \\\"Installation\n  Type\\\" dialog box and click on \\\"Next\\\".\n\n  Select the IIS 8.5 web server on the \\\"Server Selection\\\" dialog box.\n\n  From the \\\"Windows Features\\\" dialog box, navigate to \\\"World Wide Web\n  Services\\\" >> \\\"Common HTTP Features\\\".\n\n  De-select \\\"WebDAV Publishing\\\" and click \\\"Next\\\" to complete removing the\n  WebDAV Publishing feature from the IIS 8.5 web server.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  describe windows_feature('Web-DAV-Publishing') do\n    it { should_not be_installed }\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76803.rb"},"results":[]},{"id":"V-76805","title":"The production website must configure the Global .NET Trust Level.","desc":"A web server may host too many applications. Each application will\n  need certain system resources and privileged operations to operate correctly.\n  An application's trust level determines the permissions granted by the ASP.NET\n  Code Access Security (CAS) policy. An application with full trust permissions\n  may access all resource types on a server and perform privileged operations,\n  while applications running with partial trust have varying levels of operating\n  permissions and access to resources. The CAS determines the permissions granted\n  to the application on the server. Setting a level of trust compatible with the\n  applications will limit the potential harm a compromised application could\n  cause to a system. The web server must be configured to contain and control the\n  applications and protect the system resources and privileged operations from\n  those not needed by the application for operation.\n\n      Limiting the application will confine the potential harm a compromised\n  application could cause to a system.","descriptions":[{"label":"default","data":"A web server may host too many applications. Each application will\n  need certain system resources and privileged operations to operate correctly.\n  An application's trust level determines the permissions granted by the ASP.NET\n  Code Access Security (CAS) policy. An application with full trust permissions\n  may access all resource types on a server and perform privileged operations,\n  while applications running with partial trust have varying levels of operating\n  permissions and access to resources. The CAS determines the permissions granted\n  to the application on the server. Setting a level of trust compatible with the\n  applications will limit the potential harm a compromised application could\n  cause to a system. The web server must be configured to contain and control the\n  applications and protect the system resources and privileged operations from\n  those not needed by the application for operation.\n\n      Limiting the application will confine the potential harm a compromised\n  application could cause to a system."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000086","gid":"V-76805","rid":"SV-91501r2_rule","stig_id":"IISW-SI-000218","fix_id":"F-83501r2_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the server being reviewed is a non-production website,\n  this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \".NET Trust Level\" icon.\n\n  If the \".NET Trust Level\" is not set to Full or less, this is a finding.\n  ","fix":"Note: If the server being reviewed is a non-production website,\n  this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \".NET Trust Level\" icon.\n\n  Set the \".NET Trust Level\" to Full or less and click Apply.\n\n  Select \"Apply\" from the \"Actions\" pane.\n  "},"code":"control 'V-76805' do\n  title 'The production website must configure the Global .NET Trust Level.'\n  desc  \"A web server may host too many applications. Each application will\n  need certain system resources and privileged operations to operate correctly.\n  An application's trust level determines the permissions granted by the ASP.NET\n  Code Access Security (CAS) policy. An application with full trust permissions\n  may access all resource types on a server and perform privileged operations,\n  while applications running with partial trust have varying levels of operating\n  permissions and access to resources. The CAS determines the permissions granted\n  to the application on the server. Setting a level of trust compatible with the\n  applications will limit the potential harm a compromised application could\n  cause to a system. The web server must be configured to contain and control the\n  applications and protect the system resources and privileged operations from\n  those not needed by the application for operation.\n\n      Limiting the application will confine the potential harm a compromised\n  application could cause to a system.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000086'\n  tag \"gid\": 'V-76805'\n  tag \"rid\": 'SV-91501r2_rule'\n  tag \"stig_id\": 'IISW-SI-000218'\n  tag \"fix_id\": 'F-83501r2_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: If the server being reviewed is a non-production website,\n  this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\".NET Trust Level\\\" icon.\n\n  If the \\\".NET Trust Level\\\" is not set to Full or less, this is a finding.\n  \"\n  tag \"fix\": \"Note: If the server being reviewed is a non-production website,\n  this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\".NET Trust Level\\\" icon.\n\n  Set the \\\".NET Trust Level\\\" to Full or less and click Apply.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\n  \"\n  get_names = command(\"Get-Website | select name | findstr /r /v '^$' | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_names.each do |names|\n    n = names.strip\n    get_trust_level = command(\"Get-WebConfigurationProperty -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter system.web/trust -name * | select -expand level\").stdout.strip.split(\"\\n\")\n    get_trust_level.each do |trust_level|\n      a = trust_level.strip\n      describe \"The IIS site: #{n} Global .NET Trust Level\" do\n        subject { a }\n        it { should cmp 'Full' }\n      end\n    end\n  end\n\n  if attribute('non_production_server')\n    impact 0.0\n    desc 'The server being reviewed is a non-production website server, hence\n    this control is Not Applicable.'\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76805.rb"},"results":[]},{"id":"V-76807","title":"Each IIS 8.5 website must be assigned a default host header.","desc":"The web server must be configured to listen on a specified IP address\n  and port. Without specifying an IP address and port for the web server to\n  utilize, the web server will listen on all IP addresses available to the\n  hosting server. If the web server has multiple IP addresses, i.e., a management\n  IP address, the web server will also accept connections on the management IP\n  address.\n\n      Accessing the hosted application through an IP address normally used for\n  non-application functions opens the possibility of user access to resources,\n  utilities, files, ports, and protocols that are protected on the desired\n  application IP address.","descriptions":[{"label":"default","data":"The web server must be configured to listen on a specified IP address\n  and port. Without specifying an IP address and port for the web server to\n  utilize, the web server will listen on all IP addresses available to the\n  hosting server. If the web server has multiple IP addresses, i.e., a management\n  IP address, the web server will also accept connections on the management IP\n  address.\n\n      Accessing the hosted application through an IP address normally used for\n  non-application functions opens the possibility of user access to resources,\n  utilities, files, ports, and protocols that are protected on the desired\n  application IP address."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000142-WSR-000089","gid":"V-76807","rid":"SV-91503r1_rule","stig_id":"IISW-SI-000219","fix_id":"F-83503r1_fix","cci":["CCI-000382"],"nist":["CM-7 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Right-click on the site name under review.\n\n  Select Edit Bindings.\n\n  Verify there are hostname entries and unique IP addresses assigned to port 80\n  for HTTP and port 443 for HTTPS.\n\n  If both hostname entries and unique IP addresses are not configure to port 80\n  for HTTP and port 443 for HTTPS, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Right-click on the site name under review.\n\n  Select Edit Bindings.\n\n  Assign hostname entries and unique IP addresses to port 80 for HTTP and port\n  443 for HTTPS.\n\n  Click \"OK\".\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76807' do\n  title 'Each IIS 8.5 website must be assigned a default host header.'\n  desc \"The web server must be configured to listen on a specified IP address\n  and port. Without specifying an IP address and port for the web server to\n  utilize, the web server will listen on all IP addresses available to the\n  hosting server. If the web server has multiple IP addresses, i.e., a management\n  IP address, the web server will also accept connections on the management IP\n  address.\n\n      Accessing the hosted application through an IP address normally used for\n  non-application functions opens the possibility of user access to resources,\n  utilities, files, ports, and protocols that are protected on the desired\n  application IP address.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000142-WSR-000089'\n  tag \"gid\": 'V-76807'\n  tag \"rid\": 'SV-91503r1_rule'\n  tag \"stig_id\": 'IISW-SI-000219'\n  tag \"fix_id\": 'F-83503r1_fix'\n  tag \"cci\": ['CCI-000382']\n  tag \"nist\": ['CM-7 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Right-click on the site name under review.\n\n  Select Edit Bindings.\n\n  Verify there are hostname entries and unique IP addresses assigned to port 80\n  for HTTP and port 443 for HTTPS.\n\n  If both hostname entries and unique IP addresses are not configure to port 80\n  for HTTP and port 443 for HTTPS, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Right-click on the site name under review.\n\n  Select Edit Bindings.\n\n  Assign hostname entries and unique IP addresses to port 80 for HTTP and port\n  443 for HTTPS.\n\n  Click \\\"OK\\\".\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_name = attribute('site_name')\n\n  http_ip = attribute('http_ip')\n\n  http_hostname = attribute('http_hostname')\n\n  https_ip = attribute('https_ip')\n\n  https_hostname = attribute('https_hostname')\n\n  site_name.zip(http_ip, http_hostname).each do |site, httpip, httphostname|\n    describe iis_site(site.to_s) do\n      it { should exist }\n      it { should have_binding(\"http #{httpip}:80:#{httphostname}\") }\n    end\n  end\n  site_name.zip(https_ip, https_hostname).each do |site, httpsip, httsphostname|\n    describe iis_site(site.to_s) do\n      it { should exist }\n      it { should have_binding(\"https #{httpsip}:80:#{httsphostname}\") }\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76807.rb"},"results":[]},{"id":"V-76809","title":"A private websites authentication mechanism must use client\n  certificates to transmit session identifier to assure integrity.","desc":"A CMS private website must utilize PKI as an authentication mechanism for web \n         users. Information systems residing behind web servers requiring authorization \n         based on individual identity must use the identity provided by certificate-based \n         authentication to support access control decisions. Not using client certificates \n         allows an attacker unauthenticated access to private websites.\n\n         Satisfies: SRG-APP-000172-WSR-000104, SRG-APP-000224-WSR-000135, SRG-APP-000427-WSR-000186","descriptions":[{"label":"default","data":"A CMS private website must utilize PKI as an authentication mechanism for web \n         users. Information systems residing behind web servers requiring authorization \n         based on individual identity must use the identity provided by certificate-based \n         authentication to support access control decisions. Not using client certificates \n         allows an attacker unauthenticated access to private websites.\n\n         Satisfies: SRG-APP-000172-WSR-000104, SRG-APP-000224-WSR-000135, SRG-APP-000427-WSR-000186"}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000172-WSR-000104","satisfies":["SRG-APP-000172-WSR-000104","SRG-APP-000224-WSR-000135","SRG-APP-000427-WSR-000186"],"gid":"V-76809","rid":"SV-91505r1_rule","stig_id":"IISW-SI-000220","fix_id":"F-83505r1_fix","cci":["CCI-000197","CCI-001188","CCI-002470"],"nist":["IA-5 (1) (c)","SC-23 (3)","SC-23 (5)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Verify the \"Clients Certificate Required\" check box is selected.\n\n  If the \"Clients Certificate Required\" check box is not selected, this is a\n  finding.","fix":"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Verify the \"Clients Certificate Required\" check box is selected.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"  control 'V-76809' do\n    desc 'A CMS private website must utilize PKI as an authentication mechanism for web \n         users. Information systems residing behind web servers requiring authorization \n         based on individual identity must use the identity provided by certificate-based \n         authentication to support access control decisions. Not using client certificates \n         allows an attacker unauthenticated access to private websites.\n\n         Satisfies: SRG-APP-000172-WSR-000104, SRG-APP-000224-WSR-000135, SRG-APP-000427-WSR-000186'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76809.rb"},"results":[]},{"id":"V-76811","title":"Anonymous IIS 8.5 website access accounts must be restricted.","desc":"Many of the security problems that occur are not the result of a user\n  gaining access to files or data for which the user does not have permissions,\n  but rather users are assigned incorrect permissions to unauthorized data. The\n  files, directories, and data that are stored on the web server need to be\n  evaluated and a determination made concerning authorized access to information\n  and programs on the server. Only authorized users and administrative accounts\n  will be allowed on the host server in order to maintain the web server,\n  applications, and review the server operations.","descriptions":[{"label":"default","data":"Many of the security problems that occur are not the result of a user\n  gaining access to files or data for which the user does not have permissions,\n  but rather users are assigned incorrect permissions to unauthorized data. The\n  files, directories, and data that are stored on the web server need to be\n  evaluated and a determination made concerning authorized access to information\n  and programs on the server. Only authorized users and administrative accounts\n  will be allowed on the host server in order to maintain the web server,\n  applications, and review the server operations."}],"impact":0.7,"refs":[],"tags":{"gtitle":"SRG-APP-000211-WSR-000031","gid":"V-76811","rid":"SV-91507r1_rule","stig_id":"IISW-SI-000221","fix_id":"F-83507r1_fix","cci":["CCI-001082"],"nist":["SC-2","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Check the account used for anonymous access to the website.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click \"Authentication\" in the IIS section of the websites Home Pane.\n\n  If Anonymous access is disabled, this is Not a Finding.\n\n  If Anonymous access is enabled, click “Anonymous Authentication”.\n\n  Click 'Edit' in the 'Actions' pane.\n\n  If the “Specific user” radio button is enabled and an ID is specified in the \n  adjacent control box, this is the ID being used for anonymous access. \n\n  Note: account name.\n\n  Check privileged groups that may allow the anonymous account inappropriate \n  membership:\n\n  Open “Server Manager” on the machine.\n\n  Expand Configuration.\n\n  Expand Local Users and Groups.\n\n  Click “Groups”.\n\n  Review members of any of the following privileged groups:\n\n  Administrators\n  Backup Operators\n  Certificate Services (of any designation)\n  Distributed COM Users\n  Event Log Readers\n  Network Configuration Operators\n  Performance Log Users\n  Performance Monitor Users\n  Power Users\n  Print Operators\n  Remote Desktop Users\n  Replicator\n  Users\n\n  Double-click each group and review its members.\n\n  If the IUSR account or any account used for anonymous access is a member of any\n  group with privileged access, this is a finding.","fix":"Remove the Anonymous access account from all privileged accounts\n  and all privileged groups."},"code":"control 'V-76811' do\n  title 'Anonymous IIS 8.5 website access accounts must be restricted.'\n  desc  \"Many of the security problems that occur are not the result of a user\n  gaining access to files or data for which the user does not have permissions,\n  but rather users are assigned incorrect permissions to unauthorized data. The\n  files, directories, and data that are stored on the web server need to be\n  evaluated and a determination made concerning authorized access to information\n  and programs on the server. Only authorized users and administrative accounts\n  will be allowed on the host server in order to maintain the web server,\n  applications, and review the server operations.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000211-WSR-000031'\n  tag \"gid\": 'V-76811'\n  tag \"rid\": 'SV-91507r1_rule'\n  tag \"stig_id\": 'IISW-SI-000221'\n  tag \"fix_id\": 'F-83507r1_fix'\n  tag \"cci\": ['CCI-001082']\n  tag \"nist\": ['SC-2', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Check the account used for anonymous access to the website.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click \\\"Authentication\\\" in the IIS section of the websites Home Pane.\n\n  If Anonymous access is disabled, this is Not a Finding.\n\n  If Anonymous access is enabled, click “Anonymous Authentication”.\n\n  Click 'Edit' in the 'Actions' pane.\n\n  If the “Specific user” radio button is enabled and an ID is specified in the \n  adjacent control box, this is the ID being used for anonymous access. \n\n  Note: account name.\n\n  Check privileged groups that may allow the anonymous account inappropriate \n  membership:\n\n  Open “Server Manager” on the machine.\n\n  Expand Configuration.\n\n  Expand Local Users and Groups.\n\n  Click “Groups”.\n\n  Review members of any of the following privileged groups:\n\n  Administrators\n  Backup Operators\n  Certificate Services (of any designation)\n  Distributed COM Users\n  Event Log Readers\n  Network Configuration Operators\n  Performance Log Users\n  Performance Monitor Users\n  Power Users\n  Print Operators\n  Remote Desktop Users\n  Replicator\n  Users\n\n  Double-click each group and review its members.\n\n  If the IUSR account or any account used for anonymous access is a member of any\n  group with privileged access, this is a finding.\"\n  tag \"fix\": \"Remove the Anonymous access account from all privileged accounts\n  and all privileged groups.\"\n\n  get_names = command(\"Get-Website | select name | findstr /r /v '^$' | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_names.each do |names|\n    n = names.strip\n\n    is_anonymous_access_enabled = command(\"Get-WebConfigurationProperty -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter system.webServer/security/authentication/anonymousAuthentication -name * | select -expand Enabled\").stdout.strip.split(\"\\n\")\n\n    is_anonymous_access_enabled.each do |a|\n      if a == 'True'\n        get_anonymous_authentication_account = command(\"Get-WebConfigurationProperty -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -Filter system.webServer/security/authentication/anonymousAuthentication -name * | select -expand userName\").stdout.strip\n\n        describe \"IIS site #{n} Administrator user with anonymous access allowed\" do\n          subject { command(\"net localgroup Administrators | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Backup Operators user with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Backup Operators' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Certificate Service DCOM Access user with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Certificate Service DCOM Access' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Distributed COM Users user with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Distributed COM Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Event Log Readers with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Event Log Readers' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Network Configuration Operators with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Network Configuration Operators' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Performance Log Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Performance Log Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Performance Monitor Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Performance Monitor Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Power Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Power Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Print Operators with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Print Operators' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Remote Desktop Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Remote Desktop Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Replicator with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Replicator' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n      else\n        describe \"IIS site #{n} anonymous access setting\" do\n          subject { a }\n          it { should cmp 'False' }\n        end\n      end\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76811.rb"},"results":[]},{"id":"V-76813","title":"The IIS 8.5 website must generate unique session identifiers that\n  cannot be reliably reproduced.","desc":"Communication between a client and the web server is done using the\n  HTTP protocol, but HTTP is a stateless protocol. In order to maintain a\n  connection or session, a web server will generate a session identifier (ID) for\n  each client session when the session is initiated. The session ID allows the\n  web server to track a user session and, in many cases, the user, if the user\n  previously logged into a hosted application.\n\n      By being able to guess session IDs, an attacker can easily perform a\n  man-in-the-middle attack. To truly generate random session identifiers that\n  cannot be reproduced, the web server session ID generator, when used twice with\n  the same input criteria, must generate an unrelated random ID.\n\n    The session ID generator also needs to be a FIPS 140-2-approved generator.","descriptions":[{"label":"default","data":"Communication between a client and the web server is done using the\n  HTTP protocol, but HTTP is a stateless protocol. In order to maintain a\n  connection or session, a web server will generate a session identifier (ID) for\n  each client session when the session is initiated. The session ID allows the\n  web server to track a user session and, in many cases, the user, if the user\n  previously logged into a hosted application.\n\n      By being able to guess session IDs, an attacker can easily perform a\n  man-in-the-middle attack. To truly generate random session identifiers that\n  cannot be reproduced, the web server session ID generator, when used twice with\n  the same input criteria, must generate an unrelated random ID.\n\n    The session ID generator also needs to be a FIPS 140-2-approved generator."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000224-WSR-000136","gid":"V-76813","rid":"SV-91509r1_rule","stig_id":"IISW-SI-000223","fix_id":"F-83509r1_fix","cci":["CCI-001188"],"nist":["SC-23 (3)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \"ASP.NET\" section, select \"Session State\".\n\n  Under \"Session State\" Mode Settings, verify the \"In Process\" mode is\n  selected.\n\n  If the \"In Process\" mode is selected, this is not a finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Verify the \"mode\" reflects \"InProc\".\n\n  If the \"mode\" is not set to \"InProc\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the ASP.NET section, select \"Session State\".\n\n  Under \"Session State\" Mode Settings, select the \"In Process\" mode."},"code":"control 'V-76813' do\n  title \"The IIS 8.5 website must generate unique session identifiers that\n  cannot be reliably reproduced.\"\n  desc \"Communication between a client and the web server is done using the\n  HTTP protocol, but HTTP is a stateless protocol. In order to maintain a\n  connection or session, a web server will generate a session identifier (ID) for\n  each client session when the session is initiated. The session ID allows the\n  web server to track a user session and, in many cases, the user, if the user\n  previously logged into a hosted application.\n\n      By being able to guess session IDs, an attacker can easily perform a\n  man-in-the-middle attack. To truly generate random session identifiers that\n  cannot be reproduced, the web server session ID generator, when used twice with\n  the same input criteria, must generate an unrelated random ID.\n\n    The session ID generator also needs to be a FIPS 140-2-approved generator.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000224-WSR-000136'\n  tag \"gid\": 'V-76813'\n  tag \"rid\": 'SV-91509r1_rule'\n  tag \"stig_id\": 'IISW-SI-000223'\n  tag \"fix_id\": 'F-83509r1_fix'\n  tag \"cci\": ['CCI-001188']\n  tag \"nist\": ['SC-23 (3)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \\\"ASP.NET\\\" section, select \\\"Session State\\\".\n\n  Under \\\"Session State\\\" Mode Settings, verify the \\\"In Process\\\" mode is\n  selected.\n\n  If the \\\"In Process\\\" mode is selected, this is not a finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Verify the \\\"mode\\\" reflects \\\"InProc\\\".\n\n  If the \\\"mode\\\" is not set to \\\"InProc\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the ASP.NET section, select \\\"Session State\\\".\n\n  Under \\\"Session State\\\" Mode Settings, select the \\\"In Process\\\" mode.\"\n  get_mode = command('Get-WebConfigurationProperty -Filter system.web/sessionState -pspath \"IIS:\\Sites\\*\" -name * | select -expand mode').stdout.strip.split(\"\\r\\n\")\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_mode.zip(get_names).each do |mode, names|\n    describe \"The IIS site: #{names} website session state\" do\n      subject { mode }\n      it { should eq 'InProc' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76813.rb"},"results":[]},{"id":"V-76815","title":"The IIS 8.5 website document directory must be in a separate partition\n  from the IIS 8.5 websites system files.","desc":"The web document (home) directory is accessed by multiple anonymous\n  users when the web server is in production. By locating the web document (home)\n  directory on the same partition as the web server system file the risk for\n  unauthorized access to these protected files is increased. Additionally, having\n  the web document (home) directory path on the same drive as the system folders\n  also increases the potential for a drive space exhaustion attack.","descriptions":[{"label":"default","data":"The web document (home) directory is accessed by multiple anonymous\n  users when the web server is in production. By locating the web document (home)\n  directory on the same partition as the web server system file the risk for\n  unauthorized access to these protected files is increased. Additionally, having\n  the web document (home) directory path on the same drive as the system folders\n  also increases the potential for a drive space exhaustion attack."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000233-WSR-000146","gid":"V-76815","rid":"SV-91511r1_rule","stig_id":"IISW-SI-000224","fix_id":"F-83511r1_fix","cci":["CCI-001084"],"nist":["SC-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click the \"Advanced Settings\" from the \"Actions\" pane.\n\n  Review the Physical Path.\n\n  If the Path is on the same partition as the OS, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click the Advanced Settings from the \"Actions\" pane.\n\n  Change the Physical Path to the new partition and directory location."},"code":"control 'V-76815' do\n  title \"The IIS 8.5 website document directory must be in a separate partition\n  from the IIS 8.5 websites system files.\"\n  desc  \"The web document (home) directory is accessed by multiple anonymous\n  users when the web server is in production. By locating the web document (home)\n  directory on the same partition as the web server system file the risk for\n  unauthorized access to these protected files is increased. Additionally, having\n  the web document (home) directory path on the same drive as the system folders\n  also increases the potential for a drive space exhaustion attack.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000233-WSR-000146'\n  tag \"gid\": 'V-76815'\n  tag \"rid\": 'SV-91511r1_rule'\n  tag \"stig_id\": 'IISW-SI-000224'\n  tag \"fix_id\": 'F-83511r1_fix'\n  tag \"cci\": ['CCI-001084']\n  tag \"nist\": ['SC-3', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click the \\\"Advanced Settings\\\" from the \\\"Actions\\\" pane.\n\n  Review the Physical Path.\n\n  If the Path is on the same partition as the OS, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click the Advanced Settings from the \\\"Actions\\\" pane.\n\n  Change the Physical Path to the new partition and directory location.\"\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_names.each do |names|\n    n = names.strip\n    system_drive = command('$env:SystemDrive').stdout.strip\n\n    get_physical_path = command(\"(Get-Website -Name '#{n}').PhysicalPath\").stdout.strip.gsub(/%SystemDrive%/, system_drive.to_s)\n\n    path = get_physical_path[0..1]\n    describe \"IIS site #{n} physical path #{path}\" do\n      subject { path.gsub(/%SystemDrive%/, system_drive.to_s) }\n      it { should_not cmp system_drive.to_s }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76815.rb"},"results":[]},{"id":"V-76817","title":"The IIS 8.5 website must be configured to limit the maxURL.","desc":"Request filtering replaces URLScan in IIS, enabling administrators to\n  create a more granular rule set with which to allow or reject inbound web\n  content. By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The MaxURL Request Filter limits the number of bytes the server will\n  accept in a URL.","descriptions":[{"label":"default","data":"Request filtering replaces URLScan in IIS, enabling administrators to\n  create a more granular rule set with which to allow or reject inbound web\n  content. By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The MaxURL Request Filter limits the number of bytes the server will\n  accept in a URL."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the \n         need for these fields in event records. As a result, the associated NIST \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76817","rid":"SV-91513r1_rule","stig_id":"IISW-SI-000225","fix_id":"F-83513r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If the \"maxUrl\" value is not set to \"4096\" or less, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Set the \"maxURL\" value to \"4096\" or less."},"code":"  control 'V-76817' do\n    tag \"cci\": ['CCI-001310']\n    tag \"nist\": ['SI-10', 'Rev_4']\n    desc 'caveat', 'SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the \n         need for these fields in event records. As a result, the associated NIST \n         control has been changed to SI-10.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76817.rb"},"results":[]},{"id":"V-76819","title":"The IIS 8.5 website must be configured to limit the size of web\n  requests.","desc":"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The\n  maxAllowedContentLength Request Filter limits the number of bytes the server\n  will accept in a request.","descriptions":[{"label":"default","data":"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The\n  maxAllowedContentLength Request Filter limits the number of bytes the server\n  will accept in a request."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76819","rid":"SV-91515r2_rule","stig_id":"IISW-SI-000226","fix_id":"F-83515r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click “Edit Feature Settings” in the \"Actions\" pane.\n\n  If the \"maxAllowedContentLength\" value is not explicitly set to \"30000000\"\n  or less or a length documented and approved by the ISSO, this is a finding.\n  ","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click “Edit Feature Settings” in the \"Actions\" pane.\n\n  Set the \"maxAllowedContentLength\" value to \"30000000\" or less."},"code":"  control 'V-76819' do\n    tag \"cci\": ['CCI-001310']\n    tag \"nist\": ['SI-10', 'Rev_4']\n    desc 'caveat', 'SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76819.rb"},"results":[]},{"id":"V-76821","title":"The IIS 8.5 websites Maximum Query String limit must be configured.","desc":"By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The Maximum Query String Request Filter describes the upper limit on\n  allowable query string lengths. Upon exceeding the configured value, IIS will\n  generate a Status Code 404.15.","descriptions":[{"label":"default","data":"By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The Maximum Query String Request Filter describes the upper limit on\n  allowable query string lengths. Upon exceeding the configured value, IIS will\n  generate a Status Code 404.15."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76821","rid":"SV-91517r1_rule","stig_id":"IISW-SI-000227","fix_id":"F-83517r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If the \"Maximum Query String\" value is not set to \"2048\" or less, this is a\n  finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Set the \"Maximum Query String\" value to \"2048\" or less."},"code":"  control 'V-76821' do\n    tag \"cci\": ['CCI-001310']\n    tag \"nist\": ['SI-10', 'Rev_4']\n    desc 'caveat', 'SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76821.rb"},"results":[]},{"id":"V-76823","title":"Non-ASCII characters in URLs must be prohibited by any IIS 8.5\n  website.","desc":"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The allow\n  high-bit characters Request Filter enables rejection of requests containing\n  non-ASCII characters.","descriptions":[{"label":"default","data":"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The allow\n  high-bit characters Request Filter enables rejection of requests containing\n  non-ASCII characters."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76823","rid":"SV-91519r1_rule","stig_id":"IISW-SI-000228","fix_id":"F-83519r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If the \"Allow high-bit characters\" check box is checked, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Uncheck the \"Allow high-bit characters\" check box."},"code":"  control 'V-76823' do\t\n    tag \"cci\": ['CCI-001310']\n    tag \"nist\": ['SI-10', 'Rev_4']\n    desc 'caveat', 'SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76823.rb"},"results":[]},{"id":"V-76825","title":"Double encoded URL requests must be prohibited by any IIS 8.5 website.","desc":"Request filtering enables administrators to create a more granular\n  rule set with which to allow or reject inbound web content. By setting limits\n  on web requests, it ensures availability of web services and mitigates the risk\n  of buffer overflow type attacks. When the “Allow double escaping” option is\n  disabled it prevents attacks that rely on double-encoded requests.","descriptions":[{"label":"default","data":"Request filtering enables administrators to create a more granular\n  rule set with which to allow or reject inbound web content. By setting limits\n  on web requests, it ensures availability of web services and mitigates the risk\n  of buffer overflow type attacks. When the “Allow double escaping” option is\n  disabled it prevents attacks that rely on double-encoded requests."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76825","rid":"SV-91521r1_rule","stig_id":"IISW-SI-000229","fix_id":"F-83521r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If the \"Allow double escaping\" check box is checked, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Uncheck the \"Allow double escaping\" check box."},"code":"  control 'V-76825' do\t\n    tag \"cci\": ['CCI-001310']\n    tag \"nist\": ['SI-10', 'Rev_4']\n    desc 'caveat', 'SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76825.rb"},"results":[]},{"id":"V-76827","title":"Unlisted file extensions in URL requests must be filtered by any IIS\n  8.5 website.","desc":"Request filtering enables administrators to create a more granular\n  rule set to allow or reject inbound web content. By setting limits on web\n  requests it helps to ensure availability of web services and may also help\n  mitigate the risk of buffer overflow type attacks. The allow unlisted property\n  of the “File Extensions Request” filter enables rejection of requests\n  containing specific file extensions not defined in the “File Extensions”\n  filter. Tripping this filter will cause IIS to generate a Status Code 404.7.","descriptions":[{"label":"default","data":"Request filtering enables administrators to create a more granular\n  rule set to allow or reject inbound web content. By setting limits on web\n  requests it helps to ensure availability of web services and may also help\n  mitigate the risk of buffer overflow type attacks. The allow unlisted property\n  of the “File Extensions Request” filter enables rejection of requests\n  containing specific file extensions not defined in the “File Extensions”\n  filter. Tripping this filter will cause IIS to generate a Status Code 404.7."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76827","rid":"SV-91523r1_rule","stig_id":"IISW-SI-000230","fix_id":"F-83523r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If \"Allow unlisted file name extensions\" check box is checked, this is a\n\n  finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Uncheck the \"Allow unlisted file extensions\" check box."},"code":"  control 'V-76827' do\t\n    tag \"cci\": ['CCI-001310']\n    tag \"nist\": ['SI-10', 'Rev_4']\n    desc 'caveat', 'SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76827.rb"},"results":[]},{"id":"V-76829","title":"Directory Browsing on the IIS 8.5 website must be disabled.","desc":"Directory Browsing is not installed, hence this control is Not Applicable.","descriptions":[{"label":"default","data":"Directory Browsing is not installed, hence this control is Not Applicable."}],"impact":0.0,"refs":[],"tags":{"gtitle":"SRG-APP-000251-WSR-000157","gid":"V-76829","rid":"SV-91525r1_rule","stig_id":"IISW-SI-000231","fix_id":"F-83525r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Click the Site.\n\n  Double-click the \"Directory Browsing\" icon.\n\n  If the \"Directory Browsing\" is not installed, this is Not Applicable.\n\n  Under the \"Actions\" pane verify \"Directory Browsing\" is \"Disabled\".\n\n  If \"Directory Browsing\" is not \"Disabled\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Site.\n\n  Double-click the \"Directory Browsing\" icon.\n\n  Under the \"Actions\" pane click \"Disabled\"."},"code":"control 'V-76829' do\n  title 'Directory Browsing on the IIS 8.5 website must be disabled.'\n  desc  \"Directory browsing allows the contents of a directory to be displayed\n  upon request from a web client. If directory browsing is enabled for a\n  directory in IIS, users could receive a web page listing the contents of the\n  directory. If directory browsing is enabled the risk of inadvertently\n  disclosing sensitive content is increased.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000251-WSR-000157'\n  tag \"gid\": 'V-76829'\n  tag \"rid\": 'SV-91525r1_rule'\n  tag \"stig_id\": 'IISW-SI-000231'\n  tag \"fix_id\": 'F-83525r1_fix'\n  tag \"cci\": ['CCI-001310']\n  tag \"nist\": ['SI-10', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Click the Site.\n\n  Double-click the \\\"Directory Browsing\\\" icon.\n\n  If the \\\"Directory Browsing\\\" is not installed, this is Not Applicable.\n\n  Under the \\\"Actions\\\" pane verify \\\"Directory Browsing\\\" is \\\"Disabled\\\".\n\n  If \\\"Directory Browsing\\\" is not \\\"Disabled\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Site.\n\n  Double-click the \\\"Directory Browsing\\\" icon.\n\n  Under the \\\"Actions\\\" pane click \\\"Disabled\\\".\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_directory_browsing = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/directoryBrowse -name * | select -expand enabled').stdout.strip.split(\"\\r\\n\")\n\n  get_directory_browsing.zip(get_names).each do |directory_browsing, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites enable directory browsing\" do\n      subject { directory_browsing }\n      it { should cmp 'False' }\n    end\n  end\n\n  if command('Get-WebConfiguration  system.webServer/globalModules/*').stdout.strip.include?('DirectoryListingModule')\n    impact 0.0\n    desc 'Directory Browsing is not installed, hence this control is Not Applicable.'\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76829.rb"},"results":[]},{"id":"V-76831","title":"The IIS 8.5 website must prevent a web content directory from being\n  displayed.","desc":"The goal is to control the web users experience in navigating any\n  portion of the web document root directories. Ensuring all web content\n  directories have at least the equivalent of an indexhtml file is a significant\n  factor to accomplish this end. Also enumeration techniques such as URL\n  parameter manipulation rely upon being able to obtain information about the\n  web servers directory structure by locating directories with default pages\n  This practice helps ensure the anonymous web user will not obtain directory\n  browsing information or an error message revealing the server type and version.","descriptions":[{"label":"default","data":"The goal is to control the web users experience in navigating any\n  portion of the web document root directories. Ensuring all web content\n  directories have at least the equivalent of an indexhtml file is a significant\n  factor to accomplish this end. Also enumeration techniques such as URL\n  parameter manipulation rely upon being able to obtain information about the\n  web servers directory structure by locating directories with default pages\n  This practice helps ensure the anonymous web user will not obtain directory\n  browsing information or an error message revealing the server type and version."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000266-WSR-000142","gid":"V-76831","rid":"SV-91527r1_rule","stig_id":"IISW-SI-000232","fix_id":"F-83527r1_fix","cci":["CCI-001312"],"nist":["SI-11 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: This requirement is only for each site's root directory.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Click the site name under review.\n\n  Double-click \"Default Document\".\n\n  In the \"Actions\" pane, verify the \"Default Document\" feature is enabled.\n\n  If an \"Enable\" option is listed under the \"Actions\" pane, the \"Default\n  Document\" feature is not enabled and this is a finding.\n\n  If \"Default Document\" is \"Enabled, review the document types.\n\n  Click the \"Content View\" tab, click on each listed \"Default Document\" and\n  click on \"Explore\" under the \"Actions\" pane. Verify there is a document of\n  that type in the directory.\n\n  If \"Default Document\" is \"Enabled\" but no listed document types are present\n  in the \"Content View\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \"Default Document\".\n\n  In the Actions pane select \"Enable\".\n\n  Click the \"Content View\" tab, click on each listed \"Default Document\" and\n  click on \"Explore\" under the \"Actions\" pane. Create a valid document for\n  the listed \"Default Document\"."},"code":"control 'V-76831' do\n  title \"The IIS 8.5 website must prevent a web content directory from being\n  displayed.\"\n  desc \"The goal is to control the web users experience in navigating any\n  portion of the web document root directories. Ensuring all web content\n  directories have at least the equivalent of an indexhtml file is a significant\n  factor to accomplish this end. Also enumeration techniques such as URL\n  parameter manipulation rely upon being able to obtain information about the\n  web servers directory structure by locating directories with default pages\n  This practice helps ensure the anonymous web user will not obtain directory\n  browsing information or an error message revealing the server type and version.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000266-WSR-000142'\n  tag \"gid\": 'V-76831'\n  tag \"rid\": 'SV-91527r1_rule'\n  tag \"stig_id\": 'IISW-SI-000232'\n  tag \"fix_id\": 'F-83527r1_fix'\n  tag \"cci\": ['CCI-001312']\n  tag \"nist\": ['SI-11 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: This requirement is only for each site's root directory.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Click the site name under review.\n\n  Double-click \\\"Default Document\\\".\n\n  In the \\\"Actions\\\" pane, verify the \\\"Default Document\\\" feature is enabled.\n\n  If an \\\"Enable\\\" option is listed under the \\\"Actions\\\" pane, the \\\"Default\n  Document\\\" feature is not enabled and this is a finding.\n\n  If \\\"Default Document\\\" is \\\"Enabled, review the document types.\n\n  Click the \\\"Content View\\\" tab, click on each listed \\\"Default Document\\\" and\n  click on \\\"Explore\\\" under the \\\"Actions\\\" pane. Verify there is a document of\n  that type in the directory.\n\n  If \\\"Default Document\\\" is \\\"Enabled\\\" but no listed document types are present\n  in the \\\"Content View\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\"Default Document\\\".\n\n  In the Actions pane select \\\"Enable\\\".\n\n  Click the \\\"Content View\\\" tab, click on each listed \\\"Default Document\\\" and\n  click on \\\"Explore\\\" under the \\\"Actions\\\" pane. Create a valid document for\n  the listed \\\"Default Document\\\".\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.split(\"\\r\\n\")\n\n  get_default_document_enabled = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/defaultDocument -name * | select -expand enabled').stdout.split(\"\\r\\n\")\n\n  get_default_document_enabled.zip(get_names).each do |default_document_enabled, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites default document enabled\" do\n      subject { default_document_enabled }\n      it { should cmp 'True' }\n    end\n  end\n\n  get_names.each do |names|\n    n = names.strip\n    get_default_document_view = command(\"Get-WebConfigurationProperty  -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -Filter system.webServer/defaultDocument/files/add -Name value | Select value | Findstr /v 'Value ---'\").stdout.strip.split(\"\\r\\n\")\n    get_default_document_view.each do |default_document_view|\n      describe \"The IIS site: #{n} websites default document view #{default_document_view}\" do\n        subject { default_document_view }\n        it { should_not eq '' }\n      end\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76831.rb"},"results":[]},{"id":"V-76835","title":"Warning and error messages displayed to clients must be modified to\n  minimize the identity of the IIS 8.5 website, patches, loaded modules, and\n  directory paths.","desc":"HTTP error pages contain information that could enable an attacker to\n  gain access to an information system. Failure to prevent the sending of HTTP\n  error pages with full information to remote requesters exposes internal\n  configuration information to potential attackers.","descriptions":[{"label":"default","data":"HTTP error pages contain information that could enable an attacker to\n  gain access to an information system. Failure to prevent the sending of HTTP\n  error pages with full information to remote requesters exposes internal\n  configuration information to potential attackers."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000266-WSR-000159","gid":"V-76835","rid":"SV-91531r1_rule","stig_id":"IISW-SI-000233","fix_id":"F-83531r1_fix","cci":["CCI-001312"],"nist":["SI-11 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Error Pages\" icon.\n\n  Click each error message and click \"Edit Feature\" setting from the\n  \"Actions\" pane.\n\n  If any error message is not set to “Detailed errors for local requests and\n  custom error pages for remote requests”, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Error Pages\" icon.\n\n  Click each error message and click \"Edit Feature\" Setting from the\n  \"Actions\" pane; set each error message to “Detailed errors for local requests\n  and custom error pages for remote requests”."},"code":"control 'V-76835' do\n  title \"Warning and error messages displayed to clients must be modified to\n  minimize the identity of the IIS 8.5 website, patches, loaded modules, and\n  directory paths.\"\n  desc \"HTTP error pages contain information that could enable an attacker to\n  gain access to an information system. Failure to prevent the sending of HTTP\n  error pages with full information to remote requesters exposes internal\n  configuration information to potential attackers.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000266-WSR-000159'\n  tag \"gid\": 'V-76835'\n  tag \"rid\": 'SV-91531r1_rule'\n  tag \"stig_id\": 'IISW-SI-000233'\n  tag \"fix_id\": 'F-83531r1_fix'\n  tag \"cci\": ['CCI-001312']\n  tag \"nist\": ['SI-11 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\"Error Pages\\\" icon.\n\n  Click each error message and click \\\"Edit Feature\\\" setting from the\n  \\\"Actions\\\" pane.\n\n  If any error message is not set to “Detailed errors for local requests and\n  custom error pages for remote requests”, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\"Error Pages\\\" icon.\n\n  Click each error message and click \\\"Edit Feature\\\" Setting from the\n  \\\"Actions\\\" pane; set each error message to “Detailed errors for local requests\n  and custom error pages for remote requests”.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_errorMode = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/httpErrors -Name errorMode').stdout.strip.split(\"\\r\\n\")\n\n  get_errorMode.zip(get_names).each do |errorMode, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites error mode\" do\n      subject { errorMode }\n      it { should cmp 'DetailedLocalOnly' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76835.rb"},"results":[]},{"id":"V-76837","title":"Debugging and trace information used to diagnose the IIS 8.5 website\n  must be disabled.","desc":".NET feature not installed hence the control not applicable","descriptions":[{"label":"default","data":".NET feature not installed hence the control not applicable"}],"impact":0.0,"refs":[],"tags":{"gtitle":"SRG-APP-000266-WSR-000160","gid":"V-76837","rid":"SV-91533r1_rule","stig_id":"IISW-SI-000234","fix_id":"F-83533r1_fix","cci":["CCI-001312"],"nist":["SI-11 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the \".NET feature\" is not installed, this check is\n  Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \".NET Compilation\".\n\n  Scroll down to the \"Behavior\" section and verify the value for \"Debug\" is\n  set to \"False\".\n\n  If the \"Debug\" value is not set to \"False\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \".NET Compilation\".\n\n  Scroll down to the \"Behavior\" section and set the value for \"Debug\" to\n  \"False\"."},"code":"control 'V-76837' do\n  title \"Debugging and trace information used to diagnose the IIS 8.5 website\n  must be disabled.\"\n  desc \"Setting compilation debug to false ensures detailed error information\n  does not inadvertently display during live application usage, mitigating the\n  risk of application information being displayed to users.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000266-WSR-000160'\n  tag \"gid\": 'V-76837'\n  tag \"rid\": 'SV-91533r1_rule'\n  tag \"stig_id\": 'IISW-SI-000234'\n  tag \"fix_id\": 'F-83533r1_fix'\n  tag \"cci\": ['CCI-001312']\n  tag \"nist\": ['SI-11 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: If the \\\".NET feature\\\" is not installed, this check is\n  Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\".NET Compilation\\\".\n\n  Scroll down to the \\\"Behavior\\\" section and verify the value for \\\"Debug\\\" is\n  set to \\\"False\\\".\n\n  If the \\\"Debug\\\" value is not set to \\\"False\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\".NET Compilation\\\".\n\n  Scroll down to the \\\"Behavior\\\" section and set the value for \\\"Debug\\\" to\n  \\\"False\\\".\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_debug_enabled = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.web/compilation -name * | select -expand debug').stdout.strip.split(\"\\r\\n\")\n\n  get_debug_enabled.zip(get_names).each do |debug_enabled, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites debugging enabled\" do\n      subject { debug_enabled }\n      it { should cmp 'False' }\n    end\n  end\n\n  iis_modules = command('Get-WebConfiguration  system.webServer/globalModules/*').stdout.strip\n\n  unless iis_modules.include?('.NET')\n    impact 0.0\n    desc '.NET feature not installed hence the control not applicable'\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76837.rb"},"results":[]},{"id":"V-76839","title":"The Idle Time-out monitor for each IIS 8.5 website must be enabled.","desc":"The idle time-out attribute controls the amount of time a worker\n  process will remain idle before it shuts down. A worker process is idle if it\n  is not processing requests and no new requests are received.\n\n      The purpose of this attribute is to conserve system resources; the default\n  value for idle time-out is 20 minutes.\n\n      By default, the World Wide Web (WWW) service establishes an overlapped\n  recycle, in which the worker process to be shut down is kept running until\n  after a new worker process is started.","descriptions":[{"label":"default","data":"The idle time-out attribute controls the amount of time a worker\n  process will remain idle before it shuts down. A worker process is idle if it\n  is not processing requests and no new requests are received.\n\n      The purpose of this attribute is to conserve system resources; the default\n  value for idle time-out is 20 minutes.\n\n      By default, the World Wide Web (WWW) service establishes an overlapped\n  recycle, in which the worker process to be shut down is kept running until\n  after a new worker process is started."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000295-WSR-000012","gid":"V-76839","rid":"SV-91535r1_rule","stig_id":"IISW-SI-000235","fix_id":"F-83535r1_fix","cci":["CCI-002361"],"nist":["AC-12","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Process Model\" section and verify the value for \"Idle\n  Time-out\" is set to \"20\".\n\n  If the \"Idle Time-out\" is not set to \"20\" or less, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Process Model\" section and set the value for \"Idle\n  Time-out\" to \"20\" or less."},"code":"control 'V-76839' do\n  title 'The Idle Time-out monitor for each IIS 8.5 website must be enabled.'\n  desc  \"The idle time-out attribute controls the amount of time a worker\n  process will remain idle before it shuts down. A worker process is idle if it\n  is not processing requests and no new requests are received.\n\n      The purpose of this attribute is to conserve system resources; the default\n  value for idle time-out is 20 minutes.\n\n      By default, the World Wide Web (WWW) service establishes an overlapped\n  recycle, in which the worker process to be shut down is kept running until\n  after a new worker process is started.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000295-WSR-000012'\n  tag \"gid\": 'V-76839'\n  tag \"rid\": 'SV-91535r1_rule'\n  tag \"stig_id\": 'IISW-SI-000235'\n  tag \"fix_id\": 'F-83535r1_fix'\n  tag \"cci\": ['CCI-002361']\n  tag \"nist\": ['AC-12', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Process Model\\\" section and verify the value for \\\"Idle\n  Time-out\\\" is set to \\\"20\\\".\n\n  If the \\\"Idle Time-out\\\" is not set to \\\"20\\\" or less, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Process Model\\\" section and set the value for \\\"Idle\n  Time-out\\\" to \\\"20\\\" or less.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_idleTimeout_monitor = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.applicationHost/applicationPools -name * | select -expand applicationPoolDefaults | select -expand processModel | select -expand idleTimeout | select -expand TotalMinutes').stdout.strip.split(\"\\r\\n\")\n\n  get_idleTimeout_monitor.zip(get_names).each do |idleTimeout_monitor, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites idle monitor time-out\" do\n      subject { idleTimeout_monitor }\n      it { should cmp <= 20 }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76839.rb"},"results":[]},{"id":"V-76841","title":"The IIS 8.5 websites connectionTimeout setting must be explicitly\n  configured to disconnect an idle session.","desc":"Leaving sessions open indefinitely is a major security risk. An\n  attacker can easily use an already authenticated session to access the hosted\n  application as the previously authenticated user. By closing sessions after a\n  set period of inactivity, the web server can make certain that those sessions\n  that are not closed through the user logging out of an application are\n  eventually closed.\n\n      Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.","descriptions":[{"label":"default","data":"Leaving sessions open indefinitely is a major security risk. An\n  attacker can easily use an already authenticated session to access the hosted\n  application as the previously authenticated user. By closing sessions after a\n  set period of inactivity, the web server can make certain that those sessions\n  that are not closed through the user logging out of an application are\n  eventually closed.\n\n      Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000295-WSR-000134","gid":"V-76841","rid":"SV-91537r2_rule","stig_id":"IISW-SI-000236","fix_id":"F-83537r2_fix","cci":["CCI-002361"],"nist":["AC-12","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Verify the \"timeout\" is set to \"00:20:00 or less”, using the lowest value\n  possible depending upon the application.\n  Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n\n  If \"timeout\" is not set to \"00:20:00 or less”, this is a finding.\n\n  ","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Set the \"timeout\" to \"00:20:00 or less”, using the lowest value possible\n  depending upon the application.\n  Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n\n  In the \"Actions\" pane, click \"Apply\".\n  "},"code":"control 'V-76841' do\n  title \"The IIS 8.5 websites connectionTimeout setting must be explicitly\n  configured to disconnect an idle session.\"\n  desc \"Leaving sessions open indefinitely is a major security risk. An\n  attacker can easily use an already authenticated session to access the hosted\n  application as the previously authenticated user. By closing sessions after a\n  set period of inactivity, the web server can make certain that those sessions\n  that are not closed through the user logging out of an application are\n  eventually closed.\n\n      Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000295-WSR-000134'\n  tag \"gid\": 'V-76841'\n  tag \"rid\": 'SV-91537r2_rule'\n  tag \"stig_id\": 'IISW-SI-000236'\n  tag \"fix_id\": 'F-83537r2_fix'\n  tag \"cci\": ['CCI-002361']\n  tag \"nist\": ['AC-12', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Verify the \\\"timeout\\\" is set to \\\"00:20:00 or less”, using the lowest value\n  possible depending upon the application.\n  Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n\n  If \\\"timeout\\\" is not set to \\\"00:20:00 or less”, this is a finding.\n\n  \"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Set the \\\"timeout\\\" to \\\"00:20:00 or less”, using the lowest value possible\n  depending upon the application.\n  Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n\n  In the \\\"Actions\\\" pane, click \\\"Apply\\\".\n  \"\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_connectionTimeout = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.web/sessionState -name * | select -expand timeout | select -expand TotalMinutes').stdout.strip.split(\"\\r\\n\")\n\n  get_connectionTimeout.zip(get_names).each do |connectionTimeout, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites connection timeout\" do\n      subject { connectionTimeout }\n      it { should cmp <= 20 }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76841.rb"},"results":[]},{"id":"V-76843","title":"The IIS 8.5 website must provide the capability to immediately\n  disconnect or disable remote access to the hosted applications.","desc":"During an attack on the web server or any of the hosted applications,\n  the system administrator may need to disconnect or disable access by users to\n  stop the attack.\n\n      The web server must provide a capability to disconnect users to a hosted\n  application without compromising other hosted applications unless deemed\n  necessary to stop the attack. Methods to disconnect or disable connections are\n  to stop the application service for a specified hosted application, stop the\n  web server, or block all connections through web server access list.\n\n      The web server capabilities used to disconnect or disable users from\n  connecting to hosted applications and the web server must be documented to make\n  certain that, during an attack, the proper action is taken to conserve\n  connectivity to any other hosted application if possible and to make certain\n  log data is conserved for later forensic analysis.","descriptions":[{"label":"default","data":"During an attack on the web server or any of the hosted applications,\n  the system administrator may need to disconnect or disable access by users to\n  stop the attack.\n\n      The web server must provide a capability to disconnect users to a hosted\n  application without compromising other hosted applications unless deemed\n  necessary to stop the attack. Methods to disconnect or disable connections are\n  to stop the application service for a specified hosted application, stop the\n  web server, or block all connections through web server access list.\n\n      The web server capabilities used to disconnect or disable users from\n  connecting to hosted applications and the web server must be documented to make\n  certain that, during an attack, the proper action is taken to conserve\n  connectivity to any other hosted application if possible and to make certain\n  log data is conserved for later forensic analysis."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000316-WSR-000170","gid":"V-76843","rid":"SV-91539r1_rule","stig_id":"IISW-SI-000237","fix_id":"F-83539r1_fix","cci":["CCI-002322"],"nist":["AC-17 (9)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Interview the System Administrator and Web Manager.\n\n  Ask for documentation for the IIS 8.5 web server administration.\n\n  Verify there are documented procedures for shutting down an IIS 8.5 website in\n  the event of an attack. The procedure should, at a minimum, provide the\n  following steps:\n\n  Determine the respective website for the application at risk of an attack.\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the respective website.\n\n  In the \"Actions\" pane, under \"Manage Website\", click on \"Stop\".\n\n  If necessary, stop all websites.\n\n  If necessary, stop the IIS 8.5 web server by selecting the web server in the\n  IIS 8.5 Manager.\n\n  In the \"Actions\" pane, under \"Manage Server\", click on \"Stop\".\n\n  If there are not documented procedures with, at a minimum, the mentioned steps\n  for stopping a website, this is a finding.","fix":"Prepare documented procedures for shutting down an IIS 8.5\n  website in the event of an attack. The procedure should, at a minimum, provide\n  the following steps:\n\n  Determine the respective website for the application at risk of an attack.\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the respective website.\n\n  In the \"Actions\" pane, under \"Manage Website\", click on \"Stop\".\n\n  If necessary, stop all websites.\n\n  If necessary, stop the IIS 8.5 web server by selecting the web server in the\n  IIS 8.5 Manager.\n\n  In the \"Actions\" pane, under \"Manage Server\", click on \"Stop\"."},"code":"control 'V-76843' do\n  title \"The IIS 8.5 website must provide the capability to immediately\n  disconnect or disable remote access to the hosted applications.\"\n  desc \"During an attack on the web server or any of the hosted applications,\n  the system administrator may need to disconnect or disable access by users to\n  stop the attack.\n\n      The web server must provide a capability to disconnect users to a hosted\n  application without compromising other hosted applications unless deemed\n  necessary to stop the attack. Methods to disconnect or disable connections are\n  to stop the application service for a specified hosted application, stop the\n  web server, or block all connections through web server access list.\n\n      The web server capabilities used to disconnect or disable users from\n  connecting to hosted applications and the web server must be documented to make\n  certain that, during an attack, the proper action is taken to conserve\n  connectivity to any other hosted application if possible and to make certain\n  log data is conserved for later forensic analysis.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000316-WSR-000170'\n  tag \"gid\": 'V-76843'\n  tag \"rid\": 'SV-91539r1_rule'\n  tag \"stig_id\": 'IISW-SI-000237'\n  tag \"fix_id\": 'F-83539r1_fix'\n  tag \"cci\": ['CCI-002322']\n  tag \"nist\": ['AC-17 (9)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Interview the System Administrator and Web Manager.\n\n  Ask for documentation for the IIS 8.5 web server administration.\n\n  Verify there are documented procedures for shutting down an IIS 8.5 website in\n  the event of an attack. The procedure should, at a minimum, provide the\n  following steps:\n\n  Determine the respective website for the application at risk of an attack.\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the respective website.\n\n  In the \\\"Actions\\\" pane, under \\\"Manage Website\\\", click on \\\"Stop\\\".\n\n  If necessary, stop all websites.\n\n  If necessary, stop the IIS 8.5 web server by selecting the web server in the\n  IIS 8.5 Manager.\n\n  In the \\\"Actions\\\" pane, under \\\"Manage Server\\\", click on \\\"Stop\\\".\n\n  If there are not documented procedures with, at a minimum, the mentioned steps\n  for stopping a website, this is a finding.\"\n  tag \"fix\": \"Prepare documented procedures for shutting down an IIS 8.5\n  website in the event of an attack. The procedure should, at a minimum, provide\n  the following steps:\n\n  Determine the respective website for the application at risk of an attack.\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the respective website.\n\n  In the \\\"Actions\\\" pane, under \\\"Manage Website\\\", click on \\\"Stop\\\".\n\n  If necessary, stop all websites.\n\n  If necessary, stop the IIS 8.5 web server by selecting the web server in the\n  IIS 8.5 Manager.\n\n  In the \\\"Actions\\\" pane, under \\\"Manage Server\\\", click on \\\"Stop\\\".\"\n\n  describe \"The IIS 8.5 website must provide the capability to immediately\n  disconnect or disable remote access to the hosted applications\" do\n    skip 'The control should be manually reviewed.'\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76843.rb"},"results":[]},{"id":"V-76845","title":"The IIS 8.5 website must use a logging mechanism that is configured to\n  allocate log record storage capacity large enough to accommodate the logging\n  requirements of the IIS 8.5 website.","desc":"In order to make certain that the logging mechanism used by the web\n  server has sufficient storage capacity in which to write the logs, the logging\n  mechanism needs to be able to allocate log record storage capacity.\n\n      The task of allocating log record storage capacity is usually performed\n  during initial installation of the logging mechanism. The system administrator\n  will usually coordinate the allocation of physical drive space with the web\n  server administrator along with the physical location of the partition and\n  disk. Refer to NIST SP 800-92 for specific requirements on log rotation and\n  storage dependent on the impact of the web server.","descriptions":[{"label":"default","data":"In order to make certain that the logging mechanism used by the web\n  server has sufficient storage capacity in which to write the logs, the logging\n  mechanism needs to be able to allocate log record storage capacity.\n\n      The task of allocating log record storage capacity is usually performed\n  during initial installation of the logging mechanism. The system administrator\n  will usually coordinate the allocation of physical drive space with the web\n  server administrator along with the physical location of the partition and\n  disk. Refer to NIST SP 800-92 for specific requirements on log rotation and\n  storage dependent on the impact of the web server."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000357-WSR-000150","gid":"V-76845","rid":"SV-91541r1_rule","stig_id":"IISW-SI-000238","fix_id":"F-83541r1_fix","cci":["CCI-001849"],"nist":["AU-4","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Under \"IIS\" double-click on the \"Logging\" icon.\n\n  In the \"Logging\" configuration box, determine the \"Directory:\" to which the\n  \"W3C\" logging is being written.\n\n  Confirm with the System Administrator that the designated log path is of\n  sufficient size to maintain the logging.\n\n  Under \"Log File Rollover\", verify the \"Do not create new log files\" is not\n  selected.\n\n  Verify a schedule is configured to rollover log files on a regular basis.\n\n  Consult with the System Administrator to determine if there is a documented\n  process for moving the log files off of the IIS 8.5 web server to another\n  logging device.\n\n  If the designated logging path device is not of sufficient space to maintain\n  all log files and there is not a schedule to rollover files on a regular basis,\n  this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Under \"IIS\" double-click on the \"Logging\" icon.\n\n  If necessary, in the \"Logging\" configuration box, redesignate a log path to a\n  location able to house the logs.\n\n  Under \"Log File Rollover\", deselect the \"Do not create new log files\"\n  setting.\n\n  Configure a schedule to rollover log files on a regular basis."},"code":"control 'V-76845' do\n  title \"The IIS 8.5 website must use a logging mechanism that is configured to\n  allocate log record storage capacity large enough to accommodate the logging\n  requirements of the IIS 8.5 website.\"\n  desc \"In order to make certain that the logging mechanism used by the web\n  server has sufficient storage capacity in which to write the logs, the logging\n  mechanism needs to be able to allocate log record storage capacity.\n\n      The task of allocating log record storage capacity is usually performed\n  during initial installation of the logging mechanism. The system administrator\n  will usually coordinate the allocation of physical drive space with the web\n  server administrator along with the physical location of the partition and\n  disk. Refer to NIST SP 800-92 for specific requirements on log rotation and\n  storage dependent on the impact of the web server.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000357-WSR-000150'\n  tag \"gid\": 'V-76845'\n  tag \"rid\": 'SV-91541r1_rule'\n  tag \"stig_id\": 'IISW-SI-000238'\n  tag \"fix_id\": 'F-83541r1_fix'\n  tag \"cci\": ['CCI-001849']\n  tag \"nist\": ['AU-4', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Under \\\"IIS\\\" double-click on the \\\"Logging\\\" icon.\n\n  In the \\\"Logging\\\" configuration box, determine the \\\"Directory:\\\" to which the\n  \\\"W3C\\\" logging is being written.\n\n  Confirm with the System Administrator that the designated log path is of\n  sufficient size to maintain the logging.\n\n  Under \\\"Log File Rollover\\\", verify the \\\"Do not create new log files\\\" is not\n  selected.\n\n  Verify a schedule is configured to rollover log files on a regular basis.\n\n  Consult with the System Administrator to determine if there is a documented\n  process for moving the log files off of the IIS 8.5 web server to another\n  logging device.\n\n  If the designated logging path device is not of sufficient space to maintain\n  all log files and there is not a schedule to rollover files on a regular basis,\n  this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Under \\\"IIS\\\" double-click on the \\\"Logging\\\" icon.\n\n  If necessary, in the \\\"Logging\\\" configuration box, redesignate a log path to a\n  location able to house the logs.\n\n  Under \\\"Log File Rollover\\\", deselect the \\\"Do not create new log files\\\"\n  setting.\n\n  Configure a schedule to rollover log files on a regular basis.\"\n\n  log_directory_path = attribute('log_directory')\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  system_drive = command('$env:SystemDrive').stdout.strip\n\n  get_log_directory = command(\"Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter 'system.applicationHost/sites/*/logFile' -name * | select -expand directory\").stdout.strip.split(\"\\r\\n\")\n\n  get_log_directory.zip(get_names).each do |log_directory, name|\n    log_directory = log_directory.gsub(/%SystemDrive%/, system_drive.to_s)\n\n    describe \"The IIS site: #{name} log directory\" do\n      subject { log_directory }\n      it { should cmp log_directory_path.to_s }\n    end\n  end\n\n  get_log_period = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.ApplicationHost/log -name centralW3CLogFile | select -expand period').stdout.strip.split(\"\\r\\n\")\n\n  get_log_period.zip(get_names).each do |log_period, name|\n    describe \"The IIS site: #{name} websites log file rollover period\" do\n      subject { log_period }\n      it { should cmp 'Daily' }\n    end\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76845.rb"},"results":[]},{"id":"V-76847","title":"The IIS 8.5 websites must utilize ports, protocols, and services \n          according to CMS guidelines.","desc":"Web servers provide numerous processes, features, and functionalities \n         that utilize TCP/IP ports. Some of these processes may be deemed \n         unnecessary or too unsecure to run on a production system.\n\n         The web server must provide the capability to disable or deactivate \n         network-related services that are deemed to be non-essential to the \n         server mission, are too unsecure, or are prohibited by CMS and \n         vulnerability assessments.\n\n         Failure to comply with CMS ports, protocols, and services (PPS) \n         requirements can result in compromise of enclave boundary protections \n         and/or functionality of the Information System.\n\n         The ISSO will ensure web servers are configured to use only necessary \n         ports, protocols, and services.","descriptions":[{"label":"default","data":"Web servers provide numerous processes, features, and functionalities \n         that utilize TCP/IP ports. Some of these processes may be deemed \n         unnecessary or too unsecure to run on a production system.\n\n         The web server must provide the capability to disable or deactivate \n         network-related services that are deemed to be non-essential to the \n         server mission, are too unsecure, or are prohibited by CMS and \n         vulnerability assessments.\n\n         Failure to comply with CMS ports, protocols, and services (PPS) \n         requirements can result in compromise of enclave boundary protections \n         and/or functionality of the Information System.\n\n         The ISSO will ensure web servers are configured to use only necessary \n         ports, protocols, and services."},{"label":"check","data":"Review the website to determine if HTTP and HTTPs (e.g., \n                  80 and 443) are used.\n\n                  Follow the procedures below for each site hosted on \n                  the IIS 8.5 web server:\n\n                  Open the IIS 8.5 Manager.\n\n                  Click the site name under review.\n\n                  In the Action Pane, click Bindings.\n\n                  Review the ports and protocols. If unknown ports or protocols \n                  are used, then this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000383-WSR-000175","gid":"V-76847","rid":"SV-91543r1_rule","stig_id":"IISW-SI-000239","fix_id":"F-83543r1_fix","cci":["CCI-001762"],"nist":["CM-7 (1) (b)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Review the website to determine if HTTP and HTTPs (e.g., 80 and\n  443) are used in accordance with those ports and services registered and\n  approved for use by the DoD PPSM. Any variation in PPS will be documented,\n  registered, and approved by the PPSM.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  In the “Action” Pane, click “Bindings”.\n\n  Review the ports and protocols. If unknown ports or protocols are used, then\n  this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  In the “Action” Pane, click “Bindings\".\n\n  Edit to change an existing binding and set the correct ports and protocol."},"code":"  control 'V-76847' do\n    title 'The IIS 8.5 websites must utilize ports, protocols, and services \n          according to CMS guidelines.'\n    desc 'Web servers provide numerous processes, features, and functionalities \n         that utilize TCP/IP ports. Some of these processes may be deemed \n         unnecessary or too unsecure to run on a production system.\n\n         The web server must provide the capability to disable or deactivate \n         network-related services that are deemed to be non-essential to the \n         server mission, are too unsecure, or are prohibited by CMS and \n         vulnerability assessments.\n\n         Failure to comply with CMS ports, protocols, and services (PPS) \n         requirements can result in compromise of enclave boundary protections \n         and/or functionality of the Information System.\n\n         The ISSO will ensure web servers are configured to use only necessary \n         ports, protocols, and services.'\n    desc 'check', 'Review the website to determine if HTTP and HTTPs (e.g., \n                  80 and 443) are used.\n\n                  Follow the procedures below for each site hosted on \n                  the IIS 8.5 web server:\n\n                  Open the IIS 8.5 Manager.\n\n                  Click the site name under review.\n\n                  In the Action Pane, click Bindings.\n\n                  Review the ports and protocols. If unknown ports or protocols \n                  are used, then this is a finding.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76847.rb"},"results":[]},{"id":"V-76849","title":"The IIS 8.5 private website have a server certificate issued by CMS \n          PKI or CMS-approved PKI Certification Authorities (CAs).","desc":"The use of a CMS PKI certificate ensures clients the private website\n         they are connecting to is legitimate, and is an essential part of the CMS\n         defense-in-depth strategy.","descriptions":[{"label":"default","data":"The use of a CMS PKI certificate ensures clients the private website\n         they are connecting to is legitimate, and is an essential part of the CMS\n         defense-in-depth strategy."},{"label":"check","data":"Follow the procedures below for each site hosted on the IIS 8.5 \n         web server:\n\n         Open the IIS 8.5 Manager.\n         \n         Click the site name under review.\n\n         Click Bindings in the Action Pane.\n\n         Click the HTTPS type from the box.\n\n         Click Edit.\n\n         Click View and then review and verify the certificate path.\n\n         If the list of CAs in the trust hierarchy does not lead to the CMS PKI Root \n         CA, CMS-approved external certificate authority (ECA), or CMS-approved \n         external partner, this is a finding.\n\n         If HTTPS is not an available type under site bindings, this is a finding."},{"label":"fix","data":"Follow the procedures below for each site hosted on the IIS 8.5 \n         web server:\n\n         Open the IIS 8.5 Manager.\n\n         Click the Server name.\n\n         Double-click Server Certificates.\n\n         Click Import under the \"Actions\" pane.\n\n         Browse to the CMS certificate location, select it, and click OK.\n\n         Remove any non-CMS certificates if present.\n\n         Click on the site needing the certificate.\n\n         Select Bindings under the \"Actions\" pane.\n\n         Click on the binding needing a certificate and select Edit, or \n         add a site binding for HTTPS.\n\n         Assign the certificate to the website by choosing it under the SSL Certificate \n         drop-down and clicking OK."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000427-WSR-000186","gid":"V-76849","rid":"SV-91545r2_rule","stig_id":"IISW-SI-000241","fix_id":"F-83545r1_fix","cci":["CCI-002470"],"nist":["SC-23 (5)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click Bindings in the Action Pane.\n\n  Click the HTTPS type from the box.\n\n  Click Edit.\n\n  Click View and then review and verify the certificate path.\n\n  If the list of CAs in the trust hierarchy does not lead to the DoD PKI Root CA,\n  DoD-approved external certificate authority (ECA), or DoD-approved external\n  partner, this is a finding.\n\n  If HTTPS is not an available type under site bindings, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Server name.\n\n  Double-click Server Certificates.\n\n  Click Import under the \"Actions\" pane.\n\n  Browse to the DoD certificate location, select it, and click OK.\n\n  Remove any non-DoD certificates if present.\n\n  Click on the site needing the certificate.\n\n  Select Bindings under the \"Actions\" pane.\n\n  Click on the binding needing a certificate and select Edit, or add a site\n  binding for HTTPS.\n\n  Assign the certificate to the website by choosing it under the SSL\n  Certificate drop-down and clicking OK."},"code":"  control 'V-76849' do\n    title 'The IIS 8.5 private website have a server certificate issued by CMS \n          PKI or CMS-approved PKI Certification Authorities (CAs).'\n    desc 'The use of a CMS PKI certificate ensures clients the private website\n         they are connecting to is legitimate, and is an essential part of the CMS\n         defense-in-depth strategy.'\n    desc 'check', 'Follow the procedures below for each site hosted on the IIS 8.5 \n         web server:\n\n         Open the IIS 8.5 Manager.\n         \n         Click the site name under review.\n\n         Click Bindings in the Action Pane.\n\n         Click the HTTPS type from the box.\n\n         Click Edit.\n\n         Click View and then review and verify the certificate path.\n\n         If the list of CAs in the trust hierarchy does not lead to the CMS PKI Root \n         CA, CMS-approved external certificate authority (ECA), or CMS-approved \n         external partner, this is a finding.\n\n         If HTTPS is not an available type under site bindings, this is a finding.'\n    desc 'fix', 'Follow the procedures below for each site hosted on the IIS 8.5 \n         web server:\n\n         Open the IIS 8.5 Manager.\n\n         Click the Server name.\n\n         Double-click Server Certificates.\n\n         Click Import under the \"Actions\" pane.\n\n         Browse to the CMS certificate location, select it, and click OK.\n\n         Remove any non-CMS certificates if present.\n\n         Click on the site needing the certificate.\n\n         Select Bindings under the \"Actions\" pane.\n\n         Click on the binding needing a certificate and select Edit, or \n         add a site binding for HTTPS.\n\n         Assign the certificate to the website by choosing it under the SSL Certificate \n         drop-down and clicking OK.'\n    describe \"For this CMS ARS 3.1 overlay, this control must be reviewed manually\" do \n      skip \"For this CMS ARS 3.1 overlay, this control must be reviewed manually\"\n    end\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76849.rb"},"results":[]},{"id":"V-76851","title":"The IIS 8.5 private website must employ cryptographic mechanisms (TLS)\n  and require client certificates.","desc":"When data is written to digital media, such as hard drives, mobile\n  computers, external/removable hard drives, personal digital assistants,\n  flash/thumb drives, etc., there is risk of data loss and data compromise. User\n  identities and passwords stored on the hard drive of the hosting hardware must\n  be encrypted to protect the data from easily being discovered and used by an\n  unauthorized user to access the hosted applications. The cryptographic\n  libraries and functionality used to store and retrieve the user identifiers and\n  passwords must be part of the web server.\n\n      Preventing the disclosure of transmitted information requires that the web\n  server take measures to employ some form of cryptographic mechanism in order to\n  protect the information during transmission. This is usually achieved through\n  the use of Transport Layer Security (TLS).\n\n      Transmission of data can take place between the web server and a large\n  number of devices/applications external to the web server. Examples are a web\n  client used by a user, a backend database, an audit server, or other web\n  servers in a web cluster.\n\n      If data is transmitted unencrypted, the data then becomes vulnerable to\n  disclosure. The disclosure may reveal user identifier/password combinations,\n  website code revealing business logic, or other user personal information.\n\n      Also satisfies: SRG-APP-000439-WSR-000151","descriptions":[{"label":"default","data":"When data is written to digital media, such as hard drives, mobile\n  computers, external/removable hard drives, personal digital assistants,\n  flash/thumb drives, etc., there is risk of data loss and data compromise. User\n  identities and passwords stored on the hard drive of the hosting hardware must\n  be encrypted to protect the data from easily being discovered and used by an\n  unauthorized user to access the hosted applications. The cryptographic\n  libraries and functionality used to store and retrieve the user identifiers and\n  passwords must be part of the web server.\n\n      Preventing the disclosure of transmitted information requires that the web\n  server take measures to employ some form of cryptographic mechanism in order to\n  protect the information during transmission. This is usually achieved through\n  the use of Transport Layer Security (TLS).\n\n      Transmission of data can take place between the web server and a large\n  number of devices/applications external to the web server. Examples are a web\n  client used by a user, a backend database, an audit server, or other web\n  servers in a web cluster.\n\n      If data is transmitted unencrypted, the data then becomes vulnerable to\n  disclosure. The disclosure may reveal user identifier/password combinations,\n  website code revealing business logic, or other user personal information.\n\n      Also satisfies: SRG-APP-000439-WSR-000151"}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000429-WSR-000113","gid":"V-76851","rid":"SV-91547r3_rule","stig_id":"IISW-SI-000242","fix_id":"F-83547r1_fix","cci":["CCI-002476"],"nist":["SC-28 (1)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon under the \"IIS\" section.\n\n  Verify \"Require SSL\" is checked.\n\n  Verify \"Client Certificates Required\" is selected.\n\n  Click the site under review.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate system.webServer/security/access.\n\n  The value for \"sslFlags\" set must include \"ssl128\".\n\n  If the \"Require SSL\" is not selected, this is a finding.\n\n  If the \"Client Certificates Required\" is not selected, this is a finding.\n\n  If the \"sslFlags\" is not set to \"ssl128\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon under the \"IIS\" section.\n\n  Select the \"Require SSL\" setting.\n\n  Select the \"Client Certificates Required\" setting.\n\n  Click \"Apply\" in the \"Actions\" pane.\n\n  Click the site under review.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate system.webServer/security/access.\n\n  Click on the drop-down list for \"sslFlags\".\n\n  Select the \"Ssl128\" check box.\n\n  Click \"Apply\" in the \"Actions\" pane."},"code":"control 'V-76851' do\n  title \"The IIS 8.5 private website must employ cryptographic mechanisms (TLS)\n  and require client certificates.\"\n  desc \"When data is written to digital media, such as hard drives, mobile\n  computers, external/removable hard drives, personal digital assistants,\n  flash/thumb drives, etc., there is risk of data loss and data compromise. User\n  identities and passwords stored on the hard drive of the hosting hardware must\n  be encrypted to protect the data from easily being discovered and used by an\n  unauthorized user to access the hosted applications. The cryptographic\n  libraries and functionality used to store and retrieve the user identifiers and\n  passwords must be part of the web server.\n\n      Preventing the disclosure of transmitted information requires that the web\n  server take measures to employ some form of cryptographic mechanism in order to\n  protect the information during transmission. This is usually achieved through\n  the use of Transport Layer Security (TLS).\n\n      Transmission of data can take place between the web server and a large\n  number of devices/applications external to the web server. Examples are a web\n  client used by a user, a backend database, an audit server, or other web\n  servers in a web cluster.\n\n      If data is transmitted unencrypted, the data then becomes vulnerable to\n  disclosure. The disclosure may reveal user identifier/password combinations,\n  website code revealing business logic, or other user personal information.\n\n      Also satisfies: SRG-APP-000439-WSR-000151\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000429-WSR-000113'\n  tag \"gid\": 'V-76851'\n  tag \"rid\": 'SV-91547r3_rule'\n  tag \"stig_id\": 'IISW-SI-000242'\n  tag \"fix_id\": 'F-83547r1_fix'\n  tag \"cci\": ['CCI-002476']\n  tag \"nist\": ['SC-28 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \\\"SSL Settings\\\" icon under the \\\"IIS\\\" section.\n\n  Verify \\\"Require SSL\\\" is checked.\n\n  Verify \\\"Client Certificates Required\\\" is selected.\n\n  Click the site under review.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate system.webServer/security/access.\n\n  The value for \\\"sslFlags\\\" set must include \\\"ssl128\\\".\n\n  If the \\\"Require SSL\\\" is not selected, this is a finding.\n\n  If the \\\"Client Certificates Required\\\" is not selected, this is a finding.\n\n  If the \\\"sslFlags\\\" is not set to \\\"ssl128\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \\\"SSL Settings\\\" icon under the \\\"IIS\\\" section.\n\n  Select the \\\"Require SSL\\\" setting.\n\n  Select the \\\"Client Certificates Required\\\" setting.\n\n  Click \\\"Apply\\\" in the \\\"Actions\\\" pane.\n\n  Click the site under review.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate system.webServer/security/access.\n\n  Click on the drop-down list for \\\"sslFlags\\\".\n\n  Select the \\\"Ssl128\\\" check box.\n\n  Click \\\"Apply\\\" in the \\\"Actions\\\" pane.\"\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  get_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.webServer/security/access 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('sslFlags') { should include 'Ssl' }\n      its('sslFlags') { should include 'SslRequireCert' }\n      its('sslFlags') { should include 'Ssl128' }\n    end\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76851.rb"},"results":[]},{"id":"V-76855","title":"IIS 8.5 website session IDs must be sent to the client using TLS.","desc":"The HTTP protocol is a stateless protocol. To maintain a session, a\n  session identifier is used. The session identifier is a piece of data that is\n  used to identify a session and a user. If the session identifier is compromised\n  by an attacker, the session can be hijacked. By encrypting the session\n  identifier, the identifier becomes more difficult for an attacker to hijack,\n  decrypt, and use before the session has expired.","descriptions":[{"label":"default","data":"The HTTP protocol is a stateless protocol. To maintain a session, a\n  session identifier is used. The session identifier is a piece of data that is\n  used to identify a session and a user. If the session identifier is compromised\n  by an attacker, the session can be hijacked. By encrypting the session\n  identifier, the identifier becomes more difficult for an attacker to hijack,\n  decrypt, and use before the session has expired."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000439-WSR-000152","gid":"V-76855","rid":"SV-91551r1_rule","stig_id":"IISW-SI-000244","fix_id":"F-83551r1_fix","cci":["CCI-002418"],"nist":["SC-8","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \"Management\" section, double-click the \"Configuration Editor\" icon.\n\n  From the \"Section:\" drop-down list, select “system.webServer/asp\".\n\n  Expand the \"session\" section.\n\n  Verify the \"keepSessionIdSecure\" is set to \"True\".\n\n  If the \"keepSessionIdSecure\" is not set to \"True\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \"Management\" section, double-click the \"Configuration Editor\" icon.\n\n  From the \"Section:\" drop-down list, select “system.webServer/asp\".\n\n  Expand the \"session\" section.\n\n  Select \"True\" for the \"keepSessionIdSecure\" setting.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76855' do\n  title 'IIS 8.5 website session IDs must be sent to the client using TLS.'\n  desc  \"The HTTP protocol is a stateless protocol. To maintain a session, a\n  session identifier is used. The session identifier is a piece of data that is\n  used to identify a session and a user. If the session identifier is compromised\n  by an attacker, the session can be hijacked. By encrypting the session\n  identifier, the identifier becomes more difficult for an attacker to hijack,\n  decrypt, and use before the session has expired.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000439-WSR-000152'\n  tag \"gid\": 'V-76855'\n  tag \"rid\": 'SV-91551r1_rule'\n  tag \"stig_id\": 'IISW-SI-000244'\n  tag \"fix_id\": 'F-83551r1_fix'\n  tag \"cci\": ['CCI-002418']\n  tag \"nist\": ['SC-8', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \\\"Management\\\" section, double-click the \\\"Configuration Editor\\\" icon.\n\n  From the \\\"Section:\\\" drop-down list, select “system.webServer/asp\\\".\n\n  Expand the \\\"session\\\" section.\n\n  Verify the \\\"keepSessionIdSecure\\\" is set to \\\"True\\\".\n\n  If the \\\"keepSessionIdSecure\\\" is not set to \\\"True\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \\\"Management\\\" section, double-click the \\\"Configuration Editor\\\" icon.\n\n  From the \\\"Section:\\\" drop-down list, select “system.webServer/asp\\\".\n\n  Expand the \\\"session\\\" section.\n\n  Select \\\"True\\\" for the \\\"keepSessionIdSecure\\\" setting.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_keepSessionIdSecure = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/asp -name * | select -expand session | select -expand keepSessionIdSecure').stdout.strip.split(\"\\r\\n\")\n\n  get_keepSessionIdSecure.zip(get_names).each do |keepSessionIdSecure, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} website keepSessionIdSecure enabled setting\" do\n      subject { keepSessionIdSecure }\n      it { should cmp 'True' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76855.rb"},"results":[]},{"id":"V-76859","title":"Cookies exchanged between the IIS 8.5 website and the client must use\n  SSL/TLS, have cookie properties set to prohibit client-side scripts from\n  reading the cookie data and must not be compressed.","desc":"A cookie is used when a web server needs to share data with the\n  client's browser. The data is often used to remember the client when the client\n  returns to the hosted application at a later date. A session cookie is a\n  special type of cookie used to remember the client during the session. The\n  cookie will contain the session identifier (ID) and may contain authentication\n  data to the hosted application. To protect this data from easily being\n  compromised, the cookie must be encrypted.\n\n      When a cookie is sent encrypted via SSL/TLS, an attacker must spend a great\n  deal of time and resources to decrypt the cookie. If, along with encryption,\n  the cookie is compressed, the attacker can now use a combination of plaintext\n  injection and inadvertent information leakage through data compression to\n  reduce the time needed to decrypt the cookie. This attack is called Compression\n  Ratio Info-leak Made Easy (CRIME).\n\n      Cookies shared between the web server and the client when encrypted should\n  not also be compressed.\n\n      A cookie can be read by client-side scripts easily if cookie properties are\n  not set properly. By allowing cookies to be read by the client-side scripts,\n  information such as session identifiers could be compromised and used by an\n  attacker who intercepts the cookie. Setting cookie properties (i.e. HttpOnly\n  property) to disallow client-side scripts from reading cookies better protects\n  the information inside the cookie.","descriptions":[{"label":"default","data":"A cookie is used when a web server needs to share data with the\n  client's browser. The data is often used to remember the client when the client\n  returns to the hosted application at a later date. A session cookie is a\n  special type of cookie used to remember the client during the session. The\n  cookie will contain the session identifier (ID) and may contain authentication\n  data to the hosted application. To protect this data from easily being\n  compromised, the cookie must be encrypted.\n\n      When a cookie is sent encrypted via SSL/TLS, an attacker must spend a great\n  deal of time and resources to decrypt the cookie. If, along with encryption,\n  the cookie is compressed, the attacker can now use a combination of plaintext\n  injection and inadvertent information leakage through data compression to\n  reduce the time needed to decrypt the cookie. This attack is called Compression\n  Ratio Info-leak Made Easy (CRIME).\n\n      Cookies shared between the web server and the client when encrypted should\n  not also be compressed.\n\n      A cookie can be read by client-side scripts easily if cookie properties are\n  not set properly. By allowing cookies to be read by the client-side scripts,\n  information such as session identifiers could be compromised and used by an\n  attacker who intercepts the cookie. Setting cookie properties (i.e. HttpOnly\n  property) to disallow client-side scripts from reading cookies better protects\n  the information inside the cookie."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000439-WSR-000154","satisfies":["SRG-APP-000439-WSR-000154","SRG-APP-000439-SSR-000155","SRG-APP-000439-WSR-000153"],"gid":"V-76859","rid":"SV-91555r2_rule","stig_id":"IISW-SI-000246","fix_id":"F-83555r1_fix","cci":["CCI-002418"],"nist":["SC-8","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Under \"Management\" section, double-click the \"Configuration Editor\" icon.\n\n  From the \"Section:\" drop-down list, select \"system.web/httpCookies\".\n\n  Verify the \"require SSL\" is set to \"True\".\n\n  From the \"Section:\" drop-down list, select \"system.web/sessionState\".\n\n  Verify the \"compressionEnabled\" is set to \"False\".\n\n  If both the \"system.web/httpCookies:require SSL\" is set to \"True\" and the\n  \"system.web/sessionState:compressionEnabled\" is set to \"False\", this is not\n  a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Under \"Management\" section, double-click the \"Configuration Editor\" icon.\n\n  From the \"Section:\" drop-down list, select \"system.web/httpCookies\".\n\n  Set the \"require SSL\" to \"True\".\n\n  From the \"Section:\" drop-down list, select \"system.web/sessionState\".\n\n  Set the \"compressionEnabled\" to \"False\".\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76859' do\n  title \"Cookies exchanged between the IIS 8.5 website and the client must use\n  SSL/TLS, have cookie properties set to prohibit client-side scripts from\n  reading the cookie data and must not be compressed.\"\n  desc \"A cookie is used when a web server needs to share data with the\n  client's browser. The data is often used to remember the client when the client\n  returns to the hosted application at a later date. A session cookie is a\n  special type of cookie used to remember the client during the session. The\n  cookie will contain the session identifier (ID) and may contain authentication\n  data to the hosted application. To protect this data from easily being\n  compromised, the cookie must be encrypted.\n\n      When a cookie is sent encrypted via SSL/TLS, an attacker must spend a great\n  deal of time and resources to decrypt the cookie. If, along with encryption,\n  the cookie is compressed, the attacker can now use a combination of plaintext\n  injection and inadvertent information leakage through data compression to\n  reduce the time needed to decrypt the cookie. This attack is called Compression\n  Ratio Info-leak Made Easy (CRIME).\n\n      Cookies shared between the web server and the client when encrypted should\n  not also be compressed.\n\n      A cookie can be read by client-side scripts easily if cookie properties are\n  not set properly. By allowing cookies to be read by the client-side scripts,\n  information such as session identifiers could be compromised and used by an\n  attacker who intercepts the cookie. Setting cookie properties (i.e. HttpOnly\n  property) to disallow client-side scripts from reading cookies better protects\n  the information inside the cookie.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000439-WSR-000154'\n  tag \"satisfies\": ['SRG-APP-000439-WSR-000154', 'SRG-APP-000439-SSR-000155',\n                    'SRG-APP-000439-WSR-000153']\n  tag \"gid\": 'V-76859'\n  tag \"rid\": 'SV-91555r2_rule'\n  tag \"stig_id\": 'IISW-SI-000246'\n  tag \"fix_id\": 'F-83555r1_fix'\n  tag \"cci\": ['CCI-002418']\n  tag \"nist\": ['SC-8', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Under \\\"Management\\\" section, double-click the \\\"Configuration Editor\\\" icon.\n\n  From the \\\"Section:\\\" drop-down list, select \\\"system.web/httpCookies\\\".\n\n  Verify the \\\"require SSL\\\" is set to \\\"True\\\".\n\n  From the \\\"Section:\\\" drop-down list, select \\\"system.web/sessionState\\\".\n\n  Verify the \\\"compressionEnabled\\\" is set to \\\"False\\\".\n\n  If both the \\\"system.web/httpCookies:require SSL\\\" is set to \\\"True\\\" and the\n  \\\"system.web/sessionState:compressionEnabled\\\" is set to \\\"False\\\", this is not\n  a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Under \\\"Management\\\" section, double-click the \\\"Configuration Editor\\\" icon.\n\n  From the \\\"Section:\\\" drop-down list, select \\\"system.web/httpCookies\\\".\n\n  Set the \\\"require SSL\\\" to \\\"True\\\".\n\n  From the \\\"Section:\\\" drop-down list, select \\\"system.web/sessionState\\\".\n\n  Set the \\\"compressionEnabled\\\" to \\\"False\\\".\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_compressionEnabled = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.web/sessionState -name * | select -expand compressionEnabled').stdout.strip.split(\"\\r\\n\")\n\n  get_compressionEnabled.zip(get_names).each do |compressionEnabled, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} website compressionEnabled enabled setting\" do\n      subject { compressionEnabled }\n      it { should cmp 'False' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76859.rb"},"results":[]},{"id":"V-76861","title":"The IIS 8.5 website must maintain the confidentiality and integrity of\n  information during preparation for transmission and during reception.","desc":"Information can be either unintentionally or maliciously disclosed or\n  modified during preparation for transmission, including, for example, during\n  aggregation, at protocol transformation points, and during packing/unpacking.\n  These unauthorized disclosures or modifications compromise the confidentiality\n  or integrity of the information.\n\n      An example of this would be an SMTP queue. This queue may be added to a web\n  server through an SMTP module to enhance error reporting or to allow developers\n  to add SMTP functionality to their applications.\n\n      Any modules used by the web server that queue data before transmission must\n  maintain the confidentiality and integrity of the information before the data\n  is transmitted.\n\n      Information can be either unintentionally or maliciously disclosed or\n  modified during reception, including, for example, during aggregation, at\n  protocol transformation points, and during packing/unpacking. These\n  unauthorized disclosures or modifications compromise the confidentiality or\n  integrity of the information.\n\n      Protecting the confidentiality and integrity of received information\n  requires that application servers take measures to employ approved cryptography\n  in order to protect the information during transmission over the network. This\n  is usually achieved through the use of Transport Layer Security (TLS), SSL VPN,\n  or IPsec tunnel.\n\n      The web server must utilize approved encryption when receiving transmitted\n  data.\n\n    Also satisfies: SRG-APP-000442-WSR-000182","descriptions":[{"label":"default","data":"Information can be either unintentionally or maliciously disclosed or\n  modified during preparation for transmission, including, for example, during\n  aggregation, at protocol transformation points, and during packing/unpacking.\n  These unauthorized disclosures or modifications compromise the confidentiality\n  or integrity of the information.\n\n      An example of this would be an SMTP queue. This queue may be added to a web\n  server through an SMTP module to enhance error reporting or to allow developers\n  to add SMTP functionality to their applications.\n\n      Any modules used by the web server that queue data before transmission must\n  maintain the confidentiality and integrity of the information before the data\n  is transmitted.\n\n      Information can be either unintentionally or maliciously disclosed or\n  modified during reception, including, for example, during aggregation, at\n  protocol transformation points, and during packing/unpacking. These\n  unauthorized disclosures or modifications compromise the confidentiality or\n  integrity of the information.\n\n      Protecting the confidentiality and integrity of received information\n  requires that application servers take measures to employ approved cryptography\n  in order to protect the information during transmission over the network. This\n  is usually achieved through the use of Transport Layer Security (TLS), SSL VPN,\n  or IPsec tunnel.\n\n      The web server must utilize approved encryption when receiving transmitted\n  data.\n\n    Also satisfies: SRG-APP-000442-WSR-000182"}],"impact":0.0,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000441-WSR-000181","gid":"V-76861","rid":"SV-91557r2_rule","stig_id":"IISW-SI-000249","fix_id":"F-83557r1_fix","cci":["CCI-002420","CCI-002422"],"nist":["SC-8 (2)","SC-8 (2)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon under the \"IIS\" section.\n\n  Verify \"Require SSL\" is checked.\n\n  Verify \"Client Certificates Required\" is selected.\n\n  Click the site under review.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate “system.webServer/security/access”.\n\n  The value for \"sslFlags\" should be ssl128.\n\n  If the \"Require SSL\" is not selected, this is a finding.\n\n  If the \"Client Certificates Required\" is not selected, this is a finding.\n\n  If the \"sslFlags\" is not set to \"ssl128\", this is a finding.","fix":"Follow the procedures below for web server and each site under\n  review:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Select \"Require SSL\" check box."},"code":"  control 'V-76861' do\n    impact \"none\"\n    desc 'caveat': \"Not applicable for this CMS ARS 3.1 overlay, since the related \n          security control is not mandatory in CMS ARS 3.1\"\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76861.rb"},"results":[]},{"id":"V-76865","title":"The IIS 8.5 website must have a unique application pool.","desc":"Application pools isolate sites and applications to address\n  reliability, availability, and security issues. Sites and applications may be\n  grouped according to configurations, although each site will be associated with\n  a unique application pool.","descriptions":[{"label":"default","data":"Application pools isolate sites and applications to address\n  reliability, availability, and security issues. Sites and applications may be\n  grouped according to configurations, although each site will be associated with\n  a unique application pool."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76865","rid":"SV-91561r2_rule","stig_id":"IISW-SI-000251","fix_id":"F-83561r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the IIS 8.5 Manager.\n\n  Click \"Application Pools\".\n\n  In the list of Application Pools, review the \"Applications\" column and verify\n  unique application pools for each website.\n\n  If any Application Pools are being used for more than one website, this is a\n  finding.\n  ","fix":"Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Assign a unique application pool to each website."},"code":"control 'V-76865' do\n  title 'The IIS 8.5 website must have a unique application pool.'\n  desc  \"Application pools isolate sites and applications to address\n  reliability, availability, and security issues. Sites and applications may be\n  grouped according to configurations, although each site will be associated with\n  a unique application pool.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76865'\n  tag \"rid\": 'SV-91561r2_rule'\n  tag \"stig_id\": 'IISW-SI-000251'\n  tag \"fix_id\": 'F-83561r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the IIS 8.5 Manager.\n\n  Click \\\"Application Pools\\\".\n\n  In the list of Application Pools, review the \\\"Applications\\\" column and verify\n  unique application pools for each website.\n\n  If any Application Pools are being used for more than one website, this is a\n  finding.\n  \"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Assign a unique application pool to each website.\"\n  describe 'Manual review of website is needed' do\n    skip 'Manually review to confirm that the IIS 8.5 websites have a unique\n    application pool'\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76865.rb"},"results":[]},{"id":"V-76867","title":"The maximum number of requests an application pool can process for\n  each IIS 8.5 website must be explicitly set.","desc":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients.","descriptions":[{"label":"default","data":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients."},{"label":"check","data":"Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, with \n         supporting documentation from the ISSO, this check can be downgraded to a Low \n         Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click the â€œApplication Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         Scroll down to the \"Recycling section\" and verify the value for \"Request Limit\" \n         is set to a value other than \"0\".\n\n         If the \"Request Limit\" is set to a value of \"0\", this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76867","rid":"SV-91563r2_rule","stig_id":"IISW-SI-000252","fix_id":"F-83563r2_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  with supporting documentation from the ISSO, this check can be downgraded to a\n  Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling section\" and verify the value for \"Request\n  Limit\" is set to a value other than \"0\".\n\n  If the \"Request Limit\" is set to a value of \"0\", this is a finding.","fix":"Open the IIS 8.5 Manager.\n\nClick on the Application Pools.\n\nHighlight an Application Pool and click \"Advanced Settings\" in the Action\nPane.\n\nScroll down to the \"Recycling section\" and set the value for \"Request\nLimit\" to greater than \"0\".\n\nClick OK.\n"},"code":"  control 'V-76867' do\n    desc 'check', 'Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, with \n         supporting documentation from the ISSO, this check can be downgraded to a Low \n         Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click the â€œApplication Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         Scroll down to the \"Recycling section\" and verify the value for \"Request Limit\" \n         is set to a value other than \"0\".\n\n         If the \"Request Limit\" is set to a value of \"0\", this is a finding.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76867.rb"},"results":[]},{"id":"V-76869","title":"The amount of virtual memory an application pool uses for each IIS 8.5\n  website must be explicitly set.","desc":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients.","descriptions":[{"label":"default","data":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients."},{"label":"check","data":"Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, mitigation \n         steps can be set, to include setting the Fixed number or requests, Specific \n         time, and Private memory usage in the recycling conditions lieu of the \n         Virtual memory setting. If mitigation is used in lieu of this requirement, \n         with supporting documentation from the ISSO, this check can be downgraded \n         to a Low Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click on Application Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         In the \"Advanced Settings\" dialog box scroll down to the \"Recycling\" section \n         and verify the value for \"Virtual Memory Limit\" is not set to 0.\n\n         If the value for \"Virtual Memory Limit\" is set to 0, this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76869","rid":"SV-91565r2_rule","stig_id":"IISW-SI-000253","fix_id":"F-83565r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  mitigation steps can be set, to include setting the “Fixed number or requests”,\n  “Specific time”, and “Private memory usage” in the recycling conditions lieu of\n  the “Virtual memory” setting. If mitigation is used in lieu of this\n  requirement, with supporting documentation from the ISSO, this check can be\n  downgraded to a Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click on “Application Pools”.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  In the \"Advanced Settings\" dialog box scroll down to the \"Recycling\"\n  section and verify the value for \"Virtual Memory Limit\" is not set to 0.\n\n  If the value for \"Virtual Memory Limit\" is set to 0, this is a finding.\n  ","fix":"Open the IIS 8.5 Manager.\n\n  Click on Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  In the \"Advanced Settings\" dialog box scroll down to the \"Recycling\"\n  section and set the value for \"Virtual Memory Limit\" to a value other than\n  \"0\".\n\n  Click OK."},"code":"  control 'V-76869' do\n    desc 'check', 'Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, mitigation \n         steps can be set, to include setting the Fixed number or requests, Specific \n         time, and Private memory usage in the recycling conditions lieu of the \n         Virtual memory setting. If mitigation is used in lieu of this requirement, \n         with supporting documentation from the ISSO, this check can be downgraded \n         to a Low Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click on Application Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         In the \"Advanced Settings\" dialog box scroll down to the \"Recycling\" section \n         and verify the value for \"Virtual Memory Limit\" is not set to 0.\n\n         If the value for \"Virtual Memory Limit\" is set to 0, this is a finding.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76869.rb"},"results":[]},{"id":"V-76871","title":"The amount of private memory an application pool uses for each IIS 8.5\n  website must be explicitly set.","desc":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients.","descriptions":[{"label":"default","data":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients."},{"label":"check","data":"Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, with supporting \n         documentation from the ISSO this check can be downgraded to a Low Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click the Application Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         Scroll down to the \"Recycling\" section and verify the value for \"Private Memory \n         Limit\" is set to a value other than \"0\".\n\n         If the \"Private Memory Limit\" is set to a value of \"0\", this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76871","rid":"SV-91567r1_rule","stig_id":"IISW-SI-000254","fix_id":"F-83567r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  with supporting documentation from the ISSO this check can be downgraded to a\n  Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling\" section and verify the value for \"Private\n  Memory Limit\" is set to a value other than \"0\".\n\n  If the \"Private Memory Limit\" is set to a value of \"0\", this is a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling\" section and set the value for \"Private Memory\n  Limit\" to a value other than \"0\"."},"code":"  control 'V-76871' do\n    desc 'check', 'Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, with supporting \n         documentation from the ISSO this check can be downgraded to a Low Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click the Application Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         Scroll down to the \"Recycling\" section and verify the value for \"Private Memory \n         Limit\" is set to a value other than \"0\".\n\n         If the \"Private Memory Limit\" is set to a value of \"0\", this is a finding.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76871.rb"},"results":[]},{"id":"V-76873","title":"The application pool for each IIS 8.5 website must have a recycle time\n  explicitly set.","desc":"Application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks.","descriptions":[{"label":"default","data":"Application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks."},{"label":"check","data":"Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, with supporting \n         documentation from the ISSO this check can be downgraded to a Low Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click the Application Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         Scroll down to the \"Recycling\" section and expand the \"Generate Recycle Event \n         Log Entry\" section.\n\n         Verify both the \"Regular time interval\" and \"Specific time\" options are set to \n         \"True\".\n\n         If both the \"Regular time interval\" and \"Specific time\" options are not set to \n         \"True\", this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76873","rid":"SV-91569r1_rule","stig_id":"IISW-SI-000255","fix_id":"F-83569r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  with supporting documentation from the ISSO this check can be downgraded to a\n  Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling\" section and expand the \"Generate Recycle\n  Event Log Entry\" section.\n\n  Verify both the \"Regular time interval\" and \"Specific time\" options are set\n  to \"True\".\n\n  If both the \"Regular time interval\" and \"Specific time\" options are not set\n  to \"True\", this is a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling\" section and expand the \"Generate Recycle\n  Event Log Entry\" section.\n\n  Set both the \"Regular time interval\" and \"Specific time\" options to\n  \"True\"."},"code":"  control 'V-76873' do\n    desc 'check', 'Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, with supporting \n         documentation from the ISSO this check can be downgraded to a Low Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click the Application Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         Scroll down to the \"Recycling\" section and expand the \"Generate Recycle Event \n         Log Entry\" section.\n\n         Verify both the \"Regular time interval\" and \"Specific time\" options are set to \n         \"True\".\n\n         If both the \"Regular time interval\" and \"Specific time\" options are not set to \n         \"True\", this is a finding.'\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76873.rb"},"results":[]},{"id":"V-76875","title":"The maximum queue length for HTTP.sys for each IIS 8.5 website must be\n  explicitly configured.","desc":"In order to determine the possible causes of client connection errors\n  and to conserve system resources, it is important to both log errors and manage\n  those settings controlling requests to the application pool.","descriptions":[{"label":"default","data":"In order to determine the possible causes of client connection errors\n  and to conserve system resources, it is important to both log errors and manage\n  those settings controlling requests to the application pool."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76875","rid":"SV-91571r1_rule","stig_id":"IISW-SI-000256","fix_id":"F-83571r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"General\" section and verify the value for \"Queue\n  Length\" is set to 1000.\n\n  If the \"Queue Length\" is set to \"1000\" or less, this is not a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the General section and set the value for Queue Length to\n  1000 or less.\n\n  Click OK."},"code":"control 'V-76875' do\n  title \"The maximum queue length for HTTP.sys for each IIS 8.5 website must be\n  explicitly configured.\"\n  desc \"In order to determine the possible causes of client connection errors\n  and to conserve system resources, it is important to both log errors and manage\n  those settings controlling requests to the application pool.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76875'\n  tag \"rid\": 'SV-91571r1_rule'\n  tag \"stig_id\": 'IISW-SI-000256'\n  tag \"fix_id\": 'F-83571r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"General\\\" section and verify the value for \\\"Queue\n  Length\\\" is set to 1000.\n\n  If the \\\"Queue Length\\\" is set to \\\"1000\\\" or less, this is not a finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the General section and set the value for Queue Length to\n  1000 or less.\n\n  Click OK.\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = command(\"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select queueLength\").stdout\n    describe \"The maximum queue length for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      it { should cmp <= '1000' }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76875.rb"},"results":[]},{"id":"V-76877","title":"The application pools pinging monitor for each IIS 8.5 website must be\n  enabled.","desc":"Windows Process Activation Service (WAS) manages application pool\n  configurations and may flag a worker process as unhealthy and shut it down. An\n  application pool’s pinging monitor must be enabled to confirm worker processes\n  are functional. A lack of response from the worker process might mean the\n  worker process does not have a thread to respond to the ping request, or it is\n  hanging for some other reason. The ping interval and ping response time may\n  need adjustment to gain access to timely information about application pool\n  health without triggering false, unhealthy conditions; for example, instability\n  caused by an application.","descriptions":[{"label":"default","data":"Windows Process Activation Service (WAS) manages application pool\n  configurations and may flag a worker process as unhealthy and shut it down. An\n  application pool’s pinging monitor must be enabled to confirm worker processes\n  are functional. A lack of response from the worker process might mean the\n  worker process does not have a thread to respond to the ping request, or it is\n  hanging for some other reason. The ping interval and ping response time may\n  need adjustment to gain access to timely information about application pool\n  health without triggering false, unhealthy conditions; for example, instability\n  caused by an application."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76877","rid":"SV-91573r1_rule","stig_id":"IISW-SI-000257","fix_id":"F-83573r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the Internet Information Services (IIS) Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Process Model\" section and verify the value for \"Ping\n  Enabled\" is set to \"True\".\n\n  If the value for \"Ping Enabled\" is not set to \"True\", this is a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Process Model\" section and set the value for \"Ping\n  Enabled\" to \"True\".\n\n  Click OK."},"code":"control 'V-76877' do\n  title \"The application pools pinging monitor for each IIS 8.5 website must be\n  enabled.\"\n  desc \"Windows Process Activation Service (WAS) manages application pool\n  configurations and may flag a worker process as unhealthy and shut it down. An\n  application pool’s pinging monitor must be enabled to confirm worker processes\n  are functional. A lack of response from the worker process might mean the\n  worker process does not have a thread to respond to the ping request, or it is\n  hanging for some other reason. The ping interval and ping response time may\n  need adjustment to gain access to timely information about application pool\n  health without triggering false, unhealthy conditions; for example, instability\n  caused by an application.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76877'\n  tag \"rid\": 'SV-91573r1_rule'\n  tag \"stig_id\": 'IISW-SI-000257'\n  tag \"fix_id\": 'F-83573r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the Internet Information Services (IIS) Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Process Model\\\" section and verify the value for \\\"Ping\n  Enabled\\\" is set to \\\"True\\\".\n\n  If the value for \\\"Ping Enabled\\\" is not set to \\\"True\\\", this is a finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Process Model\\\" section and set the value for \\\"Ping\n  Enabled\\\" to \\\"True\\\".\n\n  Click OK.\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand processModel | ConvertTo-Json\")\n\n    describe \"The pingingEnabled setting for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      its('pingingEnabled') { should cmp 'True' }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76877.rb"},"results":[]},{"id":"V-76879","title":"The application pools rapid fail protection for each IIS 8.5 website\n  must be enabled.","desc":"Rapid fail protection is a feature that interrogates the health of\n  worker processes associated with websites and web applications. It can be\n  configured to perform a number of actions such as shutting down and restarting\n  worker processes that have reached failure thresholds. By not setting rapid\n  fail protection the web server could become unstable in the event of a worker\n  process crash potentially leaving the web server unusable.","descriptions":[{"label":"default","data":"Rapid fail protection is a feature that interrogates the health of\n  worker processes associated with websites and web applications. It can be\n  configured to perform a number of actions such as shutting down and restarting\n  worker processes that have reached failure thresholds. By not setting rapid\n  fail protection the web server could become unstable in the event of a worker\n  process crash potentially leaving the web server unusable."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76879","rid":"SV-91575r1_rule","stig_id":"IISW-SI-000258","fix_id":"F-83575r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Rapid Fail Protection\" section and verify the value for\n  \"Enabled\" is set to \"True\".\n\n  If the \"Rapid Fail Protection:Enabled\" is not set to \"True\", this is a\n  finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Rapid Fail Protection\" section and set the value for\n  \"Enabled\" to \"True\".\n\n  Click OK."},"code":"control 'V-76879' do\n  title \"The application pools rapid fail protection for each IIS 8.5 website\n  must be enabled.\"\n  desc \"Rapid fail protection is a feature that interrogates the health of\n  worker processes associated with websites and web applications. It can be\n  configured to perform a number of actions such as shutting down and restarting\n  worker processes that have reached failure thresholds. By not setting rapid\n  fail protection the web server could become unstable in the event of a worker\n  process crash potentially leaving the web server unusable.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76879'\n  tag \"rid\": 'SV-91575r1_rule'\n  tag \"stig_id\": 'IISW-SI-000258'\n  tag \"fix_id\": 'F-83575r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Rapid Fail Protection\\\" section and verify the value for\n  \\\"Enabled\\\" is set to \\\"True\\\".\n\n  If the \\\"Rapid Fail Protection:Enabled\\\" is not set to \\\"True\\\", this is a\n  finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Rapid Fail Protection\\\" section and set the value for\n  \\\"Enabled\\\" to \\\"True\\\".\n\n  Click OK.\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand failure | ConvertTo-Json\")\n\n    describe \"The rapid fail protection setting for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      its('rapidFailProtection') { should cmp 'True' }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76879.rb"},"results":[]},{"id":"V-76881","title":"The application pools rapid fail protection settings for each IIS 8.5\n  website must be managed.","desc":"Windows Process Activation Service (WAS) manages application pool\n  configuration and may flag a worker process as unhealthy and shut it down. The\n  rapid fail protection must be set to a suitable value. A lack of response from\n  the worker process might mean the worker process does not have a thread to\n  respond to the ping request, or that it is hanging for some other reason. The\n  ping interval and ping response time may need adjustment to gain access to\n  timely information about application pool health without triggering false,\n  unhealthy conditions.","descriptions":[{"label":"default","data":"Windows Process Activation Service (WAS) manages application pool\n  configuration and may flag a worker process as unhealthy and shut it down. The\n  rapid fail protection must be set to a suitable value. A lack of response from\n  the worker process might mean the worker process does not have a thread to\n  respond to the ping request, or that it is hanging for some other reason. The\n  ping interval and ping response time may need adjustment to gain access to\n  timely information about application pool health without triggering false,\n  unhealthy conditions."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76881","rid":"SV-91577r1_rule","stig_id":"IISW-SI-000259","fix_id":"F-83577r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Rapid Fail Protection\" section and verify the value for\n  \"Failure Interval\" is set to \"5\".\n\n  If the \"Failure Interval\" is not set to \"5\" or less, this is a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Rapid Fail Protection\" section and set the value for\n  \"Failure Interval\" to \"5\" or less.\n\n  Click OK."},"code":"control 'V-76881' do\n  title \"The application pools rapid fail protection settings for each IIS 8.5\n  website must be managed.\"\n  desc \"Windows Process Activation Service (WAS) manages application pool\n  configuration and may flag a worker process as unhealthy and shut it down. The\n  rapid fail protection must be set to a suitable value. A lack of response from\n  the worker process might mean the worker process does not have a thread to\n  respond to the ping request, or that it is hanging for some other reason. The\n  ping interval and ping response time may need adjustment to gain access to\n  timely information about application pool health without triggering false,\n  unhealthy conditions.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76881'\n  tag \"rid\": 'SV-91577r1_rule'\n  tag \"stig_id\": 'IISW-SI-000259'\n  tag \"fix_id\": 'F-83577r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Rapid Fail Protection\\\" section and verify the value for\n  \\\"Failure Interval\\\" is set to \\\"5\\\".\n\n  If the \\\"Failure Interval\\\" is not set to \\\"5\\\" or less, this is a finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Rapid Fail Protection\\\" section and set the value for\n  \\\"Failure Interval\\\" to \\\"5\\\" or less.\n\n  Click OK.\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand failure | select -expand rapidFailProtectionInterval| ConvertTo-Json\")\n\n    describe \"The rapid fail protection total minutes for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      its('TotalMinutes') { should cmp <= 5 }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76881.rb"},"results":[]},{"id":"V-76885","title":"Interactive scripts on the IIS 8.5 web server must be located in\n  unique and designated folders.","desc":"CGI and ASP scripts represent one of the most common and exploitable\n  means of compromising a web server. All CGI and ASP program files must be\n  segregated into their own unique folder to simplify the protection of these\n  files. ASP scripts must be placed into a unique folder only containing other\n  ASP scripts. JAVA and other technology-specific scripts must also be placed\n  into their own unique folders. The placement of CGI, ASP, or equivalent scripts\n  to special folders gives the Web Manager or the SA control over what goes into\n  those folders and to facilitate access control at the folder level.","descriptions":[{"label":"default","data":"CGI and ASP scripts represent one of the most common and exploitable\n  means of compromising a web server. All CGI and ASP program files must be\n  segregated into their own unique folder to simplify the protection of these\n  files. ASP scripts must be placed into a unique folder only containing other\n  ASP scripts. JAVA and other technology-specific scripts must also be placed\n  into their own unique folders. The placement of CGI, ASP, or equivalent scripts\n  to special folders gives the Web Manager or the SA control over what goes into\n  those folders and to facilitate access control at the folder level."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000087","gid":"V-76885","rid":"SV-91581r2_rule","stig_id":"IISW-SI-000261","fix_id":"F-83581r2_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Determine whether scripts are used on the web server for the\n  target website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  All interactive programs must be placed in unique designated folders based on\n  CGI or ASP script type.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions. Each script type must be in its unique\n  designated folder.\n\n  If scripts are not segregated from web content and in their own unique folders,\n  then this is a finding.","fix":"All interactive programs must be placed in unique designated\n  folders based on CGI or ASP script type.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web server name and select Explore.\n\n  Search for the listed script extensions.\n\n  Move each script type to its unique designated folder.\n\n  Set the permissions to the scripts folders as follows:\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  SYSTEM: FULL\n  ApplicationPoolId:READ\n  Custom Service Account: READ\n  Users: READ\n  ALL APPLICATION PACKAGES: READ\n  "},"code":"control 'V-76885' do\n  title \"Interactive scripts on the IIS 8.5 web server must be located in\n  unique and designated folders.\"\n  desc  \"CGI and ASP scripts represent one of the most common and exploitable\n  means of compromising a web server. All CGI and ASP program files must be\n  segregated into their own unique folder to simplify the protection of these\n  files. ASP scripts must be placed into a unique folder only containing other\n  ASP scripts. JAVA and other technology-specific scripts must also be placed\n  into their own unique folders. The placement of CGI, ASP, or equivalent scripts\n  to special folders gives the Web Manager or the SA control over what goes into\n  those folders and to facilitate access control at the folder level.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000087'\n  tag \"gid\": 'V-76885'\n  tag \"rid\": 'SV-91581r2_rule'\n  tag \"stig_id\": 'IISW-SI-000261'\n  tag \"fix_id\": 'F-83581r2_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Determine whether scripts are used on the web server for the\n  target website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  All interactive programs must be placed in unique designated folders based on\n  CGI or ASP script type.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions. Each script type must be in its unique\n  designated folder.\n\n  If scripts are not segregated from web content and in their own unique folders,\n  then this is a finding.\"\n  tag \"fix\": \"All interactive programs must be placed in unique designated\n  folders based on CGI or ASP script type.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web server name and select Explore.\n\n  Search for the listed script extensions.\n\n  Move each script type to its unique designated folder.\n\n  Set the permissions to the scripts folders as follows:\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  SYSTEM: FULL\n  ApplicationPoolId:READ\n  Custom Service Account: READ\n  Users: READ\n  ALL APPLICATION PACKAGES: READ\n  \"\n  describe 'Manual review of website is needed' do\n    skip \"Manually review to confirm that that interactive scripts on the\n    IIS 8.5 web server is located in unique and designated folders\"\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76885.rb"},"results":[]},{"id":"V-76887","title":"Interactive scripts on the IIS 8.5 web server must have restrictive\n  access controls.","desc":"CGI is a programming standard for interfacing external applications\n  with information servers, such as HTTP or web servers. CGI, represented by all\n  upper case letters, should not be confused with the .cgi file extension. The\n  .cgi file extension does represent a CGI script, but CGI scripts may be written\n  in a number of programming languages (e.g., PERL, C, PHP, and JavaScript), each\n  having their own unique file extension.\n\n      The use of CGI scripts represent one of the most common and exploitable\n  means of compromising a web server. By definition, CGI scripts are executable\n  by the operating system of the host server. While access control is provided\n  via the web service, the execution of CGI programs is not limited unless the SA\n  or the Web Manager takes specific measures. CGI programs can access and alter\n  data files, launch other programs, and use the network.","descriptions":[{"label":"default","data":"CGI is a programming standard for interfacing external applications\n  with information servers, such as HTTP or web servers. CGI, represented by all\n  upper case letters, should not be confused with the .cgi file extension. The\n  .cgi file extension does represent a CGI script, but CGI scripts may be written\n  in a number of programming languages (e.g., PERL, C, PHP, and JavaScript), each\n  having their own unique file extension.\n\n      The use of CGI scripts represent one of the most common and exploitable\n  means of compromising a web server. By definition, CGI scripts are executable\n  by the operating system of the host server. While access control is provided\n  via the web service, the execution of CGI programs is not limited unless the SA\n  or the Web Manager takes specific measures. CGI programs can access and alter\n  data files, launch other programs, and use the network."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000087","gid":"V-76887","rid":"SV-91583r1_rule","stig_id":"IISW-SI-000262","fix_id":"F-83583r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is Not Applicable.\n\n  All interactive programs must have restrictive permissions.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions.\n\n  Review the permissions to the CGI scripts and verify only the permissions\n  listed, or more restrictive permissions are assigned.\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  ALL APPLICATION PACKAGES: Read\n  SYSTEM: FULL\n  ApplicationPoolId: READ\n  Custom Service Account: READ\n  Users: READ\n\n  If the permissions are less restrictive than listed above, this is a finding.","fix":"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is NA.\n\n  All interactive programs must have restrictive permissions.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web server name and select Explore.\n\n  Search for the listed script extensions.\n\n  Set the permissions to the CGI scripts as follows:\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  ALL APPLICATION PACKAGES: Read\n  SYSTEM: FULL\n  ApplicationPoolId: READ\n  Custom Service Account: READ\n  Users: READ"},"code":"control 'V-76887' do\n  title \"Interactive scripts on the IIS 8.5 web server must have restrictive\n  access controls.\"\n  desc \"CGI is a programming standard for interfacing external applications\n  with information servers, such as HTTP or web servers. CGI, represented by all\n  upper case letters, should not be confused with the .cgi file extension. The\n  .cgi file extension does represent a CGI script, but CGI scripts may be written\n  in a number of programming languages (e.g., PERL, C, PHP, and JavaScript), each\n  having their own unique file extension.\n\n      The use of CGI scripts represent one of the most common and exploitable\n  means of compromising a web server. By definition, CGI scripts are executable\n  by the operating system of the host server. While access control is provided\n  via the web service, the execution of CGI programs is not limited unless the SA\n  or the Web Manager takes specific measures. CGI programs can access and alter\n  data files, launch other programs, and use the network.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000087'\n  tag \"gid\": 'V-76887'\n  tag \"rid\": 'SV-91583r1_rule'\n  tag \"stig_id\": 'IISW-SI-000262'\n  tag \"fix_id\": 'F-83583r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is Not Applicable.\n\n  All interactive programs must have restrictive permissions.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions.\n\n  Review the permissions to the CGI scripts and verify only the permissions\n  listed, or more restrictive permissions are assigned.\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  ALL APPLICATION PACKAGES: Read\n  SYSTEM: FULL\n  ApplicationPoolId: READ\n  Custom Service Account: READ\n  Users: READ\n\n  If the permissions are less restrictive than listed above, this is a finding.\"\n  tag \"fix\": \"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is NA.\n\n  All interactive programs must have restrictive permissions.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web server name and select Explore.\n\n  Search for the listed script extensions.\n\n  Set the permissions to the CGI scripts as follows:\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  ALL APPLICATION PACKAGES: Read\n  SYSTEM: FULL\n  ApplicationPoolId: READ\n  Custom Service Account: READ\n  Users: READ\"\n  describe 'Manual review of website is needed' do\n    skip \"Manually review to confirm that Interactive scripts on the IIS 8.5 web\n    server has restrictive access controls\"\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76887.rb"},"results":[]},{"id":"V-76889","title":"Backup interactive scripts on the IIS 8.5 server must be removed.","desc":"CgiMowdule not installed hence the control not applicable","descriptions":[{"label":"default","data":"CgiMowdule not installed hence the control not applicable"}],"impact":0.0,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000087","gid":"V-76889","rid":"SV-91585r1_rule","stig_id":"IISW-SI-000263","fix_id":"F-83585r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is Not Applicable.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions\n\n  Search for the following files: *.bak, *.old, *.temp, *.tmp, *.backup, or copy\n  of....\n\n  If files with these extensions are found, this is a finding.","fix":"Remove the backup files from the production web server."},"code":"control 'V-76889' do\n  title 'Backup interactive scripts on the IIS 8.5 server must be removed.'\n  desc  \"Copies of backup files will not execute on the server, but they can be\n  read by the anonymous user if special precautions are not taken. Such backup\n  copies contain the same sensitive information as the actual script being\n  executed and, as such, are useful to malicious users. Techniques and systems\n  exist today to search web servers for such files and are able to exploit the\n  information contained in them.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000087'\n  tag \"gid\": 'V-76889'\n  tag \"rid\": 'SV-91585r1_rule'\n  tag \"stig_id\": 'IISW-SI-000263'\n  tag \"fix_id\": 'F-83585r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is Not Applicable.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions\n\n  Search for the following files: *.bak, *.old, *.temp, *.tmp, *.backup, or copy\n  of....\n\n  If files with these extensions are found, this is a finding.\"\n  tag \"fix\": 'Remove the backup files from the production web server.'\n\n  iis_modules = command('Get-WebConfiguration  system.webServer/globalModules/*').stdout.strip\n\n  unless iis_modules.include?('CgiMowdule')\n    impact 0.0\n    desc 'CgiMowdule not installed hence the control not applicable'\n  end\n\n  describe 'Manual review of website is needed' do\n    skip 'Manual review that Backup interactive scripts on the IIS 8.5 server is removed'\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76889.rb"},"results":[]},{"id":"V-76891","title":"The required CMS banner page must be displayed to authenticated users accessing \n          a CMS private website.","desc":"A consent banner will be in place to make prospective entrants aware that the \n         website they are about to enter is a CMS web site and their activity is subject \n         to monitoring.\n\n         The requirement for the banner is for websites with security and access controls. \n         These are restricted and not publicly accessible. If the website does not require \n         authentication/authorization for use, then the banner does not need to be present. \n         A manual check of the document root directory for a banner page file (such as \n         banner.html) or navigation to the website via a browser can be used to confirm the \n         information provided from interviewing the web staff.","descriptions":[{"label":"default","data":"A consent banner will be in place to make prospective entrants aware that the \n         website they are about to enter is a CMS web site and their activity is subject \n         to monitoring.\n\n         The requirement for the banner is for websites with security and access controls. \n         These are restricted and not publicly accessible. If the website does not require \n         authentication/authorization for use, then the banner does not need to be present. \n         A manual check of the document root directory for a banner page file (such as \n         banner.html) or navigation to the website via a browser can be used to confirm the \n         information provided from interviewing the web staff."},{"label":"check","data":"Note: This requirement is only applicable for private CMS websites.\n\n         If a banner is required, the following banner page must be in place: \n\n         * This warning banner provides privacy and security notices consistent with \n         applicable federal laws, directives, and other federal guidance for accessing this \n         Government system, which includes (1) this computer network, (2) all computers \n         connected to this network, and (3) all devices and storage media attached to this \n         network or to a computer on this network.  \n\n         * This system is provided for Government authorized use only.  \n         \n         * Unauthorized or improper use of this system is prohibited and may result in \n         disciplinary action and/or civil and criminal penalties.  \n         \n         * Personal use of social media and networking sites on this system is limited as to \n         not interfere with official work duties and is subject to monitoring.  \n\n         * By using this system, you understand and consent to the following:   \n\n                  - The Government may monitor, record, and audit your system usage, including usage \n                  of personal devices and email systems for official duties or to conduct HHS \n                  business. Therefore, you have no reasonable expectation of privacy regarding any \n                  communication or data transiting or stored on this system. At any time, and for any \n                  lawful Government purpose, the government may monitor, intercept, and search and \n                  seize any communication or data transiting or stored on this system.     \n         \n                  - Any communication or data transiting or stored on this system may be disclosed or \n                   used for any lawful Government purpose. \n\n         If the access-controlled website does not display this banner page before entry, \n         this is a finding."},{"label":"fix","data":"Configure a CMS private website to display the required CMS banner page when \n         authentication is required for user access."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76891","rid":"SV-91587r1_rule","stig_id":"IISW-SI-000264","fix_id":"F-83587r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: This requirement is only applicable for private DoD\n  websites.\n\n  If a banner is required, the following banner page must be in place:\n\n  You are accessing a U.S. Government (USG) Information System (IS) that is\n  provided for USG-authorized use only.\n\n  By using this IS (which includes any device attached to this IS), you consent\n  to the following conditions:\n\n  -The USG routinely intercepts and monitors communications on this IS for\n  purposes including, but not limited to, penetration testing, COMSEC monitoring,\n  network operations and defense, personnel misconduct (PM), law enforcement\n  (LE), and counterintelligence (CI) investigations.\n\n  - At any time, the USG may inspect and seize data stored on this IS.\n\n  - Communications using, or data stored on, this IS are not private, are subject\n  to routine monitoring, interception, and search, and may be disclosed or used\n  for any USG-authorized purpose.\n\n  - This IS includes security measures (e.g., authentication and access controls)\n  to protect USG interests—not for your personal benefit or privacy.\n\n  - Notwithstanding the above, using this IS does not constitute consent to PM,\n  LE or CI investigative searching or monitoring of the content of privileged\n  communications, or work product, related to personal representation or services\n  by attorneys, psychotherapists, or clergy, and their assistants. Such\n  communications and work product are private and confidential. See User\n  Agreement for details.\n\n  OR\n\n  If your system cannot meet the character limits to store this amount of text in\n  the banner, the following is another option for the warning banner:\n\n  \"I've read & consent to terms in IS user agreem't.\"\n\n  NOTE: While DoDI 8500.01 does not contain a copy of the banner to be used, it\n  does point to the RMF Knowledge Service for a copy of the required text. It is\n  also noted that the banner is to be displayed only once when the individual\n  enters the site and not for each page.\n\n  If the access-controlled website does not display this banner page before\n  entry, this is a finding.","fix":"Configure a DoD private website to display the required DoD\n  banner page when authentication is required for user access."},"code":"  control 'V-76891' do\n    title 'The required CMS banner page must be displayed to authenticated users accessing \n          a CMS private website.'\n    desc 'A consent banner will be in place to make prospective entrants aware that the \n         website they are about to enter is a CMS web site and their activity is subject \n         to monitoring.\n\n         The requirement for the banner is for websites with security and access controls. \n         These are restricted and not publicly accessible. If the website does not require \n         authentication/authorization for use, then the banner does not need to be present. \n         A manual check of the document root directory for a banner page file (such as \n         banner.html) or navigation to the website via a browser can be used to confirm the \n         information provided from interviewing the web staff.'\n    desc 'check', 'Note: This requirement is only applicable for private CMS websites.\n\n         If a banner is required, the following banner page must be in place: \n\n         * This warning banner provides privacy and security notices consistent with \n         applicable federal laws, directives, and other federal guidance for accessing this \n         Government system, which includes (1) this computer network, (2) all computers \n         connected to this network, and (3) all devices and storage media attached to this \n         network or to a computer on this network.  \n\n         * This system is provided for Government authorized use only.  \n         \n         * Unauthorized or improper use of this system is prohibited and may result in \n         disciplinary action and/or civil and criminal penalties.  \n         \n         * Personal use of social media and networking sites on this system is limited as to \n         not interfere with official work duties and is subject to monitoring.  \n\n         * By using this system, you understand and consent to the following:   \n\n                  - The Government may monitor, record, and audit your system usage, including usage \n                  of personal devices and email systems for official duties or to conduct HHS \n                  business. Therefore, you have no reasonable expectation of privacy regarding any \n                  communication or data transiting or stored on this system. At any time, and for any \n                  lawful Government purpose, the government may monitor, intercept, and search and \n                  seize any communication or data transiting or stored on this system.     \n         \n                  - Any communication or data transiting or stored on this system may be disclosed or \n                   used for any lawful Government purpose. \n\n         If the access-controlled website does not display this banner page before entry, \n         this is a finding.'\n    desc 'fix', 'Configure a CMS private website to display the required CMS banner page when \n         authentication is required for user access.'\n    \n    describe 'Manual review of website is needed' do\n      skip \"Manual review that required CMS banner page is displayed to authenticated \n           users accessing a CMS private website\"\n    end\n  end\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76891.rb"},"results":[]}],"status":"loaded"},{"name":"microsoft-iis-8.5-site-stig-baseline","version":"0.1.0","sha256":"1c4baee6dbedf62faafc7075fa63d7e454e2fb74376298d76f4cb8a062e5ea62","title":"IIS 8.5 Site Security Technical Implementation Guide","maintainer":"The MITRE Corporation","license":"Apache-2.0","copyright":"(c) 2018 The MITRE Corporation","copyright_email":"inspec@mitre.org","supports":[],"attributes":[{"name":"public_server","options":{"description":"Specify if the server being reviewed is a public IIS 8.5 web server","type":"boolean","value":false}},{"name":"private_server","options":{"description":"Specify if the server being reviewed is a private IIS 8.5 web server","type":"boolean","value":false}},{"name":"non_production_server","options":{"description":"Specify if the server being reviewed is a non-production website","type":"boolean","value":false}},{"name":"black_listed_extensions","options":{"description":"List of Request Filtering black listed extensions","type":"array","value":[]}},{"name":"site_name","options":{"description":"Name of IIS site","type":"array","value":["tt","Default"]}},{"name":"http_ip","options":{"description":"IP address used for http","type":"array","value":["10.0.2.15","0.0.0.0"]}},{"name":"http_hostname","options":{"description":"IP address used for https","type":"array","value":["local","l"]}},{"name":"https_ip","options":{"description":"IP address used for https","type":"array","value":["10.0.2.15","0.0.0.0"]}},{"name":"https_hostname","options":{"description":"Hostname used for https","type":"array","value":["localhttps","localhttps2"]}},{"name":"log_directory","options":{"description":"Path of IIS log directory","type":"string","value":"C:\\inetpub\\logs\\LogFiles"}}],"parent_profile":"cms-ars3.1-high-microsoft-iis-8.5-site-overlay","groups":[{"id":"controls/V-76773.rb","controls":["V-76773"]},{"id":"controls/V-76775.rb","controls":["V-76775"]},{"id":"controls/V-76777.rb","controls":["V-76777"]},{"id":"controls/V-76779.rb","controls":["V-76779"]},{"id":"controls/V-76781.rb","controls":["V-76781"]},{"id":"controls/V-76783.rb","controls":["V-76783"]},{"id":"controls/V-76785.rb","controls":["V-76785"]},{"id":"controls/V-76787.rb","controls":["V-76787"]},{"id":"controls/V-76789.rb","controls":["V-76789"]},{"id":"controls/V-76791.rb","controls":["V-76791"]},{"id":"controls/V-76795.rb","controls":["V-76795"]},{"id":"controls/V-76797.rb","controls":["V-76797"]},{"id":"controls/V-76799.rb","controls":["V-76799"]},{"id":"controls/V-76801.rb","controls":["V-76801"]},{"id":"controls/V-76803.rb","controls":["V-76803"]},{"id":"controls/V-76805.rb","controls":["V-76805"]},{"id":"controls/V-76807.rb","controls":["V-76807"]},{"id":"controls/V-76809.rb","controls":["V-76809"]},{"id":"controls/V-76811.rb","controls":["V-76811"]},{"id":"controls/V-76813.rb","controls":["V-76813"]},{"id":"controls/V-76815.rb","controls":["V-76815"]},{"id":"controls/V-76817.rb","controls":["V-76817"]},{"id":"controls/V-76819.rb","controls":["V-76819"]},{"id":"controls/V-76821.rb","controls":["V-76821"]},{"id":"controls/V-76823.rb","controls":["V-76823"]},{"id":"controls/V-76825.rb","controls":["V-76825"]},{"id":"controls/V-76827.rb","controls":["V-76827"]},{"id":"controls/V-76829.rb","controls":["V-76829"]},{"id":"controls/V-76831.rb","controls":["V-76831"]},{"id":"controls/V-76835.rb","controls":["V-76835"]},{"id":"controls/V-76837.rb","controls":["V-76837"]},{"id":"controls/V-76839.rb","controls":["V-76839"]},{"id":"controls/V-76841.rb","controls":["V-76841"]},{"id":"controls/V-76843.rb","controls":["V-76843"]},{"id":"controls/V-76845.rb","controls":["V-76845"]},{"id":"controls/V-76847.rb","controls":["V-76847"]},{"id":"controls/V-76849.rb","controls":["V-76849"]},{"id":"controls/V-76851.rb","controls":["V-76851"]},{"id":"controls/V-76855.rb","controls":["V-76855"]},{"id":"controls/V-76859.rb","controls":["V-76859"]},{"id":"controls/V-76861.rb","controls":["V-76861"]},{"id":"controls/V-76865.rb","controls":["V-76865"]},{"id":"controls/V-76867.rb","controls":["V-76867"]},{"id":"controls/V-76869.rb","controls":["V-76869"]},{"id":"controls/V-76871.rb","controls":["V-76871"]},{"id":"controls/V-76873.rb","controls":["V-76873"]},{"id":"controls/V-76875.rb","controls":["V-76875"]},{"id":"controls/V-76877.rb","controls":["V-76877"]},{"id":"controls/V-76879.rb","controls":["V-76879"]},{"id":"controls/V-76881.rb","controls":["V-76881"]},{"id":"controls/V-76885.rb","controls":["V-76885"]},{"id":"controls/V-76887.rb","controls":["V-76887"]},{"id":"controls/V-76889.rb","controls":["V-76889"]},{"id":"controls/V-76891.rb","controls":["V-76891"]}],"controls":[{"id":"V-76773","title":"The IIS 8.5 websites MaxConnections setting must be configured to\n  limit the number of allowed simultaneous session requests.","desc":"Resource exhaustion can occur when an unlimited number of concurrent\n  requests are allowed on a website, facilitating a Denial of Service attack.\n  Mitigating this kind of attack will include limiting the number of concurrent\n  HTTP/HTTPS requests per IP address and may include, where feasible, limiting\n  parameter values associated with keepalive (i.e., a parameter used to limit the\n  amount of time a connection may be inactive).","descriptions":[{"label":"default","data":"Resource exhaustion can occur when an unlimited number of concurrent\n  requests are allowed on a website, facilitating a Denial of Service attack.\n  Mitigating this kind of attack will include limiting the number of concurrent\n  HTTP/HTTPS requests per IP address and may include, where feasible, limiting\n  parameter values associated with keepalive (i.e., a parameter used to limit the\n  amount of time a connection may be inactive)."},{"label":"check","data":"Access the IIS 8.5 IIS Manager.\n    \n    Click the IIS 8.5 server.\n\n    Select \"Configuration Editor\" under the \"Management\" section.\n\n    From the \"Section:\" drop-down list at the top of the configuration editor, \n    locate \"system.applicationHost/sites\".\n\n    Expand \"siteDefaults\".\n    Expand \"limits\".\n\n    Review the results and verify the value is \"1\" for the \"maxconnections\" \n    parameter.\n\n    If the maxconnections parameter is set a value other than \"1\", this \n    is a finding."},{"label":"fix","data":"Access the IIS 8.5 IIS Manager.\n\n         Click the IIS 8.5 server.\n\n         Select \"Configuration Editor\" under the \"Management\" section.\n\n         From the \"Section:\" drop-down list at the top of the configuration \n         editor, locate \"system.applicationHost/sites\".\n\n         Expand \"siteDefaults\".\n         Expand \"limits\".\n\n         Set the \"maxconnections\" parameter to \"1\"."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000001-WSR-000001","gid":"V-76773","rid":"SV-91469r1_rule","stig_id":"IISW-SI-000200","fix_id":"F-83469r1_fix","cci":["CCI-000054"],"nist":["AC-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Access the IIS 8.5 IIS Manager.\n\n  Click the IIS 8.5 server.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.applicationHost/sites\".\n\n  Expand \"siteDefaults\".\n  Expand \"limits\".\n\n  Review the results and verify the value is greater than zero for the\n  \"maxconnections\" parameter.\n\n  If the maxconnections parameter is set to zero, this is a finding.","fix":"Access the IIS 8.5 IIS Manager.\n\n  Click the IIS 8.5 server.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.applicationHost/sites\".\n\n  Expand \"siteDefaults\".\n  Expand \"limits\".\n\n  Set the \"maxconnections\" parameter to a value greater than zero."},"code":"control 'V-76773' do\n  title \"The IIS 8.5 websites MaxConnections setting must be configured to\n  limit the number of allowed simultaneous session requests.\"\n  desc  \"Resource exhaustion can occur when an unlimited number of concurrent\n  requests are allowed on a website, facilitating a Denial of Service attack.\n  Mitigating this kind of attack will include limiting the number of concurrent\n  HTTP/HTTPS requests per IP address and may include, where feasible, limiting\n  parameter values associated with keepalive (i.e., a parameter used to limit the\n  amount of time a connection may be inactive).\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000001-WSR-000001'\n  tag \"gid\": 'V-76773'\n  tag \"rid\": 'SV-91469r1_rule'\n  tag \"stig_id\": 'IISW-SI-000200'\n  tag \"fix_id\": 'F-83469r1_fix'\n  tag \"cci\": ['CCI-000054']\n  tag \"nist\": ['AC-10', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Access the IIS 8.5 IIS Manager.\n\n  Click the IIS 8.5 server.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.applicationHost/sites\\\".\n\n  Expand \\\"siteDefaults\\\".\n  Expand \\\"limits\\\".\n\n  Review the results and verify the value is greater than zero for the\n  \\\"maxconnections\\\" parameter.\n\n  If the maxconnections parameter is set to zero, this is a finding.\"\n  tag \"fix\": \"Access the IIS 8.5 IIS Manager.\n\n  Click the IIS 8.5 server.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.applicationHost/sites\\\".\n\n  Expand \\\"siteDefaults\\\".\n  Expand \\\"limits\\\".\n\n  Set the \\\"maxconnections\\\" parameter to a value greater than zero.\"\n\n  describe 'IIS Configuration' do\n    subject { json(command: 'Get-WebConfigurationProperty -Filter system.applicationHost/sites -name * | select -expand siteDefaults | select -expand limits | ConvertTo-Json ') }\n    its('maxBandwidth') { should cmp > 0 }\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76773.rb"},"results":[{"status":"failed","code_desc":"IIS Configuration maxBandwidth should eq 1","run_time":0.185366,"start_time":"2019-02-04T07:09:59-08:00","message":"\nexpected: 1\n     got: nil\n\n(compared using ==)\n"}]},{"id":"V-76775","title":"The IIS 8.5 website session state must be enabled.","desc":"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and web server will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.","descriptions":[{"label":"default","data":"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and web server will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000001-WSR-000002","gid":"V-76775","rid":"SV-91471r1_rule","stig_id":"IISW-SI-000201","fix_id":"F-83471r1_fix","cci":["CCI-000054"],"nist":["AC-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \"ASP.NET\" section, select \"Session State\".\n\n  Under \"Session State Mode Settings\", verify the \"In Process\" mode is\n  selected.\n\n  If the \"Session State Mode Settings\" is set to \"In Process\", this is not a\n  finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Verify the \"mode\" reflects \"InProc\".\n\n  If the \"mode\" is not set to \"InProc\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \"ASP.NET\" section, select \"Session State\".\n\n  Under \"Session State Mode Settings\", verify the \"In Process\" mode is\n  selected.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76775' do\n  title 'The IIS 8.5 website session state must be enabled.'\n  desc  \"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and web server will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000001-WSR-000002'\n  tag \"gid\": 'V-76775'\n  tag \"rid\": 'SV-91471r1_rule'\n  tag \"stig_id\": 'IISW-SI-000201'\n  tag \"fix_id\": 'F-83471r1_fix'\n  tag \"cci\": ['CCI-000054']\n  tag \"nist\": ['AC-10', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \\\"ASP.NET\\\" section, select \\\"Session State\\\".\n\n  Under \\\"Session State Mode Settings\\\", verify the \\\"In Process\\\" mode is\n  selected.\n\n  If the \\\"Session State Mode Settings\\\" is set to \\\"In Process\\\", this is not a\n  finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Verify the \\\"mode\\\" reflects \\\"InProc\\\".\n\n  If the \\\"mode\\\" is not set to \\\"InProc\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \\\"ASP.NET\\\" section, select \\\"Session State\\\".\n\n  Under \\\"Session State Mode Settings\\\", verify the \\\"In Process\\\" mode is\n  selected.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.web/sessionState 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState setting for Site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('mode') { should cmp 'InProc' }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76775.rb"},"results":[{"status":"passed","code_desc":"IIS sessionState setting for Site :'Default Web Site' mode should cmp == \"InProc\"","run_time":0.000303,"start_time":"2019-02-04T07:09:59-08:00"}]},{"id":"V-76777","title":"The IIS 8.5 website session state cookie settings must be configured\n  to Use Cookies mode.","desc":"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and website will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.\n\n      Cookies associate session information with client information for the\n  duration of a user’s connection to a website. Using cookies is a more efficient\n  way to track session state than any of the methods that do not use cookies\n  because cookies do not require any redirection.","descriptions":[{"label":"default","data":"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and website will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.\n\n      Cookies associate session information with client information for the\n  duration of a user’s connection to a website. Using cookies is a more efficient\n  way to track session state than any of the methods that do not use cookies\n  because cookies do not require any redirection."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000001-WSR-000002","gid":"V-76777","rid":"SV-91473r2_rule","stig_id":"IISW-SI-000202","fix_id":"F-83473r2_fix","cci":["CCI-000054"],"nist":["AC-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \"ASP.NET\" section, select \"Session State\".\n\n  Under \"Cookie Settings\", verify the \"Use Cookies\" mode is selected from the\n  \"Mode:\" drop-down list.\n\n  If the \"Use Cookies\" mode is selected, this is not a finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Verify the \"cookieless\" is set to \"UseCookies\".\n\n  If the \"cookieless\" is not set to \"UseCookies\", this is a finding","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the ASP.NET section, select \"Session State\".\n\n  Under \"Cookie Settings\", select the \"Use Cookies\" from the \"Mode:\"\n  drop-dowssn list.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76777' do\n  title \"The IIS 8.5 website session state cookie settings must be configured\n  to Use Cookies mode.\"\n  desc  \"When the session information is stored on the client, the session ID,\n  along with the user authorization and identity information, is sent along with\n  each client request and is stored in either a cookie, embedded in the uniform\n  resource locator (URL), or placed in a hidden field on the displayed form. Each\n  of these offers advantages and disadvantages. The biggest disadvantage to all\n  three is the hijacking of a session along with all of the user's credentials.\n\n      When the user authorization and identity information is stored on the\n  server in a protected and encrypted database, the communication between the\n  client and website will only send the session identifier, and the server can\n  then retrieve user credentials for the session when needed. If, during\n  transmission, the session were to be hijacked, the user's credentials would not\n  be compromised.\n\n      ASP.NET provides a session state, which is available as the\n  HttpSessionState class, as a method of storing session-specific information\n  that is visible only within the session. ASP.NET session state identifies\n  requests from the same browser during a limited time window as a session, and\n  provides the ability to persist variable values for the duration of that\n  session.\n\n      Cookies associate session information with client information for the\n  duration of a user’s connection to a website. Using cookies is a more efficient\n  way to track session state than any of the methods that do not use cookies\n  because cookies do not require any redirection.\n\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000001-WSR-000002'\n  tag \"gid\": 'V-76777'\n  tag \"rid\": 'SV-91473r2_rule'\n  tag \"stig_id\": 'IISW-SI-000202'\n  tag \"fix_id\": 'F-83473r2_fix'\n  tag \"cci\": ['CCI-000054']\n  tag \"nist\": ['AC-10', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \\\"ASP.NET\\\" section, select \\\"Session State\\\".\n\n  Under \\\"Cookie Settings\\\", verify the \\\"Use Cookies\\\" mode is selected from the\n  \\\"Mode:\\\" drop-down list.\n\n  If the \\\"Use Cookies\\\" mode is selected, this is not a finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Verify the \\\"cookieless\\\" is set to \\\"UseCookies\\\".\n\n  If the \\\"cookieless\\\" is not set to \\\"UseCookies\\\", this is a finding\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the ASP.NET section, select \\\"Session State\\\".\n\n  Under \\\"Cookie Settings\\\", select the \\\"Use Cookies\\\" from the \\\"Mode:\\\"\n  drop-dowssn list.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.web/sessionState 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('cookieless') { should cmp 'UseCookies' }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76777.rb"},"results":[{"status":"passed","code_desc":"IIS sessionState for site :'Default Web Site' cookieless should cmp == \"UseCookies\"","run_time":0.000305,"start_time":"2019-02-04T07:09:59-08:00"}]},{"id":"V-76779","title":"A private IIS 8.5 website must only accept Secure Socket Layer\n  connections.","desc":"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems.","descriptions":[{"label":"default","data":"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000014-WSR-000006","gid":"V-76779","rid":"SV-91475r1_rule","stig_id":"IISW-SI-000203","fix_id":"F-83475r1_fix","cci":["CCI-000068"],"nist":["AC-17 (2)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Verify \"Require SSL\" check box is selected.\n\n  If the \"Require SSL\" check box is not selected, this is a finding.","fix":"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Select \"Require SSL\" check box.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76779' do\n  title \"A private IIS 8.5 website must only accept Secure Socket Layer\n  connections.\"\n  desc \"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000014-WSR-000006'\n  tag \"gid\": 'V-76779'\n  tag \"rid\": 'SV-91475r1_rule'\n  tag \"stig_id\": 'IISW-SI-000203'\n  tag \"fix_id\": 'F-83475r1_fix'\n  tag \"cci\": ['CCI-000068']\n  tag \"nist\": ['AC-17 (2)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Verify \\\"Require SSL\\\" check box is selected.\n\n  If the \\\"Require SSL\\\" check box is not selected, this is a finding.\"\n  tag \"fix\": \"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Select \\\"Require SSL\\\" check box.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.webServer/security/access 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('sslFlags') { should include 'Ssl' }\n    end\n  end\n\n  if attribute('public_server')\n    impact 0.0\n    desc 'The server being reviewed is a public IIS 8.5 web\n    server, hence this control is Not Applicable.'\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76779.rb"},"results":[{"status":"failed","code_desc":"IIS sessionState for site :'Default Web Site' sslFlags should include \"Ssl\"","run_time":0.005004,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"\" to include \"Ssl\""}]},{"id":"V-76781","title":"A public IIS 8.5 website must only accept Secure Socket Layer\n  connections when authentication is required.","desc":"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems.","descriptions":[{"label":"default","data":"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000014-WSR-000006","gid":"V-76781","rid":"SV-91477r1_rule","stig_id":"IISW-SI-000204","fix_id":"F-83477r1_fix","cci":["CCI-000068"],"nist":["AC-17 (2)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the server being reviewed is a private IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Verify \"Require SSL\" check box is selected.\n\n  If the \"Require SSL\" check box is not selected, this is a finding.","fix":"Note: If the server being reviewed is a private IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Select \"Require SSL\" check box.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76781' do\n  title \"A public IIS 8.5 website must only accept Secure Socket Layer\n  connections when authentication is required.\"\n  desc \"Transport Layer Security (TLS) encryption is a required security\n  setting for a private web server. Encryption of private information is\n  essential to ensuring data confidentiality. If private information is not\n  encrypted, it can be intercepted and easily read by an unauthorized party. A\n  private web server must use a FIPS 140-2-approved TLS version, and all\n  non-FIPS-approved SSL versions must be disabled.\n\n      FIPS 140-2-approved TLS versions include TLS V1.1 or greater. NIST SP\n  800-52 specifies the preferred configurations for government systems.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000014-WSR-000006'\n  tag \"gid\": 'V-76781'\n  tag \"rid\": 'SV-91477r1_rule'\n  tag \"stig_id\": 'IISW-SI-000204'\n  tag \"fix_id\": 'F-83477r1_fix'\n  tag \"cci\": ['CCI-000068']\n  tag \"nist\": ['AC-17 (2)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: If the server being reviewed is a private IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Verify \\\"Require SSL\\\" check box is selected.\n\n  If the \\\"Require SSL\\\" check box is not selected, this is a finding.\"\n  tag \"fix\": \"Note: If the server being reviewed is a private IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Select \\\"Require SSL\\\" check box.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.webServer/security/access 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('sslFlags') { should include 'Ssl' }\n    end\n  end\n\n  if attribute('private_server')\n    impact 0.0\n    desc 'The server being reviewed is a private IIS 8.5 web\n    server, hence this control is Not Applicable.'\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76781.rb"},"results":[{"status":"failed","code_desc":"IIS sessionState for site :'Default Web Site' sslFlags should include \"Ssl\"","run_time":0.000457,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"\" to include \"Ssl\""}]},{"id":"V-76783","title":"The enhanced logging for each IIS 8.5 website must be enabled and\n  capture, record, and log all content related to a user session.","desc":"Log files are a critical component to the successful management \n         of an IS used within the CMS. By generating log files with useful \n         information web administrators can leverage them in the event of a \n         disaster, malicious attack, or other site-specific needs.\n\n         Ascertaining the correct order of the events that occurred is \n         important during forensic analysis. Events that appear harmless by \n         themselves might be flagged as a potential threat when properly viewed \n         in sequence. By also establishing the event date and time, an event \n         can be properly viewed with an enterprise tool to fully see a possible \n         threat in its entirety.\n\n         Without sufficient information establishing when the log event occurred, \n         investigation into the cause of event is severely hindered. Log record \n         content that may be necessary to satisfy the requirement of this control \n         includes, but is not limited to, time stamps, source and destination IP \n         addresses, user/process identifiers, event descriptions, \n         application-specific events, success/fail indications, file names involved, \n         access control, or flow control rules invoked.\n\n         Satisfies: SRG-APP-000092-WSR-000055, SRG-APP-000093-WSR-000053","descriptions":[{"label":"default","data":"Log files are a critical component to the successful management \n         of an IS used within the CMS. By generating log files with useful \n         information web administrators can leverage them in the event of a \n         disaster, malicious attack, or other site-specific needs.\n\n         Ascertaining the correct order of the events that occurred is \n         important during forensic analysis. Events that appear harmless by \n         themselves might be flagged as a potential threat when properly viewed \n         in sequence. By also establishing the event date and time, an event \n         can be properly viewed with an enterprise tool to fully see a possible \n         threat in its entirety.\n\n         Without sufficient information establishing when the log event occurred, \n         investigation into the cause of event is severely hindered. Log record \n         content that may be necessary to satisfy the requirement of this control \n         includes, but is not limited to, time stamps, source and destination IP \n         addresses, user/process identifiers, event descriptions, \n         application-specific events, success/fail indications, file names involved, \n         access control, or flow control rules invoked.\n\n         Satisfies: SRG-APP-000092-WSR-000055, SRG-APP-000093-WSR-000053"},{"label":"caveat","data":"AU-14 is not listed in ARS, but the ARS AU-3 clearly implies the\n         need for these fields in event records. As a result, the associated NIST \n          control has been changed to AU-3."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000092-WSR-000055","satisfies":["SRG-APP-000092-WSR-000055","SRG-APP-000093-WSR-000053"],"gid":"V-76783","rid":"SV-91479r1_rule","stig_id":"IISW-SI-000205","fix_id":"F-83479r1_fix","cci":["CCI-001487"],"nist":["AU-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Under Format select \"W3C\".\n\n  Click Select Fields, verify at a minimum the following fields are checked:\n  Date, Time, Client IP Address, User Name, Method, URI Query, Protocol Status,\n  and Referrer.\n\n  If the \"W3C\" is not selected as the logging format OR any of the required\n  fields are not selected, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Under Format select \"W3C\".\n\n  Select the following fields: Date, Time, Client IP Address, User Name, Method,\n  URI Query, Protocol Status, and Referrer.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76783' do\n  title \"The enhanced logging for each IIS 8.5 website must be enabled and\n  capture, record, and log all content related to a user session.\"\n  desc \"Log files are a critical component to the successful management of an\n  IS used within the DoD. By generating log files with useful information web\n  administrators can leverage them in the event of a disaster, malicious attack,\n  or other site-specific needs.\n\n      Ascertaining the correct order of the events that occurred is important\n  during forensic analysis. Events that appear harmless by themselves might be\n  flagged as a potential threat when properly viewed in sequence. By also\n  establishing the event date and time, an event can be properly viewed with an\n  enterprise tool to fully see a possible threat in its entirety.\n\n      Without sufficient information establishing when the log event occurred,\n  investigation into the cause of event is severely hindered. Log record content\n  that may be necessary to satisfy the requirement of this control includes, but\n  is not limited to, time stamps, source and destination IP addresses,\n  user/process identifiers, event descriptions, application-specific events,\n  success/fail indications, file names involved, access control, or flow control\n  rules invoked.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000092-WSR-000055'\n  tag \"satisfies\": ['SRG-APP-000092-WSR-000055', 'SRG-APP-000093-WSR-000053']\n  tag \"gid\": 'V-76783'\n  tag \"rid\": 'SV-91479r1_rule'\n  tag \"stig_id\": 'IISW-SI-000205'\n  tag \"fix_id\": 'F-83479r1_fix'\n  tag \"cci\": ['CCI-001462', 'CCI-001464']\n  tag \"nist\": ['AU-14 (2)', 'AU-14 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Under Format select \\\"W3C\\\".\n\n  Click Select Fields, verify at a minimum the following fields are checked:\n  Date, Time, Client IP Address, User Name, Method, URI Query, Protocol Status,\n  and Referrer.\n\n  If the \\\"W3C\\\" is not selected as the logging format OR any of the required\n  fields are not selected, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Under Format select \\\"W3C\\\".\n\n  Select the following fields: Date, Time, Client IP Address, User Name, Method,\n  URI Query, Protocol Status, and Referrer.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_logging_configuration = json(command: %(Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter 'System.Applicationhost/Sites/site[@name=\"#{site_name}\"]/logfile'  -Name * | ConvertTo-Json))\n\n    describe \"IIS Logging configuration for Site :'#{site_name}'\" do\n      subject { iis_logging_configuration }\n      its('logFormat') { should cmp 'W3C' }\n      its('logExtFileFlags') { should include 'Date' }\n      its('logExtFileFlags') { should include 'Time' }\n      its('logExtFileFlags') { should include 'ClientIP' }\n      its('logExtFileFlags') { should include 'UserName' }\n      its('logExtFileFlags') { should include 'Method' }\n      its('logExtFileFlags') { should include 'UriQuery' }\n      its('logExtFileFlags') { should include 'HttpStatus' }\n      its('logExtFileFlags') { should include 'Referer' }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76783.rb"},"results":[{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logFormat should cmp == \"W3C\"","run_time":0.000479,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"Date\"","run_time":0.000384,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"Time\"","run_time":0.000211,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"ClientIP\"","run_time":0.000675,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"UserName\"","run_time":0.000244,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"Method\"","run_time":0.000279,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"UriQuery\"","run_time":0.000236,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"HttpStatus\"","run_time":0.000231,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"Referer\"","run_time":0.000735,"start_time":"2019-02-04T07:09:59-08:00"}]},{"id":"V-76785","title":"Both the log file and Event Tracing for Windows (ETW) for each IIS 8.5\n  website must be enabled.","desc":"Internet Information Services (IIS) on Windows Server 2012 provides\n  basic logging capabilities. However, because IIS takes some time to flush logs\n  to disk, administrators do not have access to logging information in real-time.\n  In addition, text-based log files can be difficult and time-consuming to\n  process.\n\n      In IIS 8.5, the administrator has the option of sending logging information\n  to Event Tracing for Windows (ETW). This option gives the administrator the\n  ability to use standard query tools, or create custom tools, for viewing\n  real-time logging information in ETW. This provides a significant advantage\n  over parsing text-based log files that are not updated in real time.","descriptions":[{"label":"default","data":"Internet Information Services (IIS) on Windows Server 2012 provides\n  basic logging capabilities. However, because IIS takes some time to flush logs\n  to disk, administrators do not have access to logging information in real-time.\n  In addition, text-based log files can be difficult and time-consuming to\n  process.\n\n      In IIS 8.5, the administrator has the option of sending logging information\n  to Event Tracing for Windows (ETW). This option gives the administrator the\n  ability to use standard query tools, or create custom tools, for viewing\n  real-time logging information in ETW. This provides a significant advantage\n  over parsing text-based log files that are not updated in real time."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000092-WSR-000055","satisfies":["SRG-APP-000092-WSR-000055","SRG-APP-000108-WSR-000166"],"gid":"V-76785","rid":"SV-91481r1_rule","stig_id":"IISW-SI-000206","fix_id":"F-83481r1_fix","cci":["CCI-000139","CCI-001464"],"nist":["AU-5 a","AU-14 (1)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Under Log Event Destination, verify the \"Both log file and ETW event\" radio\n  button is selected.\n\n  If the \"Both log file and ETW event\" radio button is not selected, this is a\n  finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Under Log Event Destination, select the \"Both log file and ETW event\" radio\n  button.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76785' do\n  title \"Both the log file and Event Tracing for Windows (ETW) for each IIS 8.5\n  website must be enabled.\"\n  desc  \"Internet Information Services (IIS) on Windows Server 2012 provides\n  basic logging capabilities. However, because IIS takes some time to flush logs\n  to disk, administrators do not have access to logging information in real-time.\n  In addition, text-based log files can be difficult and time-consuming to\n  process.\n\n      In IIS 8.5, the administrator has the option of sending logging information\n  to Event Tracing for Windows (ETW). This option gives the administrator the\n  ability to use standard query tools, or create custom tools, for viewing\n  real-time logging information in ETW. This provides a significant advantage\n  over parsing text-based log files that are not updated in real time.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000092-WSR-000055'\n  tag \"satisfies\": ['SRG-APP-000092-WSR-000055', 'SRG-APP-000108-WSR-000166']\n  tag \"gid\": 'V-76785'\n  tag \"rid\": 'SV-91481r1_rule'\n  tag \"stig_id\": 'IISW-SI-000206'\n  tag \"fix_id\": 'F-83481r1_fix'\n  tag \"cci\": ['CCI-000139', 'CCI-001464']\n  tag \"nist\": ['AU-5 a', 'AU-14 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Under Log Event Destination, verify the \\\"Both log file and ETW event\\\" radio\n  button is selected.\n\n  If the \\\"Both log file and ETW event\\\" radio button is not selected, this is a\n  finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Under Log Event Destination, select the \\\"Both log file and ETW event\\\" radio\n  button.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  iis_modules = command('Get-WebConfiguration  system.webServer/globalModules/*').stdout.strip\n\n  describe 'IIS Module for ETW (Tracing) should be installed; Installed modules' do\n    subject { iis_modules }\n    it { should include 'UriCacheModule' }\n  end\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_logging_configuration = json(command: %(Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter 'System.Applicationhost/Sites/site[@name=\"#{site_name}\"]/logfile'  -Name * | ConvertTo-Json))\n\n    describe \"IIS Logging configuration for Site :'#{site_name}'\" do\n      subject { iis_logging_configuration }\n      its('logTargetW3C') { should include 'File' }\n      its('logTargetW3C') { should include 'ETW' }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76785.rb"},"results":[{"status":"passed","code_desc":"IIS Module for ETW (Tracing) should be installed; Installed modules should include \"UriCacheModule\"","run_time":0.000202,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logTargetW3C should include \"File\"","run_time":0.000164,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"failed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logTargetW3C should include \"ETW\"","run_time":0.000403,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"File\" to include \"ETW\""}]},{"id":"V-76787","title":"An IIS 8.5 website behind a load balancer or proxy server, must\nproduce log records containing the source client IP and destination\ninformation.","desc":"Web server logging capability is critical for accurate forensic\nanalysis. Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct source, e.g. source IP, of the events is important\nduring forensic analysis. Correctly determining the source of events will add\ninformation to the overall reconstruction of the logable event. By determining\nthe source of the event correctly, analysis of the enterprise can be undertaken\nto determine if events tied to the source occurred in other areas within the\nenterprise.\n\n    A web server behind a load balancer or proxy server, when not configured\ncorrectly, will record the load balancer or proxy server as the source of every\nlogable event. When looking at the information forensically, this information\nis not helpful in the investigation of events. The web server must record with\neach event the client source of the event.","descriptions":[{"label":"default","data":"Web server logging capability is critical for accurate forensic\nanalysis. Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct source, e.g. source IP, of the events is important\nduring forensic analysis. Correctly determining the source of events will add\ninformation to the overall reconstruction of the logable event. By determining\nthe source of the event correctly, analysis of the enterprise can be undertaken\nto determine if events tied to the source occurred in other areas within the\nenterprise.\n\n    A web server behind a load balancer or proxy server, when not configured\ncorrectly, will record the load balancer or proxy server as the source of every\nlogable event. When looking at the information forensically, this information\nis not helpful in the investigation of events. The web server must record with\neach event the client source of the event."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000098-WSR-000060","gid":"V-76787","rid":"SV-91483r1_rule","stig_id":"IISW-SI-000208","fix_id":"F-83483r1_fix","cci":["CCI-000133"],"nist":["AU-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Interview the System Administrator to review the configuration\n  of the IIS 8.5 architecture and determine if inbound web traffic is passed\n  through a proxy.\n\n  If the IIS 8.5 is receiving inbound web traffic through a proxy, the audit logs\n  must be reviewed to determine if correct source information is being passed\n  through by the proxy server.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Click on \"View log file\" button.\n\n  When log file is displaced, review source IP information in log entries and\n  verify entries do not reflect the IP address of the proxy server.\n\n  If the log entries in the log file(s) reflect the IP address of the proxy\n  server as the source, this is a finding.\n\n  If the website is not behind a load balancer or proxy server, this is\n  Not Applicable.\n  ","fix":"Access the proxy server through which inbound web traffic is\n  passed and configure settings to pass web traffic to the IIS 8.5 web server\n  transparently."},"code":"control 'V-76787' do\n  title \"An IIS 8.5 website behind a load balancer or proxy server, must\nproduce log records containing the source client IP and destination\ninformation.\"\n  desc  \"Web server logging capability is critical for accurate forensic\nanalysis. Without sufficient and accurate information, a correct replay of the\nevents cannot be determined.\n\n    Ascertaining the correct source, e.g. source IP, of the events is important\nduring forensic analysis. Correctly determining the source of events will add\ninformation to the overall reconstruction of the logable event. By determining\nthe source of the event correctly, analysis of the enterprise can be undertaken\nto determine if events tied to the source occurred in other areas within the\nenterprise.\n\n    A web server behind a load balancer or proxy server, when not configured\ncorrectly, will record the load balancer or proxy server as the source of every\nlogable event. When looking at the information forensically, this information\nis not helpful in the investigation of events. The web server must record with\neach event the client source of the event.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000098-WSR-000060'\n  tag \"gid\": 'V-76787'\n  tag \"rid\": 'SV-91483r1_rule'\n  tag \"stig_id\": 'IISW-SI-000208'\n  tag \"fix_id\": 'F-83483r1_fix'\n  tag \"cci\": ['CCI-000133']\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Interview the System Administrator to review the configuration\n  of the IIS 8.5 architecture and determine if inbound web traffic is passed\n  through a proxy.\n\n  If the IIS 8.5 is receiving inbound web traffic through a proxy, the audit logs\n  must be reviewed to determine if correct source information is being passed\n  through by the proxy server.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Click on \\\"View log file\\\" button.\n\n  When log file is displaced, review source IP information in log entries and\n  verify entries do not reflect the IP address of the proxy server.\n\n  If the log entries in the log file(s) reflect the IP address of the proxy\n  server as the source, this is a finding.\n\n  If the website is not behind a load balancer or proxy server, this is\n  Not Applicable.\n  \"\n  tag \"fix\": \"Access the proxy server through which inbound web traffic is\n  passed and configure settings to pass web traffic to the IIS 8.5 web server\n  transparently.\"\n\n  describe 'Manual review of IIS Logs is required ' do\n    skip 'Manually review to confirm  Client IP accurately identifies the client\n    and not proxy server ( if used north of IIS )'\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76787.rb"},"results":[{"status":"skipped","code_desc":"Manual review of IIS Logs is required ","run_time":1.0e-05,"start_time":"2019-02-04T07:09:59-08:00","resource":"","skip_message":"Manually review to confirm  Client IP accurately identifies the client\n    and not proxy server ( if used north of IIS )"}]},{"id":"V-76789","title":"The IIS 8.5 website must produce log records that contain sufficient\n  information to establish the outcome (success or failure) of IIS 8.5 website\n  events.","desc":"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Ascertaining the success or failure of an event is important during\n  forensic analysis. Correctly determining the outcome will add information to\n  the overall reconstruction of the logable event. By determining the success or\n  failure of the event correctly, analysis of the enterprise can be undertaken to\n  determine if events tied to the event occurred in other areas within the\n  enterprise.\n\n      Without sufficient information establishing the success or failure of the\n  logged event, investigation into the cause of event is severely hindered. The\n  success or failure also provides a means to measure the impact of an event and\n  help authorized personnel to determine the appropriate response. Log record\n  content that may be necessary to satisfy the requirement of this control\n  includes, but is not limited to, time stamps, source and destination IP\n  addresses, user/process identifiers, event descriptions, application-specific\n  events, success/fail indications, file names involved, access control, or flow\n  control rules invoked.","descriptions":[{"label":"default","data":"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Ascertaining the success or failure of an event is important during\n  forensic analysis. Correctly determining the outcome will add information to\n  the overall reconstruction of the logable event. By determining the success or\n  failure of the event correctly, analysis of the enterprise can be undertaken to\n  determine if events tied to the event occurred in other areas within the\n  enterprise.\n\n      Without sufficient information establishing the success or failure of the\n  logged event, investigation into the cause of event is severely hindered. The\n  success or failure also provides a means to measure the impact of an event and\n  help authorized personnel to determine the appropriate response. Log record\n  content that may be necessary to satisfy the requirement of this control\n  includes, but is not limited to, time stamps, source and destination IP\n  addresses, user/process identifiers, event descriptions, application-specific\n  events, success/fail indications, file names involved, access control, or flow\n  control rules invoked."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000099-WSR-000061","gid":"V-76789","rid":"SV-91485r1_rule","stig_id":"IISW-SI-000209","fix_id":"F-83485r1_fix","cci":["CCI-000134"],"nist":["AU-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Select the website being reviewed.\n\n  Under \"IIS\", double-click the \"Logging\" icon.\n\n  Verify the \"Format:\" under \"Log File\" is configured to \"W3C\".\n\n  Select the \"Fields\" button.\n\n  Under \"Custom Fields\", verify the following fields are selected:\n\n  Request Header >> Connection\n\n  Request Header >> Warning\n\n  Server Variable >> HTTP_CONNECTION\n\n  If any of the above fields are not selected, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Select the website being reviewed.\n\n  Under \"IIS\", double-click the \"Logging\" icon.\n\n  Configure the \"Format:\" under \"Log File\" to \"W3C\".\n\n  Select the \"Fields\" button.\n\n  Under \"Custom Fields\", select the following fields:\n\n  Request Header >> Connection\n\n  Request Header >> Warning\n\n  Server Variable >> HTTP_CONNECTION\n\n  Click \"OK\".\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76789' do\n  title \"The IIS 8.5 website must produce log records that contain sufficient\n  information to establish the outcome (success or failure) of IIS 8.5 website\n  events.\"\n  desc \"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Ascertaining the success or failure of an event is important during\n  forensic analysis. Correctly determining the outcome will add information to\n  the overall reconstruction of the logable event. By determining the success or\n  failure of the event correctly, analysis of the enterprise can be undertaken to\n  determine if events tied to the event occurred in other areas within the\n  enterprise.\n\n      Without sufficient information establishing the success or failure of the\n  logged event, investigation into the cause of event is severely hindered. The\n  success or failure also provides a means to measure the impact of an event and\n  help authorized personnel to determine the appropriate response. Log record\n  content that may be necessary to satisfy the requirement of this control\n  includes, but is not limited to, time stamps, source and destination IP\n  addresses, user/process identifiers, event descriptions, application-specific\n  events, success/fail indications, file names involved, access control, or flow\n  control rules invoked.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000099-WSR-000061'\n  tag \"gid\": 'V-76789'\n  tag \"rid\": 'SV-91485r1_rule'\n  tag \"stig_id\": 'IISW-SI-000209'\n  tag \"fix_id\": 'F-83485r1_fix'\n  tag \"cci\": ['CCI-000134']\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Select the website being reviewed.\n\n  Under \\\"IIS\\\", double-click the \\\"Logging\\\" icon.\n\n  Verify the \\\"Format:\\\" under \\\"Log File\\\" is configured to \\\"W3C\\\".\n\n  Select the \\\"Fields\\\" button.\n\n  Under \\\"Custom Fields\\\", verify the following fields are selected:\n\n  Request Header >> Connection\n\n  Request Header >> Warning\n\n  Server Variable >> HTTP_CONNECTION\n\n  If any of the above fields are not selected, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Select the website being reviewed.\n\n  Under \\\"IIS\\\", double-click the \\\"Logging\\\" icon.\n\n  Configure the \\\"Format:\\\" under \\\"Log File\\\" to \\\"W3C\\\".\n\n  Select the \\\"Fields\\\" button.\n\n  Under \\\"Custom Fields\\\", select the following fields:\n\n  Request Header >> Connection\n\n  Request Header >> Warning\n\n  Server Variable >> HTTP_CONNECTION\n\n  Click \\\"OK\\\".\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_logging_configuration = json(command: %(Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter 'System.Applicationhost/Sites/site[@name=\"#{site_name}\"]/logfile'  -Name * | ConvertTo-Json))\n\n    describe \"IIS Logging configuration for Site :'#{site_name}'\" do\n      subject { iis_logging_configuration }\n      its('logFormat') { should cmp 'W3C' }\n    end\n  end\n\n  custom_field_configuration = []\n  site_names.each do |site_name|\n    custom_field_configuration = command(\"Get-WebConfiguration -filter \\\"system.applicationHost/sites/site[@name=\\'#{site_name}\\']/logFile/customFields/*\\\"\").stdout.strip\n    describe \"IIS Custom Fields Logging configuration for Site :'#{site_name}'\" do\n      subject { custom_field_configuration }\n      it { should match /sourceName\\s+:\\s+Connection\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+Warning\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+HTTP_CONNECTION\\s+sourceType\\s+:\\s+ServerVariable/ }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76789.rb"},"results":[{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logFormat should cmp == \"W3C\"","run_time":0.000203,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"failed","code_desc":"IIS Custom Fields Logging configuration for Site :'Default Web Site' should match /sourceName\\s+:\\s+Connection\\s+sourceType\\s+:\\s+RequestHeader/","run_time":0.004088,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"\" to match /sourceName\\s+:\\s+Connection\\s+sourceType\\s+:\\s+RequestHeader/\nDiff:\n@@ -1,2 +1,2 @@\n-/sourceName\\s+:\\s+Connection\\s+sourceType\\s+:\\s+RequestHeader/\n+\"\"\n"},{"status":"failed","code_desc":"IIS Custom Fields Logging configuration for Site :'Default Web Site' should match /sourceName\\s+:\\s+Warning\\s+sourceType\\s+:\\s+RequestHeader/","run_time":0.000438,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"\" to match /sourceName\\s+:\\s+Warning\\s+sourceType\\s+:\\s+RequestHeader/\nDiff:\n@@ -1,2 +1,2 @@\n-/sourceName\\s+:\\s+Warning\\s+sourceType\\s+:\\s+RequestHeader/\n+\"\"\n"},{"status":"failed","code_desc":"IIS Custom Fields Logging configuration for Site :'Default Web Site' should match /sourceName\\s+:\\s+HTTP_CONNECTION\\s+sourceType\\s+:\\s+ServerVariable/","run_time":0.00049,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"\" to match /sourceName\\s+:\\s+HTTP_CONNECTION\\s+sourceType\\s+:\\s+ServerVariable/\nDiff:\n@@ -1,2 +1,2 @@\n-/sourceName\\s+:\\s+HTTP_CONNECTION\\s+sourceType\\s+:\\s+ServerVariable/\n+\"\"\n"}]},{"id":"V-76791","title":"The IIS 8.5 website must produce log records containing sufficient\n  information to establish the identity of any user/subject or process associated\n  with an event.","desc":"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Determining user accounts, processes running on behalf of the user, and\n  running process identifiers also enable a better understanding of the overall\n  event. User tool identification is also helpful to determine if events are\n  related to overall user access or specific client tools.\n\n      Log record content that may be necessary to satisfy the requirement of this\n  control includes: time stamps, source and destination addresses, user/process\n  identifiers, event descriptions, success/fail indications, file names involved,\n  and access control or flow control rules invoked.","descriptions":[{"label":"default","data":"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Determining user accounts, processes running on behalf of the user, and\n  running process identifiers also enable a better understanding of the overall\n  event. User tool identification is also helpful to determine if events are\n  related to overall user access or specific client tools.\n\n      Log record content that may be necessary to satisfy the requirement of this\n  control includes: time stamps, source and destination addresses, user/process\n  identifiers, event descriptions, success/fail indications, file names involved,\n  and access control or flow control rules invoked."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000100-WSR-000064","gid":"V-76791","rid":"SV-91487r1_rule","stig_id":"IISW-SI-000210","fix_id":"F-83487r1_fix","cci":["CCI-001487"],"nist":["AU-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Under \"IIS\", double-click the \"Logging\" icon.\n\n  Verify the \"Format:\" under \"Log File\" is configured to \"W3C\".\n\n  Select the \"Fields\" button.\n\n  Under \"Standard Fields\", verify \"User Agent\", \"User Name\" and\n  \"Referrer\" are selected.\n\n  Under \"Custom Fields\", verify the following fields have been configured:\n\n  Server Variable >> HTTP_USER_AGENT\n\n  Request Header >> User-Agent\n\n  Request Header >> Authorization\n\n  Response Header >> Content-Type\n\n  If any of the above fields are not selected, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \"IIS\", double-click the \"Logging\" icon.\n\n  Configure the \"Format:\" under \"Log File\" to \"W3C\".\n\n  Select the \"Fields\" button.\n\n  Under \"Standard Fields\", select \"User Agent\", \"User Name\" and\n  \"Referrer\".\n\n  Under \"Custom Fields\", select the following fields:\n\n  Server Variable >> HTTP_USER_AGENT\n\n  Request Header >> User-Agent\n\n  Request Header >> Authorization\n\n  Response Header >> Content-Type\n\n  Click \"OK\".\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76791' do\n  title \"The IIS 8.5 website must produce log records containing sufficient\n  information to establish the identity of any user/subject or process associated\n  with an event.\"\n  desc \"Web server logging capability is critical for accurate forensic\n  analysis. Without sufficient and accurate information, a correct replay of the\n  events cannot be determined.\n\n      Determining user accounts, processes running on behalf of the user, and\n  running process identifiers also enable a better understanding of the overall\n  event. User tool identification is also helpful to determine if events are\n  related to overall user access or specific client tools.\n\n      Log record content that may be necessary to satisfy the requirement of this\n  control includes: time stamps, source and destination addresses, user/process\n  identifiers, event descriptions, success/fail indications, file names involved,\n  and access control or flow control rules invoked.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000100-WSR-000064'\n  tag \"gid\": 'V-76791'\n  tag \"rid\": 'SV-91487r1_rule'\n  tag \"stig_id\": 'IISW-SI-000210'\n  tag \"fix_id\": 'F-83487r1_fix'\n  tag \"cci\": ['CCI-001487']\n  tag \"nist\": ['AU-3', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Under \\\"IIS\\\", double-click the \\\"Logging\\\" icon.\n\n  Verify the \\\"Format:\\\" under \\\"Log File\\\" is configured to \\\"W3C\\\".\n\n  Select the \\\"Fields\\\" button.\n\n  Under \\\"Standard Fields\\\", verify \\\"User Agent\\\", \\\"User Name\\\" and\n  \\\"Referrer\\\" are selected.\n\n  Under \\\"Custom Fields\\\", verify the following fields have been configured:\n\n  Server Variable >> HTTP_USER_AGENT\n\n  Request Header >> User-Agent\n\n  Request Header >> Authorization\n\n  Response Header >> Content-Type\n\n  If any of the above fields are not selected, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \\\"IIS\\\", double-click the \\\"Logging\\\" icon.\n\n  Configure the \\\"Format:\\\" under \\\"Log File\\\" to \\\"W3C\\\".\n\n  Select the \\\"Fields\\\" button.\n\n  Under \\\"Standard Fields\\\", select \\\"User Agent\\\", \\\"User Name\\\" and\n  \\\"Referrer\\\".\n\n  Under \\\"Custom Fields\\\", select the following fields:\n\n  Server Variable >> HTTP_USER_AGENT\n\n  Request Header >> User-Agent\n\n  Request Header >> Authorization\n\n  Response Header >> Content-Type\n\n  Click \\\"OK\\\".\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  site_names.each do |site_name|\n    iis_logging_configuration = json(command: %(Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter 'System.Applicationhost/Sites/site[@name=\"#{site_name}\"]/logfile'  -Name * | ConvertTo-Json))\n\n    describe \"IIS Logging configuration for Site :'#{site_name}'\" do\n      subject { iis_logging_configuration }\n      its('logFormat') { should cmp 'W3C' }\n      its('logExtFileFlags') { should include 'UserName' }\n      its('logExtFileFlags') { should include 'UserAgent' }\n      its('logExtFileFlags') { should include 'Referer' }\n    end\n  end\n\n  site_names.each do |site_name|\n    custom_field_configuration = command(\"Get-WebConfiguration -filter \\\"system.applicationHost/sites/site[@name=\\'#{site_name}\\']/logFile/customFields/*\\\"\").stdout.strip\n    describe \"IIS Custom Fields Logging configuration for Site :'#{site_name}'\" do\n      subject { custom_field_configuration }\n      it { should match /sourceName\\s+:\\s+User-Agent\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+Authorization\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+Content-Type\\s+sourceType\\s+:\\s+RequestHeader/ }\n      it { should match /sourceName\\s+:\\s+HTTP_USER_AGENT\\s+sourceType\\s+:\\s+ServerVariable/ }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76791.rb"},"results":[{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logFormat should cmp == \"W3C\"","run_time":0.000343,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"UserName\"","run_time":0.000251,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"UserAgent\"","run_time":0.000283,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"IIS Logging configuration for Site :'Default Web Site' logExtFileFlags should include \"Referer\"","run_time":0.000214,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"failed","code_desc":"IIS Custom Fields Logging configuration for Site :'Default Web Site' should match /sourceName\\s+:\\s+User-Agent\\s+sourceType\\s+:\\s+RequestHeader/","run_time":0.000455,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"\" to match /sourceName\\s+:\\s+User-Agent\\s+sourceType\\s+:\\s+RequestHeader/\nDiff:\n@@ -1,2 +1,2 @@\n-/sourceName\\s+:\\s+User-Agent\\s+sourceType\\s+:\\s+RequestHeader/\n+\"\"\n"},{"status":"failed","code_desc":"IIS Custom Fields Logging configuration for Site :'Default Web Site' should match /sourceName\\s+:\\s+Authorization\\s+sourceType\\s+:\\s+RequestHeader/","run_time":0.000553,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"\" to match /sourceName\\s+:\\s+Authorization\\s+sourceType\\s+:\\s+RequestHeader/\nDiff:\n@@ -1,2 +1,2 @@\n-/sourceName\\s+:\\s+Authorization\\s+sourceType\\s+:\\s+RequestHeader/\n+\"\"\n"},{"status":"failed","code_desc":"IIS Custom Fields Logging configuration for Site :'Default Web Site' should match /sourceName\\s+:\\s+Content-Type\\s+sourceType\\s+:\\s+RequestHeader/","run_time":0.000881,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"\" to match /sourceName\\s+:\\s+Content-Type\\s+sourceType\\s+:\\s+RequestHeader/\nDiff:\n@@ -1,2 +1,2 @@\n-/sourceName\\s+:\\s+Content-Type\\s+sourceType\\s+:\\s+RequestHeader/\n+\"\"\n"},{"status":"failed","code_desc":"IIS Custom Fields Logging configuration for Site :'Default Web Site' should match /sourceName\\s+:\\s+HTTP_USER_AGENT\\s+sourceType\\s+:\\s+ServerVariable/","run_time":0.000704,"start_time":"2019-02-04T07:09:59-08:00","message":"expected \"\" to match /sourceName\\s+:\\s+HTTP_USER_AGENT\\s+sourceType\\s+:\\s+ServerVariable/\nDiff:\n@@ -1,2 +1,2 @@\n-/sourceName\\s+:\\s+HTTP_USER_AGENT\\s+sourceType\\s+:\\s+ServerVariable/\n+\"\"\n"}]},{"id":"V-76795","title":"The log information from the IIS 8.5 website must be protected from\n  unauthorized modification or deletion.","desc":"A major tool in exploring the website use, attempted use, unusual\n  conditions, and problems are the access and error logs. In the event of a\n  security incident, these logs can provide the SA and the web manager with\n  valuable information. Failure to protect log files could enable an attacker to\n  modify the log file data or falsify events to mask an attacker's activity.","descriptions":[{"label":"default","data":"A major tool in exploring the website use, attempted use, unusual\n  conditions, and problems are the access and error logs. In the event of a\n  security incident, these logs can provide the SA and the web manager with\n  valuable information. Failure to protect log files could enable an attacker to\n  modify the log file data or falsify events to mask an attacker's activity."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000120-WSR-000070","gid":"V-76795","rid":"SV-91491r2_rule","stig_id":"IISW-SI-000213","fix_id":"F-83491r1_fix","cci":["CCI-000163","CCI-000164"],"nist":["AU-9","AU-9","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Click \"Browse\" and navigate to the directory where the log files are stored.\n\n  Right-click the log file name to review and click Properties.\n\n  Click the Security tab; verify only authorized groups are listed, if others\n  are listed, this is a finding.\n\n  Note: The log file should be restricted as follows:\n\n  SYSTEM, Auditors group: Full\n  SA, web managers: Read\n  ","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \"Logging\" icon.\n\n  Click \"Browse\" and navigate to the directory where the log files are stored.\n\n  Right-click the log file name to review and click Properties.\n\n  Click the Security tab.\n\n  Set the log file permissions for the appropriate group."},"code":"control 'V-76795' do\n  title \"The log information from the IIS 8.5 website must be protected from\n  unauthorized modification or deletion.\"\n  desc \"A major tool in exploring the website use, attempted use, unusual\n  conditions, and problems are the access and error logs. In the event of a\n  security incident, these logs can provide the SA and the web manager with\n  valuable information. Failure to protect log files could enable an attacker to\n  modify the log file data or falsify events to mask an attacker's activity.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000120-WSR-000070'\n  tag \"gid\": 'V-76795'\n  tag \"rid\": 'SV-91491r2_rule'\n  tag \"stig_id\": 'IISW-SI-000213'\n  tag \"fix_id\": 'F-83491r1_fix'\n  tag \"cci\": ['CCI-000163', 'CCI-000164']\n  tag \"nist\": ['AU-9', 'AU-9', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Click \\\"Browse\\\" and navigate to the directory where the log files are stored.\n\n  Right-click the log file name to review and click Properties.\n\n  Click the Security tab; verify only authorized groups are listed, if others\n  are listed, this is a finding.\n\n  Note: The log file should be restricted as follows:\n\n  SYSTEM, Auditors group: Full\n  SA, web managers: Read\n  \"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Click the \\\"Logging\\\" icon.\n\n  Click \\\"Browse\\\" and navigate to the directory where the log files are stored.\n\n  Right-click the log file name to review and click Properties.\n\n  Click the Security tab.\n\n  Set the log file permissions for the appropriate group.\"\n\n  get_log_directory = command(\"Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter 'system.applicationHost/sites/*/logFile' -name * | select -expand directory\").stdout.strip.split(\"\\r\\n\")\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  get_log_directory.zip(get_names).each do |log_dir, names|\n    system_drive = command('$env:SystemDrive').stdout.strip\n\n    dirs = log_dir.gsub(/%SystemDrive%/, system_drive.to_s)\n\n    describe \"IIS site #{names} log file directory #{dirs}\" do\n      subject { file(dirs.to_s) }\n      it { should be_allowed('read', by_user: 'BUILTIN\\\\Administrators') }\n      it { should be_allowed('full-control', by_user: 'NT AUTHORITY\\\\SYSTEM') }\n      it { should be_allowed('full-control', by_user: 'NT SERVICE\\\\TrustedInstaller') }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76795.rb"},"results":[{"status":"failed","code_desc":"IIS site Default Web Site log file directory C:\\inetpub\\logs\\LogFiles should be allowed \"read\" and {:by_user=>\"BUILTIN\\\\Administrators\"}","run_time":0.006069,"start_time":"2019-02-04T07:09:59-08:00","message":"expected `File C:\\inetpub\\logs\\LogFiles.allowed?(\"read\", {:by_user=>\"BUILTIN\\\\Administrators\"})` to return true, got false"},{"status":"failed","code_desc":"IIS site Default Web Site log file directory C:\\inetpub\\logs\\LogFiles should be allowed \"full-control\" and {:by_user=>\"NT AUTHORITY\\\\SYSTEM\"}","run_time":0.000655,"start_time":"2019-02-04T07:09:59-08:00","message":"expected `File C:\\inetpub\\logs\\LogFiles.allowed?(\"full-control\", {:by_user=>\"NT AUTHORITY\\\\SYSTEM\"})` to return true, got false"},{"status":"failed","code_desc":"IIS site Default Web Site log file directory C:\\inetpub\\logs\\LogFiles should be allowed \"full-control\" and {:by_user=>\"NT SERVICE\\\\TrustedInstaller\"}","run_time":0.00055,"start_time":"2019-02-04T07:09:59-08:00","message":"expected `File C:\\inetpub\\logs\\LogFiles.allowed?(\"full-control\", {:by_user=>\"NT SERVICE\\\\TrustedInstaller\"})` to return true, got false"},{"status":"failed","code_desc":"IIS site  log file directory C:\\inetpub\\logs\\LogFiles should be allowed \"read\" and {:by_user=>\"BUILTIN\\\\Administrators\"}","run_time":0.000511,"start_time":"2019-02-04T07:09:59-08:00","message":"expected `File C:\\inetpub\\logs\\LogFiles.allowed?(\"read\", {:by_user=>\"BUILTIN\\\\Administrators\"})` to return true, got false"},{"status":"failed","code_desc":"IIS site  log file directory C:\\inetpub\\logs\\LogFiles should be allowed \"full-control\" and {:by_user=>\"NT AUTHORITY\\\\SYSTEM\"}","run_time":0.000451,"start_time":"2019-02-04T07:09:59-08:00","message":"expected `File C:\\inetpub\\logs\\LogFiles.allowed?(\"full-control\", {:by_user=>\"NT AUTHORITY\\\\SYSTEM\"})` to return true, got false"},{"status":"failed","code_desc":"IIS site  log file directory C:\\inetpub\\logs\\LogFiles should be allowed \"full-control\" and {:by_user=>\"NT SERVICE\\\\TrustedInstaller\"}","run_time":0.000412,"start_time":"2019-02-04T07:09:59-08:00","message":"expected `File C:\\inetpub\\logs\\LogFiles.allowed?(\"full-control\", {:by_user=>\"NT SERVICE\\\\TrustedInstaller\"})` to return true, got false"}]},{"id":"V-76797","title":"The IIS 8.5 website must have Multipurpose Internet Mail Extensions\n  (MIME) that invoke OS shell programs disabled.","desc":"Controlling what a user of a hosted application can access is part of\n  the security posture of the web server. Any time a user can access more\n  functionality than is needed for the operation of the hosted application poses\n  a security issue. A user with too much access can view information that is not\n  needed for the user's job role, or the user could use the function in an\n  unintentional manner.\n\n      A MIME tells the web server what type of program various file types and\n  extensions are and what external utilities or programs are needed to execute\n  the file type.\n\n      A shell is a program that serves as the basic interface between the user\n  and the operating system, so hosted application users must not have access to\n  these programs. Shell programs may execute shell escapes and can then perform\n  unauthorized activities that could damage the security posture of the web\n  server.","descriptions":[{"label":"default","data":"Controlling what a user of a hosted application can access is part of\n  the security posture of the web server. Any time a user can access more\n  functionality than is needed for the operation of the hosted application poses\n  a security issue. A user with too much access can view information that is not\n  needed for the user's job role, or the user could use the function in an\n  unintentional manner.\n\n      A MIME tells the web server what type of program various file types and\n  extensions are and what external utilities or programs are needed to execute\n  the file type.\n\n      A shell is a program that serves as the basic interface between the user\n  and the operating system, so hosted application users must not have access to\n  these programs. Shell programs may execute shell escapes and can then perform\n  unauthorized activities that could damage the security posture of the web\n  server."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000081","gid":"V-76797","rid":"SV-91493r1_rule","stig_id":"IISW-SI-000214","fix_id":"F-83493r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the IIS 8.5 site.\n\n  Under IIS, double-click the “MIME Types” icon.\n\n  From the \"Group by:\" drop-down list, select \"Content Type\".\n\n  From the list of extensions under \"Application\", verify MIME types for OS\n  shell program extensions have been removed, to include at a minimum, the\n  following extensions:\n\n  .exe\n  .dll\n  .com\n  .bat\n  .csh\n\n  If any OS shell MIME types are configured, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the IIS 8.5 site.\n\n  Under IIS, double-click the MIME Types icon.\n\n  From the \"Group by:\" drop-down list, select \"Content Type\".\n\n  From the list of extensions under \"Application\", remove MIME types for OS\n  shell program extensions, to include at a minimum, the following extensions:\n\n  .exe\n  .dll\n  .com\n  .bat\n  .csh\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76797' do\n  title \"The IIS 8.5 website must have Multipurpose Internet Mail Extensions\n  (MIME) that invoke OS shell programs disabled.\"\n  desc \"Controlling what a user of a hosted application can access is part of\n  the security posture of the web server. Any time a user can access more\n  functionality than is needed for the operation of the hosted application poses\n  a security issue. A user with too much access can view information that is not\n  needed for the user's job role, or the user could use the function in an\n  unintentional manner.\n\n      A MIME tells the web server what type of program various file types and\n  extensions are and what external utilities or programs are needed to execute\n  the file type.\n\n      A shell is a program that serves as the basic interface between the user\n  and the operating system, so hosted application users must not have access to\n  these programs. Shell programs may execute shell escapes and can then perform\n  unauthorized activities that could damage the security posture of the web\n  server.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000081'\n  tag \"gid\": 'V-76797'\n  tag \"rid\": 'SV-91493r1_rule'\n  tag \"stig_id\": 'IISW-SI-000214'\n  tag \"fix_id\": 'F-83493r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the IIS 8.5 site.\n\n  Under IIS, double-click the “MIME Types” icon.\n\n  From the \\\"Group by:\\\" drop-down list, select \\\"Content Type\\\".\n\n  From the list of extensions under \\\"Application\\\", verify MIME types for OS\n  shell program extensions have been removed, to include at a minimum, the\n  following extensions:\n\n  .exe\n  .dll\n  .com\n  .bat\n  .csh\n\n  If any OS shell MIME types are configured, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the IIS 8.5 site.\n\n  Under IIS, double-click the MIME Types icon.\n\n  From the \\\"Group by:\\\" drop-down list, select \\\"Content Type\\\".\n\n  From the list of extensions under \\\"Application\\\", remove MIME types for OS\n  shell program extensions, to include at a minimum, the following extensions:\n\n  .exe\n  .dll\n  .com\n  .bat\n  .csh\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  get_names = command(\"Get-Website | select name | findstr /r /v '^$' | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_names.each do |names|\n    n = names.strip\n    exe_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.exe'}\").stdout\n    dll_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.dll'}\").stdout\n\n    com_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.com'}\").stdout\n\n    bat_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.bat'}\").stdout\n\n    csh_files = command(\"Get-WebConfiguration -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter \\\"system.webServer/staticContent/mimeMap\\\" | ? {$_.fileextension -eq '.csh'}\").stdout\n\n    describe \"The IIS Site: #{n} MIME .exe files found\" do\n      subject { exe_files }\n      it { should be_empty }\n    end\n    describe \"The IIS Site: #{n}  MIME .dll files found\" do\n      subject { dll_files }\n      it { should be_empty }\n    end\n    describe \"The IIS Site: #{n} MIME .com files found\" do\n      subject { com_files }\n      it { should be_empty }\n    end\n    describe \"The IIS Site: #{n} .bat files found\" do\n      subject { bat_files }\n      it { should be_empty }\n    end\n    describe \"The IIS Site: #{n} MIME .csh files found\" do\n      subject { csh_files }\n      it { should be_empty }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76797.rb"},"results":[{"status":"failed","code_desc":"The IIS Site: Default Web Site MIME .exe files found should be empty","run_time":0.000274,"start_time":"2019-02-04T07:09:59-08:00","message":"expected `\"\\r\\n\\r\\nfileExtension         : .exe\\r\\nmimeType              : application/octet-stream\\r\\nPSPath  ...hema                : Microsoft.IIs.PowerShell.Framework.ConfigurationElementSchema\\r\\n\\r\\n\\r\\n\\r\\n\".empty?` to return true, got false"},{"status":"failed","code_desc":"The IIS Site: Default Web Site  MIME .dll files found should be empty","run_time":0.000375,"start_time":"2019-02-04T07:09:59-08:00","message":"expected `\"\\r\\n\\r\\nfileExtension         : .dll\\r\\nmimeType              : application/x-msdownload\\r\\nPSPath  ...hema                : Microsoft.IIs.PowerShell.Framework.ConfigurationElementSchema\\r\\n\\r\\n\\r\\n\\r\\n\".empty?` to return true, got false"},{"status":"passed","code_desc":"The IIS Site: Default Web Site MIME .com files found should be empty","run_time":0.000159,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"passed","code_desc":"The IIS Site: Default Web Site .bat files found should be empty","run_time":0.000211,"start_time":"2019-02-04T07:09:59-08:00"},{"status":"failed","code_desc":"The IIS Site: Default Web Site MIME .csh files found should be empty","run_time":0.000326,"start_time":"2019-02-04T07:09:59-08:00","message":"expected `\"\\r\\n\\r\\nfileExtension         : .csh\\r\\nmimeType              : application/x-csh\\r\\nPSPath         ...hema                : Microsoft.IIs.PowerShell.Framework.ConfigurationElementSchema\\r\\n\\r\\n\\r\\n\\r\\n\".empty?` to return true, got false"}]},{"id":"V-76799","title":"Mappings to unused and vulnerable scripts on the IIS 8.5 website must\n  be removed.","desc":"IIS 8.5 will either allow or deny script execution based on file\n  extension. The ability to control script execution is controlled through two\n  features with IIS 8.5, Request Filtering and \"Handler Mappings\".\n\n      For \"Handler Mappings\", the ISSO must document and approve all allowable\n  file extensions the website allows (white list) and denies (black list) by the\n  website. The white list and black list will be compared to the \"Handler\n  Mappings\" in IIS 8. \"Handler Mappings\" at the site level take precedence\n  over \"Handler Mappings\" at the server level.","descriptions":[{"label":"default","data":"IIS 8.5 will either allow or deny script execution based on file\n  extension. The ability to control script execution is controlled through two\n  features with IIS 8.5, Request Filtering and \"Handler Mappings\".\n\n      For \"Handler Mappings\", the ISSO must document and approve all allowable\n  file extensions the website allows (white list) and denies (black list) by the\n  website. The white list and black list will be compared to the \"Handler\n  Mappings\" in IIS 8. \"Handler Mappings\" at the site level take precedence\n  over \"Handler Mappings\" at the server level."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000082","gid":"V-76799","rid":"SV-91495r1_rule","stig_id":"IISW-SI-000215","fix_id":"F-83495r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"For \"Handler Mappings\", the ISSO must document and approve\n  all allowable scripts the website allows (white list) and denies (black list)\n  by the website. The white list and black list will be compared to the \"Handler\n  Mappings\" in IIS 8.5. \"Handler Mappings\" at the site level take precedence\n  over \"Handler Mappings\" at the server level.\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \"Handler Mappings\".\n\n  If any script file extensions from the black list are enabled, this is a\n  finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \"Handler Mappings\".\n\n  Remove any script file extensions listed on the black list that are enabled.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76799' do\n  title \"Mappings to unused and vulnerable scripts on the IIS 8.5 website must\n  be removed.\"\n  desc \"IIS 8.5 will either allow or deny script execution based on file\n  extension. The ability to control script execution is controlled through two\n  features with IIS 8.5, Request Filtering and \\\"Handler Mappings\\\".\n\n      For \\\"Handler Mappings\\\", the ISSO must document and approve all allowable\n  file extensions the website allows (white list) and denies (black list) by the\n  website. The white list and black list will be compared to the \\\"Handler\n  Mappings\\\" in IIS 8. \\\"Handler Mappings\\\" at the site level take precedence\n  over \\\"Handler Mappings\\\" at the server level.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000082'\n  tag \"gid\": 'V-76799'\n  tag \"rid\": 'SV-91495r1_rule'\n  tag \"stig_id\": 'IISW-SI-000215'\n  tag \"fix_id\": 'F-83495r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For \\\"Handler Mappings\\\", the ISSO must document and approve\n  all allowable scripts the website allows (white list) and denies (black list)\n  by the website. The white list and black list will be compared to the \\\"Handler\n  Mappings\\\" in IIS 8.5. \\\"Handler Mappings\\\" at the site level take precedence\n  over \\\"Handler Mappings\\\" at the server level.\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\"Handler Mappings\\\".\n\n  If any script file extensions from the black list are enabled, this is a\n  finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\"Handler Mappings\\\".\n\n  Remove any script file extensions listed on the black list that are enabled.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  describe 'Manually review the Handler Mappings' do\n    skip 'Manually review site Handler Mappings configuration; If any script file\n    extensions from the black list are enabled, this is a finding.\"'\n  end\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76799.rb"},"results":[{"status":"skipped","code_desc":"Manually review the Handler Mappings","run_time":9.0e-06,"start_time":"2019-02-04T07:09:59-08:00","resource":"","skip_message":"Manually review site Handler Mappings configuration; If any script file\n    extensions from the black list are enabled, this is a finding.\""}]},{"id":"V-76801","title":"The IIS 8.5 website must have resource mappings set to disable the\nserving of certain file types.","desc":"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    The web server must only allow hosted application file types to be served\nto a user and all other types must be disabled.","descriptions":[{"label":"default","data":"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    The web server must only allow hosted application file types to be served\nto a user and all other types must be disabled."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000083","gid":"V-76801","rid":"SV-91497r1_rule","stig_id":"IISW-SI-000216","fix_id":"F-83497r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"For \"Handler Mappings\", the ISSO must document and approve\n  all allowable file extensions the website allows (white list) and denies (black\n  list) by the website. The white list and black list will be compared to the\n  \"Handler Mappings\" in IIS 8.5. \"Handler Mappings\" at the site level take\n  precedence over \"Handler Mappings\" at the server level.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click \"Request Filtering\".\n\n  If any file name extensions from the black list have \"Allowed\" set to\n  \"True\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \"Request Filtering\".\n\n  For any file name extensions from the black list which have \"Allowed\" set to\n  \"True\", remove the file name extension.\n\n  Select \"Deny File Name Extension\" from the \"Actions\" pane.\n\n  Add each file name extension from the black list.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76801' do\n  title \"The IIS 8.5 website must have resource mappings set to disable the\nserving of certain file types.\"\n  desc  \"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    The web server must only allow hosted application file types to be served\nto a user and all other types must be disabled.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000083'\n  tag \"gid\": 'V-76801'\n  tag \"rid\": 'SV-91497r1_rule'\n  tag \"stig_id\": 'IISW-SI-000216'\n  tag \"fix_id\": 'F-83497r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"For \\\"Handler Mappings\\\", the ISSO must document and approve\n  all allowable file extensions the website allows (white list) and denies (black\n  list) by the website. The white list and black list will be compared to the\n  \\\"Handler Mappings\\\" in IIS 8.5. \\\"Handler Mappings\\\" at the site level take\n  precedence over \\\"Handler Mappings\\\" at the server level.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click \\\"Request Filtering\\\".\n\n  If any file name extensions from the black list have \\\"Allowed\\\" set to\n  \\\"True\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\"Request Filtering\\\".\n\n  For any file name extensions from the black list which have \\\"Allowed\\\" set to\n  \\\"True\\\", remove the file name extension.\n\n  Select \\\"Deny File Name Extension\\\" from the \\\"Actions\\\" pane.\n\n  Add each file name extension from the black list.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n  black_listed_extensions = attribute('black_listed_extensions')\n\n  site_names.each do |site_name|\n    extensions = command(\"Get-WebConfigurationProperty -Filter /system.webserver/security/requestFiltering/fileExtensions 'IIS:\\\\Sites\\\\#{site_name}'  -Name Collection | where {$_.allowed -eq $true}| select -expand fileExtension\").stdout.split\n\n    describe \"Allowed Request Filtering extensions should not be in black listed extensions; #{extensions}\" do\n      subject { extensions }\n      it { should_not be_in black_listed_extensions }\n    end\n  end\n\n  if site_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76801.rb"},"results":[{"status":"passed","code_desc":"Allowed Request Filtering extensions should not be in black listed extensions; [] should not be in","run_time":0.000181,"start_time":"2019-02-04T07:09:59-08:00"}]},{"id":"V-76803","title":"The IIS 8.5 website must have Web Distributed Authoring and Versioning\n  (WebDAV) disabled.","desc":"A web server can be installed with functionality that, just by its\n  nature, is not secure. Web Distributed Authoring (WebDAV) is an extension to\n  the HTTP protocol that, when developed, was meant to allow users to create,\n  change, and move documents on a server, typically a web server or web share.\n  Allowing this functionality, development, and deployment is much easier for web\n  authors.\n\n      WebDAV is not widely used and has serious security concerns because it may\n  allow clients to modify unauthorized files on the web server.","descriptions":[{"label":"default","data":"A web server can be installed with functionality that, just by its\n  nature, is not secure. Web Distributed Authoring (WebDAV) is an extension to\n  the HTTP protocol that, when developed, was meant to allow users to create,\n  change, and move documents on a server, typically a web server or web share.\n  Allowing this functionality, development, and deployment is much easier for web\n  authors.\n\n      WebDAV is not widely used and has serious security concerns because it may\n  allow clients to modify unauthorized files on the web server."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000085","gid":"V-76803","rid":"SV-91499r1_rule","stig_id":"IISW-SI-000217","fix_id":"F-83499r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Select the IIS 8.5 website.\n\n  Review the features listed under the \"IIS\" section.\n\n  If the \"WebDAV Authoring Rules\" icon exists, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access Server Manager on the IIS 8.5 website.\n\n  Select the Local Server.\n\n  Click on \"Manage\".\n\n  Select \"Add Roles and Features\".\n\n  Click \"Next\" on the \"Before you begin\" dialog box.\n\n  Select \"Role-based or feature-based installation\" on the \"Installation\n  Type\" dialog box and click on \"Next\".\n\n  Select the IIS 8.5 web server on the \"Server Selection\" dialog box.\n\n  From the \"Windows Features\" dialog box, navigate to \"World Wide Web\n  Services\" >> \"Common HTTP Features\".\n\n  De-select \"WebDAV Publishing\" and click \"Next\" to complete removing the\n  WebDAV Publishing feature from the IIS 8.5 web server.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76803' do\n  title \"The IIS 8.5 website must have Web Distributed Authoring and Versioning\n  (WebDAV) disabled.\"\n  desc \"A web server can be installed with functionality that, just by its\n  nature, is not secure. Web Distributed Authoring (WebDAV) is an extension to\n  the HTTP protocol that, when developed, was meant to allow users to create,\n  change, and move documents on a server, typically a web server or web share.\n  Allowing this functionality, development, and deployment is much easier for web\n  authors.\n\n      WebDAV is not widely used and has serious security concerns because it may\n  allow clients to modify unauthorized files on the web server.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000085'\n  tag \"gid\": 'V-76803'\n  tag \"rid\": 'SV-91499r1_rule'\n  tag \"stig_id\": 'IISW-SI-000217'\n  tag \"fix_id\": 'F-83499r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Select the IIS 8.5 website.\n\n  Review the features listed under the \\\"IIS\\\" section.\n\n  If the \\\"WebDAV Authoring Rules\\\" icon exists, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access Server Manager on the IIS 8.5 website.\n\n  Select the Local Server.\n\n  Click on \\\"Manage\\\".\n\n  Select \\\"Add Roles and Features\\\".\n\n  Click \\\"Next\\\" on the \\\"Before you begin\\\" dialog box.\n\n  Select \\\"Role-based or feature-based installation\\\" on the \\\"Installation\n  Type\\\" dialog box and click on \\\"Next\\\".\n\n  Select the IIS 8.5 web server on the \\\"Server Selection\\\" dialog box.\n\n  From the \\\"Windows Features\\\" dialog box, navigate to \\\"World Wide Web\n  Services\\\" >> \\\"Common HTTP Features\\\".\n\n  De-select \\\"WebDAV Publishing\\\" and click \\\"Next\\\" to complete removing the\n  WebDAV Publishing feature from the IIS 8.5 web server.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  describe windows_feature('Web-DAV-Publishing') do\n    it { should_not be_installed }\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76803.rb"},"results":[{"status":"passed","code_desc":"Windows Feature 'Web-DAV-Publishing' should not be installed","run_time":0.484455,"start_time":"2019-02-04T07:09:59-08:00"}]},{"id":"V-76805","title":"The production website must configure the Global .NET Trust Level.","desc":"A web server may host too many applications. Each application will\n  need certain system resources and privileged operations to operate correctly.\n  An application's trust level determines the permissions granted by the ASP.NET\n  Code Access Security (CAS) policy. An application with full trust permissions\n  may access all resource types on a server and perform privileged operations,\n  while applications running with partial trust have varying levels of operating\n  permissions and access to resources. The CAS determines the permissions granted\n  to the application on the server. Setting a level of trust compatible with the\n  applications will limit the potential harm a compromised application could\n  cause to a system. The web server must be configured to contain and control the\n  applications and protect the system resources and privileged operations from\n  those not needed by the application for operation.\n\n      Limiting the application will confine the potential harm a compromised\n  application could cause to a system.","descriptions":[{"label":"default","data":"A web server may host too many applications. Each application will\n  need certain system resources and privileged operations to operate correctly.\n  An application's trust level determines the permissions granted by the ASP.NET\n  Code Access Security (CAS) policy. An application with full trust permissions\n  may access all resource types on a server and perform privileged operations,\n  while applications running with partial trust have varying levels of operating\n  permissions and access to resources. The CAS determines the permissions granted\n  to the application on the server. Setting a level of trust compatible with the\n  applications will limit the potential harm a compromised application could\n  cause to a system. The web server must be configured to contain and control the\n  applications and protect the system resources and privileged operations from\n  those not needed by the application for operation.\n\n      Limiting the application will confine the potential harm a compromised\n  application could cause to a system."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000086","gid":"V-76805","rid":"SV-91501r2_rule","stig_id":"IISW-SI-000218","fix_id":"F-83501r2_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the server being reviewed is a non-production website,\n  this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \".NET Trust Level\" icon.\n\n  If the \".NET Trust Level\" is not set to Full or less, this is a finding.\n  ","fix":"Note: If the server being reviewed is a non-production website,\n  this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \".NET Trust Level\" icon.\n\n  Set the \".NET Trust Level\" to Full or less and click Apply.\n\n  Select \"Apply\" from the \"Actions\" pane.\n  "},"code":"control 'V-76805' do\n  title 'The production website must configure the Global .NET Trust Level.'\n  desc  \"A web server may host too many applications. Each application will\n  need certain system resources and privileged operations to operate correctly.\n  An application's trust level determines the permissions granted by the ASP.NET\n  Code Access Security (CAS) policy. An application with full trust permissions\n  may access all resource types on a server and perform privileged operations,\n  while applications running with partial trust have varying levels of operating\n  permissions and access to resources. The CAS determines the permissions granted\n  to the application on the server. Setting a level of trust compatible with the\n  applications will limit the potential harm a compromised application could\n  cause to a system. The web server must be configured to contain and control the\n  applications and protect the system resources and privileged operations from\n  those not needed by the application for operation.\n\n      Limiting the application will confine the potential harm a compromised\n  application could cause to a system.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000086'\n  tag \"gid\": 'V-76805'\n  tag \"rid\": 'SV-91501r2_rule'\n  tag \"stig_id\": 'IISW-SI-000218'\n  tag \"fix_id\": 'F-83501r2_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: If the server being reviewed is a non-production website,\n  this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\".NET Trust Level\\\" icon.\n\n  If the \\\".NET Trust Level\\\" is not set to Full or less, this is a finding.\n  \"\n  tag \"fix\": \"Note: If the server being reviewed is a non-production website,\n  this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\".NET Trust Level\\\" icon.\n\n  Set the \\\".NET Trust Level\\\" to Full or less and click Apply.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\n  \"\n  get_names = command(\"Get-Website | select name | findstr /r /v '^$' | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_names.each do |names|\n    n = names.strip\n    get_trust_level = command(\"Get-WebConfigurationProperty -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter system.web/trust -name * | select -expand level\").stdout.strip.split(\"\\n\")\n    get_trust_level.each do |trust_level|\n      a = trust_level.strip\n      describe \"The IIS site: #{n} Global .NET Trust Level\" do\n        subject { a }\n        it { should cmp 'Full' }\n      end\n    end\n  end\n\n  if attribute('non_production_server')\n    impact 0.0\n    desc 'The server being reviewed is a non-production website server, hence\n    this control is Not Applicable.'\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76805.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site Global .NET Trust Level should cmp == \"Full\"","run_time":0.000574,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76807","title":"Each IIS 8.5 website must be assigned a default host header.","desc":"The web server must be configured to listen on a specified IP address\n  and port. Without specifying an IP address and port for the web server to\n  utilize, the web server will listen on all IP addresses available to the\n  hosting server. If the web server has multiple IP addresses, i.e., a management\n  IP address, the web server will also accept connections on the management IP\n  address.\n\n      Accessing the hosted application through an IP address normally used for\n  non-application functions opens the possibility of user access to resources,\n  utilities, files, ports, and protocols that are protected on the desired\n  application IP address.","descriptions":[{"label":"default","data":"The web server must be configured to listen on a specified IP address\n  and port. Without specifying an IP address and port for the web server to\n  utilize, the web server will listen on all IP addresses available to the\n  hosting server. If the web server has multiple IP addresses, i.e., a management\n  IP address, the web server will also accept connections on the management IP\n  address.\n\n      Accessing the hosted application through an IP address normally used for\n  non-application functions opens the possibility of user access to resources,\n  utilities, files, ports, and protocols that are protected on the desired\n  application IP address."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000142-WSR-000089","gid":"V-76807","rid":"SV-91503r1_rule","stig_id":"IISW-SI-000219","fix_id":"F-83503r1_fix","cci":["CCI-000382"],"nist":["CM-7 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Right-click on the site name under review.\n\n  Select Edit Bindings.\n\n  Verify there are hostname entries and unique IP addresses assigned to port 80\n  for HTTP and port 443 for HTTPS.\n\n  If both hostname entries and unique IP addresses are not configure to port 80\n  for HTTP and port 443 for HTTPS, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Right-click on the site name under review.\n\n  Select Edit Bindings.\n\n  Assign hostname entries and unique IP addresses to port 80 for HTTP and port\n  443 for HTTPS.\n\n  Click \"OK\".\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76807' do\n  title 'Each IIS 8.5 website must be assigned a default host header.'\n  desc \"The web server must be configured to listen on a specified IP address\n  and port. Without specifying an IP address and port for the web server to\n  utilize, the web server will listen on all IP addresses available to the\n  hosting server. If the web server has multiple IP addresses, i.e., a management\n  IP address, the web server will also accept connections on the management IP\n  address.\n\n      Accessing the hosted application through an IP address normally used for\n  non-application functions opens the possibility of user access to resources,\n  utilities, files, ports, and protocols that are protected on the desired\n  application IP address.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000142-WSR-000089'\n  tag \"gid\": 'V-76807'\n  tag \"rid\": 'SV-91503r1_rule'\n  tag \"stig_id\": 'IISW-SI-000219'\n  tag \"fix_id\": 'F-83503r1_fix'\n  tag \"cci\": ['CCI-000382']\n  tag \"nist\": ['CM-7 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Right-click on the site name under review.\n\n  Select Edit Bindings.\n\n  Verify there are hostname entries and unique IP addresses assigned to port 80\n  for HTTP and port 443 for HTTPS.\n\n  If both hostname entries and unique IP addresses are not configure to port 80\n  for HTTP and port 443 for HTTPS, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Right-click on the site name under review.\n\n  Select Edit Bindings.\n\n  Assign hostname entries and unique IP addresses to port 80 for HTTP and port\n  443 for HTTPS.\n\n  Click \\\"OK\\\".\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  site_name = attribute('site_name')\n\n  http_ip = attribute('http_ip')\n\n  http_hostname = attribute('http_hostname')\n\n  https_ip = attribute('https_ip')\n\n  https_hostname = attribute('https_hostname')\n\n  site_name.zip(http_ip, http_hostname).each do |site, httpip, httphostname|\n    describe iis_site(site.to_s) do\n      it { should exist }\n      it { should have_binding(\"http #{httpip}:80:#{httphostname}\") }\n    end\n  end\n  site_name.zip(https_ip, https_hostname).each do |site, httpsip, httsphostname|\n    describe iis_site(site.to_s) do\n      it { should exist }\n      it { should have_binding(\"https #{httpsip}:80:#{httsphostname}\") }\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76807.rb"},"results":[{"status":"failed","code_desc":"iis_site 'tt' should exist","run_time":0.010193,"start_time":"2019-02-04T07:10:00-08:00","message":"expected iis_site 'tt' to exist"},{"status":"failed","code_desc":"iis_site 'tt' should have binding \"http 10.0.2.15:80:local\"","run_time":0.006018,"start_time":"2019-02-04T07:10:00-08:00","message":"expected #has_binding?(\"http 10.0.2.15:80:local\") to return true, got false"},{"status":"failed","code_desc":"iis_site 'Default' should exist","run_time":0.005174,"start_time":"2019-02-04T07:10:00-08:00","message":"expected iis_site 'Default' to exist"},{"status":"failed","code_desc":"iis_site 'Default' should have binding \"http 0.0.0.0:80:l\"","run_time":0.001777,"start_time":"2019-02-04T07:10:00-08:00","message":"expected #has_binding?(\"http 0.0.0.0:80:l\") to return true, got false"},{"status":"failed","code_desc":"iis_site 'tt' should exist","run_time":0.000473,"start_time":"2019-02-04T07:10:00-08:00","message":"expected iis_site 'tt' to exist"},{"status":"failed","code_desc":"iis_site 'tt' should have binding \"https 10.0.2.15:80:localhttps\"","run_time":0.000549,"start_time":"2019-02-04T07:10:00-08:00","message":"expected #has_binding?(\"https 10.0.2.15:80:localhttps\") to return true, got false"},{"status":"failed","code_desc":"iis_site 'Default' should exist","run_time":0.000413,"start_time":"2019-02-04T07:10:00-08:00","message":"expected iis_site 'Default' to exist"},{"status":"failed","code_desc":"iis_site 'Default' should have binding \"https 0.0.0.0:80:localhttps2\"","run_time":0.000581,"start_time":"2019-02-04T07:10:00-08:00","message":"expected #has_binding?(\"https 0.0.0.0:80:localhttps2\") to return true, got false"}]},{"id":"V-76809","title":"A private websites authentication mechanism must use client\n  certificates to transmit session identifier to assure integrity.","desc":"A CMS private website must utilize PKI as an authentication mechanism for web \n         users. Information systems residing behind web servers requiring authorization \n         based on individual identity must use the identity provided by certificate-based \n         authentication to support access control decisions. Not using client certificates \n         allows an attacker unauthenticated access to private websites.\n\n         Satisfies: SRG-APP-000172-WSR-000104, SRG-APP-000224-WSR-000135, SRG-APP-000427-WSR-000186","descriptions":[{"label":"default","data":"A CMS private website must utilize PKI as an authentication mechanism for web \n         users. Information systems residing behind web servers requiring authorization \n         based on individual identity must use the identity provided by certificate-based \n         authentication to support access control decisions. Not using client certificates \n         allows an attacker unauthenticated access to private websites.\n\n         Satisfies: SRG-APP-000172-WSR-000104, SRG-APP-000224-WSR-000135, SRG-APP-000427-WSR-000186"}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000172-WSR-000104","satisfies":["SRG-APP-000172-WSR-000104","SRG-APP-000224-WSR-000135","SRG-APP-000427-WSR-000186"],"gid":"V-76809","rid":"SV-91505r1_rule","stig_id":"IISW-SI-000220","fix_id":"F-83505r1_fix","cci":["CCI-000197","CCI-001188","CCI-002470"],"nist":["IA-5 (1) (c)","SC-23 (3)","SC-23 (5)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Verify the \"Clients Certificate Required\" check box is selected.\n\n  If the \"Clients Certificate Required\" check box is not selected, this is a\n  finding.","fix":"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Verify the \"Clients Certificate Required\" check box is selected.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76809' do\n  title \"A private websites authentication mechanism must use client\n  certificates to transmit session identifier to assure integrity.\"\n  desc \"A DoD private website must utilize PKI as an authentication mechanism\n  for web users. Information systems residing behind web servers requiring\n  authorization based on individual identity must use the identity provided by\n  certificate-based authentication to support access control decisions. Not using\n  client certificates allows an attacker unauthenticated access to private\n  websites.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000172-WSR-000104'\n  tag \"satisfies\": ['SRG-APP-000172-WSR-000104', 'SRG-APP-000224-WSR-000135',\n                    'SRG-APP-000427-WSR-000186']\n  tag \"gid\": 'V-76809'\n  tag \"rid\": 'SV-91505r1_rule'\n  tag \"stig_id\": 'IISW-SI-000220'\n  tag \"fix_id\": 'F-83505r1_fix'\n  tag \"cci\": ['CCI-000197', 'CCI-001188', 'CCI-002470']\n  tag \"nist\": ['IA-5 (1) (c)', 'SC-23 (3)', 'SC-23 (5)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Verify the \\\"Clients Certificate Required\\\" check box is selected.\n\n  If the \\\"Clients Certificate Required\\\" check box is not selected, this is a\n  finding.\"\n  tag \"fix\": \"Note: If the server being reviewed is a public IIS 8.5 web\n  server, this is Not Applicable\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Verify the \\\"Clients Certificate Required\\\" check box is selected.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  get_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.webServer/security/access 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('sslFlags') { should include 'SslRequireCert' }\n    end\n  end\n\n  if attribute('public_server')\n    impact 0.0\n    desc 'The server being reviewed is a public IIS 8.5 web\n    server, hence this control is Not Applicable.'\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76809.rb"},"results":[{"status":"failed","code_desc":"IIS sessionState for site :'Default Web Site' sslFlags should include \"SslRequireCert\"","run_time":0.000391,"start_time":"2019-02-04T07:10:00-08:00","message":"expected \"\" to include \"SslRequireCert\""}]},{"id":"V-76811","title":"Anonymous IIS 8.5 website access accounts must be restricted.","desc":"Many of the security problems that occur are not the result of a user\n  gaining access to files or data for which the user does not have permissions,\n  but rather users are assigned incorrect permissions to unauthorized data. The\n  files, directories, and data that are stored on the web server need to be\n  evaluated and a determination made concerning authorized access to information\n  and programs on the server. Only authorized users and administrative accounts\n  will be allowed on the host server in order to maintain the web server,\n  applications, and review the server operations.","descriptions":[{"label":"default","data":"Many of the security problems that occur are not the result of a user\n  gaining access to files or data for which the user does not have permissions,\n  but rather users are assigned incorrect permissions to unauthorized data. The\n  files, directories, and data that are stored on the web server need to be\n  evaluated and a determination made concerning authorized access to information\n  and programs on the server. Only authorized users and administrative accounts\n  will be allowed on the host server in order to maintain the web server,\n  applications, and review the server operations."}],"impact":0.7,"refs":[],"tags":{"gtitle":"SRG-APP-000211-WSR-000031","gid":"V-76811","rid":"SV-91507r1_rule","stig_id":"IISW-SI-000221","fix_id":"F-83507r1_fix","cci":["CCI-001082"],"nist":["SC-2","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Check the account used for anonymous access to the website.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click \"Authentication\" in the IIS section of the websites Home Pane.\n\n  If Anonymous access is disabled, this is Not a Finding.\n\n  If Anonymous access is enabled, click “Anonymous Authentication”.\n\n  Click 'Edit' in the 'Actions' pane.\n\n  If the “Specific user” radio button is enabled and an ID is specified in the \n  adjacent control box, this is the ID being used for anonymous access. \n\n  Note: account name.\n\n  Check privileged groups that may allow the anonymous account inappropriate \n  membership:\n\n  Open “Server Manager” on the machine.\n\n  Expand Configuration.\n\n  Expand Local Users and Groups.\n\n  Click “Groups”.\n\n  Review members of any of the following privileged groups:\n\n  Administrators\n  Backup Operators\n  Certificate Services (of any designation)\n  Distributed COM Users\n  Event Log Readers\n  Network Configuration Operators\n  Performance Log Users\n  Performance Monitor Users\n  Power Users\n  Print Operators\n  Remote Desktop Users\n  Replicator\n  Users\n\n  Double-click each group and review its members.\n\n  If the IUSR account or any account used for anonymous access is a member of any\n  group with privileged access, this is a finding.","fix":"Remove the Anonymous access account from all privileged accounts\n  and all privileged groups."},"code":"control 'V-76811' do\n  title 'Anonymous IIS 8.5 website access accounts must be restricted.'\n  desc  \"Many of the security problems that occur are not the result of a user\n  gaining access to files or data for which the user does not have permissions,\n  but rather users are assigned incorrect permissions to unauthorized data. The\n  files, directories, and data that are stored on the web server need to be\n  evaluated and a determination made concerning authorized access to information\n  and programs on the server. Only authorized users and administrative accounts\n  will be allowed on the host server in order to maintain the web server,\n  applications, and review the server operations.\"\n  impact 0.7\n  tag \"gtitle\": 'SRG-APP-000211-WSR-000031'\n  tag \"gid\": 'V-76811'\n  tag \"rid\": 'SV-91507r1_rule'\n  tag \"stig_id\": 'IISW-SI-000221'\n  tag \"fix_id\": 'F-83507r1_fix'\n  tag \"cci\": ['CCI-001082']\n  tag \"nist\": ['SC-2', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Check the account used for anonymous access to the website.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click \\\"Authentication\\\" in the IIS section of the websites Home Pane.\n\n  If Anonymous access is disabled, this is Not a Finding.\n\n  If Anonymous access is enabled, click “Anonymous Authentication”.\n\n  Click 'Edit' in the 'Actions' pane.\n\n  If the “Specific user” radio button is enabled and an ID is specified in the \n  adjacent control box, this is the ID being used for anonymous access. \n\n  Note: account name.\n\n  Check privileged groups that may allow the anonymous account inappropriate \n  membership:\n\n  Open “Server Manager” on the machine.\n\n  Expand Configuration.\n\n  Expand Local Users and Groups.\n\n  Click “Groups”.\n\n  Review members of any of the following privileged groups:\n\n  Administrators\n  Backup Operators\n  Certificate Services (of any designation)\n  Distributed COM Users\n  Event Log Readers\n  Network Configuration Operators\n  Performance Log Users\n  Performance Monitor Users\n  Power Users\n  Print Operators\n  Remote Desktop Users\n  Replicator\n  Users\n\n  Double-click each group and review its members.\n\n  If the IUSR account or any account used for anonymous access is a member of any\n  group with privileged access, this is a finding.\"\n  tag \"fix\": \"Remove the Anonymous access account from all privileged accounts\n  and all privileged groups.\"\n\n  get_names = command(\"Get-Website | select name | findstr /r /v '^$' | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_names.each do |names|\n    n = names.strip\n\n    is_anonymous_access_enabled = command(\"Get-WebConfigurationProperty -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -filter system.webServer/security/authentication/anonymousAuthentication -name * | select -expand Enabled\").stdout.strip.split(\"\\n\")\n\n    is_anonymous_access_enabled.each do |a|\n      if a == 'True'\n        get_anonymous_authentication_account = command(\"Get-WebConfigurationProperty -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -Filter system.webServer/security/authentication/anonymousAuthentication -name * | select -expand userName\").stdout.strip\n\n        describe \"IIS site #{n} Administrator user with anonymous access allowed\" do\n          subject { command(\"net localgroup Administrators | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Backup Operators user with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Backup Operators' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Certificate Service DCOM Access user with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Certificate Service DCOM Access' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Distributed COM Users user with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Distributed COM Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Event Log Readers with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Event Log Readers' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Network Configuration Operators with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Network Configuration Operators' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Performance Log Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Performance Log Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Performance Monitor Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Performance Monitor Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Power Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Power Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Print Operators with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Print Operators' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Remote Desktop Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Remote Desktop Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Replicator with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Replicator' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n\n        describe \"IIS site #{n} Users with anonymous access allowed\" do\n          subject { command(\"net localgroup 'Users' | Findstr #{get_anonymous_authentication_account}\").stdout }\n          it { should eq '' }\n        end\n      else\n        describe \"IIS site #{n} anonymous access setting\" do\n          subject { a }\n          it { should cmp 'False' }\n        end\n      end\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76811.rb"},"results":[{"status":"passed","code_desc":"IIS site Default Web Site Administrator user with anonymous access allowed should eq \"\"","run_time":0.032281,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Backup Operators user with anonymous access allowed should eq \"\"","run_time":0.076306,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Certificate Service DCOM Access user with anonymous access allowed should eq \"\"","run_time":0.03157,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Distributed COM Users user with anonymous access allowed should eq \"\"","run_time":0.028652,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Event Log Readers with anonymous access allowed should eq \"\"","run_time":0.028236,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Network Configuration Operators with anonymous access allowed should eq \"\"","run_time":0.027986,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Performance Log Users with anonymous access allowed should eq \"\"","run_time":0.028558,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Performance Monitor Users with anonymous access allowed should eq \"\"","run_time":0.031686,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Power Users with anonymous access allowed should eq \"\"","run_time":0.02677,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Print Operators with anonymous access allowed should eq \"\"","run_time":0.027386,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Remote Desktop Users with anonymous access allowed should eq \"\"","run_time":0.027443,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Replicator with anonymous access allowed should eq \"\"","run_time":0.027846,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"IIS site Default Web Site Users with anonymous access allowed should eq \"\"","run_time":0.02824,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76813","title":"The IIS 8.5 website must generate unique session identifiers that\n  cannot be reliably reproduced.","desc":"Communication between a client and the web server is done using the\n  HTTP protocol, but HTTP is a stateless protocol. In order to maintain a\n  connection or session, a web server will generate a session identifier (ID) for\n  each client session when the session is initiated. The session ID allows the\n  web server to track a user session and, in many cases, the user, if the user\n  previously logged into a hosted application.\n\n      By being able to guess session IDs, an attacker can easily perform a\n  man-in-the-middle attack. To truly generate random session identifiers that\n  cannot be reproduced, the web server session ID generator, when used twice with\n  the same input criteria, must generate an unrelated random ID.\n\n    The session ID generator also needs to be a FIPS 140-2-approved generator.","descriptions":[{"label":"default","data":"Communication between a client and the web server is done using the\n  HTTP protocol, but HTTP is a stateless protocol. In order to maintain a\n  connection or session, a web server will generate a session identifier (ID) for\n  each client session when the session is initiated. The session ID allows the\n  web server to track a user session and, in many cases, the user, if the user\n  previously logged into a hosted application.\n\n      By being able to guess session IDs, an attacker can easily perform a\n  man-in-the-middle attack. To truly generate random session identifiers that\n  cannot be reproduced, the web server session ID generator, when used twice with\n  the same input criteria, must generate an unrelated random ID.\n\n    The session ID generator also needs to be a FIPS 140-2-approved generator."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000224-WSR-000136","gid":"V-76813","rid":"SV-91509r1_rule","stig_id":"IISW-SI-000223","fix_id":"F-83509r1_fix","cci":["CCI-001188"],"nist":["SC-23 (3)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \"ASP.NET\" section, select \"Session State\".\n\n  Under \"Session State\" Mode Settings, verify the \"In Process\" mode is\n  selected.\n\n  If the \"In Process\" mode is selected, this is not a finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Verify the \"mode\" reflects \"InProc\".\n\n  If the \"mode\" is not set to \"InProc\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the ASP.NET section, select \"Session State\".\n\n  Under \"Session State\" Mode Settings, select the \"In Process\" mode."},"code":"control 'V-76813' do\n  title \"The IIS 8.5 website must generate unique session identifiers that\n  cannot be reliably reproduced.\"\n  desc \"Communication between a client and the web server is done using the\n  HTTP protocol, but HTTP is a stateless protocol. In order to maintain a\n  connection or session, a web server will generate a session identifier (ID) for\n  each client session when the session is initiated. The session ID allows the\n  web server to track a user session and, in many cases, the user, if the user\n  previously logged into a hosted application.\n\n      By being able to guess session IDs, an attacker can easily perform a\n  man-in-the-middle attack. To truly generate random session identifiers that\n  cannot be reproduced, the web server session ID generator, when used twice with\n  the same input criteria, must generate an unrelated random ID.\n\n    The session ID generator also needs to be a FIPS 140-2-approved generator.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000224-WSR-000136'\n  tag \"gid\": 'V-76813'\n  tag \"rid\": 'SV-91509r1_rule'\n  tag \"stig_id\": 'IISW-SI-000223'\n  tag \"fix_id\": 'F-83509r1_fix'\n  tag \"cci\": ['CCI-001188']\n  tag \"nist\": ['SC-23 (3)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the \\\"ASP.NET\\\" section, select \\\"Session State\\\".\n\n  Under \\\"Session State\\\" Mode Settings, verify the \\\"In Process\\\" mode is\n  selected.\n\n  If the \\\"In Process\\\" mode is selected, this is not a finding.\n\n  Alternative method:\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Verify the \\\"mode\\\" reflects \\\"InProc\\\".\n\n  If the \\\"mode\\\" is not set to \\\"InProc\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Under the ASP.NET section, select \\\"Session State\\\".\n\n  Under \\\"Session State\\\" Mode Settings, select the \\\"In Process\\\" mode.\"\n  get_mode = command('Get-WebConfigurationProperty -Filter system.web/sessionState -pspath \"IIS:\\Sites\\*\" -name * | select -expand mode').stdout.strip.split(\"\\r\\n\")\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_mode.zip(get_names).each do |mode, names|\n    describe \"The IIS site: #{names} website session state\" do\n      subject { mode }\n      it { should eq 'InProc' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76813.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site website session state should eq \"InProc\"","run_time":0.000251,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76815","title":"The IIS 8.5 website document directory must be in a separate partition\n  from the IIS 8.5 websites system files.","desc":"The web document (home) directory is accessed by multiple anonymous\n  users when the web server is in production. By locating the web document (home)\n  directory on the same partition as the web server system file the risk for\n  unauthorized access to these protected files is increased. Additionally, having\n  the web document (home) directory path on the same drive as the system folders\n  also increases the potential for a drive space exhaustion attack.","descriptions":[{"label":"default","data":"The web document (home) directory is accessed by multiple anonymous\n  users when the web server is in production. By locating the web document (home)\n  directory on the same partition as the web server system file the risk for\n  unauthorized access to these protected files is increased. Additionally, having\n  the web document (home) directory path on the same drive as the system folders\n  also increases the potential for a drive space exhaustion attack."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000233-WSR-000146","gid":"V-76815","rid":"SV-91511r1_rule","stig_id":"IISW-SI-000224","fix_id":"F-83511r1_fix","cci":["CCI-001084"],"nist":["SC-3","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click the \"Advanced Settings\" from the \"Actions\" pane.\n\n  Review the Physical Path.\n\n  If the Path is on the same partition as the OS, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click the Advanced Settings from the \"Actions\" pane.\n\n  Change the Physical Path to the new partition and directory location."},"code":"control 'V-76815' do\n  title \"The IIS 8.5 website document directory must be in a separate partition\n  from the IIS 8.5 websites system files.\"\n  desc  \"The web document (home) directory is accessed by multiple anonymous\n  users when the web server is in production. By locating the web document (home)\n  directory on the same partition as the web server system file the risk for\n  unauthorized access to these protected files is increased. Additionally, having\n  the web document (home) directory path on the same drive as the system folders\n  also increases the potential for a drive space exhaustion attack.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000233-WSR-000146'\n  tag \"gid\": 'V-76815'\n  tag \"rid\": 'SV-91511r1_rule'\n  tag \"stig_id\": 'IISW-SI-000224'\n  tag \"fix_id\": 'F-83511r1_fix'\n  tag \"cci\": ['CCI-001084']\n  tag \"nist\": ['SC-3', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click the \\\"Advanced Settings\\\" from the \\\"Actions\\\" pane.\n\n  Review the Physical Path.\n\n  If the Path is on the same partition as the OS, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click the Advanced Settings from the \\\"Actions\\\" pane.\n\n  Change the Physical Path to the new partition and directory location.\"\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n\n  get_names.each do |names|\n    n = names.strip\n    system_drive = command('$env:SystemDrive').stdout.strip\n\n    get_physical_path = command(\"(Get-Website -Name '#{n}').PhysicalPath\").stdout.strip.gsub(/%SystemDrive%/, system_drive.to_s)\n\n    path = get_physical_path[0..1]\n    describe \"IIS site #{n} physical path #{path}\" do\n      subject { path.gsub(/%SystemDrive%/, system_drive.to_s) }\n      it { should_not cmp system_drive.to_s }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76815.rb"},"results":[{"status":"failed","code_desc":"IIS site Default Web Site physical path C: should not cmp == \"C:\"","run_time":0.000802,"start_time":"2019-02-04T07:10:00-08:00","message":"\nexpected it not to be == \"C:\"\n     got: \"C:\"\n\n(compared using `cmp` matcher)\n"}]},{"id":"V-76817","title":"The IIS 8.5 website must be configured to limit the maxURL.","desc":"Request filtering replaces URLScan in IIS, enabling administrators to\n  create a more granular rule set with which to allow or reject inbound web\n  content. By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The MaxURL Request Filter limits the number of bytes the server will\n  accept in a URL.","descriptions":[{"label":"default","data":"Request filtering replaces URLScan in IIS, enabling administrators to\n  create a more granular rule set with which to allow or reject inbound web\n  content. By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The MaxURL Request Filter limits the number of bytes the server will\n  accept in a URL."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the \n         need for these fields in event records. As a result, the associated NIST \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76817","rid":"SV-91513r1_rule","stig_id":"IISW-SI-000225","fix_id":"F-83513r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If the \"maxUrl\" value is not set to \"4096\" or less, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Set the \"maxURL\" value to \"4096\" or less."},"code":"control 'V-76817' do\n  title 'The IIS 8.5 website must be configured to limit the maxURL.'\n  desc  \"Request filtering replaces URLScan in IIS, enabling administrators to\n  create a more granular rule set with which to allow or reject inbound web\n  content. By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The MaxURL Request Filter limits the number of bytes the server will\n  accept in a URL.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000246-WSR-000149'\n  tag \"gid\": 'V-76817'\n  tag \"rid\": 'SV-91513r1_rule'\n  tag \"stig_id\": 'IISW-SI-000225'\n  tag \"fix_id\": 'F-83513r1_fix'\n  tag \"cci\": ['CCI-001094']\n  tag \"nist\": ['SC-5 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  If the \\\"maxUrl\\\" value is not set to \\\"4096\\\" or less, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Click the site name under review.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  Set the \\\"maxURL\\\" value to \\\"4096\\\" or less.\"\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_maxurl = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/security/requestFiltering -name * | select -expand requestLimits | select -expand maxUrl').stdout.strip.split(\"\\r\\n\")\n\n  get_maxurl.zip(get_names).each do |maxurl, names|\n    n = names.strip\n    describe \"IIS site: #{n} websites maxUrl\" do\n      subject { maxurl }\n      it { should cmp <= 4096 }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76817.rb"},"results":[{"status":"passed","code_desc":"IIS site: Default Web Site websites maxUrl should cmp <= 4096","run_time":0.000432,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76819","title":"The IIS 8.5 website must be configured to limit the size of web\n  requests.","desc":"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The\n  maxAllowedContentLength Request Filter limits the number of bytes the server\n  will accept in a request.","descriptions":[{"label":"default","data":"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The\n  maxAllowedContentLength Request Filter limits the number of bytes the server\n  will accept in a request."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76819","rid":"SV-91515r2_rule","stig_id":"IISW-SI-000226","fix_id":"F-83515r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click “Edit Feature Settings” in the \"Actions\" pane.\n\n  If the \"maxAllowedContentLength\" value is not explicitly set to \"30000000\"\n  or less or a length documented and approved by the ISSO, this is a finding.\n  ","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click “Edit Feature Settings” in the \"Actions\" pane.\n\n  Set the \"maxAllowedContentLength\" value to \"30000000\" or less."},"code":"control 'V-76819' do\n  title \"The IIS 8.5 website must be configured to limit the size of web\n  requests.\"\n  desc \"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The\n  maxAllowedContentLength Request Filter limits the number of bytes the server\n  will accept in a request.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000246-WSR-000149'\n  tag \"gid\": 'V-76819'\n  tag \"rid\": 'SV-91515r2_rule'\n  tag \"stig_id\": 'IISW-SI-000226'\n  tag \"fix_id\": 'F-83515r1_fix'\n  tag \"cci\": ['CCI-001094']\n  tag \"nist\": ['SC-5 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click “Edit Feature Settings” in the \\\"Actions\\\" pane.\n\n  If the \\\"maxAllowedContentLength\\\" value is not explicitly set to \\\"30000000\\\"\n  or less or a length documented and approved by the ISSO, this is a finding.\n  \"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click “Edit Feature Settings” in the \\\"Actions\\\" pane.\n\n  Set the \\\"maxAllowedContentLength\\\" value to \\\"30000000\\\" or less.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_maxAllowedContentLength = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/security/requestFiltering -name * | select -expand requestLimits | select -expand maxAllowedContentLength').stdout.strip.split(\"\\r\\n\")\n\n  get_maxAllowedContentLength.zip(get_names).each do |maxAllowedContentLength, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites max allowed content length\" do\n      subject { maxAllowedContentLength }\n      it { should cmp <= 30_000_000 }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76819.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site websites max allowed content length should cmp <= 30000000","run_time":0.00052,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76821","title":"The IIS 8.5 websites Maximum Query String limit must be configured.","desc":"By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The Maximum Query String Request Filter describes the upper limit on\n  allowable query string lengths. Upon exceeding the configured value, IIS will\n  generate a Status Code 404.15.","descriptions":[{"label":"default","data":"By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The Maximum Query String Request Filter describes the upper limit on\n  allowable query string lengths. Upon exceeding the configured value, IIS will\n  generate a Status Code 404.15."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76821","rid":"SV-91517r1_rule","stig_id":"IISW-SI-000227","fix_id":"F-83517r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If the \"Maximum Query String\" value is not set to \"2048\" or less, this is a\n  finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Set the \"Maximum Query String\" value to \"2048\" or less."},"code":"control 'V-76821' do\n  title 'The IIS 8.5 websites Maximum Query String limit must be configured.'\n  desc  \"By setting limits on web requests, it helps to ensure availability of\n  web services and may also help mitigate the risk of buffer overflow type\n  attacks. The Maximum Query String Request Filter describes the upper limit on\n  allowable query string lengths. Upon exceeding the configured value, IIS will\n  generate a Status Code 404.15.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000246-WSR-000149'\n  tag \"gid\": 'V-76821'\n  tag \"rid\": 'SV-91517r1_rule'\n  tag \"stig_id\": 'IISW-SI-000227'\n  tag \"fix_id\": 'F-83517r1_fix'\n  tag \"cci\": ['CCI-001094']\n  tag \"nist\": ['SC-5 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  If the \\\"Maximum Query String\\\" value is not set to \\\"2048\\\" or less, this is a\n  finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  Set the \\\"Maximum Query String\\\" value to \\\"2048\\\" or less.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_maxQueryString = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/security/requestFiltering -name * | select -expand requestLimits | select -expand maxQueryString').stdout.strip.split(\"\\r\\n\")\n\n  get_maxQueryString.zip(get_names).each do |maxQueryString, names|\n    n = names.strip\n    describe \"The IIS site: #{n} websites Maximum Query String limit\" do\n      subject { maxQueryString }\n      it { should cmp <= 2048 }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76821.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site websites Maximum Query String limit should cmp <= 2048","run_time":0.000203,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76823","title":"Non-ASCII characters in URLs must be prohibited by any IIS 8.5\n  website.","desc":"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The allow\n  high-bit characters Request Filter enables rejection of requests containing\n  non-ASCII characters.","descriptions":[{"label":"default","data":"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The allow\n  high-bit characters Request Filter enables rejection of requests containing\n  non-ASCII characters."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76823","rid":"SV-91519r1_rule","stig_id":"IISW-SI-000228","fix_id":"F-83519r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If the \"Allow high-bit characters\" check box is checked, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Uncheck the \"Allow high-bit characters\" check box."},"code":"control 'V-76823' do\n  title \"Non-ASCII characters in URLs must be prohibited by any IIS 8.5\n  website.\"\n  desc \"By setting limits on web requests, it ensures availability of web\n  services and mitigates the risk of buffer overflow type attacks. The allow\n  high-bit characters Request Filter enables rejection of requests containing\n  non-ASCII characters.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000246-WSR-000149'\n  tag \"gid\": 'V-76823'\n  tag \"rid\": 'SV-91519r1_rule'\n  tag \"stig_id\": 'IISW-SI-000228'\n  tag \"fix_id\": 'F-83519r1_fix'\n  tag \"cci\": ['CCI-001094']\n  tag \"nist\": ['SC-5 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  If the \\\"Allow high-bit characters\\\" check box is checked, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  Uncheck the \\\"Allow high-bit characters\\\" check box.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_allowHighBitCharacters = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/security/requestFiltering -name * | select -expand allowHighBitCharacters').stdout.strip.split(\"\\r\\n\")\n\n  get_allowHighBitCharacters.zip(get_names).each do |allowHighBitCharacters, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites Allow high-bit characters\" do\n      subject { allowHighBitCharacters }\n      it { should cmp 'True' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76823.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site websites Allow high-bit characters should cmp == \"True\"","run_time":0.000221,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76825","title":"Double encoded URL requests must be prohibited by any IIS 8.5 website.","desc":"Request filtering enables administrators to create a more granular\n  rule set with which to allow or reject inbound web content. By setting limits\n  on web requests, it ensures availability of web services and mitigates the risk\n  of buffer overflow type attacks. When the “Allow double escaping” option is\n  disabled it prevents attacks that rely on double-encoded requests.","descriptions":[{"label":"default","data":"Request filtering enables administrators to create a more granular\n  rule set with which to allow or reject inbound web content. By setting limits\n  on web requests, it ensures availability of web services and mitigates the risk\n  of buffer overflow type attacks. When the “Allow double escaping” option is\n  disabled it prevents attacks that rely on double-encoded requests."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76825","rid":"SV-91521r1_rule","stig_id":"IISW-SI-000229","fix_id":"F-83521r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If the \"Allow double escaping\" check box is checked, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Uncheck the \"Allow double escaping\" check box."},"code":"control 'V-76825' do\n  title 'Double encoded URL requests must be prohibited by any IIS 8.5 website.'\n  desc  \"Request filtering enables administrators to create a more granular\n  rule set with which to allow or reject inbound web content. By setting limits\n  on web requests, it ensures availability of web services and mitigates the risk\n  of buffer overflow type attacks. When the “Allow double escaping” option is\n  disabled it prevents attacks that rely on double-encoded requests.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000246-WSR-000149'\n  tag \"gid\": 'V-76825'\n  tag \"rid\": 'SV-91521r1_rule'\n  tag \"stig_id\": 'IISW-SI-000229'\n  tag \"fix_id\": 'F-83521r1_fix'\n  tag \"cci\": ['CCI-001094']\n  tag \"nist\": ['SC-5 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  If the \\\"Allow double escaping\\\" check box is checked, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  Uncheck the \\\"Allow double escaping\\\" check box.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_allowdouble_escaping = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/security/requestFiltering -name * | select -expand allowDoubleEscaping').stdout.strip.split(\"\\r\\n\")\n\n  get_allowdouble_escaping.zip(get_names).each do |allow_double_escaping, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites Allow double escaping\" do\n      subject { allow_double_escaping }\n      it { should cmp 'False' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76825.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site websites Allow double escaping should cmp == \"False\"","run_time":0.000292,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76827","title":"Unlisted file extensions in URL requests must be filtered by any IIS\n  8.5 website.","desc":"Request filtering enables administrators to create a more granular\n  rule set to allow or reject inbound web content. By setting limits on web\n  requests it helps to ensure availability of web services and may also help\n  mitigate the risk of buffer overflow type attacks. The allow unlisted property\n  of the “File Extensions Request” filter enables rejection of requests\n  containing specific file extensions not defined in the “File Extensions”\n  filter. Tripping this filter will cause IIS to generate a Status Code 404.7.","descriptions":[{"label":"default","data":"Request filtering enables administrators to create a more granular\n  rule set to allow or reject inbound web content. By setting limits on web\n  requests it helps to ensure availability of web services and may also help\n  mitigate the risk of buffer overflow type attacks. The allow unlisted property\n  of the “File Extensions Request” filter enables rejection of requests\n  containing specific file extensions not defined in the “File Extensions”\n  filter. Tripping this filter will cause IIS to generate a Status Code 404.7."},{"label":"caveat","data":"SC-5(1) is not listed in ARS, but the ARS SI-10 clearly implies the                       \n         need for these fields in event records. As a result, the associated NIST                             \n         control has been changed to SI-10."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000246-WSR-000149","gid":"V-76827","rid":"SV-91523r1_rule","stig_id":"IISW-SI-000230","fix_id":"F-83523r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  If \"Allow unlisted file name extensions\" check box is checked, this is a\n\n  finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Request Filtering\" icon.\n\n  Click Edit Feature Settings in the \"Actions\" pane.\n\n  Uncheck the \"Allow unlisted file extensions\" check box."},"code":"control 'V-76827' do\n  title \"Unlisted file extensions in URL requests must be filtered by any IIS\n  8.5 website.\"\n  desc \"Request filtering enables administrators to create a more granular\n  rule set to allow or reject inbound web content. By setting limits on web\n  requests it helps to ensure availability of web services and may also help\n  mitigate the risk of buffer overflow type attacks. The allow unlisted property\n  of the “File Extensions Request” filter enables rejection of requests\n  containing specific file extensions not defined in the “File Extensions”\n  filter. Tripping this filter will cause IIS to generate a Status Code 404.7.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000246-WSR-000149'\n  tag \"gid\": 'V-76827'\n  tag \"rid\": 'SV-91523r1_rule'\n  tag \"stig_id\": 'IISW-SI-000230'\n  tag \"fix_id\": 'F-83523r1_fix'\n  tag \"cci\": ['CCI-001094']\n  tag \"nist\": ['SC-5 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click on the site name.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  If \\\"Allow unlisted file name extensions\\\" check box is checked, this is a\n\n  finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\"Request Filtering\\\" icon.\n\n  Click Edit Feature Settings in the \\\"Actions\\\" pane.\n\n  Uncheck the \\\"Allow unlisted file extensions\\\" check box.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_allow_unlisted = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/security/requestFiltering -name * | select -expand fileExtensions | select -expand allowUnlisted').stdout.strip.split(\"\\r\\n\")\n\n  get_allow_unlisted.zip(get_names).each do |allow_unlisted, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites Allow unlisted file extension\" do\n      subject { allow_unlisted }\n      it { should cmp 'False' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76827.rb"},"results":[{"status":"failed","code_desc":"The IIS site: Default Web Site websites Allow unlisted file extension should cmp == \"False\"","run_time":0.000312,"start_time":"2019-02-04T07:10:00-08:00","message":"\nexpected: \"False\"\n     got: \"True\"\n\n(compared using `cmp` matcher)\n"}]},{"id":"V-76829","title":"Directory Browsing on the IIS 8.5 website must be disabled.","desc":"Directory Browsing is not installed, hence this control is Not Applicable.","descriptions":[{"label":"default","data":"Directory Browsing is not installed, hence this control is Not Applicable."}],"impact":0.0,"refs":[],"tags":{"gtitle":"SRG-APP-000251-WSR-000157","gid":"V-76829","rid":"SV-91525r1_rule","stig_id":"IISW-SI-000231","fix_id":"F-83525r1_fix","cci":["CCI-001310"],"nist":["SI-10","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Click the Site.\n\n  Double-click the \"Directory Browsing\" icon.\n\n  If the \"Directory Browsing\" is not installed, this is Not Applicable.\n\n  Under the \"Actions\" pane verify \"Directory Browsing\" is \"Disabled\".\n\n  If \"Directory Browsing\" is not \"Disabled\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Site.\n\n  Double-click the \"Directory Browsing\" icon.\n\n  Under the \"Actions\" pane click \"Disabled\"."},"code":"control 'V-76829' do\n  title 'Directory Browsing on the IIS 8.5 website must be disabled.'\n  desc  \"Directory browsing allows the contents of a directory to be displayed\n  upon request from a web client. If directory browsing is enabled for a\n  directory in IIS, users could receive a web page listing the contents of the\n  directory. If directory browsing is enabled the risk of inadvertently\n  disclosing sensitive content is increased.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000251-WSR-000157'\n  tag \"gid\": 'V-76829'\n  tag \"rid\": 'SV-91525r1_rule'\n  tag \"stig_id\": 'IISW-SI-000231'\n  tag \"fix_id\": 'F-83525r1_fix'\n  tag \"cci\": ['CCI-001310']\n  tag \"nist\": ['SI-10', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Click the Site.\n\n  Double-click the \\\"Directory Browsing\\\" icon.\n\n  If the \\\"Directory Browsing\\\" is not installed, this is Not Applicable.\n\n  Under the \\\"Actions\\\" pane verify \\\"Directory Browsing\\\" is \\\"Disabled\\\".\n\n  If \\\"Directory Browsing\\\" is not \\\"Disabled\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Site.\n\n  Double-click the \\\"Directory Browsing\\\" icon.\n\n  Under the \\\"Actions\\\" pane click \\\"Disabled\\\".\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_directory_browsing = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/directoryBrowse -name * | select -expand enabled').stdout.strip.split(\"\\r\\n\")\n\n  get_directory_browsing.zip(get_names).each do |directory_browsing, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites enable directory browsing\" do\n      subject { directory_browsing }\n      it { should cmp 'False' }\n    end\n  end\n\n  if command('Get-WebConfiguration  system.webServer/globalModules/*').stdout.strip.include?('DirectoryListingModule')\n    impact 0.0\n    desc 'Directory Browsing is not installed, hence this control is Not Applicable.'\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76829.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site websites enable directory browsing should cmp == \"False\"","run_time":0.000193,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76831","title":"The IIS 8.5 website must prevent a web content directory from being\n  displayed.","desc":"The goal is to control the web users experience in navigating any\n  portion of the web document root directories. Ensuring all web content\n  directories have at least the equivalent of an indexhtml file is a significant\n  factor to accomplish this end. Also enumeration techniques such as URL\n  parameter manipulation rely upon being able to obtain information about the\n  web servers directory structure by locating directories with default pages\n  This practice helps ensure the anonymous web user will not obtain directory\n  browsing information or an error message revealing the server type and version.","descriptions":[{"label":"default","data":"The goal is to control the web users experience in navigating any\n  portion of the web document root directories. Ensuring all web content\n  directories have at least the equivalent of an indexhtml file is a significant\n  factor to accomplish this end. Also enumeration techniques such as URL\n  parameter manipulation rely upon being able to obtain information about the\n  web servers directory structure by locating directories with default pages\n  This practice helps ensure the anonymous web user will not obtain directory\n  browsing information or an error message revealing the server type and version."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000266-WSR-000142","gid":"V-76831","rid":"SV-91527r1_rule","stig_id":"IISW-SI-000232","fix_id":"F-83527r1_fix","cci":["CCI-001312"],"nist":["SI-11 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: This requirement is only for each site's root directory.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Click the site name under review.\n\n  Double-click \"Default Document\".\n\n  In the \"Actions\" pane, verify the \"Default Document\" feature is enabled.\n\n  If an \"Enable\" option is listed under the \"Actions\" pane, the \"Default\n  Document\" feature is not enabled and this is a finding.\n\n  If \"Default Document\" is \"Enabled, review the document types.\n\n  Click the \"Content View\" tab, click on each listed \"Default Document\" and\n  click on \"Explore\" under the \"Actions\" pane. Verify there is a document of\n  that type in the directory.\n\n  If \"Default Document\" is \"Enabled\" but no listed document types are present\n  in the \"Content View\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \"Default Document\".\n\n  In the Actions pane select \"Enable\".\n\n  Click the \"Content View\" tab, click on each listed \"Default Document\" and\n  click on \"Explore\" under the \"Actions\" pane. Create a valid document for\n  the listed \"Default Document\"."},"code":"control 'V-76831' do\n  title \"The IIS 8.5 website must prevent a web content directory from being\n  displayed.\"\n  desc \"The goal is to control the web users experience in navigating any\n  portion of the web document root directories. Ensuring all web content\n  directories have at least the equivalent of an indexhtml file is a significant\n  factor to accomplish this end. Also enumeration techniques such as URL\n  parameter manipulation rely upon being able to obtain information about the\n  web servers directory structure by locating directories with default pages\n  This practice helps ensure the anonymous web user will not obtain directory\n  browsing information or an error message revealing the server type and version.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000266-WSR-000142'\n  tag \"gid\": 'V-76831'\n  tag \"rid\": 'SV-91527r1_rule'\n  tag \"stig_id\": 'IISW-SI-000232'\n  tag \"fix_id\": 'F-83527r1_fix'\n  tag \"cci\": ['CCI-001312']\n  tag \"nist\": ['SI-11 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: This requirement is only for each site's root directory.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Click the site name under review.\n\n  Double-click \\\"Default Document\\\".\n\n  In the \\\"Actions\\\" pane, verify the \\\"Default Document\\\" feature is enabled.\n\n  If an \\\"Enable\\\" option is listed under the \\\"Actions\\\" pane, the \\\"Default\n  Document\\\" feature is not enabled and this is a finding.\n\n  If \\\"Default Document\\\" is \\\"Enabled, review the document types.\n\n  Click the \\\"Content View\\\" tab, click on each listed \\\"Default Document\\\" and\n  click on \\\"Explore\\\" under the \\\"Actions\\\" pane. Verify there is a document of\n  that type in the directory.\n\n  If \\\"Default Document\\\" is \\\"Enabled\\\" but no listed document types are present\n  in the \\\"Content View\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\"Default Document\\\".\n\n  In the Actions pane select \\\"Enable\\\".\n\n  Click the \\\"Content View\\\" tab, click on each listed \\\"Default Document\\\" and\n  click on \\\"Explore\\\" under the \\\"Actions\\\" pane. Create a valid document for\n  the listed \\\"Default Document\\\".\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.split(\"\\r\\n\")\n\n  get_default_document_enabled = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/defaultDocument -name * | select -expand enabled').stdout.split(\"\\r\\n\")\n\n  get_default_document_enabled.zip(get_names).each do |default_document_enabled, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites default document enabled\" do\n      subject { default_document_enabled }\n      it { should cmp 'True' }\n    end\n  end\n\n  get_names.each do |names|\n    n = names.strip\n    get_default_document_view = command(\"Get-WebConfigurationProperty  -pspath \\\"IIS:\\Sites\\\\#{n}\\\" -Filter system.webServer/defaultDocument/files/add -Name value | Select value | Findstr /v 'Value ---'\").stdout.strip.split(\"\\r\\n\")\n    get_default_document_view.each do |default_document_view|\n      describe \"The IIS site: #{n} websites default document view #{default_document_view}\" do\n        subject { default_document_view }\n        it { should_not eq '' }\n      end\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76831.rb"},"results":[{"status":"passed","code_desc":"The IIS site:  websites default document enabled should cmp == \"True\"","run_time":0.000138,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site:  websites default document view Default.htm                                                                                                             should not eq \"\"","run_time":0.000136,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site:  websites default document view Default.asp                                                                                                             should not eq \"\"","run_time":0.000108,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site:  websites default document view index.htm                                                                                                               should not eq \"\"","run_time":9.7e-05,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site:  websites default document view index.html                                                                                                              should not eq \"\"","run_time":9.7e-05,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site:  websites default document view iisstart.htm should not eq \"\"","run_time":9.4e-05,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site: Default Web Site websites default document view Default.htm                                                                                                             should not eq \"\"","run_time":0.000106,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site: Default Web Site websites default document view Default.asp                                                                                                             should not eq \"\"","run_time":0.000103,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site: Default Web Site websites default document view index.htm                                                                                                               should not eq \"\"","run_time":0.000102,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site: Default Web Site websites default document view index.html                                                                                                              should not eq \"\"","run_time":8.4e-05,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site: Default Web Site websites default document view iisstart.htm should not eq \"\"","run_time":8.3e-05,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76835","title":"Warning and error messages displayed to clients must be modified to\n  minimize the identity of the IIS 8.5 website, patches, loaded modules, and\n  directory paths.","desc":"HTTP error pages contain information that could enable an attacker to\n  gain access to an information system. Failure to prevent the sending of HTTP\n  error pages with full information to remote requesters exposes internal\n  configuration information to potential attackers.","descriptions":[{"label":"default","data":"HTTP error pages contain information that could enable an attacker to\n  gain access to an information system. Failure to prevent the sending of HTTP\n  error pages with full information to remote requesters exposes internal\n  configuration information to potential attackers."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000266-WSR-000159","gid":"V-76835","rid":"SV-91531r1_rule","stig_id":"IISW-SI-000233","fix_id":"F-83531r1_fix","cci":["CCI-001312"],"nist":["SI-11 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Error Pages\" icon.\n\n  Click each error message and click \"Edit Feature\" setting from the\n  \"Actions\" pane.\n\n  If any error message is not set to “Detailed errors for local requests and\n  custom error pages for remote requests”, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \"Error Pages\" icon.\n\n  Click each error message and click \"Edit Feature\" Setting from the\n  \"Actions\" pane; set each error message to “Detailed errors for local requests\n  and custom error pages for remote requests”."},"code":"control 'V-76835' do\n  title \"Warning and error messages displayed to clients must be modified to\n  minimize the identity of the IIS 8.5 website, patches, loaded modules, and\n  directory paths.\"\n  desc \"HTTP error pages contain information that could enable an attacker to\n  gain access to an information system. Failure to prevent the sending of HTTP\n  error pages with full information to remote requesters exposes internal\n  configuration information to potential attackers.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000266-WSR-000159'\n  tag \"gid\": 'V-76835'\n  tag \"rid\": 'SV-91531r1_rule'\n  tag \"stig_id\": 'IISW-SI-000233'\n  tag \"fix_id\": 'F-83531r1_fix'\n  tag \"cci\": ['CCI-001312']\n  tag \"nist\": ['SI-11 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\"Error Pages\\\" icon.\n\n  Click each error message and click \\\"Edit Feature\\\" setting from the\n  \\\"Actions\\\" pane.\n\n  If any error message is not set to “Detailed errors for local requests and\n  custom error pages for remote requests”, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click the \\\"Error Pages\\\" icon.\n\n  Click each error message and click \\\"Edit Feature\\\" Setting from the\n  \\\"Actions\\\" pane; set each error message to “Detailed errors for local requests\n  and custom error pages for remote requests”.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_errorMode = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/httpErrors -Name errorMode').stdout.strip.split(\"\\r\\n\")\n\n  get_errorMode.zip(get_names).each do |errorMode, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites error mode\" do\n      subject { errorMode }\n      it { should cmp 'DetailedLocalOnly' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76835.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site websites error mode should cmp == \"DetailedLocalOnly\"","run_time":0.000151,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76837","title":"Debugging and trace information used to diagnose the IIS 8.5 website\n  must be disabled.","desc":".NET feature not installed hence the control not applicable","descriptions":[{"label":"default","data":".NET feature not installed hence the control not applicable"}],"impact":0.0,"refs":[],"tags":{"gtitle":"SRG-APP-000266-WSR-000160","gid":"V-76837","rid":"SV-91533r1_rule","stig_id":"IISW-SI-000234","fix_id":"F-83533r1_fix","cci":["CCI-001312"],"nist":["SI-11 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: If the \".NET feature\" is not installed, this check is\n  Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \".NET Compilation\".\n\n  Scroll down to the \"Behavior\" section and verify the value for \"Debug\" is\n  set to \"False\".\n\n  If the \"Debug\" value is not set to \"False\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \".NET Compilation\".\n\n  Scroll down to the \"Behavior\" section and set the value for \"Debug\" to\n  \"False\"."},"code":"control 'V-76837' do\n  title \"Debugging and trace information used to diagnose the IIS 8.5 website\n  must be disabled.\"\n  desc \"Setting compilation debug to false ensures detailed error information\n  does not inadvertently display during live application usage, mitigating the\n  risk of application information being displayed to users.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000266-WSR-000160'\n  tag \"gid\": 'V-76837'\n  tag \"rid\": 'SV-91533r1_rule'\n  tag \"stig_id\": 'IISW-SI-000234'\n  tag \"fix_id\": 'F-83533r1_fix'\n  tag \"cci\": ['CCI-001312']\n  tag \"nist\": ['SI-11 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: If the \\\".NET feature\\\" is not installed, this check is\n  Not Applicable.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\".NET Compilation\\\".\n\n  Scroll down to the \\\"Behavior\\\" section and verify the value for \\\"Debug\\\" is\n  set to \\\"False\\\".\n\n  If the \\\"Debug\\\" value is not set to \\\"False\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Double-click \\\".NET Compilation\\\".\n\n  Scroll down to the \\\"Behavior\\\" section and set the value for \\\"Debug\\\" to\n  \\\"False\\\".\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_debug_enabled = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.web/compilation -name * | select -expand debug').stdout.strip.split(\"\\r\\n\")\n\n  get_debug_enabled.zip(get_names).each do |debug_enabled, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites debugging enabled\" do\n      subject { debug_enabled }\n      it { should cmp 'False' }\n    end\n  end\n\n  iis_modules = command('Get-WebConfiguration  system.webServer/globalModules/*').stdout.strip\n\n  unless iis_modules.include?('.NET')\n    impact 0.0\n    desc '.NET feature not installed hence the control not applicable'\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76837.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site websites debugging enabled should cmp == \"False\"","run_time":0.00014,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76839","title":"The Idle Time-out monitor for each IIS 8.5 website must be enabled.","desc":"The idle time-out attribute controls the amount of time a worker\n  process will remain idle before it shuts down. A worker process is idle if it\n  is not processing requests and no new requests are received.\n\n      The purpose of this attribute is to conserve system resources; the default\n  value for idle time-out is 20 minutes.\n\n      By default, the World Wide Web (WWW) service establishes an overlapped\n  recycle, in which the worker process to be shut down is kept running until\n  after a new worker process is started.","descriptions":[{"label":"default","data":"The idle time-out attribute controls the amount of time a worker\n  process will remain idle before it shuts down. A worker process is idle if it\n  is not processing requests and no new requests are received.\n\n      The purpose of this attribute is to conserve system resources; the default\n  value for idle time-out is 20 minutes.\n\n      By default, the World Wide Web (WWW) service establishes an overlapped\n  recycle, in which the worker process to be shut down is kept running until\n  after a new worker process is started."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000295-WSR-000012","gid":"V-76839","rid":"SV-91535r1_rule","stig_id":"IISW-SI-000235","fix_id":"F-83535r1_fix","cci":["CCI-002361"],"nist":["AC-12","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Process Model\" section and verify the value for \"Idle\n  Time-out\" is set to \"20\".\n\n  If the \"Idle Time-out\" is not set to \"20\" or less, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Process Model\" section and set the value for \"Idle\n  Time-out\" to \"20\" or less."},"code":"control 'V-76839' do\n  title 'The Idle Time-out monitor for each IIS 8.5 website must be enabled.'\n  desc  \"The idle time-out attribute controls the amount of time a worker\n  process will remain idle before it shuts down. A worker process is idle if it\n  is not processing requests and no new requests are received.\n\n      The purpose of this attribute is to conserve system resources; the default\n  value for idle time-out is 20 minutes.\n\n      By default, the World Wide Web (WWW) service establishes an overlapped\n  recycle, in which the worker process to be shut down is kept running until\n  after a new worker process is started.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000295-WSR-000012'\n  tag \"gid\": 'V-76839'\n  tag \"rid\": 'SV-91535r1_rule'\n  tag \"stig_id\": 'IISW-SI-000235'\n  tag \"fix_id\": 'F-83535r1_fix'\n  tag \"cci\": ['CCI-002361']\n  tag \"nist\": ['AC-12', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Process Model\\\" section and verify the value for \\\"Idle\n  Time-out\\\" is set to \\\"20\\\".\n\n  If the \\\"Idle Time-out\\\" is not set to \\\"20\\\" or less, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Process Model\\\" section and set the value for \\\"Idle\n  Time-out\\\" to \\\"20\\\" or less.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_idleTimeout_monitor = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.applicationHost/applicationPools -name * | select -expand applicationPoolDefaults | select -expand processModel | select -expand idleTimeout | select -expand TotalMinutes').stdout.strip.split(\"\\r\\n\")\n\n  get_idleTimeout_monitor.zip(get_names).each do |idleTimeout_monitor, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites idle monitor time-out\" do\n      subject { idleTimeout_monitor }\n      it { should cmp <= 20 }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76839.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site websites idle monitor time-out should cmp <= 20","run_time":0.000157,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76841","title":"The IIS 8.5 websites connectionTimeout setting must be explicitly\n  configured to disconnect an idle session.","desc":"Leaving sessions open indefinitely is a major security risk. An\n  attacker can easily use an already authenticated session to access the hosted\n  application as the previously authenticated user. By closing sessions after a\n  set period of inactivity, the web server can make certain that those sessions\n  that are not closed through the user logging out of an application are\n  eventually closed.\n\n      Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.","descriptions":[{"label":"default","data":"Leaving sessions open indefinitely is a major security risk. An\n  attacker can easily use an already authenticated session to access the hosted\n  application as the previously authenticated user. By closing sessions after a\n  set period of inactivity, the web server can make certain that those sessions\n  that are not closed through the user logging out of an application are\n  eventually closed.\n\n      Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000295-WSR-000134","gid":"V-76841","rid":"SV-91537r2_rule","stig_id":"IISW-SI-000236","fix_id":"F-83537r2_fix","cci":["CCI-002361"],"nist":["AC-12","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Verify the \"timeout\" is set to \"00:20:00 or less”, using the lowest value\n  possible depending upon the application.\n  Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n\n  If \"timeout\" is not set to \"00:20:00 or less”, this is a finding.\n\n  ","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate \"system.web/sessionState\".\n\n  Set the \"timeout\" to \"00:20:00 or less”, using the lowest value possible\n  depending upon the application.\n  Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n\n  In the \"Actions\" pane, click \"Apply\".\n  "},"code":"control 'V-76841' do\n  title \"The IIS 8.5 websites connectionTimeout setting must be explicitly\n  configured to disconnect an idle session.\"\n  desc \"Leaving sessions open indefinitely is a major security risk. An\n  attacker can easily use an already authenticated session to access the hosted\n  application as the previously authenticated user. By closing sessions after a\n  set period of inactivity, the web server can make certain that those sessions\n  that are not closed through the user logging out of an application are\n  eventually closed.\n\n      Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000295-WSR-000134'\n  tag \"gid\": 'V-76841'\n  tag \"rid\": 'SV-91537r2_rule'\n  tag \"stig_id\": 'IISW-SI-000236'\n  tag \"fix_id\": 'F-83537r2_fix'\n  tag \"cci\": ['CCI-002361']\n  tag \"nist\": ['AC-12', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Verify the \\\"timeout\\\" is set to \\\"00:20:00 or less”, using the lowest value\n  possible depending upon the application.\n  Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n\n  If \\\"timeout\\\" is not set to \\\"00:20:00 or less”, this is a finding.\n\n  \"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate \\\"system.web/sessionState\\\".\n\n  Set the \\\"timeout\\\" to \\\"00:20:00 or less”, using the lowest value possible\n  depending upon the application.\n  Acceptable values are 5 minutes for high-value applications, 10 minutes for\n  medium-value applications, and 20 minutes for low-value applications.\n\n  In the \\\"Actions\\\" pane, click \\\"Apply\\\".\n  \"\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_connectionTimeout = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.web/sessionState -name * | select -expand timeout | select -expand TotalMinutes').stdout.strip.split(\"\\r\\n\")\n\n  get_connectionTimeout.zip(get_names).each do |connectionTimeout, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} websites connection timeout\" do\n      subject { connectionTimeout }\n      it { should cmp <= 20 }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76841.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site websites connection timeout should cmp <= 20","run_time":0.00021,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76843","title":"The IIS 8.5 website must provide the capability to immediately\n  disconnect or disable remote access to the hosted applications.","desc":"During an attack on the web server or any of the hosted applications,\n  the system administrator may need to disconnect or disable access by users to\n  stop the attack.\n\n      The web server must provide a capability to disconnect users to a hosted\n  application without compromising other hosted applications unless deemed\n  necessary to stop the attack. Methods to disconnect or disable connections are\n  to stop the application service for a specified hosted application, stop the\n  web server, or block all connections through web server access list.\n\n      The web server capabilities used to disconnect or disable users from\n  connecting to hosted applications and the web server must be documented to make\n  certain that, during an attack, the proper action is taken to conserve\n  connectivity to any other hosted application if possible and to make certain\n  log data is conserved for later forensic analysis.","descriptions":[{"label":"default","data":"During an attack on the web server or any of the hosted applications,\n  the system administrator may need to disconnect or disable access by users to\n  stop the attack.\n\n      The web server must provide a capability to disconnect users to a hosted\n  application without compromising other hosted applications unless deemed\n  necessary to stop the attack. Methods to disconnect or disable connections are\n  to stop the application service for a specified hosted application, stop the\n  web server, or block all connections through web server access list.\n\n      The web server capabilities used to disconnect or disable users from\n  connecting to hosted applications and the web server must be documented to make\n  certain that, during an attack, the proper action is taken to conserve\n  connectivity to any other hosted application if possible and to make certain\n  log data is conserved for later forensic analysis."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000316-WSR-000170","gid":"V-76843","rid":"SV-91539r1_rule","stig_id":"IISW-SI-000237","fix_id":"F-83539r1_fix","cci":["CCI-002322"],"nist":["AC-17 (9)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Interview the System Administrator and Web Manager.\n\n  Ask for documentation for the IIS 8.5 web server administration.\n\n  Verify there are documented procedures for shutting down an IIS 8.5 website in\n  the event of an attack. The procedure should, at a minimum, provide the\n  following steps:\n\n  Determine the respective website for the application at risk of an attack.\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the respective website.\n\n  In the \"Actions\" pane, under \"Manage Website\", click on \"Stop\".\n\n  If necessary, stop all websites.\n\n  If necessary, stop the IIS 8.5 web server by selecting the web server in the\n  IIS 8.5 Manager.\n\n  In the \"Actions\" pane, under \"Manage Server\", click on \"Stop\".\n\n  If there are not documented procedures with, at a minimum, the mentioned steps\n  for stopping a website, this is a finding.","fix":"Prepare documented procedures for shutting down an IIS 8.5\n  website in the event of an attack. The procedure should, at a minimum, provide\n  the following steps:\n\n  Determine the respective website for the application at risk of an attack.\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the respective website.\n\n  In the \"Actions\" pane, under \"Manage Website\", click on \"Stop\".\n\n  If necessary, stop all websites.\n\n  If necessary, stop the IIS 8.5 web server by selecting the web server in the\n  IIS 8.5 Manager.\n\n  In the \"Actions\" pane, under \"Manage Server\", click on \"Stop\"."},"code":"control 'V-76843' do\n  title \"The IIS 8.5 website must provide the capability to immediately\n  disconnect or disable remote access to the hosted applications.\"\n  desc \"During an attack on the web server or any of the hosted applications,\n  the system administrator may need to disconnect or disable access by users to\n  stop the attack.\n\n      The web server must provide a capability to disconnect users to a hosted\n  application without compromising other hosted applications unless deemed\n  necessary to stop the attack. Methods to disconnect or disable connections are\n  to stop the application service for a specified hosted application, stop the\n  web server, or block all connections through web server access list.\n\n      The web server capabilities used to disconnect or disable users from\n  connecting to hosted applications and the web server must be documented to make\n  certain that, during an attack, the proper action is taken to conserve\n  connectivity to any other hosted application if possible and to make certain\n  log data is conserved for later forensic analysis.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000316-WSR-000170'\n  tag \"gid\": 'V-76843'\n  tag \"rid\": 'SV-91539r1_rule'\n  tag \"stig_id\": 'IISW-SI-000237'\n  tag \"fix_id\": 'F-83539r1_fix'\n  tag \"cci\": ['CCI-002322']\n  tag \"nist\": ['AC-17 (9)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Interview the System Administrator and Web Manager.\n\n  Ask for documentation for the IIS 8.5 web server administration.\n\n  Verify there are documented procedures for shutting down an IIS 8.5 website in\n  the event of an attack. The procedure should, at a minimum, provide the\n  following steps:\n\n  Determine the respective website for the application at risk of an attack.\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the respective website.\n\n  In the \\\"Actions\\\" pane, under \\\"Manage Website\\\", click on \\\"Stop\\\".\n\n  If necessary, stop all websites.\n\n  If necessary, stop the IIS 8.5 web server by selecting the web server in the\n  IIS 8.5 Manager.\n\n  In the \\\"Actions\\\" pane, under \\\"Manage Server\\\", click on \\\"Stop\\\".\n\n  If there are not documented procedures with, at a minimum, the mentioned steps\n  for stopping a website, this is a finding.\"\n  tag \"fix\": \"Prepare documented procedures for shutting down an IIS 8.5\n  website in the event of an attack. The procedure should, at a minimum, provide\n  the following steps:\n\n  Determine the respective website for the application at risk of an attack.\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Select the respective website.\n\n  In the \\\"Actions\\\" pane, under \\\"Manage Website\\\", click on \\\"Stop\\\".\n\n  If necessary, stop all websites.\n\n  If necessary, stop the IIS 8.5 web server by selecting the web server in the\n  IIS 8.5 Manager.\n\n  In the \\\"Actions\\\" pane, under \\\"Manage Server\\\", click on \\\"Stop\\\".\"\n\n  describe \"The IIS 8.5 website must provide the capability to immediately\n  disconnect or disable remote access to the hosted applications\" do\n    skip 'The control should be manually reviewed.'\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76843.rb"},"results":[{"status":"skipped","code_desc":"The IIS 8.5 website must provide the capability to immediately\n  disconnect or disable remote access to the hosted applications","run_time":7.0e-06,"start_time":"2019-02-04T07:10:00-08:00","resource":"","skip_message":"The control should be manually reviewed."}]},{"id":"V-76845","title":"The IIS 8.5 website must use a logging mechanism that is configured to\n  allocate log record storage capacity large enough to accommodate the logging\n  requirements of the IIS 8.5 website.","desc":"In order to make certain that the logging mechanism used by the web\n  server has sufficient storage capacity in which to write the logs, the logging\n  mechanism needs to be able to allocate log record storage capacity.\n\n      The task of allocating log record storage capacity is usually performed\n  during initial installation of the logging mechanism. The system administrator\n  will usually coordinate the allocation of physical drive space with the web\n  server administrator along with the physical location of the partition and\n  disk. Refer to NIST SP 800-92 for specific requirements on log rotation and\n  storage dependent on the impact of the web server.","descriptions":[{"label":"default","data":"In order to make certain that the logging mechanism used by the web\n  server has sufficient storage capacity in which to write the logs, the logging\n  mechanism needs to be able to allocate log record storage capacity.\n\n      The task of allocating log record storage capacity is usually performed\n  during initial installation of the logging mechanism. The system administrator\n  will usually coordinate the allocation of physical drive space with the web\n  server administrator along with the physical location of the partition and\n  disk. Refer to NIST SP 800-92 for specific requirements on log rotation and\n  storage dependent on the impact of the web server."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000357-WSR-000150","gid":"V-76845","rid":"SV-91541r1_rule","stig_id":"IISW-SI-000238","fix_id":"F-83541r1_fix","cci":["CCI-001849"],"nist":["AU-4","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Under \"IIS\" double-click on the \"Logging\" icon.\n\n  In the \"Logging\" configuration box, determine the \"Directory:\" to which the\n  \"W3C\" logging is being written.\n\n  Confirm with the System Administrator that the designated log path is of\n  sufficient size to maintain the logging.\n\n  Under \"Log File Rollover\", verify the \"Do not create new log files\" is not\n  selected.\n\n  Verify a schedule is configured to rollover log files on a regular basis.\n\n  Consult with the System Administrator to determine if there is a documented\n  process for moving the log files off of the IIS 8.5 web server to another\n  logging device.\n\n  If the designated logging path device is not of sufficient space to maintain\n  all log files and there is not a schedule to rollover files on a regular basis,\n  this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Under \"IIS\" double-click on the \"Logging\" icon.\n\n  If necessary, in the \"Logging\" configuration box, redesignate a log path to a\n  location able to house the logs.\n\n  Under \"Log File Rollover\", deselect the \"Do not create new log files\"\n  setting.\n\n  Configure a schedule to rollover log files on a regular basis."},"code":"control 'V-76845' do\n  title \"The IIS 8.5 website must use a logging mechanism that is configured to\n  allocate log record storage capacity large enough to accommodate the logging\n  requirements of the IIS 8.5 website.\"\n  desc \"In order to make certain that the logging mechanism used by the web\n  server has sufficient storage capacity in which to write the logs, the logging\n  mechanism needs to be able to allocate log record storage capacity.\n\n      The task of allocating log record storage capacity is usually performed\n  during initial installation of the logging mechanism. The system administrator\n  will usually coordinate the allocation of physical drive space with the web\n  server administrator along with the physical location of the partition and\n  disk. Refer to NIST SP 800-92 for specific requirements on log rotation and\n  storage dependent on the impact of the web server.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000357-WSR-000150'\n  tag \"gid\": 'V-76845'\n  tag \"rid\": 'SV-91541r1_rule'\n  tag \"stig_id\": 'IISW-SI-000238'\n  tag \"fix_id\": 'F-83541r1_fix'\n  tag \"cci\": ['CCI-001849']\n  tag \"nist\": ['AU-4', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 web server IIS 8.5 Manager.\n\n  Under \\\"IIS\\\" double-click on the \\\"Logging\\\" icon.\n\n  In the \\\"Logging\\\" configuration box, determine the \\\"Directory:\\\" to which the\n  \\\"W3C\\\" logging is being written.\n\n  Confirm with the System Administrator that the designated log path is of\n  sufficient size to maintain the logging.\n\n  Under \\\"Log File Rollover\\\", verify the \\\"Do not create new log files\\\" is not\n  selected.\n\n  Verify a schedule is configured to rollover log files on a regular basis.\n\n  Consult with the System Administrator to determine if there is a documented\n  process for moving the log files off of the IIS 8.5 web server to another\n  logging device.\n\n  If the designated logging path device is not of sufficient space to maintain\n  all log files and there is not a schedule to rollover files on a regular basis,\n  this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Under \\\"IIS\\\" double-click on the \\\"Logging\\\" icon.\n\n  If necessary, in the \\\"Logging\\\" configuration box, redesignate a log path to a\n  location able to house the logs.\n\n  Under \\\"Log File Rollover\\\", deselect the \\\"Do not create new log files\\\"\n  setting.\n\n  Configure a schedule to rollover log files on a regular basis.\"\n\n  log_directory_path = attribute('log_directory')\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  system_drive = command('$env:SystemDrive').stdout.strip\n\n  get_log_directory = command(\"Get-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter 'system.applicationHost/sites/*/logFile' -name * | select -expand directory\").stdout.strip.split(\"\\r\\n\")\n\n  get_log_directory.zip(get_names).each do |log_directory, name|\n    log_directory = log_directory.gsub(/%SystemDrive%/, system_drive.to_s)\n\n    describe \"The IIS site: #{name} log directory\" do\n      subject { log_directory }\n      it { should cmp log_directory_path.to_s }\n    end\n  end\n\n  get_log_period = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.ApplicationHost/log -name centralW3CLogFile | select -expand period').stdout.strip.split(\"\\r\\n\")\n\n  get_log_period.zip(get_names).each do |log_period, name|\n    describe \"The IIS site: #{name} websites log file rollover period\" do\n      subject { log_period }\n      it { should cmp 'Daily' }\n    end\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76845.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site log directory should cmp == \"C:\\\\inetpub\\\\logs\\\\LogFiles\"","run_time":0.000168,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site:  log directory should cmp == \"C:\\\\inetpub\\\\logs\\\\LogFiles\"","run_time":0.000161,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"passed","code_desc":"The IIS site: Default Web Site websites log file rollover period should cmp == \"Daily\"","run_time":0.000152,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76847","title":"The IIS 8.5 websites must utilize ports, protocols, and services \n          according to CMS guidelines.","desc":"Web servers provide numerous processes, features, and functionalities \n         that utilize TCP/IP ports. Some of these processes may be deemed \n         unnecessary or too unsecure to run on a production system.\n\n         The web server must provide the capability to disable or deactivate \n         network-related services that are deemed to be non-essential to the \n         server mission, are too unsecure, or are prohibited by CMS and \n         vulnerability assessments.\n\n         Failure to comply with CMS ports, protocols, and services (PPS) \n         requirements can result in compromise of enclave boundary protections \n         and/or functionality of the Information System.\n\n         The ISSO will ensure web servers are configured to use only necessary \n         ports, protocols, and services.","descriptions":[{"label":"default","data":"Web servers provide numerous processes, features, and functionalities \n         that utilize TCP/IP ports. Some of these processes may be deemed \n         unnecessary or too unsecure to run on a production system.\n\n         The web server must provide the capability to disable or deactivate \n         network-related services that are deemed to be non-essential to the \n         server mission, are too unsecure, or are prohibited by CMS and \n         vulnerability assessments.\n\n         Failure to comply with CMS ports, protocols, and services (PPS) \n         requirements can result in compromise of enclave boundary protections \n         and/or functionality of the Information System.\n\n         The ISSO will ensure web servers are configured to use only necessary \n         ports, protocols, and services."},{"label":"check","data":"Review the website to determine if HTTP and HTTPs (e.g., \n                  80 and 443) are used.\n\n                  Follow the procedures below for each site hosted on \n                  the IIS 8.5 web server:\n\n                  Open the IIS 8.5 Manager.\n\n                  Click the site name under review.\n\n                  In the Action Pane, click Bindings.\n\n                  Review the ports and protocols. If unknown ports or protocols \n                  are used, then this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000383-WSR-000175","gid":"V-76847","rid":"SV-91543r1_rule","stig_id":"IISW-SI-000239","fix_id":"F-83543r1_fix","cci":["CCI-001762"],"nist":["CM-7 (1) (b)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Review the website to determine if HTTP and HTTPs (e.g., 80 and\n  443) are used in accordance with those ports and services registered and\n  approved for use by the DoD PPSM. Any variation in PPS will be documented,\n  registered, and approved by the PPSM.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  In the “Action” Pane, click “Bindings”.\n\n  Review the ports and protocols. If unknown ports or protocols are used, then\n  this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  In the “Action” Pane, click “Bindings\".\n\n  Edit to change an existing binding and set the correct ports and protocol."},"code":"control 'V-76847' do\n  title \"The IIS 8.5 websites must utilize ports, protocols, and services\n  according to PPSM guidelines.\"\n  desc \"Web servers provide numerous processes, features, and functionalities\n  that utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\n  too unsecure to run on a production system.\n\n      The web server must provide the capability to disable or deactivate\n  network-related services that are deemed to be non-essential to the server\n  mission, are too unsecure, or are prohibited by the PPSM CAL and vulnerability\n  assessments.\n\n      Failure to comply with DoD ports, protocols, and services (PPS)\n  requirements can result in compromise of enclave boundary protections and/or\n  functionality of the AIS.\n\n      The ISSM will ensure web servers are configured to use only authorized PPS\n  in accordance with the Network Infrastructure STIG, DoD Instruction 8551.1,\n  Ports, Protocols, and Services Management (PPSM), and the associated Ports,\n  Protocols, and Services (PPS) Assurance Category Assignments List.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000383-WSR-000175'\n  tag \"gid\": 'V-76847'\n  tag \"rid\": 'SV-91543r1_rule'\n  tag \"stig_id\": 'IISW-SI-000239'\n  tag \"fix_id\": 'F-83543r1_fix'\n  tag \"cci\": ['CCI-001762']\n  tag \"nist\": ['CM-7 (1) (b)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Review the website to determine if HTTP and HTTPs (e.g., 80 and\n  443) are used in accordance with those ports and services registered and\n  approved for use by the DoD PPSM. Any variation in PPS will be documented,\n  registered, and approved by the PPSM.\n\n  Follow the procedures below for each site hosted on the IIS 8.5 web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  In the “Action” Pane, click “Bindings”.\n\n  Review the ports and protocols. If unknown ports or protocols are used, then\n  this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  In the “Action” Pane, click “Bindings\\\".\n\n  Edit to change an existing binding and set the correct ports and protocol.\"\n\n  site_name = attribute('site_name')\n\n  http_ip = attribute('http_ip')\n\n  http_hostname = attribute('http_hostname')\n\n  https_ip = attribute('https_ip')\n\n  https_hostname = attribute('https_hostname')\n\n  site_name.zip(http_ip, http_hostname).each do |site, httpip, httphostname|\n    describe iis_site(site.to_s) do\n      it { should exist }\n      it { should have_binding(\"http #{httpip}:80:#{httphostname}\") }\n    end\n  end\n  site_name.zip(https_ip, https_hostname).each do |site, httpsip, httsphostname|\n    describe iis_site(site.to_s) do\n      it { should exist }\n      it { should have_binding(\"https #{httpsip}:443:#{httsphostname}\") }\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76847.rb"},"results":[{"status":"failed","code_desc":"iis_site 'tt' should exist","run_time":0.000384,"start_time":"2019-02-04T07:10:00-08:00","message":"expected iis_site 'tt' to exist"},{"status":"failed","code_desc":"iis_site 'tt' should have binding \"http 10.0.2.15:80:local\"","run_time":0.000592,"start_time":"2019-02-04T07:10:00-08:00","message":"expected #has_binding?(\"http 10.0.2.15:80:local\") to return true, got false"},{"status":"failed","code_desc":"iis_site 'Default' should exist","run_time":0.000393,"start_time":"2019-02-04T07:10:00-08:00","message":"expected iis_site 'Default' to exist"},{"status":"failed","code_desc":"iis_site 'Default' should have binding \"http 0.0.0.0:80:l\"","run_time":0.000534,"start_time":"2019-02-04T07:10:00-08:00","message":"expected #has_binding?(\"http 0.0.0.0:80:l\") to return true, got false"},{"status":"failed","code_desc":"iis_site 'tt' should exist","run_time":0.000329,"start_time":"2019-02-04T07:10:00-08:00","message":"expected iis_site 'tt' to exist"},{"status":"failed","code_desc":"iis_site 'tt' should have binding \"https 10.0.2.15:443:localhttps\"","run_time":0.001615,"start_time":"2019-02-04T07:10:00-08:00","message":"expected #has_binding?(\"https 10.0.2.15:443:localhttps\") to return true, got false"},{"status":"failed","code_desc":"iis_site 'Default' should exist","run_time":0.000415,"start_time":"2019-02-04T07:10:00-08:00","message":"expected iis_site 'Default' to exist"},{"status":"failed","code_desc":"iis_site 'Default' should have binding \"https 0.0.0.0:443:localhttps2\"","run_time":0.000491,"start_time":"2019-02-04T07:10:00-08:00","message":"expected #has_binding?(\"https 0.0.0.0:443:localhttps2\") to return true, got false"}]},{"id":"V-76849","title":"The IIS 8.5 private website have a server certificate issued by CMS \n          PKI or CMS-approved PKI Certification Authorities (CAs).","desc":"The use of a CMS PKI certificate ensures clients the private website\n         they are connecting to is legitimate, and is an essential part of the CMS\n         defense-in-depth strategy.","descriptions":[{"label":"default","data":"The use of a CMS PKI certificate ensures clients the private website\n         they are connecting to is legitimate, and is an essential part of the CMS\n         defense-in-depth strategy."},{"label":"check","data":"Follow the procedures below for each site hosted on the IIS 8.5 \n         web server:\n\n         Open the IIS 8.5 Manager.\n         \n         Click the site name under review.\n\n         Click Bindings in the Action Pane.\n\n         Click the HTTPS type from the box.\n\n         Click Edit.\n\n         Click View and then review and verify the certificate path.\n\n         If the list of CAs in the trust hierarchy does not lead to the CMS PKI Root \n         CA, CMS-approved external certificate authority (ECA), or CMS-approved \n         external partner, this is a finding.\n\n         If HTTPS is not an available type under site bindings, this is a finding."},{"label":"fix","data":"Follow the procedures below for each site hosted on the IIS 8.5 \n         web server:\n\n         Open the IIS 8.5 Manager.\n\n         Click the Server name.\n\n         Double-click Server Certificates.\n\n         Click Import under the \"Actions\" pane.\n\n         Browse to the CMS certificate location, select it, and click OK.\n\n         Remove any non-CMS certificates if present.\n\n         Click on the site needing the certificate.\n\n         Select Bindings under the \"Actions\" pane.\n\n         Click on the binding needing a certificate and select Edit, or \n         add a site binding for HTTPS.\n\n         Assign the certificate to the website by choosing it under the SSL Certificate \n         drop-down and clicking OK."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000427-WSR-000186","gid":"V-76849","rid":"SV-91545r2_rule","stig_id":"IISW-SI-000241","fix_id":"F-83545r1_fix","cci":["CCI-002470"],"nist":["SC-23 (5)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click Bindings in the Action Pane.\n\n  Click the HTTPS type from the box.\n\n  Click Edit.\n\n  Click View and then review and verify the certificate path.\n\n  If the list of CAs in the trust hierarchy does not lead to the DoD PKI Root CA,\n  DoD-approved external certificate authority (ECA), or DoD-approved external\n  partner, this is a finding.\n\n  If HTTPS is not an available type under site bindings, this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Server name.\n\n  Double-click Server Certificates.\n\n  Click Import under the \"Actions\" pane.\n\n  Browse to the DoD certificate location, select it, and click OK.\n\n  Remove any non-DoD certificates if present.\n\n  Click on the site needing the certificate.\n\n  Select Bindings under the \"Actions\" pane.\n\n  Click on the binding needing a certificate and select Edit, or add a site\n  binding for HTTPS.\n\n  Assign the certificate to the website by choosing it under the SSL\n  Certificate drop-down and clicking OK."},"code":"control 'V-76849' do\n  title \"The IIS 8.5 private website have a server certificate issued by DoD\n  PKI or DoD-approved PKI Certification Authorities (CAs).\"\n  desc \"The use of a DoD PKI certificate ensures clients the private website\n  they are connecting to is legitimate, and is an essential part of the DoD\n  defense-in-depth strategy.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000427-WSR-000186'\n  tag \"gid\": 'V-76849'\n  tag \"rid\": 'SV-91545r2_rule'\n  tag \"stig_id\": 'IISW-SI-000241'\n  tag \"fix_id\": 'F-83545r1_fix'\n  tag \"cci\": ['CCI-002470']\n  tag \"nist\": ['SC-23 (5)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Click Bindings in the Action Pane.\n\n  Click the HTTPS type from the box.\n\n  Click Edit.\n\n  Click View and then review and verify the certificate path.\n\n  If the list of CAs in the trust hierarchy does not lead to the DoD PKI Root CA,\n  DoD-approved external certificate authority (ECA), or DoD-approved external\n  partner, this is a finding.\n\n  If HTTPS is not an available type under site bindings, this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Click the Server name.\n\n  Double-click Server Certificates.\n\n  Click Import under the \\\"Actions\\\" pane.\n\n  Browse to the DoD certificate location, select it, and click OK.\n\n  Remove any non-DoD certificates if present.\n\n  Click on the site needing the certificate.\n\n  Select Bindings under the \\\"Actions\\\" pane.\n\n  Click on the binding needing a certificate and select Edit, or add a site\n  binding for HTTPS.\n\n  Assign the certificate to the website by choosing it under the SSL\n  Certificate drop-down and clicking OK.\"\n\n  describe 'Manually review the site certificate' do\n    skip 'Manually review to confirm that the certificate trust hierarchy leads\n    to the DoD PKI Root CA, DoD-approved external certificate authority (ECA),\n    or DoD-approved external partner'\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76849.rb"},"results":[{"status":"skipped","code_desc":"For this CMS ARS 3.1 overlay, this control must be reviewed manually","run_time":9.0e-06,"start_time":"2019-02-04T07:10:00-08:00","resource":"","skip_message":"For this CMS ARS 3.1 overlay, this control must be reviewed manually"}]},{"id":"V-76851","title":"The IIS 8.5 private website must employ cryptographic mechanisms (TLS)\n  and require client certificates.","desc":"When data is written to digital media, such as hard drives, mobile\n  computers, external/removable hard drives, personal digital assistants,\n  flash/thumb drives, etc., there is risk of data loss and data compromise. User\n  identities and passwords stored on the hard drive of the hosting hardware must\n  be encrypted to protect the data from easily being discovered and used by an\n  unauthorized user to access the hosted applications. The cryptographic\n  libraries and functionality used to store and retrieve the user identifiers and\n  passwords must be part of the web server.\n\n      Preventing the disclosure of transmitted information requires that the web\n  server take measures to employ some form of cryptographic mechanism in order to\n  protect the information during transmission. This is usually achieved through\n  the use of Transport Layer Security (TLS).\n\n      Transmission of data can take place between the web server and a large\n  number of devices/applications external to the web server. Examples are a web\n  client used by a user, a backend database, an audit server, or other web\n  servers in a web cluster.\n\n      If data is transmitted unencrypted, the data then becomes vulnerable to\n  disclosure. The disclosure may reveal user identifier/password combinations,\n  website code revealing business logic, or other user personal information.\n\n      Also satisfies: SRG-APP-000439-WSR-000151","descriptions":[{"label":"default","data":"When data is written to digital media, such as hard drives, mobile\n  computers, external/removable hard drives, personal digital assistants,\n  flash/thumb drives, etc., there is risk of data loss and data compromise. User\n  identities and passwords stored on the hard drive of the hosting hardware must\n  be encrypted to protect the data from easily being discovered and used by an\n  unauthorized user to access the hosted applications. The cryptographic\n  libraries and functionality used to store and retrieve the user identifiers and\n  passwords must be part of the web server.\n\n      Preventing the disclosure of transmitted information requires that the web\n  server take measures to employ some form of cryptographic mechanism in order to\n  protect the information during transmission. This is usually achieved through\n  the use of Transport Layer Security (TLS).\n\n      Transmission of data can take place between the web server and a large\n  number of devices/applications external to the web server. Examples are a web\n  client used by a user, a backend database, an audit server, or other web\n  servers in a web cluster.\n\n      If data is transmitted unencrypted, the data then becomes vulnerable to\n  disclosure. The disclosure may reveal user identifier/password combinations,\n  website code revealing business logic, or other user personal information.\n\n      Also satisfies: SRG-APP-000439-WSR-000151"}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000429-WSR-000113","gid":"V-76851","rid":"SV-91547r3_rule","stig_id":"IISW-SI-000242","fix_id":"F-83547r1_fix","cci":["CCI-002476"],"nist":["SC-28 (1)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon under the \"IIS\" section.\n\n  Verify \"Require SSL\" is checked.\n\n  Verify \"Client Certificates Required\" is selected.\n\n  Click the site under review.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate system.webServer/security/access.\n\n  The value for \"sslFlags\" set must include \"ssl128\".\n\n  If the \"Require SSL\" is not selected, this is a finding.\n\n  If the \"Client Certificates Required\" is not selected, this is a finding.\n\n  If the \"sslFlags\" is not set to \"ssl128\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon under the \"IIS\" section.\n\n  Select the \"Require SSL\" setting.\n\n  Select the \"Client Certificates Required\" setting.\n\n  Click \"Apply\" in the \"Actions\" pane.\n\n  Click the site under review.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate system.webServer/security/access.\n\n  Click on the drop-down list for \"sslFlags\".\n\n  Select the \"Ssl128\" check box.\n\n  Click \"Apply\" in the \"Actions\" pane."},"code":"control 'V-76851' do\n  title \"The IIS 8.5 private website must employ cryptographic mechanisms (TLS)\n  and require client certificates.\"\n  desc \"When data is written to digital media, such as hard drives, mobile\n  computers, external/removable hard drives, personal digital assistants,\n  flash/thumb drives, etc., there is risk of data loss and data compromise. User\n  identities and passwords stored on the hard drive of the hosting hardware must\n  be encrypted to protect the data from easily being discovered and used by an\n  unauthorized user to access the hosted applications. The cryptographic\n  libraries and functionality used to store and retrieve the user identifiers and\n  passwords must be part of the web server.\n\n      Preventing the disclosure of transmitted information requires that the web\n  server take measures to employ some form of cryptographic mechanism in order to\n  protect the information during transmission. This is usually achieved through\n  the use of Transport Layer Security (TLS).\n\n      Transmission of data can take place between the web server and a large\n  number of devices/applications external to the web server. Examples are a web\n  client used by a user, a backend database, an audit server, or other web\n  servers in a web cluster.\n\n      If data is transmitted unencrypted, the data then becomes vulnerable to\n  disclosure. The disclosure may reveal user identifier/password combinations,\n  website code revealing business logic, or other user personal information.\n\n      Also satisfies: SRG-APP-000439-WSR-000151\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000429-WSR-000113'\n  tag \"gid\": 'V-76851'\n  tag \"rid\": 'SV-91547r3_rule'\n  tag \"stig_id\": 'IISW-SI-000242'\n  tag \"fix_id\": 'F-83547r1_fix'\n  tag \"cci\": ['CCI-002476']\n  tag \"nist\": ['SC-28 (1)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \\\"SSL Settings\\\" icon under the \\\"IIS\\\" section.\n\n  Verify \\\"Require SSL\\\" is checked.\n\n  Verify \\\"Client Certificates Required\\\" is selected.\n\n  Click the site under review.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate system.webServer/security/access.\n\n  The value for \\\"sslFlags\\\" set must include \\\"ssl128\\\".\n\n  If the \\\"Require SSL\\\" is not selected, this is a finding.\n\n  If the \\\"Client Certificates Required\\\" is not selected, this is a finding.\n\n  If the \\\"sslFlags\\\" is not set to \\\"ssl128\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \\\"SSL Settings\\\" icon under the \\\"IIS\\\" section.\n\n  Select the \\\"Require SSL\\\" setting.\n\n  Select the \\\"Client Certificates Required\\\" setting.\n\n  Click \\\"Apply\\\" in the \\\"Actions\\\" pane.\n\n  Click the site under review.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate system.webServer/security/access.\n\n  Click on the drop-down list for \\\"sslFlags\\\".\n\n  Select the \\\"Ssl128\\\" check box.\n\n  Click \\\"Apply\\\" in the \\\"Actions\\\" pane.\"\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  get_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.webServer/security/access 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('sslFlags') { should include 'Ssl' }\n      its('sslFlags') { should include 'SslRequireCert' }\n      its('sslFlags') { should include 'Ssl128' }\n    end\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76851.rb"},"results":[{"status":"failed","code_desc":"IIS sessionState for site :'Default Web Site' sslFlags should include \"Ssl\"","run_time":0.000698,"start_time":"2019-02-04T07:10:00-08:00","message":"expected \"\" to include \"Ssl\""},{"status":"failed","code_desc":"IIS sessionState for site :'Default Web Site' sslFlags should include \"SslRequireCert\"","run_time":0.000302,"start_time":"2019-02-04T07:10:00-08:00","message":"expected \"\" to include \"SslRequireCert\""},{"status":"failed","code_desc":"IIS sessionState for site :'Default Web Site' sslFlags should include \"Ssl128\"","run_time":0.001287,"start_time":"2019-02-04T07:10:00-08:00","message":"expected \"\" to include \"Ssl128\""}]},{"id":"V-76855","title":"IIS 8.5 website session IDs must be sent to the client using TLS.","desc":"The HTTP protocol is a stateless protocol. To maintain a session, a\n  session identifier is used. The session identifier is a piece of data that is\n  used to identify a session and a user. If the session identifier is compromised\n  by an attacker, the session can be hijacked. By encrypting the session\n  identifier, the identifier becomes more difficult for an attacker to hijack,\n  decrypt, and use before the session has expired.","descriptions":[{"label":"default","data":"The HTTP protocol is a stateless protocol. To maintain a session, a\n  session identifier is used. The session identifier is a piece of data that is\n  used to identify a session and a user. If the session identifier is compromised\n  by an attacker, the session can be hijacked. By encrypting the session\n  identifier, the identifier becomes more difficult for an attacker to hijack,\n  decrypt, and use before the session has expired."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000439-WSR-000152","gid":"V-76855","rid":"SV-91551r1_rule","stig_id":"IISW-SI-000244","fix_id":"F-83551r1_fix","cci":["CCI-002418"],"nist":["SC-8","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \"Management\" section, double-click the \"Configuration Editor\" icon.\n\n  From the \"Section:\" drop-down list, select “system.webServer/asp\".\n\n  Expand the \"session\" section.\n\n  Verify the \"keepSessionIdSecure\" is set to \"True\".\n\n  If the \"keepSessionIdSecure\" is not set to \"True\", this is a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \"Management\" section, double-click the \"Configuration Editor\" icon.\n\n  From the \"Section:\" drop-down list, select “system.webServer/asp\".\n\n  Expand the \"session\" section.\n\n  Select \"True\" for the \"keepSessionIdSecure\" setting.\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76855' do\n  title 'IIS 8.5 website session IDs must be sent to the client using TLS.'\n  desc  \"The HTTP protocol is a stateless protocol. To maintain a session, a\n  session identifier is used. The session identifier is a piece of data that is\n  used to identify a session and a user. If the session identifier is compromised\n  by an attacker, the session can be hijacked. By encrypting the session\n  identifier, the identifier becomes more difficult for an attacker to hijack,\n  decrypt, and use before the session has expired.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000439-WSR-000152'\n  tag \"gid\": 'V-76855'\n  tag \"rid\": 'SV-91551r1_rule'\n  tag \"stig_id\": 'IISW-SI-000244'\n  tag \"fix_id\": 'F-83551r1_fix'\n  tag \"cci\": ['CCI-002418']\n  tag \"nist\": ['SC-8', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \\\"Management\\\" section, double-click the \\\"Configuration Editor\\\" icon.\n\n  From the \\\"Section:\\\" drop-down list, select “system.webServer/asp\\\".\n\n  Expand the \\\"session\\\" section.\n\n  Verify the \\\"keepSessionIdSecure\\\" is set to \\\"True\\\".\n\n  If the \\\"keepSessionIdSecure\\\" is not set to \\\"True\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Select the website being reviewed.\n\n  Under \\\"Management\\\" section, double-click the \\\"Configuration Editor\\\" icon.\n\n  From the \\\"Section:\\\" drop-down list, select “system.webServer/asp\\\".\n\n  Expand the \\\"session\\\" section.\n\n  Select \\\"True\\\" for the \\\"keepSessionIdSecure\\\" setting.\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_keepSessionIdSecure = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.webServer/asp -name * | select -expand session | select -expand keepSessionIdSecure').stdout.strip.split(\"\\r\\n\")\n\n  get_keepSessionIdSecure.zip(get_names).each do |keepSessionIdSecure, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} website keepSessionIdSecure enabled setting\" do\n      subject { keepSessionIdSecure }\n      it { should cmp 'True' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76855.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site website keepSessionIdSecure enabled setting should cmp == \"True\"","run_time":0.000272,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76859","title":"Cookies exchanged between the IIS 8.5 website and the client must use\n  SSL/TLS, have cookie properties set to prohibit client-side scripts from\n  reading the cookie data and must not be compressed.","desc":"A cookie is used when a web server needs to share data with the\n  client's browser. The data is often used to remember the client when the client\n  returns to the hosted application at a later date. A session cookie is a\n  special type of cookie used to remember the client during the session. The\n  cookie will contain the session identifier (ID) and may contain authentication\n  data to the hosted application. To protect this data from easily being\n  compromised, the cookie must be encrypted.\n\n      When a cookie is sent encrypted via SSL/TLS, an attacker must spend a great\n  deal of time and resources to decrypt the cookie. If, along with encryption,\n  the cookie is compressed, the attacker can now use a combination of plaintext\n  injection and inadvertent information leakage through data compression to\n  reduce the time needed to decrypt the cookie. This attack is called Compression\n  Ratio Info-leak Made Easy (CRIME).\n\n      Cookies shared between the web server and the client when encrypted should\n  not also be compressed.\n\n      A cookie can be read by client-side scripts easily if cookie properties are\n  not set properly. By allowing cookies to be read by the client-side scripts,\n  information such as session identifiers could be compromised and used by an\n  attacker who intercepts the cookie. Setting cookie properties (i.e. HttpOnly\n  property) to disallow client-side scripts from reading cookies better protects\n  the information inside the cookie.","descriptions":[{"label":"default","data":"A cookie is used when a web server needs to share data with the\n  client's browser. The data is often used to remember the client when the client\n  returns to the hosted application at a later date. A session cookie is a\n  special type of cookie used to remember the client during the session. The\n  cookie will contain the session identifier (ID) and may contain authentication\n  data to the hosted application. To protect this data from easily being\n  compromised, the cookie must be encrypted.\n\n      When a cookie is sent encrypted via SSL/TLS, an attacker must spend a great\n  deal of time and resources to decrypt the cookie. If, along with encryption,\n  the cookie is compressed, the attacker can now use a combination of plaintext\n  injection and inadvertent information leakage through data compression to\n  reduce the time needed to decrypt the cookie. This attack is called Compression\n  Ratio Info-leak Made Easy (CRIME).\n\n      Cookies shared between the web server and the client when encrypted should\n  not also be compressed.\n\n      A cookie can be read by client-side scripts easily if cookie properties are\n  not set properly. By allowing cookies to be read by the client-side scripts,\n  information such as session identifiers could be compromised and used by an\n  attacker who intercepts the cookie. Setting cookie properties (i.e. HttpOnly\n  property) to disallow client-side scripts from reading cookies better protects\n  the information inside the cookie."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000439-WSR-000154","satisfies":["SRG-APP-000439-WSR-000154","SRG-APP-000439-SSR-000155","SRG-APP-000439-WSR-000153"],"gid":"V-76859","rid":"SV-91555r2_rule","stig_id":"IISW-SI-000246","fix_id":"F-83555r1_fix","cci":["CCI-002418"],"nist":["SC-8","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Under \"Management\" section, double-click the \"Configuration Editor\" icon.\n\n  From the \"Section:\" drop-down list, select \"system.web/httpCookies\".\n\n  Verify the \"require SSL\" is set to \"True\".\n\n  From the \"Section:\" drop-down list, select \"system.web/sessionState\".\n\n  Verify the \"compressionEnabled\" is set to \"False\".\n\n  If both the \"system.web/httpCookies:require SSL\" is set to \"True\" and the\n  \"system.web/sessionState:compressionEnabled\" is set to \"False\", this is not\n  a finding.","fix":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Under \"Management\" section, double-click the \"Configuration Editor\" icon.\n\n  From the \"Section:\" drop-down list, select \"system.web/httpCookies\".\n\n  Set the \"require SSL\" to \"True\".\n\n  From the \"Section:\" drop-down list, select \"system.web/sessionState\".\n\n  Set the \"compressionEnabled\" to \"False\".\n\n  Select \"Apply\" from the \"Actions\" pane."},"code":"control 'V-76859' do\n  title \"Cookies exchanged between the IIS 8.5 website and the client must use\n  SSL/TLS, have cookie properties set to prohibit client-side scripts from\n  reading the cookie data and must not be compressed.\"\n  desc \"A cookie is used when a web server needs to share data with the\n  client's browser. The data is often used to remember the client when the client\n  returns to the hosted application at a later date. A session cookie is a\n  special type of cookie used to remember the client during the session. The\n  cookie will contain the session identifier (ID) and may contain authentication\n  data to the hosted application. To protect this data from easily being\n  compromised, the cookie must be encrypted.\n\n      When a cookie is sent encrypted via SSL/TLS, an attacker must spend a great\n  deal of time and resources to decrypt the cookie. If, along with encryption,\n  the cookie is compressed, the attacker can now use a combination of plaintext\n  injection and inadvertent information leakage through data compression to\n  reduce the time needed to decrypt the cookie. This attack is called Compression\n  Ratio Info-leak Made Easy (CRIME).\n\n      Cookies shared between the web server and the client when encrypted should\n  not also be compressed.\n\n      A cookie can be read by client-side scripts easily if cookie properties are\n  not set properly. By allowing cookies to be read by the client-side scripts,\n  information such as session identifiers could be compromised and used by an\n  attacker who intercepts the cookie. Setting cookie properties (i.e. HttpOnly\n  property) to disallow client-side scripts from reading cookies better protects\n  the information inside the cookie.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000439-WSR-000154'\n  tag \"satisfies\": ['SRG-APP-000439-WSR-000154', 'SRG-APP-000439-SSR-000155',\n                    'SRG-APP-000439-WSR-000153']\n  tag \"gid\": 'V-76859'\n  tag \"rid\": 'SV-91555r2_rule'\n  tag \"stig_id\": 'IISW-SI-000246'\n  tag \"fix_id\": 'F-83555r1_fix'\n  tag \"cci\": ['CCI-002418']\n  tag \"nist\": ['SC-8', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Under \\\"Management\\\" section, double-click the \\\"Configuration Editor\\\" icon.\n\n  From the \\\"Section:\\\" drop-down list, select \\\"system.web/httpCookies\\\".\n\n  Verify the \\\"require SSL\\\" is set to \\\"True\\\".\n\n  From the \\\"Section:\\\" drop-down list, select \\\"system.web/sessionState\\\".\n\n  Verify the \\\"compressionEnabled\\\" is set to \\\"False\\\".\n\n  If both the \\\"system.web/httpCookies:require SSL\\\" is set to \\\"True\\\" and the\n  \\\"system.web/sessionState:compressionEnabled\\\" is set to \\\"False\\\", this is not\n  a finding.\"\n  tag \"fix\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Access the IIS 8.5 Manager.\n\n  Under \\\"Management\\\" section, double-click the \\\"Configuration Editor\\\" icon.\n\n  From the \\\"Section:\\\" drop-down list, select \\\"system.web/httpCookies\\\".\n\n  Set the \\\"require SSL\\\" to \\\"True\\\".\n\n  From the \\\"Section:\\\" drop-down list, select \\\"system.web/sessionState\\\".\n\n  Set the \\\"compressionEnabled\\\" to \\\"False\\\".\n\n  Select \\\"Apply\\\" from the \\\"Actions\\\" pane.\"\n\n  get_names = command(\"Get-Website | select name | findstr /v 'name ---'\").stdout.strip.split(\"\\r\\n\")\n  get_compressionEnabled = command('Get-WebConfigurationProperty -pspath \"IIS:\\Sites\\*\" -Filter system.web/sessionState -name * | select -expand compressionEnabled').stdout.strip.split(\"\\r\\n\")\n\n  get_compressionEnabled.zip(get_names).each do |compressionEnabled, names|\n    n = names.strip\n\n    describe \"The IIS site: #{n} website compressionEnabled enabled setting\" do\n      subject { compressionEnabled }\n      it { should cmp 'False' }\n    end\n  end\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76859.rb"},"results":[{"status":"passed","code_desc":"The IIS site: Default Web Site website compressionEnabled enabled setting should cmp == \"False\"","run_time":0.000267,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76861","title":"The IIS 8.5 website must maintain the confidentiality and integrity of\n  information during preparation for transmission and during reception.","desc":"Information can be either unintentionally or maliciously disclosed or\n  modified during preparation for transmission, including, for example, during\n  aggregation, at protocol transformation points, and during packing/unpacking.\n  These unauthorized disclosures or modifications compromise the confidentiality\n  or integrity of the information.\n\n      An example of this would be an SMTP queue. This queue may be added to a web\n  server through an SMTP module to enhance error reporting or to allow developers\n  to add SMTP functionality to their applications.\n\n      Any modules used by the web server that queue data before transmission must\n  maintain the confidentiality and integrity of the information before the data\n  is transmitted.\n\n      Information can be either unintentionally or maliciously disclosed or\n  modified during reception, including, for example, during aggregation, at\n  protocol transformation points, and during packing/unpacking. These\n  unauthorized disclosures or modifications compromise the confidentiality or\n  integrity of the information.\n\n      Protecting the confidentiality and integrity of received information\n  requires that application servers take measures to employ approved cryptography\n  in order to protect the information during transmission over the network. This\n  is usually achieved through the use of Transport Layer Security (TLS), SSL VPN,\n  or IPsec tunnel.\n\n      The web server must utilize approved encryption when receiving transmitted\n  data.\n\n    Also satisfies: SRG-APP-000442-WSR-000182","descriptions":[{"label":"default","data":"Information can be either unintentionally or maliciously disclosed or\n  modified during preparation for transmission, including, for example, during\n  aggregation, at protocol transformation points, and during packing/unpacking.\n  These unauthorized disclosures or modifications compromise the confidentiality\n  or integrity of the information.\n\n      An example of this would be an SMTP queue. This queue may be added to a web\n  server through an SMTP module to enhance error reporting or to allow developers\n  to add SMTP functionality to their applications.\n\n      Any modules used by the web server that queue data before transmission must\n  maintain the confidentiality and integrity of the information before the data\n  is transmitted.\n\n      Information can be either unintentionally or maliciously disclosed or\n  modified during reception, including, for example, during aggregation, at\n  protocol transformation points, and during packing/unpacking. These\n  unauthorized disclosures or modifications compromise the confidentiality or\n  integrity of the information.\n\n      Protecting the confidentiality and integrity of received information\n  requires that application servers take measures to employ approved cryptography\n  in order to protect the information during transmission over the network. This\n  is usually achieved through the use of Transport Layer Security (TLS), SSL VPN,\n  or IPsec tunnel.\n\n      The web server must utilize approved encryption when receiving transmitted\n  data.\n\n    Also satisfies: SRG-APP-000442-WSR-000182"}],"impact":0.0,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000441-WSR-000181","gid":"V-76861","rid":"SV-91557r2_rule","stig_id":"IISW-SI-000249","fix_id":"F-83557r1_fix","cci":["CCI-002420","CCI-002422"],"nist":["SC-8 (2)","SC-8 (2)","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \"SSL Settings\" icon under the \"IIS\" section.\n\n  Verify \"Require SSL\" is checked.\n\n  Verify \"Client Certificates Required\" is selected.\n\n  Click the site under review.\n\n  Select \"Configuration Editor\" under the \"Management\" section.\n\n  From the \"Section:\" drop-down list at the top of the configuration editor,\n  locate “system.webServer/security/access”.\n\n  The value for \"sslFlags\" should be ssl128.\n\n  If the \"Require SSL\" is not selected, this is a finding.\n\n  If the \"Client Certificates Required\" is not selected, this is a finding.\n\n  If the \"sslFlags\" is not set to \"ssl128\", this is a finding.","fix":"Follow the procedures below for web server and each site under\n  review:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \"SSL Settings\" icon.\n\n  Select \"Require SSL\" check box."},"code":"control 'V-76861' do\n  title \"The IIS 8.5 website must maintain the confidentiality and integrity of\n  information during preparation for transmission and during reception.\"\n  desc \"Information can be either unintentionally or maliciously disclosed or\n  modified during preparation for transmission, including, for example, during\n  aggregation, at protocol transformation points, and during packing/unpacking.\n  These unauthorized disclosures or modifications compromise the confidentiality\n  or integrity of the information.\n\n      An example of this would be an SMTP queue. This queue may be added to a web\n  server through an SMTP module to enhance error reporting or to allow developers\n  to add SMTP functionality to their applications.\n\n      Any modules used by the web server that queue data before transmission must\n  maintain the confidentiality and integrity of the information before the data\n  is transmitted.\n\n      Information can be either unintentionally or maliciously disclosed or\n  modified during reception, including, for example, during aggregation, at\n  protocol transformation points, and during packing/unpacking. These\n  unauthorized disclosures or modifications compromise the confidentiality or\n  integrity of the information.\n\n      Protecting the confidentiality and integrity of received information\n  requires that application servers take measures to employ approved cryptography\n  in order to protect the information during transmission over the network. This\n  is usually achieved through the use of Transport Layer Security (TLS), SSL VPN,\n  or IPsec tunnel.\n\n      The web server must utilize approved encryption when receiving transmitted\n  data.\n\n    Also satisfies: SRG-APP-000442-WSR-000182\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000441-WSR-000181'\n  tag \"gid\": 'V-76861'\n  tag \"rid\": 'SV-91557r2_rule'\n  tag \"stig_id\": 'IISW-SI-000249'\n  tag \"fix_id\": 'F-83557r1_fix'\n  tag \"cci\": ['CCI-002420', 'CCI-002422']\n  tag \"nist\": ['SC-8 (2)', 'SC-8 (2)', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Follow the procedures below for each site hosted on the IIS 8.5\n  web server:\n\n  Open the IIS 8.5 Manager.\n\n  Double-click the \\\"SSL Settings\\\" icon under the \\\"IIS\\\" section.\n\n  Verify \\\"Require SSL\\\" is checked.\n\n  Verify \\\"Client Certificates Required\\\" is selected.\n\n  Click the site under review.\n\n  Select \\\"Configuration Editor\\\" under the \\\"Management\\\" section.\n\n  From the \\\"Section:\\\" drop-down list at the top of the configuration editor,\n  locate “system.webServer/security/access”.\n\n  The value for \\\"sslFlags\\\" should be ssl128.\n\n  If the \\\"Require SSL\\\" is not selected, this is a finding.\n\n  If the \\\"Client Certificates Required\\\" is not selected, this is a finding.\n\n  If the \\\"sslFlags\\\" is not set to \\\"ssl128\\\", this is a finding.\"\n  tag \"fix\": \"Follow the procedures below for web server and each site under\n  review:\n\n  Open the IIS 8.5 Manager.\n\n  Click the site name.\n\n  Double-click the \\\"SSL Settings\\\" icon.\n\n  Select \\\"Require SSL\\\" check box.\"\n\n  get_names = json(command: 'ConvertTo-Json @(Get-Website | select -expand name)').params\n\n  get_names.each do |site_name|\n    iis_configuration = json(command: \"Get-WebConfigurationProperty -Filter system.webServer/security/access 'IIS:\\\\Sites\\\\#{site_name}'  -Name * | ConvertTo-Json\")\n\n    describe \"IIS sessionState for site :'#{site_name}'\" do\n      subject { iis_configuration }\n      its('sslFlags') { should include 'Ssl' }\n      its('sslFlags') { should include 'SslRequireCert' }\n      its('sslFlags') { should include 'Ssl128' }\n    end\n  end\n\n  if get_names.empty?\n    impact 0.0\n    desc 'There are no IIS sites configured hence the control is Not-Applicable'\n\n    describe 'No sites where found to be reviewed' do\n      skip 'No sites where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76861.rb"},"results":[{"status":"failed","code_desc":"Control Source Code Error ./cms-ars-3.1-high-microsoft-iis-8.5-site-stig-overlay-master/controls/overlay.rb:219 ","run_time":0.001632,"start_time":"2019-02-04T07:10:00-08:00","message":"undefined method `split' for #<Hash:0x0000000008fe8f00>","exception":"RuntimeError","backtrace":["C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/inspec-3.5.0/lib/inspec/rule.rb:64:in `block (2 levels) in initialize'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:254:in `instance_exec'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:254:in `block in run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:500:in `block in with_around_and_singleton_context_hooks'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:457:in `block in with_around_example_hooks'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:464:in `block in run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:602:in `run_around_example_hooks_for'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:464:in `run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:457:in `with_around_example_hooks'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:500:in `with_around_and_singleton_context_hooks'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:251:in `run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:629:in `block in run_examples'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:625:in `map'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:625:in `run_examples'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:591:in `run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:592:in `block in run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:592:in `map'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/example_group.rb:592:in `run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:116:in `block (3 levels) in run_specs'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:116:in `map'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:116:in `block (2 levels) in run_specs'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/configuration.rb:1989:in `with_suite_hooks'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:111:in `block in run_specs'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/reporter.rb:74:in `report'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/rspec-core-3.8.0/lib/rspec/core/runner.rb:110:in `run_specs'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/inspec-3.5.0/lib/inspec/runner_rspec.rb:77:in `run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/inspec-3.5.0/lib/inspec/runner.rb:140:in `run_tests'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/inspec-3.5.0/lib/inspec/runner.rb:111:in `run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/inspec-3.5.0/lib/inspec/cli.rb:264:in `exec'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'","C:/opscode/inspec/embedded/lib/ruby/gems/2.5.0/gems/inspec-3.5.0/bin/inspec:12:in `<top (required)>'","C:/opscode/inspec/bin/inspec:124:in `load'","C:/opscode/inspec/bin/inspec:124:in `<main>'"]}]},{"id":"V-76865","title":"The IIS 8.5 website must have a unique application pool.","desc":"Application pools isolate sites and applications to address\n  reliability, availability, and security issues. Sites and applications may be\n  grouped according to configurations, although each site will be associated with\n  a unique application pool.","descriptions":[{"label":"default","data":"Application pools isolate sites and applications to address\n  reliability, availability, and security issues. Sites and applications may be\n  grouped according to configurations, although each site will be associated with\n  a unique application pool."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76865","rid":"SV-91561r2_rule","stig_id":"IISW-SI-000251","fix_id":"F-83561r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the IIS 8.5 Manager.\n\n  Click \"Application Pools\".\n\n  In the list of Application Pools, review the \"Applications\" column and verify\n  unique application pools for each website.\n\n  If any Application Pools are being used for more than one website, this is a\n  finding.\n  ","fix":"Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Assign a unique application pool to each website."},"code":"control 'V-76865' do\n  title 'The IIS 8.5 website must have a unique application pool.'\n  desc  \"Application pools isolate sites and applications to address\n  reliability, availability, and security issues. Sites and applications may be\n  grouped according to configurations, although each site will be associated with\n  a unique application pool.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76865'\n  tag \"rid\": 'SV-91561r2_rule'\n  tag \"stig_id\": 'IISW-SI-000251'\n  tag \"fix_id\": 'F-83561r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the IIS 8.5 Manager.\n\n  Click \\\"Application Pools\\\".\n\n  In the list of Application Pools, review the \\\"Applications\\\" column and verify\n  unique application pools for each website.\n\n  If any Application Pools are being used for more than one website, this is a\n  finding.\n  \"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the site name under review.\n\n  Assign a unique application pool to each website.\"\n  describe 'Manual review of website is needed' do\n    skip 'Manually review to confirm that the IIS 8.5 websites have a unique\n    application pool'\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76865.rb"},"results":[{"status":"skipped","code_desc":"Manual review of website is needed","run_time":5.0e-06,"start_time":"2019-02-04T07:10:00-08:00","resource":"","skip_message":"Manually review to confirm that the IIS 8.5 websites have a unique\n    application pool"}]},{"id":"V-76867","title":"The maximum number of requests an application pool can process for\n  each IIS 8.5 website must be explicitly set.","desc":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients.","descriptions":[{"label":"default","data":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients."},{"label":"check","data":"Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, with \n         supporting documentation from the ISSO, this check can be downgraded to a Low \n         Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click the â€œApplication Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         Scroll down to the \"Recycling section\" and verify the value for \"Request Limit\" \n         is set to a value other than \"0\".\n\n         If the \"Request Limit\" is set to a value of \"0\", this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76867","rid":"SV-91563r2_rule","stig_id":"IISW-SI-000252","fix_id":"F-83563r2_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  with supporting documentation from the ISSO, this check can be downgraded to a\n  Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling section\" and verify the value for \"Request\n  Limit\" is set to a value other than \"0\".\n\n  If the \"Request Limit\" is set to a value of \"0\", this is a finding.","fix":"Open the IIS 8.5 Manager.\n\nClick on the Application Pools.\n\nHighlight an Application Pool and click \"Advanced Settings\" in the Action\nPane.\n\nScroll down to the \"Recycling section\" and set the value for \"Request\nLimit\" to greater than \"0\".\n\nClick OK.\n"},"code":"control 'V-76867' do\n  title \"The maximum number of requests an application pool can process for\n  each IIS 8.5 website must be explicitly set.\"\n  desc \"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76867'\n  tag \"rid\": 'SV-91563r2_rule'\n  tag \"stig_id\": 'IISW-SI-000252'\n  tag \"fix_id\": 'F-83563r2_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  with supporting documentation from the ISSO, this check can be downgraded to a\n  Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool and click \\\"Advanced Settings\\\" in the Action\n  Pane.\n\n  Scroll down to the \\\"Recycling section\\\" and verify the value for \\\"Request\n  Limit\\\" is set to a value other than \\\"0\\\".\n\n  If the \\\"Request Limit\\\" is set to a value of \\\"0\\\", this is a finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\nClick on the Application Pools.\n\nHighlight an Application Pool and click \\\"Advanced Settings\\\" in the Action\nPane.\n\nScroll down to the \\\"Recycling section\\\" and set the value for \\\"Request\nLimit\\\" to greater than \\\"0\\\".\n\nClick OK.\n\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand recycling | select -expand periodicRestart | ConvertTo-Json\")\n\n    describe \"The maximum number of requests an application pool can process for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      its('requests') { should cmp > 3 }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76867.rb"},"results":[{"status":"failed","code_desc":"The maximum number of requests an application pool can process for IIS Application Pool :'DefaultAppPool' requests should cmp > 3","run_time":0.000379,"start_time":"2019-02-04T07:10:00-08:00","message":"\nexpected it to be > 3\n     got: 0\n\n(compared using `cmp` matcher)\n"}]},{"id":"V-76869","title":"The amount of virtual memory an application pool uses for each IIS 8.5\n  website must be explicitly set.","desc":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients.","descriptions":[{"label":"default","data":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients."},{"label":"check","data":"Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, mitigation \n         steps can be set, to include setting the Fixed number or requests, Specific \n         time, and Private memory usage in the recycling conditions lieu of the \n         Virtual memory setting. If mitigation is used in lieu of this requirement, \n         with supporting documentation from the ISSO, this check can be downgraded \n         to a Low Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click on Application Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         In the \"Advanced Settings\" dialog box scroll down to the \"Recycling\" section \n         and verify the value for \"Virtual Memory Limit\" is not set to 0.\n\n         If the value for \"Virtual Memory Limit\" is set to 0, this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76869","rid":"SV-91565r2_rule","stig_id":"IISW-SI-000253","fix_id":"F-83565r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  mitigation steps can be set, to include setting the “Fixed number or requests”,\n  “Specific time”, and “Private memory usage” in the recycling conditions lieu of\n  the “Virtual memory” setting. If mitigation is used in lieu of this\n  requirement, with supporting documentation from the ISSO, this check can be\n  downgraded to a Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click on “Application Pools”.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  In the \"Advanced Settings\" dialog box scroll down to the \"Recycling\"\n  section and verify the value for \"Virtual Memory Limit\" is not set to 0.\n\n  If the value for \"Virtual Memory Limit\" is set to 0, this is a finding.\n  ","fix":"Open the IIS 8.5 Manager.\n\n  Click on Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  In the \"Advanced Settings\" dialog box scroll down to the \"Recycling\"\n  section and set the value for \"Virtual Memory Limit\" to a value other than\n  \"0\".\n\n  Click OK."},"code":"control 'V-76869' do\n  title \"The amount of virtual memory an application pool uses for each IIS 8.5\n  website must be explicitly set.\"\n  desc \"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76869'\n  tag \"rid\": 'SV-91565r2_rule'\n  tag \"stig_id\": 'IISW-SI-000253'\n  tag \"fix_id\": 'F-83565r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  mitigation steps can be set, to include setting the “Fixed number or requests”,\n  “Specific time”, and “Private memory usage” in the recycling conditions lieu of\n  the “Virtual memory” setting. If mitigation is used in lieu of this\n  requirement, with supporting documentation from the ISSO, this check can be\n  downgraded to a Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click on “Application Pools”.\n\n  Highlight an Application Pool and click \\\"Advanced Settings\\\" in the Action\n  Pane.\n\n  In the \\\"Advanced Settings\\\" dialog box scroll down to the \\\"Recycling\\\"\n  section and verify the value for \\\"Virtual Memory Limit\\\" is not set to 0.\n\n  If the value for \\\"Virtual Memory Limit\\\" is set to 0, this is a finding.\n  \"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click on Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool and click \\\"Advanced Settings\\\" in the Action\n  Pane.\n\n  In the \\\"Advanced Settings\\\" dialog box scroll down to the \\\"Recycling\\\"\n  section and set the value for \\\"Virtual Memory Limit\\\" to a value other than\n  \\\"0\\\".\n\n  Click OK.\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand recycling | select -expand periodicRestart | ConvertTo-Json\")\n\n    describe \"The amount of virtual memory for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      its('memory') { should_not cmp 0 }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76869.rb"},"results":[{"status":"failed","code_desc":"The amount of virtual memory for IIS Application Pool :'DefaultAppPool' memory should not cmp == 0","run_time":0.000253,"start_time":"2019-02-04T07:10:00-08:00","message":"\nexpected it not to be == 0\n     got: 0\n\n(compared using `cmp` matcher)\n"}]},{"id":"V-76871","title":"The amount of private memory an application pool uses for each IIS 8.5\n  website must be explicitly set.","desc":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients.","descriptions":[{"label":"default","data":"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients."},{"label":"check","data":"Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, with supporting \n         documentation from the ISSO this check can be downgraded to a Low Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click the Application Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         Scroll down to the \"Recycling\" section and verify the value for \"Private Memory \n         Limit\" is set to a value other than \"0\".\n\n         If the \"Private Memory Limit\" is set to a value of \"0\", this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76871","rid":"SV-91567r1_rule","stig_id":"IISW-SI-000254","fix_id":"F-83567r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  with supporting documentation from the ISSO this check can be downgraded to a\n  Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling\" section and verify the value for \"Private\n  Memory Limit\" is set to a value other than \"0\".\n\n  If the \"Private Memory Limit\" is set to a value of \"0\", this is a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling\" section and set the value for \"Private Memory\n  Limit\" to a value other than \"0\"."},"code":"control 'V-76871' do\n  title \"The amount of private memory an application pool uses for each IIS 8.5\n  website must be explicitly set.\"\n  desc \"IIS application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks. By\n  default, application pool recycling is overlapped, which means the worker\n  process to be shut down is kept running until after a new worker process is\n  started. After a new worker process starts, new requests are passed to it. The\n  old worker process shuts down after it finishes processing its existing\n  requests, or after a configured time-out, whichever comes first. This way of\n  recycling ensures uninterrupted service to clients.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76871'\n  tag \"rid\": 'SV-91567r1_rule'\n  tag \"stig_id\": 'IISW-SI-000254'\n  tag \"fix_id\": 'F-83567r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  with supporting documentation from the ISSO this check can be downgraded to a\n  Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool and click \\\"Advanced Settings\\\" in the Action\n  Pane.\n\n  Scroll down to the \\\"Recycling\\\" section and verify the value for \\\"Private\n  Memory Limit\\\" is set to a value other than \\\"0\\\".\n\n  If the \\\"Private Memory Limit\\\" is set to a value of \\\"0\\\", this is a finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool and click \\\"Advanced Settings\\\" in the Action\n  Pane.\n\n  Scroll down to the \\\"Recycling\\\" section and set the value for \\\"Private Memory\n  Limit\\\" to a value other than \\\"0\\\".\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand recycling | select -expand periodicRestart | ConvertTo-Json\")\n\n    describe \"The amount of private memory for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      its('privateMemory') { should_not cmp 0 }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76871.rb"},"results":[{"status":"failed","code_desc":"The amount of private memory for IIS Application Pool :'DefaultAppPool' privateMemory should not cmp == 0","run_time":0.000271,"start_time":"2019-02-04T07:10:00-08:00","message":"\nexpected it not to be == 0\n     got: 0\n\n(compared using `cmp` matcher)\n"}]},{"id":"V-76873","title":"The application pool for each IIS 8.5 website must have a recycle time\n  explicitly set.","desc":"Application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks.","descriptions":[{"label":"default","data":"Application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks."},{"label":"check","data":"Note: Recycling Application Pools can create an unstable environment \n         in a 64-bit SharePoint environment. If operational issues arise, with supporting \n         documentation from the ISSO this check can be downgraded to a Low Impact/Severity.\n\n         Open the IIS 8.5 Manager.\n\n         Perform for each Application Pool.\n\n         Click the Application Pools.\n\n         Highlight an Application Pool and click \"Advanced Settings\" in the Action Pane.\n\n         Scroll down to the \"Recycling\" section and expand the \"Generate Recycle Event \n         Log Entry\" section.\n\n         Verify both the \"Regular time interval\" and \"Specific time\" options are set to \n         \"True\".\n\n         If both the \"Regular time interval\" and \"Specific time\" options are not set to \n         \"True\", this is a finding."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76873","rid":"SV-91569r1_rule","stig_id":"IISW-SI-000255","fix_id":"F-83569r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  with supporting documentation from the ISSO this check can be downgraded to a\n  Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling\" section and expand the \"Generate Recycle\n  Event Log Entry\" section.\n\n  Verify both the \"Regular time interval\" and \"Specific time\" options are set\n  to \"True\".\n\n  If both the \"Regular time interval\" and \"Specific time\" options are not set\n  to \"True\", this is a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool and click \"Advanced Settings\" in the Action\n  Pane.\n\n  Scroll down to the \"Recycling\" section and expand the \"Generate Recycle\n  Event Log Entry\" section.\n\n  Set both the \"Regular time interval\" and \"Specific time\" options to\n  \"True\"."},"code":"control 'V-76873' do\n  title \"The application pool for each IIS 8.5 website must have a recycle time\n  explicitly set.\"\n  desc \"Application pools can be periodically recycled to avoid unstable\n  states possibly leading to application crashes, hangs, or memory leaks.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76873'\n  tag \"rid\": 'SV-91569r1_rule'\n  tag \"stig_id\": 'IISW-SI-000255'\n  tag \"fix_id\": 'F-83569r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: Recycling Application Pools can create an unstable\n  environment in a 64-bit SharePoint environment. If operational issues arise,\n  with supporting documentation from the ISSO this check can be downgraded to a\n  Cat III.\n\n  Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool and click \\\"Advanced Settings\\\" in the Action\n  Pane.\n\n  Scroll down to the \\\"Recycling\\\" section and expand the \\\"Generate Recycle\n  Event Log Entry\\\" section.\n\n  Verify both the \\\"Regular time interval\\\" and \\\"Specific time\\\" options are set\n  to \\\"True\\\".\n\n  If both the \\\"Regular time interval\\\" and \\\"Specific time\\\" options are not set\n  to \\\"True\\\", this is a finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool and click \\\"Advanced Settings\\\" in the Action\n  Pane.\n\n  Scroll down to the \\\"Recycling\\\" section and expand the \\\"Generate Recycle\n  Event Log Entry\\\" section.\n\n  Set both the \\\"Regular time interval\\\" and \\\"Specific time\\\" options to\n  \\\"True\\\".\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand recycling | ConvertTo-Json\")\n\n    describe \"The recycle time for IIS Application Pool :'#{application_pool}\" do\n      subject { iis_configuration }\n      its('logEventOnRecycle') { should include 'Time' }\n      its('logEventOnRecycle') { should include 'Schedule' }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76873.rb"},"results":[{"status":"passed","code_desc":"The recycle time for IIS Application Pool :'DefaultAppPool logEventOnRecycle should include \"Time\"","run_time":0.000249,"start_time":"2019-02-04T07:10:00-08:00"},{"status":"failed","code_desc":"The recycle time for IIS Application Pool :'DefaultAppPool logEventOnRecycle should include \"Schedule\"","run_time":0.000341,"start_time":"2019-02-04T07:10:00-08:00","message":"expected \"Time,Memory,PrivateMemory\" to include \"Schedule\""}]},{"id":"V-76875","title":"The maximum queue length for HTTP.sys for each IIS 8.5 website must be\n  explicitly configured.","desc":"In order to determine the possible causes of client connection errors\n  and to conserve system resources, it is important to both log errors and manage\n  those settings controlling requests to the application pool.","descriptions":[{"label":"default","data":"In order to determine the possible causes of client connection errors\n  and to conserve system resources, it is important to both log errors and manage\n  those settings controlling requests to the application pool."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76875","rid":"SV-91571r1_rule","stig_id":"IISW-SI-000256","fix_id":"F-83571r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"General\" section and verify the value for \"Queue\n  Length\" is set to 1000.\n\n  If the \"Queue Length\" is set to \"1000\" or less, this is not a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the General section and set the value for Queue Length to\n  1000 or less.\n\n  Click OK."},"code":"control 'V-76875' do\n  title \"The maximum queue length for HTTP.sys for each IIS 8.5 website must be\n  explicitly configured.\"\n  desc \"In order to determine the possible causes of client connection errors\n  and to conserve system resources, it is important to both log errors and manage\n  those settings controlling requests to the application pool.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76875'\n  tag \"rid\": 'SV-91571r1_rule'\n  tag \"stig_id\": 'IISW-SI-000256'\n  tag \"fix_id\": 'F-83571r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the IIS 8.5 Manager.\n\n  Perform for each Application Pool.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"General\\\" section and verify the value for \\\"Queue\n  Length\\\" is set to 1000.\n\n  If the \\\"Queue Length\\\" is set to \\\"1000\\\" or less, this is not a finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the General section and set the value for Queue Length to\n  1000 or less.\n\n  Click OK.\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = command(\"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select queueLength\").stdout\n    describe \"The maximum queue length for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      it { should cmp <= '1000' }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76875.rb"},"results":[{"status":"passed","code_desc":"The maximum queue length for IIS Application Pool :'DefaultAppPool' should cmp <= \"1000\"","run_time":0.00033,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76877","title":"The application pools pinging monitor for each IIS 8.5 website must be\n  enabled.","desc":"Windows Process Activation Service (WAS) manages application pool\n  configurations and may flag a worker process as unhealthy and shut it down. An\n  application pool’s pinging monitor must be enabled to confirm worker processes\n  are functional. A lack of response from the worker process might mean the\n  worker process does not have a thread to respond to the ping request, or it is\n  hanging for some other reason. The ping interval and ping response time may\n  need adjustment to gain access to timely information about application pool\n  health without triggering false, unhealthy conditions; for example, instability\n  caused by an application.","descriptions":[{"label":"default","data":"Windows Process Activation Service (WAS) manages application pool\n  configurations and may flag a worker process as unhealthy and shut it down. An\n  application pool’s pinging monitor must be enabled to confirm worker processes\n  are functional. A lack of response from the worker process might mean the\n  worker process does not have a thread to respond to the ping request, or it is\n  hanging for some other reason. The ping interval and ping response time may\n  need adjustment to gain access to timely information about application pool\n  health without triggering false, unhealthy conditions; for example, instability\n  caused by an application."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76877","rid":"SV-91573r1_rule","stig_id":"IISW-SI-000257","fix_id":"F-83573r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the Internet Information Services (IIS) Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Process Model\" section and verify the value for \"Ping\n  Enabled\" is set to \"True\".\n\n  If the value for \"Ping Enabled\" is not set to \"True\", this is a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Process Model\" section and set the value for \"Ping\n  Enabled\" to \"True\".\n\n  Click OK."},"code":"control 'V-76877' do\n  title \"The application pools pinging monitor for each IIS 8.5 website must be\n  enabled.\"\n  desc \"Windows Process Activation Service (WAS) manages application pool\n  configurations and may flag a worker process as unhealthy and shut it down. An\n  application pool’s pinging monitor must be enabled to confirm worker processes\n  are functional. A lack of response from the worker process might mean the\n  worker process does not have a thread to respond to the ping request, or it is\n  hanging for some other reason. The ping interval and ping response time may\n  need adjustment to gain access to timely information about application pool\n  health without triggering false, unhealthy conditions; for example, instability\n  caused by an application.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76877'\n  tag \"rid\": 'SV-91573r1_rule'\n  tag \"stig_id\": 'IISW-SI-000257'\n  tag \"fix_id\": 'F-83573r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the Internet Information Services (IIS) Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Process Model\\\" section and verify the value for \\\"Ping\n  Enabled\\\" is set to \\\"True\\\".\n\n  If the value for \\\"Ping Enabled\\\" is not set to \\\"True\\\", this is a finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Process Model\\\" section and set the value for \\\"Ping\n  Enabled\\\" to \\\"True\\\".\n\n  Click OK.\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand processModel | ConvertTo-Json\")\n\n    describe \"The pingingEnabled setting for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      its('pingingEnabled') { should cmp 'True' }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76877.rb"},"results":[{"status":"passed","code_desc":"The pingingEnabled setting for IIS Application Pool :'DefaultAppPool' pingingEnabled should cmp == \"True\"","run_time":0.000219,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76879","title":"The application pools rapid fail protection for each IIS 8.5 website\n  must be enabled.","desc":"Rapid fail protection is a feature that interrogates the health of\n  worker processes associated with websites and web applications. It can be\n  configured to perform a number of actions such as shutting down and restarting\n  worker processes that have reached failure thresholds. By not setting rapid\n  fail protection the web server could become unstable in the event of a worker\n  process crash potentially leaving the web server unusable.","descriptions":[{"label":"default","data":"Rapid fail protection is a feature that interrogates the health of\n  worker processes associated with websites and web applications. It can be\n  configured to perform a number of actions such as shutting down and restarting\n  worker processes that have reached failure thresholds. By not setting rapid\n  fail protection the web server could become unstable in the event of a worker\n  process crash potentially leaving the web server unusable."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76879","rid":"SV-91575r1_rule","stig_id":"IISW-SI-000258","fix_id":"F-83575r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Rapid Fail Protection\" section and verify the value for\n  \"Enabled\" is set to \"True\".\n\n  If the \"Rapid Fail Protection:Enabled\" is not set to \"True\", this is a\n  finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Rapid Fail Protection\" section and set the value for\n  \"Enabled\" to \"True\".\n\n  Click OK."},"code":"control 'V-76879' do\n  title \"The application pools rapid fail protection for each IIS 8.5 website\n  must be enabled.\"\n  desc \"Rapid fail protection is a feature that interrogates the health of\n  worker processes associated with websites and web applications. It can be\n  configured to perform a number of actions such as shutting down and restarting\n  worker processes that have reached failure thresholds. By not setting rapid\n  fail protection the web server could become unstable in the event of a worker\n  process crash potentially leaving the web server unusable.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76879'\n  tag \"rid\": 'SV-91575r1_rule'\n  tag \"stig_id\": 'IISW-SI-000258'\n  tag \"fix_id\": 'F-83575r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Rapid Fail Protection\\\" section and verify the value for\n  \\\"Enabled\\\" is set to \\\"True\\\".\n\n  If the \\\"Rapid Fail Protection:Enabled\\\" is not set to \\\"True\\\", this is a\n  finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Rapid Fail Protection\\\" section and set the value for\n  \\\"Enabled\\\" to \\\"True\\\".\n\n  Click OK.\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand failure | ConvertTo-Json\")\n\n    describe \"The rapid fail protection setting for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      its('rapidFailProtection') { should cmp 'True' }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76879.rb"},"results":[{"status":"passed","code_desc":"The rapid fail protection setting for IIS Application Pool :'DefaultAppPool' rapidFailProtection should cmp == \"True\"","run_time":0.00036,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76881","title":"The application pools rapid fail protection settings for each IIS 8.5\n  website must be managed.","desc":"Windows Process Activation Service (WAS) manages application pool\n  configuration and may flag a worker process as unhealthy and shut it down. The\n  rapid fail protection must be set to a suitable value. A lack of response from\n  the worker process might mean the worker process does not have a thread to\n  respond to the ping request, or that it is hanging for some other reason. The\n  ping interval and ping response time may need adjustment to gain access to\n  timely information about application pool health without triggering false,\n  unhealthy conditions.","descriptions":[{"label":"default","data":"Windows Process Activation Service (WAS) manages application pool\n  configuration and may flag a worker process as unhealthy and shut it down. The\n  rapid fail protection must be set to a suitable value. A lack of response from\n  the worker process might mean the worker process does not have a thread to\n  respond to the ping request, or that it is hanging for some other reason. The\n  ping interval and ping response time may need adjustment to gain access to\n  timely information about application pool health without triggering false,\n  unhealthy conditions."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76881","rid":"SV-91577r1_rule","stig_id":"IISW-SI-000259","fix_id":"F-83577r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Rapid Fail Protection\" section and verify the value for\n  \"Failure Interval\" is set to \"5\".\n\n  If the \"Failure Interval\" is not set to \"5\" or less, this is a finding.","fix":"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \"Advanced Settings\" in the\n  \"Actions\" pane.\n\n  Scroll down to the \"Rapid Fail Protection\" section and set the value for\n  \"Failure Interval\" to \"5\" or less.\n\n  Click OK."},"code":"control 'V-76881' do\n  title \"The application pools rapid fail protection settings for each IIS 8.5\n  website must be managed.\"\n  desc \"Windows Process Activation Service (WAS) manages application pool\n  configuration and may flag a worker process as unhealthy and shut it down. The\n  rapid fail protection must be set to a suitable value. A lack of response from\n  the worker process might mean the worker process does not have a thread to\n  respond to the ping request, or that it is hanging for some other reason. The\n  ping interval and ping response time may need adjustment to gain access to\n  timely information about application pool health without triggering false,\n  unhealthy conditions.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76881'\n  tag \"rid\": 'SV-91577r1_rule'\n  tag \"stig_id\": 'IISW-SI-000259'\n  tag \"fix_id\": 'F-83577r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Rapid Fail Protection\\\" section and verify the value for\n  \\\"Failure Interval\\\" is set to \\\"5\\\".\n\n  If the \\\"Failure Interval\\\" is not set to \\\"5\\\" or less, this is a finding.\"\n  tag \"fix\": \"Open the IIS 8.5 Manager.\n\n  Click the Application Pools.\n\n  Perform for each Application Pool.\n\n  Highlight an Application Pool to review and click \\\"Advanced Settings\\\" in the\n  \\\"Actions\\\" pane.\n\n  Scroll down to the \\\"Rapid Fail Protection\\\" section and set the value for\n  \\\"Failure Interval\\\" to \\\"5\\\" or less.\n\n  Click OK.\"\n\n  application_pool_names = json(command: 'ConvertTo-Json @(Get-ChildItem -Path IIS:\\AppPools | select -expand name)').params\n\n  application_pool_names.each do |application_pool|\n    iis_configuration = json(command: \"Get-ItemProperty 'IIS:\\\\AppPools\\\\#{application_pool}' -name * | select -expand failure | select -expand rapidFailProtectionInterval| ConvertTo-Json\")\n\n    describe \"The rapid fail protection total minutes for IIS Application Pool :'#{application_pool}'\" do\n      subject { iis_configuration }\n      its('TotalMinutes') { should cmp <= 5 }\n    end\n  end\n  if application_pool_names.empty?\n    impact 0.0\n    desc 'There are no application pool configured hence the control is Not-Applicable'\n\n    describe 'No application pool where found to be reviewed' do\n      skip 'No application pool where found to be reviewed'\n    end\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76881.rb"},"results":[{"status":"passed","code_desc":"The rapid fail protection total minutes for IIS Application Pool :'DefaultAppPool' TotalMinutes should cmp <= 5","run_time":0.000206,"start_time":"2019-02-04T07:10:00-08:00"}]},{"id":"V-76885","title":"Interactive scripts on the IIS 8.5 web server must be located in\n  unique and designated folders.","desc":"CGI and ASP scripts represent one of the most common and exploitable\n  means of compromising a web server. All CGI and ASP program files must be\n  segregated into their own unique folder to simplify the protection of these\n  files. ASP scripts must be placed into a unique folder only containing other\n  ASP scripts. JAVA and other technology-specific scripts must also be placed\n  into their own unique folders. The placement of CGI, ASP, or equivalent scripts\n  to special folders gives the Web Manager or the SA control over what goes into\n  those folders and to facilitate access control at the folder level.","descriptions":[{"label":"default","data":"CGI and ASP scripts represent one of the most common and exploitable\n  means of compromising a web server. All CGI and ASP program files must be\n  segregated into their own unique folder to simplify the protection of these\n  files. ASP scripts must be placed into a unique folder only containing other\n  ASP scripts. JAVA and other technology-specific scripts must also be placed\n  into their own unique folders. The placement of CGI, ASP, or equivalent scripts\n  to special folders gives the Web Manager or the SA control over what goes into\n  those folders and to facilitate access control at the folder level."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000087","gid":"V-76885","rid":"SV-91581r2_rule","stig_id":"IISW-SI-000261","fix_id":"F-83581r2_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Determine whether scripts are used on the web server for the\n  target website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  All interactive programs must be placed in unique designated folders based on\n  CGI or ASP script type.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions. Each script type must be in its unique\n  designated folder.\n\n  If scripts are not segregated from web content and in their own unique folders,\n  then this is a finding.","fix":"All interactive programs must be placed in unique designated\n  folders based on CGI or ASP script type.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web server name and select Explore.\n\n  Search for the listed script extensions.\n\n  Move each script type to its unique designated folder.\n\n  Set the permissions to the scripts folders as follows:\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  SYSTEM: FULL\n  ApplicationPoolId:READ\n  Custom Service Account: READ\n  Users: READ\n  ALL APPLICATION PACKAGES: READ\n  "},"code":"control 'V-76885' do\n  title \"Interactive scripts on the IIS 8.5 web server must be located in\n  unique and designated folders.\"\n  desc  \"CGI and ASP scripts represent one of the most common and exploitable\n  means of compromising a web server. All CGI and ASP program files must be\n  segregated into their own unique folder to simplify the protection of these\n  files. ASP scripts must be placed into a unique folder only containing other\n  ASP scripts. JAVA and other technology-specific scripts must also be placed\n  into their own unique folders. The placement of CGI, ASP, or equivalent scripts\n  to special folders gives the Web Manager or the SA control over what goes into\n  those folders and to facilitate access control at the folder level.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000087'\n  tag \"gid\": 'V-76885'\n  tag \"rid\": 'SV-91581r2_rule'\n  tag \"stig_id\": 'IISW-SI-000261'\n  tag \"fix_id\": 'F-83581r2_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Determine whether scripts are used on the web server for the\n  target website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  All interactive programs must be placed in unique designated folders based on\n  CGI or ASP script type.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions. Each script type must be in its unique\n  designated folder.\n\n  If scripts are not segregated from web content and in their own unique folders,\n  then this is a finding.\"\n  tag \"fix\": \"All interactive programs must be placed in unique designated\n  folders based on CGI or ASP script type.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web server name and select Explore.\n\n  Search for the listed script extensions.\n\n  Move each script type to its unique designated folder.\n\n  Set the permissions to the scripts folders as follows:\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  SYSTEM: FULL\n  ApplicationPoolId:READ\n  Custom Service Account: READ\n  Users: READ\n  ALL APPLICATION PACKAGES: READ\n  \"\n  describe 'Manual review of website is needed' do\n    skip \"Manually review to confirm that that interactive scripts on the\n    IIS 8.5 web server is located in unique and designated folders\"\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76885.rb"},"results":[{"status":"skipped","code_desc":"Manual review of website is needed","run_time":6.0e-06,"start_time":"2019-02-04T07:10:00-08:00","resource":"","skip_message":"Manually review to confirm that that interactive scripts on the\n    IIS 8.5 web server is located in unique and designated folders"}]},{"id":"V-76887","title":"Interactive scripts on the IIS 8.5 web server must have restrictive\n  access controls.","desc":"CGI is a programming standard for interfacing external applications\n  with information servers, such as HTTP or web servers. CGI, represented by all\n  upper case letters, should not be confused with the .cgi file extension. The\n  .cgi file extension does represent a CGI script, but CGI scripts may be written\n  in a number of programming languages (e.g., PERL, C, PHP, and JavaScript), each\n  having their own unique file extension.\n\n      The use of CGI scripts represent one of the most common and exploitable\n  means of compromising a web server. By definition, CGI scripts are executable\n  by the operating system of the host server. While access control is provided\n  via the web service, the execution of CGI programs is not limited unless the SA\n  or the Web Manager takes specific measures. CGI programs can access and alter\n  data files, launch other programs, and use the network.","descriptions":[{"label":"default","data":"CGI is a programming standard for interfacing external applications\n  with information servers, such as HTTP or web servers. CGI, represented by all\n  upper case letters, should not be confused with the .cgi file extension. The\n  .cgi file extension does represent a CGI script, but CGI scripts may be written\n  in a number of programming languages (e.g., PERL, C, PHP, and JavaScript), each\n  having their own unique file extension.\n\n      The use of CGI scripts represent one of the most common and exploitable\n  means of compromising a web server. By definition, CGI scripts are executable\n  by the operating system of the host server. While access control is provided\n  via the web service, the execution of CGI programs is not limited unless the SA\n  or the Web Manager takes specific measures. CGI programs can access and alter\n  data files, launch other programs, and use the network."}],"impact":0.5,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000087","gid":"V-76887","rid":"SV-91583r1_rule","stig_id":"IISW-SI-000262","fix_id":"F-83583r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is Not Applicable.\n\n  All interactive programs must have restrictive permissions.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions.\n\n  Review the permissions to the CGI scripts and verify only the permissions\n  listed, or more restrictive permissions are assigned.\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  ALL APPLICATION PACKAGES: Read\n  SYSTEM: FULL\n  ApplicationPoolId: READ\n  Custom Service Account: READ\n  Users: READ\n\n  If the permissions are less restrictive than listed above, this is a finding.","fix":"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is NA.\n\n  All interactive programs must have restrictive permissions.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web server name and select Explore.\n\n  Search for the listed script extensions.\n\n  Set the permissions to the CGI scripts as follows:\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  ALL APPLICATION PACKAGES: Read\n  SYSTEM: FULL\n  ApplicationPoolId: READ\n  Custom Service Account: READ\n  Users: READ"},"code":"control 'V-76887' do\n  title \"Interactive scripts on the IIS 8.5 web server must have restrictive\n  access controls.\"\n  desc \"CGI is a programming standard for interfacing external applications\n  with information servers, such as HTTP or web servers. CGI, represented by all\n  upper case letters, should not be confused with the .cgi file extension. The\n  .cgi file extension does represent a CGI script, but CGI scripts may be written\n  in a number of programming languages (e.g., PERL, C, PHP, and JavaScript), each\n  having their own unique file extension.\n\n      The use of CGI scripts represent one of the most common and exploitable\n  means of compromising a web server. By definition, CGI scripts are executable\n  by the operating system of the host server. While access control is provided\n  via the web service, the execution of CGI programs is not limited unless the SA\n  or the Web Manager takes specific measures. CGI programs can access and alter\n  data files, launch other programs, and use the network.\n  \"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000087'\n  tag \"gid\": 'V-76887'\n  tag \"rid\": 'SV-91583r1_rule'\n  tag \"stig_id\": 'IISW-SI-000262'\n  tag \"fix_id\": 'F-83583r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is Not Applicable.\n\n  All interactive programs must have restrictive permissions.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions.\n\n  Review the permissions to the CGI scripts and verify only the permissions\n  listed, or more restrictive permissions are assigned.\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  ALL APPLICATION PACKAGES: Read\n  SYSTEM: FULL\n  ApplicationPoolId: READ\n  Custom Service Account: READ\n  Users: READ\n\n  If the permissions are less restrictive than listed above, this is a finding.\"\n  tag \"fix\": \"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is NA.\n\n  All interactive programs must have restrictive permissions.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web server name and select Explore.\n\n  Search for the listed script extensions.\n\n  Set the permissions to the CGI scripts as follows:\n\n  Administrators: FULL\n  TrustedInstaller: FULL\n  ALL APPLICATION PACKAGES: Read\n  SYSTEM: FULL\n  ApplicationPoolId: READ\n  Custom Service Account: READ\n  Users: READ\"\n  describe 'Manual review of website is needed' do\n    skip \"Manually review to confirm that Interactive scripts on the IIS 8.5 web\n    server has restrictive access controls\"\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76887.rb"},"results":[{"status":"skipped","code_desc":"Manual review of website is needed","run_time":6.0e-06,"start_time":"2019-02-04T07:10:00-08:00","resource":"","skip_message":"Manually review to confirm that Interactive scripts on the IIS 8.5 web\n    server has restrictive access controls"}]},{"id":"V-76889","title":"Backup interactive scripts on the IIS 8.5 server must be removed.","desc":"CgiMowdule not installed hence the control not applicable","descriptions":[{"label":"default","data":"CgiMowdule not installed hence the control not applicable"}],"impact":0.0,"refs":[],"tags":{"gtitle":"SRG-APP-000141-WSR-000087","gid":"V-76889","rid":"SV-91585r1_rule","stig_id":"IISW-SI-000263","fix_id":"F-83585r1_fix","cci":["CCI-000381"],"nist":["CM-7 a","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is Not Applicable.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions\n\n  Search for the following files: *.bak, *.old, *.temp, *.tmp, *.backup, or copy\n  of....\n\n  If files with these extensions are found, this is a finding.","fix":"Remove the backup files from the production web server."},"code":"control 'V-76889' do\n  title 'Backup interactive scripts on the IIS 8.5 server must be removed.'\n  desc  \"Copies of backup files will not execute on the server, but they can be\n  read by the anonymous user if special precautions are not taken. Such backup\n  copies contain the same sensitive information as the actual script being\n  executed and, as such, are useful to malicious users. Techniques and systems\n  exist today to search web servers for such files and are able to exploit the\n  information contained in them.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000141-WSR-000087'\n  tag \"gid\": 'V-76889'\n  tag \"rid\": 'SV-91585r1_rule'\n  tag \"stig_id\": 'IISW-SI-000263'\n  tag \"fix_id\": 'F-83585r1_fix'\n  tag \"cci\": ['CCI-000381']\n  tag \"nist\": ['CM-7 a', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Determine whether scripts are used on the web server for the\n  subject website. Common file extensions include, but are not limited to: .cgi,\n  .pl, .vb, .class, .c, .php, .asp, and .aspx.\n\n  If the website does not utilize CGI, this finding is Not Applicable.\n\n  Open the IIS 8.5 Manager.\n\n  Right-click the IIS 8.5 web site name and select Explore.\n\n  Search for the listed script extensions\n\n  Search for the following files: *.bak, *.old, *.temp, *.tmp, *.backup, or copy\n  of....\n\n  If files with these extensions are found, this is a finding.\"\n  tag \"fix\": 'Remove the backup files from the production web server.'\n\n  iis_modules = command('Get-WebConfiguration  system.webServer/globalModules/*').stdout.strip\n\n  unless iis_modules.include?('CgiMowdule')\n    impact 0.0\n    desc 'CgiMowdule not installed hence the control not applicable'\n  end\n\n  describe 'Manual review of website is needed' do\n    skip 'Manual review that Backup interactive scripts on the IIS 8.5 server is removed'\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76889.rb"},"results":[{"status":"skipped","code_desc":"Manual review of website is needed","run_time":3.0e-06,"start_time":"2019-02-04T07:10:00-08:00","resource":"","skip_message":"Manual review that Backup interactive scripts on the IIS 8.5 server is removed"}]},{"id":"V-76891","title":"The required CMS banner page must be displayed to authenticated users accessing \n          a CMS private website.","desc":"A consent banner will be in place to make prospective entrants aware that the \n         website they are about to enter is a CMS web site and their activity is subject \n         to monitoring.\n\n         The requirement for the banner is for websites with security and access controls. \n         These are restricted and not publicly accessible. If the website does not require \n         authentication/authorization for use, then the banner does not need to be present. \n         A manual check of the document root directory for a banner page file (such as \n         banner.html) or navigation to the website via a browser can be used to confirm the \n         information provided from interviewing the web staff.","descriptions":[{"label":"default","data":"A consent banner will be in place to make prospective entrants aware that the \n         website they are about to enter is a CMS web site and their activity is subject \n         to monitoring.\n\n         The requirement for the banner is for websites with security and access controls. \n         These are restricted and not publicly accessible. If the website does not require \n         authentication/authorization for use, then the banner does not need to be present. \n         A manual check of the document root directory for a banner page file (such as \n         banner.html) or navigation to the website via a browser can be used to confirm the \n         information provided from interviewing the web staff."},{"label":"check","data":"Note: This requirement is only applicable for private CMS websites.\n\n         If a banner is required, the following banner page must be in place: \n\n         * This warning banner provides privacy and security notices consistent with \n         applicable federal laws, directives, and other federal guidance for accessing this \n         Government system, which includes (1) this computer network, (2) all computers \n         connected to this network, and (3) all devices and storage media attached to this \n         network or to a computer on this network.  \n\n         * This system is provided for Government authorized use only.  \n         \n         * Unauthorized or improper use of this system is prohibited and may result in \n         disciplinary action and/or civil and criminal penalties.  \n         \n         * Personal use of social media and networking sites on this system is limited as to \n         not interfere with official work duties and is subject to monitoring.  \n\n         * By using this system, you understand and consent to the following:   \n\n                  - The Government may monitor, record, and audit your system usage, including usage \n                  of personal devices and email systems for official duties or to conduct HHS \n                  business. Therefore, you have no reasonable expectation of privacy regarding any \n                  communication or data transiting or stored on this system. At any time, and for any \n                  lawful Government purpose, the government may monitor, intercept, and search and \n                  seize any communication or data transiting or stored on this system.     \n         \n                  - Any communication or data transiting or stored on this system may be disclosed or \n                   used for any lawful Government purpose. \n\n         If the access-controlled website does not display this banner page before entry, \n         this is a finding."},{"label":"fix","data":"Configure a CMS private website to display the required CMS banner page when \n         authentication is required for user access."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{"gtitle":"SRG-APP-000516-WSR-000174","gid":"V-76891","rid":"SV-91587r1_rule","stig_id":"IISW-SI-000264","fix_id":"F-83587r1_fix","cci":["CCI-000366"],"nist":["CM-6 b","Rev_4"],"false_negatives":null,"false_positives":null,"documentable":false,"mitigations":null,"severity_override_guidance":false,"potential_impacts":null,"third_party_tools":null,"mitigation_controls":null,"responsibility":null,"ia_controls":null,"check":"Note: This requirement is only applicable for private DoD\n  websites.\n\n  If a banner is required, the following banner page must be in place:\n\n  You are accessing a U.S. Government (USG) Information System (IS) that is\n  provided for USG-authorized use only.\n\n  By using this IS (which includes any device attached to this IS), you consent\n  to the following conditions:\n\n  -The USG routinely intercepts and monitors communications on this IS for\n  purposes including, but not limited to, penetration testing, COMSEC monitoring,\n  network operations and defense, personnel misconduct (PM), law enforcement\n  (LE), and counterintelligence (CI) investigations.\n\n  - At any time, the USG may inspect and seize data stored on this IS.\n\n  - Communications using, or data stored on, this IS are not private, are subject\n  to routine monitoring, interception, and search, and may be disclosed or used\n  for any USG-authorized purpose.\n\n  - This IS includes security measures (e.g., authentication and access controls)\n  to protect USG interests—not for your personal benefit or privacy.\n\n  - Notwithstanding the above, using this IS does not constitute consent to PM,\n  LE or CI investigative searching or monitoring of the content of privileged\n  communications, or work product, related to personal representation or services\n  by attorneys, psychotherapists, or clergy, and their assistants. Such\n  communications and work product are private and confidential. See User\n  Agreement for details.\n\n  OR\n\n  If your system cannot meet the character limits to store this amount of text in\n  the banner, the following is another option for the warning banner:\n\n  \"I've read & consent to terms in IS user agreem't.\"\n\n  NOTE: While DoDI 8500.01 does not contain a copy of the banner to be used, it\n  does point to the RMF Knowledge Service for a copy of the required text. It is\n  also noted that the banner is to be displayed only once when the individual\n  enters the site and not for each page.\n\n  If the access-controlled website does not display this banner page before\n  entry, this is a finding.","fix":"Configure a DoD private website to display the required DoD\n  banner page when authentication is required for user access."},"code":"control 'V-76891' do\n  title \"The required DoD banner page must be displayed to authenticated users\n  accessing a DoD private website.\"\n  desc \"A consent banner will be in place to make prospective entrants aware\n  that the website they are about to enter is a DoD web site and their activity\n  is subject to monitoring. The document, DoDI 8500.01, establishes the policy on\n  the use of DoD information systems. It requires the use of a standard Notice\n  and Consent Banner and standard text to be included in user agreements. The\n  requirement for the banner is for websites with security and access controls.\n  These are restricted and not publicly accessible. If the website does not\n  require authentication/authorization for use, then the banner does not need to\n  be present. A manual check of the document root directory for a banner page\n  file (such as banner.html) or navigation to the website via a browser can be\n  used to confirm the information provided from interviewing the web staff.\"\n  impact 0.5\n  tag \"gtitle\": 'SRG-APP-000516-WSR-000174'\n  tag \"gid\": 'V-76891'\n  tag \"rid\": 'SV-91587r1_rule'\n  tag \"stig_id\": 'IISW-SI-000264'\n  tag \"fix_id\": 'F-83587r1_fix'\n  tag \"cci\": ['CCI-000366']\n  tag \"nist\": ['CM-6 b', 'Rev_4']\n  tag \"false_negatives\": nil\n  tag \"false_positives\": nil\n  tag \"documentable\": false\n  tag \"mitigations\": nil\n  tag \"severity_override_guidance\": false\n  tag \"potential_impacts\": nil\n  tag \"third_party_tools\": nil\n  tag \"mitigation_controls\": nil\n  tag \"responsibility\": nil\n  tag \"ia_controls\": nil\n  tag \"check\": \"Note: This requirement is only applicable for private DoD\n  websites.\n\n  If a banner is required, the following banner page must be in place:\n\n  You are accessing a U.S. Government (USG) Information System (IS) that is\n  provided for USG-authorized use only.\n\n  By using this IS (which includes any device attached to this IS), you consent\n  to the following conditions:\n\n  -The USG routinely intercepts and monitors communications on this IS for\n  purposes including, but not limited to, penetration testing, COMSEC monitoring,\n  network operations and defense, personnel misconduct (PM), law enforcement\n  (LE), and counterintelligence (CI) investigations.\n\n  - At any time, the USG may inspect and seize data stored on this IS.\n\n  - Communications using, or data stored on, this IS are not private, are subject\n  to routine monitoring, interception, and search, and may be disclosed or used\n  for any USG-authorized purpose.\n\n  - This IS includes security measures (e.g., authentication and access controls)\n  to protect USG interests—not for your personal benefit or privacy.\n\n  - Notwithstanding the above, using this IS does not constitute consent to PM,\n  LE or CI investigative searching or monitoring of the content of privileged\n  communications, or work product, related to personal representation or services\n  by attorneys, psychotherapists, or clergy, and their assistants. Such\n  communications and work product are private and confidential. See User\n  Agreement for details.\n\n  OR\n\n  If your system cannot meet the character limits to store this amount of text in\n  the banner, the following is another option for the warning banner:\n\n  \\\"I've read & consent to terms in IS user agreem't.\\\"\n\n  NOTE: While DoDI 8500.01 does not contain a copy of the banner to be used, it\n  does point to the RMF Knowledge Service for a copy of the required text. It is\n  also noted that the banner is to be displayed only once when the individual\n  enters the site and not for each page.\n\n  If the access-controlled website does not display this banner page before\n  entry, this is a finding.\"\n  tag \"fix\": \"Configure a DoD private website to display the required DoD\n  banner page when authentication is required for user access.\"\n\n  describe 'Manual review of website is needed' do\n    skip \"Manual review that required DoD banner page must is displayed to authenticated users\n    accessing a DoD private website\"\n  end\nend\n","source_location":{"line":1,"ref":"C:/Users/Administrator/Desktop/microsoft-iis-8.5-site-stig-baseline/controls/V-76891.rb"},"results":[{"status":"skipped","code_desc":"Manual review of website is needed","run_time":5.0e-06,"start_time":"2019-02-04T07:10:00-08:00","resource":"","skip_message":"Manual review that required CMS banner page is displayed to authenticated \n           users accessing a CMS private website"}]}],"status":"loaded"}],"statistics":{"duration":1.20063},"version":"3.5.0"}