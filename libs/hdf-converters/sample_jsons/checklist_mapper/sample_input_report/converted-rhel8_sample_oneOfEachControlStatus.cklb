{"stigs":[{"stig_name":"redhat-enterprise-linux-8-stig-baseline","display_name":"redhat-enterprise-linux-8-stig-baseline","version":"1","stig_id":"redhat-enterprise-linux-8-stig-baseline","release_info":"Release: 13","size":4,"rules":[{"group_id":"SV-230221","group_id_src":"SV-230221","severity":"high","group_title":"SRG-OS-000480-GPOS-00227","rule_id_src":"SV-230221r858734_rule","rule_id":"SV-230221r858734","rule_version":"RHEL-08-010000","rule_title":"RHEL 8 must be a vendor-supported release.","discussion":"An operating system release is considered \"supported\" if the vendor continues to provide security patches for the product. With an unsupported release, it will not be possible to resolve security issues discovered in the system software.\n\n  Red Hat offers the Extended Update Support (EUS) add-on to a Red Hat Enterprise Linux subscription, for a fee, for those customers who wish to standardize on a specific minor release for an extended period. The RHEL 8 minor releases eligible for EUS are 8.1, 8.2, 8.4, 8.6, and 8.8. Each RHEL 8 EUS stream is available for 24 months from the availability of the minor release. RHEL 8.10 will be the final minor release overall. For more details on the Red Hat Enterprise Linux Life Cycle  visit https://access.redhat.com/support/policy/updates/errata/.\n\n  Note: The life-cycle time spans and dates are subject to adjustment.","ia_controls":"","check_content":"Verify the version of the operating system is vendor supported.\n\nNote: The lifecycle time spans and dates are subject to adjustment.\n\nCheck the version of the operating system with the following command:\n\n$ sudo cat /etc/redhat-release\n\nRed Hat Enterprise Linux Server release 8.6 (Ootpa)\n\nCurrent End of Extended Update Support for RHEL 8.1 is 30 November 2021.\n\nCurrent End of Extended Update Support for RHEL 8.2 is 30 April 2022.\n\nCurrent End of Extended Update Support for RHEL 8.4 is 31 May 2023.\n\nCurrent End of Maintenance Support for RHEL 8.5 is 31 May 2022.\n\nCurrent End of Extended Update Support for RHEL 8.6 is 31 May 2024.\n\nCurrent End of Maintenance Support for RHEL 8.7 is 31 May 2023.\n\nCurrent End of Extended Update Support for RHEL 8.8 is 31 May 2025.\n\nCurrent End of Maintenance Support for RHEL 8.9 is 31 May 2024.\n\nCurrent End of Maintenance Support for RHEL 8.10 is 31 May 2029.\n\nIf the release is not supported by the vendor, this is a finding.","fix_text":"Upgrade to a supported version of RHEL 8.","false_positives":"","false_negatives":"","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"{\n  \"hdfSpecificData\": {\n    \"code\": \"control 'SV-230221' do\\n  title 'RHEL 8 must be a vendor-supported release.'\\n  desc 'An operating system release is considered \\\"supported\\\" if the vendor continues to provide security patches for the product. With an unsupported release, it will not be possible to resolve security issues discovered in the system software.\\n\\n  Red Hat offers the Extended Update Support (EUS) add-on to a Red Hat Enterprise Linux subscription, for a fee, for those customers who wish to standardize on a specific minor release for an extended period. The RHEL 8 minor releases eligible for EUS are 8.1, 8.2, 8.4, 8.6, and 8.8. Each RHEL 8 EUS stream is available for 24 months from the availability of the minor release. RHEL 8.10 will be the final minor release overall. For more details on the Red Hat Enterprise Linux Life Cycle  visit https://access.redhat.com/support/policy/updates/errata/.\\n\\n  Note: The life-cycle time spans and dates are subject to adjustment.'\\n  desc 'check', 'Verify the version of the operating system is vendor supported.\\n\\nNote: The lifecycle time spans and dates are subject to adjustment.\\n\\nCheck the version of the operating system with the following command:\\n\\n$ sudo cat /etc/redhat-release\\n\\nRed Hat Enterprise Linux Server release 8.6 (Ootpa)\\n\\nCurrent End of Extended Update Support for RHEL 8.1 is 30 November 2021.\\n\\nCurrent End of Extended Update Support for RHEL 8.2 is 30 April 2022.\\n\\nCurrent End of Extended Update Support for RHEL 8.4 is 31 May 2023.\\n\\nCurrent End of Maintenance Support for RHEL 8.5 is 31 May 2022.\\n\\nCurrent End of Extended Update Support for RHEL 8.6 is 31 May 2024.\\n\\nCurrent End of Maintenance Support for RHEL 8.7 is 31 May 2023.\\n\\nCurrent End of Extended Update Support for RHEL 8.8 is 31 May 2025.\\n\\nCurrent End of Maintenance Support for RHEL 8.9 is 31 May 2024.\\n\\nCurrent End of Maintenance Support for RHEL 8.10 is 31 May 2029.\\n\\nIf the release is not supported by the vendor, this is a finding.'\\n  desc 'fix', 'Upgrade to a supported version of RHEL 8.'\\n  impact 0.7\\n  tag severity: 'high'\\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\\n  tag gid: 'V-230221'\\n  tag rid: 'SV-230221r858734_rule'\\n  tag stig_id: 'RHEL-08-010000'\\n  tag fix_id: 'F-32865r567410_fix'\\n  tag cci: ['CCI-000366']\\n  tag nist: ['CM-6 b']\\n  tag 'host'\\n  tag 'container'\\n\\n  release = os.release\\n\\n  EOMS_DATE = {\\n    /^8\\\\.1/ => '30 November 2021',\\n    /^8\\\\.2/ => '30 April 2022',\\n    /^8\\\\.3/ => '30 April 2021',\\n    /^8\\\\.4/ => '31 May 2023',\\n    /^8\\\\.5/ => '31 May 2022',\\n    /^8\\\\.6/ => '31 May 2024',\\n    /^8\\\\.7/ => '31 May 2023',\\n    /^8\\\\.8/ => '31 May 2025',\\n    /^8\\\\.9/ => '31 May 2024',\\n    /^8\\\\.10/ => '31 May 2029'\\n  }.find { |k, _v| k.match(release) }&.last\\n\\n  describe \\\"The release \\\\\\\"#{release}\\\\\\\" is still be within the support window\\\" do\\n    it \\\"ending on #{EOMS_DATE}\\\" do\\n      expect(Date.today).to be <= Date.parse(EOMS_DATE)\\n    end\\n  end\\nend\\n\"\n  }\n}","mitigation_control":"","responsibility":"","security_override_guidance":"","check_content_ref":{"name":"M","href":""},"weight":"10.0","classification":"Unclass","legacy_ids":[],"ccis":["CCI-000366"],"stig_ref":"redhat-enterprise-linux-8-stig-baseline :: Version 1, Release: 13","target_key":"","uuid":"2c02f570-1aee-47e1-a22b-d014f261e27d","comments":"","finding_details":"passed :: TEST The release \"8.9\" is still be within the support window ending on 31 May 2024","group_tree":[],"status":"not_a_finding","overrides":{}},{"group_id":"SV-230222","group_id_src":"SV-230222","severity":"medium","group_title":"SRG-OS-000480-GPOS-00227","rule_id_src":"SV-230222r627750_rule","rule_id":"SV-230222r627750","rule_version":"RHEL-08-010010","rule_title":"RHEL 8 vendor packaged system security patches and updates must be installed and up to date.","discussion":"Timely patching is critical for maintaining the operational\n    availability, confidentiality, and integrity of information technology (IT)\n    systems. However, failure to keep operating system and application software\n    patched is a common mistake made by IT professionals. New patches are released\n    daily, and it is often difficult for even experienced System Administrators to\n    keep abreast of all the new patches. When new weaknesses in an operating system\n    exist, patches are usually made available by the vendor to resolve the\n    problems. If the most recent security patches and updates are not installed,\n    unauthorized users may take advantage of weaknesses in the unpatched software.\n    The lack of prompt attention to patching could result in a system compromise.","ia_controls":"","check_content":"Verify the operating system security patches and updates are installed and\n    up to date. Updates are required to be applied with a frequency determined by\n    the site or Program Management Office (PMO).\n\n    Obtain the list of available package security updates from Red Hat. The URL\n    for updates is https://rhn.redhat.com/errata/. It is important to note that\n    updates provided by Red Hat may not be present on the system if the underlying\n    packages are not installed.\n\n    Check that the available package security updates have been installed on\n    the system with the following command:\n\n        $ sudo yum history list | more\n\n        Loaded plugins: langpacks, product-id, subscription-manager\n        ID | Command line | Date and time | Action(s) | Altered\n\n    -------------------------------------------------------------------------------\n        70 | install aide | 2020-03-05 10:58 | Install | 1\n        69 | update -y | 2020-03-04 14:34 | Update | 18 EE\n        68 | install vlc | 2020-02-21 17:12 | Install | 21\n        67 | update -y | 2020-02-21 17:04 | Update | 7 EE\n\n    If package updates have not been performed on the system within the\n    timeframe the site/program documentation requires, this is a finding.\n\n    Typical update frequency may be overridden by Information Assurance\n    Vulnerability Alert (IAVA) notifications from CYBERCOM.\n\n    If the operating system is in non-compliance with the Information Assurance\n    Vulnerability Management (IAVM) process, this is a finding.","fix_text":"Install the operating system patches or updated packages\n    available from Red Hat within 30 days or sooner as local policy dictates.","false_positives":"","false_negatives":"","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"{\n  \"hdfSpecificData\": {\n    \"code\": \"control 'SV-230222' do\\n  title 'RHEL 8 vendor packaged system security patches and updates must be installed and up to date.'\\n  desc 'Timely patching is critical for maintaining the operational\\n    availability, confidentiality, and integrity of information technology (IT)\\n    systems. However, failure to keep operating system and application software\\n    patched is a common mistake made by IT professionals. New patches are released\\n    daily, and it is often difficult for even experienced System Administrators to\\n    keep abreast of all the new patches. When new weaknesses in an operating system\\n    exist, patches are usually made available by the vendor to resolve the\\n    problems. If the most recent security patches and updates are not installed,\\n    unauthorized users may take advantage of weaknesses in the unpatched software.\\n    The lack of prompt attention to patching could result in a system compromise.'\\n  desc 'check', 'Verify the operating system security patches and updates are installed and\\n    up to date. Updates are required to be applied with a frequency determined by\\n    the site or Program Management Office (PMO).\\n\\n    Obtain the list of available package security updates from Red Hat. The URL\\n    for updates is https://rhn.redhat.com/errata/. It is important to note that\\n    updates provided by Red Hat may not be present on the system if the underlying\\n    packages are not installed.\\n\\n    Check that the available package security updates have been installed on\\n    the system with the following command:\\n\\n        $ sudo yum history list | more\\n\\n        Loaded plugins: langpacks, product-id, subscription-manager\\n        ID | Command line | Date and time | Action(s) | Altered\\n\\n    -------------------------------------------------------------------------------\\n        70 | install aide | 2020-03-05 10:58 | Install | 1\\n        69 | update -y | 2020-03-04 14:34 | Update | 18 EE\\n        68 | install vlc | 2020-02-21 17:12 | Install | 21\\n        67 | update -y | 2020-02-21 17:04 | Update | 7 EE\\n\\n    If package updates have not been performed on the system within the\\n    timeframe the site/program documentation requires, this is a finding.\\n\\n    Typical update frequency may be overridden by Information Assurance\\n    Vulnerability Alert (IAVA) notifications from CYBERCOM.\\n\\n    If the operating system is in non-compliance with the Information Assurance\\n    Vulnerability Management (IAVM) process, this is a finding.'\\n  desc 'fix', 'Install the operating system patches or updated packages\\n    available from Red Hat within 30 days or sooner as local policy dictates.'\\n  impact 0.5\\n  tag severity: 'medium'\\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\\n  tag gid: 'V-230222'\\n  tag rid: 'SV-230222r627750_rule'\\n  tag stig_id: 'RHEL-08-010010'\\n  tag fix_id: 'F-32866r567413_fix'\\n  tag cci: ['CCI-000366']\\n  tag nist: ['CM-6 b']\\n  tag 'host'\\n  tag 'container'\\n\\n  only_if(\\\"This control takes a long time to execute so it has been disabled through 'slow_controls'\\\") {\\n    !input('disable_slow_controls')\\n  }\\n\\n  if input('disconnected_system')\\n    describe 'The system is set to a `disconnected` state and you must validate the state of the system packages manually' do\\n      skip 'The system is set to a `disconnected` state and you must validate the state of the system packages manually'\\n    end\\n  else\\n    updates = linux_update.updates\\n    package_names = updates.map { |h| h['name'] }\\n\\n    describe.one do\\n      describe 'List of out-of-date packages' do\\n        subject { package_names }\\n        it { should be_empty }\\n      end\\n      updates.each do |update|\\n        describe package(update['name']) do\\n          its('version') { should eq update['version'] }\\n        end\\n      end\\n    end\\n  end\\nend\\n\"\n  }\n}","mitigation_control":"","responsibility":"","security_override_guidance":"","check_content_ref":{"name":"M","href":""},"weight":"10.0","classification":"Unclass","legacy_ids":[],"ccis":["CCI-000366"],"stig_ref":"redhat-enterprise-linux-8-stig-baseline :: Version 1, Release: 13","target_key":"","uuid":"8ec78e6a-011c-4630-b26c-eabecc882e65","comments":"","finding_details":"failed :: TEST List of out-of-date packages is expected to be empty :: MESSAGE expected `[\"libsemanage\"].empty?` to be truthy, got false\n--------------------------------\nfailed :: TEST System Package libsemanage version is expected to eq \"2.9-9.el8_6\" :: MESSAGE \nexpected: \"2.9-9.el8_6\"\n     got: \"2.9-9.el8\"\n\n(compared using ==)","group_tree":[],"status":"open","overrides":{}},{"group_id":"SV-230223","group_id_src":"SV-230223","severity":"high","group_title":"SRG-OS-000033-GPOS-00014","rule_id_src":"SV-230223r928585_rule","rule_id":"SV-230223r928585","rule_version":"RHEL-08-010020","rule_title":"RHEL 8 must implement NIST FIPS-validated cryptography for the following: To provision digital signatures, to generate cryptographic hashes, and to protect data requiring data-at-rest protections in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards.","discussion":"Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\nRHEL 8 utilizes GRUB 2 as the default bootloader. Note that GRUB 2 command-line parameters are defined in the \"kernelopts\" variable of the /boot/grub2/grubenv file for all kernel boot entries. The command \"fips-mode-setup\" modifies the \"kernelopts\" variable, which in turn updates all kernel boot entries.\n\nThe fips=1 kernel option needs to be added to the kernel command line during system installation so that key generation is done with FIPS-approved algorithms and continuous monitoring tests in place. Users must also ensure the system has plenty of entropy during the installation process by moving the mouse around, or if no mouse is available, ensuring that many keystrokes are typed. The recommended amount of keystrokes is 256 and more. Less than 256 keystrokes may generate a nonunique key.","ia_controls":"","check_content":"Verify the operating system implements DOD-approved encryption to protect the confidentiality of remote access sessions.\n\nCheck to see if FIPS mode is enabled with the following command:\n\n     $ fips-mode-setup --check\n     FIPS mode is enabled\n\nIf FIPS mode is \"enabled\", check to see if the kernel boot parameter is configured for FIPS mode with the following command:\n\n     $ sudo grub2-editenv list | grep fips\n     kernelopts=root=/dev/mapper/rhel-root ro crashkernel=auto resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet fips=1 boot=UUID=8d171156-cd61-421c-ba41-1c021ac29e82\n\nIf the kernel boot parameter is configured to use FIPS mode, check to see if the system is in FIPS mode with the following command:\n\n     $ sudo cat /proc/sys/crypto/fips_enabled\n     1\n\nIf FIPS mode is not \"on\", the kernel boot parameter is not configured for FIPS mode, or the system does not have a value of \"1\" for \"fips_enabled\" in \"/proc/sys/crypto\", this is a finding.","fix_text":"Configure the operating system to implement DOD-approved encryption by following the steps below:\n\nTo enable strict FIPS compliance, the fips=1 kernel option needs to be added to the kernel boot parameters during system installation so key generation is done with FIPS-approved algorithms and continuous monitoring tests in place.\n\nEnable FIPS mode after installation (not strict FIPS-compliant) with the following command:\n\n     $ sudo fips-mode-setup --enable\n\nReboot the system for the changes to take effect.","false_positives":"","false_negatives":"","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"{\n  \"hdfSpecificData\": {\n    \"code\": \"control 'SV-230223' do\\n  title 'RHEL 8 must implement NIST FIPS-validated cryptography for the following: To provision digital signatures, to generate cryptographic hashes, and to protect data requiring data-at-rest protections in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards.'\\n  desc 'Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\\n\\nRHEL 8 utilizes GRUB 2 as the default bootloader. Note that GRUB 2 command-line parameters are defined in the \\\"kernelopts\\\" variable of the /boot/grub2/grubenv file for all kernel boot entries. The command \\\"fips-mode-setup\\\" modifies the \\\"kernelopts\\\" variable, which in turn updates all kernel boot entries.\\n\\nThe fips=1 kernel option needs to be added to the kernel command line during system installation so that key generation is done with FIPS-approved algorithms and continuous monitoring tests in place. Users must also ensure the system has plenty of entropy during the installation process by moving the mouse around, or if no mouse is available, ensuring that many keystrokes are typed. The recommended amount of keystrokes is 256 and more. Less than 256 keystrokes may generate a nonunique key.'\\n  desc 'check', 'Verify the operating system implements DOD-approved encryption to protect the confidentiality of remote access sessions.\\n\\nCheck to see if FIPS mode is enabled with the following command:\\n\\n     $ fips-mode-setup --check\\n     FIPS mode is enabled\\n\\nIf FIPS mode is \\\"enabled\\\", check to see if the kernel boot parameter is configured for FIPS mode with the following command:\\n\\n     $ sudo grub2-editenv list | grep fips\\n     kernelopts=root=/dev/mapper/rhel-root ro crashkernel=auto resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet fips=1 boot=UUID=8d171156-cd61-421c-ba41-1c021ac29e82\\n\\nIf the kernel boot parameter is configured to use FIPS mode, check to see if the system is in FIPS mode with the following command:\\n\\n     $ sudo cat /proc/sys/crypto/fips_enabled\\n     1\\n\\nIf FIPS mode is not \\\"on\\\", the kernel boot parameter is not configured for FIPS mode, or the system does not have a value of \\\"1\\\" for \\\"fips_enabled\\\" in \\\"/proc/sys/crypto\\\", this is a finding.'\\n  desc 'fix', 'Configure the operating system to implement DOD-approved encryption by following the steps below:\\n\\nTo enable strict FIPS compliance, the fips=1 kernel option needs to be added to the kernel boot parameters during system installation so key generation is done with FIPS-approved algorithms and continuous monitoring tests in place.\\n\\nEnable FIPS mode after installation (not strict FIPS-compliant) with the following command:\\n\\n     $ sudo fips-mode-setup --enable\\n\\nReboot the system for the changes to take effect.'\\n  impact 0.7\\n  tag severity: 'high'\\n  tag gtitle: 'SRG-OS-000033-GPOS-00014'\\n  tag satisfies: ['SRG-OS-000033-GPOS-00014', 'SRG-OS-000125-GPOS-00065', 'SRG-OS-000396-GPOS-00176', 'SRG-OS-000423-GPOS-00187', 'SRG-OS-000478-GPOS-00223']\\n  tag gid: 'V-230223'\\n  tag rid: 'SV-230223r928585_rule'\\n  tag stig_id: 'RHEL-08-010020'\\n  tag fix_id: 'F-32867r928584_fix'\\n  tag cci: ['CCI-000068']\\n  tag nist: ['AC-17 (2)']\\n  tag 'host'\\n\\n  if virtualization.system.eql?('docker')\\n    impact 0.0\\n    describe 'Control not applicable in a container' do\\n      skip 'The host OS controls the FIPS mode settings. The host OS should also be scanned with the applicable OS validation profile.'\\n    end\\n  elsif input('use_fips') == false\\n    impact 0.0\\n    describe 'This control is Not Applicable as FIPS is not required for this system' do\\n      skip 'This control is Not Applicable as FIPS is not required for this system'\\n    end\\n  else\\n    describe command('fips-mode-setup --check') do\\n      its('stdout.strip') { should match(/FIPS mode is enabled/) }\\n    end\\n\\n    grub_config = command('grub2-editenv - list').stdout\\n\\n    describe parse_config(grub_config) do\\n      its('kernelopts') { should match(/fips=1/) }\\n    end\\n\\n    describe file('/proc/sys/crypto/fips_enabled') do\\n      its('content.strip') { should cmp '1' }\\n    end\\n  end\\nend\\n\"\n  }\n}","mitigation_control":"","responsibility":"","security_override_guidance":"","check_content_ref":{"name":"M","href":""},"weight":"10.0","classification":"Unclass","legacy_ids":[],"ccis":["CCI-000068"],"stig_ref":"redhat-enterprise-linux-8-stig-baseline :: Version 1, Release: 13","target_key":"","uuid":"2d4cb49a-7232-4a4c-9b57-080e24a7cdbe","comments":"","finding_details":"skipped :: TEST Control not applicable in a container :: SKIP_MESSAGE The host OS controls the FIPS mode settings. The host OS should also be scanned with the applicable OS validation profile.","group_tree":[],"status":"not_applicable","overrides":{}},{"group_id":"SV-230328","group_id_src":"SV-230328","severity":"medium","group_title":"SRG-OS-000480-GPOS-00227","rule_id_src":"SV-230328r902723_rule","rule_id":"SV-230328r902723","rule_version":"RHEL-08-010800","rule_title":"A separate RHEL 8 filesystem must be used for user home directories\n(such as /home or an equivalent).","discussion":"The use of separate file systems for different paths can protect the\nsystem from failures resulting from a file system becoming full or failing.","ia_controls":"","check_content":"Verify that a separate file system has been created for non-privileged local interactive user home directories.\n\n  Check the home directory assignment for all non-privileged users, users with a User Identifier (UID) greater than 1000, on the system with the following command:\n\n     $ sudo awk -F: '($3>=1000)&&($7 !~ /nologin/){print $1,$3,$6}' /etc/passwd\n\n     doej 1001 /home/doej\n     publicj 1002 /home/publicj\n     smithj 1003 /home/smithj\n\nThe output of the command will give the directory/partition that contains the home directories for the non-privileged users on the system (in this example, \"/home\") and users’ shell. All accounts with a valid shell (such as /bin/bash) are considered interactive users.\n\nCheck that a file system/partition has been created for the nonprivileged interactive users with the following command:\n\nNote: The partition of \"/home\" is used in the example.\n\n     $ sudo grep /home /etc/fstab\n\n     /dev/mapper/...   /home   xfs   defaults,noexec,nosuid,nodev 0 0\n\nIf a separate entry for the file system/partition containing the nonprivileged interactive user home directories does not exist, this is a finding.","fix_text":"Migrate the \"/home\" directory onto a separate file system.","false_positives":"","false_negatives":"","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"{\n  \"hdfSpecificData\": {\n    \"code\": \"control 'SV-230328' do\\n  title 'A separate RHEL 8 filesystem must be used for user home directories\\n(such as /home or an equivalent).'\\n  desc 'The use of separate file systems for different paths can protect the\\nsystem from failures resulting from a file system becoming full or failing.'\\n  desc 'check', %q(Verify that a separate file system has been created for non-privileged local interactive user home directories.\\n\\n  Check the home directory assignment for all non-privileged users, users with a User Identifier (UID) greater than 1000, on the system with the following command:\\n\\n     $ sudo awk -F: '($3>=1000)&&($7 !~ /nologin/){print $1,$3,$6}' /etc/passwd\\n\\n     doej 1001 /home/doej\\n     publicj 1002 /home/publicj\\n     smithj 1003 /home/smithj\\n\\nThe output of the command will give the directory/partition that contains the home directories for the non-privileged users on the system (in this example, \\\"/home\\\") and users’ shell. All accounts with a valid shell (such as /bin/bash) are considered interactive users.\\n\\nCheck that a file system/partition has been created for the nonprivileged interactive users with the following command:\\n\\nNote: The partition of \\\"/home\\\" is used in the example.\\n\\n     $ sudo grep /home /etc/fstab\\n\\n     /dev/mapper/...   /home   xfs   defaults,noexec,nosuid,nodev 0 0\\n\\nIf a separate entry for the file system/partition containing the nonprivileged interactive user home directories does not exist, this is a finding.)\\n  desc 'fix', 'Migrate the \\\"/home\\\" directory onto a separate file system.'\\n  impact 0.5\\n  tag severity: 'medium'\\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\\n  tag gid: 'V-230328'\\n  tag rid: 'SV-230328r902723_rule'\\n  tag stig_id: 'RHEL-08-010800'\\n  tag fix_id: 'F-32972r902722_fix'\\n  tag cci: ['CCI-000366']\\n  tag nist: ['CM-6 b']\\n  tag 'host'\\n\\n  only_if('This requirement is Not Applicable inside a container, the containers host manages the containers filesystems') {\\n    !virtualization.system.eql?('docker')\\n  }\\n\\n  ignore_shells = input('non_interactive_shells').join('|')\\n  homes = users.where { uid >= 1000 && !shell.match(ignore_shells) }.homes\\n  root_device = etc_fstab.where { mount_point == '/' }.device_name\\n\\n  if input('seperate_filesystem_exempt')\\n    impact 0.0\\n    describe 'This system is not required to have sperate filesystems for each mount point' do\\n      skip 'The system is managing filesystems and space via other mechanisms; this requirement is Not Applicable'\\n    end\\n  else\\n    homes.each do |home|\\n      pn_parent = Pathname.new(home).parent.to_s\\n      home_device = etc_fstab.where { mount_point == pn_parent }.device_name\\n\\n      describe \\\"The '#{pn_parent}' mount point\\\" do\\n        subject { home_device }\\n\\n        it 'is not on the same partition as the root partition' do\\n          is_expected.not_to equal(root_device)\\n        end\\n\\n        it 'has its own partition' do\\n          is_expected.not_to be_empty\\n        end\\n      end\\n    end\\n  end\\nend\\n\"\n  }\n}","mitigation_control":"","responsibility":"","security_override_guidance":"","check_content_ref":{"name":"M","href":""},"weight":"10.0","classification":"Unclass","legacy_ids":[],"ccis":["CCI-000366"],"stig_ref":"redhat-enterprise-linux-8-stig-baseline :: Version 1, Release: 13","target_key":"","uuid":"81938ff4-1c32-4d03-818b-946f3d4f2a50","comments":"","finding_details":"skipped :: TEST No-op :: SKIP_MESSAGE Skipped control due to only_if condition: This requirement is Not Applicable inside a container, the containers host manages the containers filesystems","group_tree":[],"status":"not_reviewed","overrides":{}}]}],"title":"converted-rhel8_sample_oneOfEachControlStatus","id":"6c0ba262-514a-4b02-875c-7dd2bcdb59a8","active":true,"mode":2,"has_path":false,"target_data":{"target_type":"Computing","host_name":"","ip_address":"","mac_address":"","fqdn":"","comments":"","role":"None","is_web_database":false,"technology_area":"","web_db_site":"","web_db_instance":""},"cklb_version":"1.0"}