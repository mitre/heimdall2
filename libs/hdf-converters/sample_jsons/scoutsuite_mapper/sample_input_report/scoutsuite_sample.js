scoutsuite_results =
  { "account_id": "916481805664", "environment": "default", "last_run": { "ruleset_about": "This ruleset consists of numerous rules that are considered standard by NCC Group. The rules enabled range from violations of well-known security best practices to gaps resulting from less-known security implications of provider-specific mechanisms. Additional rules exist, some of them requiring extra-parameters to be configured, and some of them being applicable to a limited number of users.", "ruleset_name": "default", "run_parameters": { "excluded_regions": [], "regions": [], "services": [], "skipped_services": [] }, "summary": { "cloudtrail": { "checked_items": 16, "flagged_items": 16, "max_level": "danger", "resources_count": 0, "rules_count": 8 } }, "time": "2021-02-19 19:16:10+0000", "version": "5.10.2" }, "partition": "aws", "provider_code": "aws", "provider_name": "Amazon Web Services", "result_format": "json", "service_groups": { "compute": { "summaries": { "external_attack_surface": {} } }, "database": { "summaries": { "external_attack_surface": {} } } }, "service_list": ["cloudtrail"], "services": { "cloudtrail": { "DuplicatedGlobalServiceEvents": false, "IncludeGlobalServiceEvents": false, "filters": {}, "findings": { "cloudtrail-duplicated-global-services-logging": { "checked_items": 0, "compliance": null, "dashboard_name": "Configurations", "description": "Global Service Logging Duplicated", "flagged_items": 0, "id_suffix": "IncludeGlobalServiceEvents", "items": [], "level": "warning", "path": "cloudtrail.regions.id.trails.id", "rationale": "Global service logging is enabled in multiple Trails. While this does not jeopardize the security of the environment, duplicated entries in logs increase the difficulty to investigate potential incidents.", "references": ["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-concepts.html#cloudtrail-concepts-global-service-events"], "remediation": null, "service": "CloudTrail" }, "cloudtrail-no-cloudwatch-integration": { "checked_items": 0, "compliance": [{ "name": "CIS Amazon Web Services Foundations", "reference": "2.4", "version": "1.0.0" }, { "name": "CIS Amazon Web Services Foundations", "reference": "2.4", "version": "1.1.0" }, { "name": "CIS Amazon Web Services Foundations", "reference": "2.4", "version": "1.2.0" }], "dashboard_name": "Configurations", "description": "Trail Is Not Integrated with CloudWatch", "display_path": "cloudtrail.regions.id.trails.id", "flagged_items": 0, "id_suffix": "TrailCloudwatchNoIntegration", "items": [], "level": "warning", "path": "cloudtrail.regions.id.trails.id", "rationale": "The lack of integration with CloudWatch hinders ral-time and historic activity logging as well as not allowing the configuration of alarms and notifications for anomalous account activity.", "references": null, "remediation": "Configure each Trail to have a CloudWatch Logs group attached", "service": "CloudTrail" }, "cloudtrail-no-data-logging": { "checked_items": 0, "compliance": null, "dashboard_name": "Configurations", "description": "Data Events Logging Not Configured", "display_path": "cloudtrail.regions.id.trails.id", "flagged_items": 0, "id_suffix": "cloudtrail-data-events-disabled", "items": [], "level": "warning", "path": "cloudtrail.regions.id.trails.id", "rationale": "CloudTrail Data Logging is not configured, which means that S3 access and Lambda invocations are not logged. <br><br>Note: S3 bucket logging can be used in place of CloudTrail data events for S3. If that is the case, logs for Lambda invocations may still be missing.", "references": ["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-data-events-with-cloudtrail.html"], "remediation": null, "service": "CloudTrail" }, "cloudtrail-no-encryption-with-kms": { "checked_items": 0, "compliance": [{ "name": "CIS Amazon Web Services Foundations", "reference": "2.7", "version": "1.0.0" }, { "name": "CIS Amazon Web Services Foundations", "reference": "2.7", "version": "1.1.0" }, { "name": "CIS Amazon Web Services Foundations", "reference": "2.7", "version": "1.2.0" }], "dashboard_name": "Configurations", "description": "CloudTrail Logs Not Encrypted with KMS Customer Master Keys (CMKs)", "display_path": "cloudtrail.regions.id.trails.id", "flagged_items": 0, "id_suffix": "cloudtrail-kms-key-unused", "items": [], "level": "danger", "path": "cloudtrail.regions.id.trails.id", "rationale": "Not encrypting CloudTrail logs with SSE-KMS affects the confidentiality of the log data.", "references": ["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html"], "remediation": "Ensure each Trail is encrypted with a KMS key", "service": "CloudTrail" }, "cloudtrail-no-global-services-logging": { "checked_items": 0, "compliance": null, "dashboard_name": "Configurations", "description": "Global Service Logging Disabled", "flagged_items": 0, "id_suffix": "IncludeGlobalServiceEvents", "items": [], "level": "danger", "path": "cloudtrail.regions.id.trails.id", "rationale": "API activity for global services such as IAM and STS is not logged. Investigation of incidents will be incomplete due to the lack of information.", "references": ["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-concepts.html#cloudtrail-concepts-global-service-events"], "remediation": null, "service": "CloudTrail" }, "cloudtrail-no-log-file-validation": { "checked_items": 0, "compliance": [{ "name": "CIS Amazon Web Services Foundations", "reference": "2.2", "version": "1.0.0" }, { "name": "CIS Amazon Web Services Foundations", "reference": "2.2", "version": "1.1.0" }, { "name": "CIS Amazon Web Services Foundations", "reference": "2.2", "version": "1.2.0" }], "dashboard_name": "Configurations", "description": "Log File Validation Is Disabled", "display_path": "cloudtrail.regions.id.trails.id", "flagged_items": 0, "id_suffix": "LogFileValidationDisabled", "items": [], "level": "danger", "path": "cloudtrail.regions.id.trails.id", "rationale": "The lack of log file validation prevents from verifying the integrity of CloudTrail log files.", "references": ["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-intro.html"], "remediation": "Ensure that each Trail has Enable log file validation set to Yes", "service": "CloudTrail" }, "cloudtrail-no-logging": { "checked_items": 0, "class_suffix": "IsLogging", "compliance": [{ "name": "CIS Amazon Web Services Foundations", "reference": "2.1", "version": "1.0.0" }, { "name": "CIS Amazon Web Services Foundations", "reference": "2.1", "version": "1.1.0" }, { "name": "CIS Amazon Web Services Foundations", "reference": "2.1", "version": "1.2.0" }], "dashboard_name": "Configurations", "description": "Disabled Trails", "flagged_items": 0, "items": [], "level": "danger", "path": "cloudtrail.regions.id.trails.id", "rationale": "Logging is disabled for a given Trail. Depending on the configuration, logs for important API activity may be missing.", "references": ["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html"], "remediation": "Configure all Trails to enable Logging, set Apply trail to all regions and ensure that Read/Write Events are set to ALL", "service": "CloudTrail" }, "cloudtrail-not-configured": { "checked_items": 16, "compliance": null, "dashboard_name": "Regions", "description": "CloudTrail Service Not Configured", "flagged_items": 16, "id_suffix": "NotConfigured", "items": ["cloudtrail.regions.ap-northeast-1.NotConfigured", "cloudtrail.regions.ap-northeast-2.NotConfigured", "cloudtrail.regions.ap-south-1.NotConfigured", "cloudtrail.regions.ap-southeast-1.NotConfigured", "cloudtrail.regions.ap-southeast-2.NotConfigured", "cloudtrail.regions.ca-central-1.NotConfigured", "cloudtrail.regions.eu-central-1.NotConfigured", "cloudtrail.regions.eu-north-1.NotConfigured", "cloudtrail.regions.eu-west-1.NotConfigured", "cloudtrail.regions.eu-west-2.NotConfigured", "cloudtrail.regions.eu-west-3.NotConfigured", "cloudtrail.regions.sa-east-1.NotConfigured", "cloudtrail.regions.us-east-1.NotConfigured", "cloudtrail.regions.us-east-2.NotConfigured", "cloudtrail.regions.us-west-1.NotConfigured", "cloudtrail.regions.us-west-2.NotConfigured"], "level": "danger", "path": "cloudtrail.regions.id", "rationale": "CloudTrail is not configured, which means that API activity is not logged.", "references": ["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html"], "remediation": null, "service": "CloudTrail" } }, "regions": { "ap-northeast-1": { "id": "ap-northeast-1", "name": "ap-northeast-1", "region": "ap-northeast-1", "trails": {}, "trails_count": 0 }, "ap-northeast-2": { "id": "ap-northeast-2", "name": "ap-northeast-2", "region": "ap-northeast-2", "trails": {}, "trails_count": 0 }, "ap-south-1": { "id": "ap-south-1", "name": "ap-south-1", "region": "ap-south-1", "trails": {}, "trails_count": 0 }, "ap-southeast-1": { "id": "ap-southeast-1", "name": "ap-southeast-1", "region": "ap-southeast-1", "trails": {}, "trails_count": 0 }, "ap-southeast-2": { "id": "ap-southeast-2", "name": "ap-southeast-2", "region": "ap-southeast-2", "trails": {}, "trails_count": 0 }, "ca-central-1": { "id": "ca-central-1", "name": "ca-central-1", "region": "ca-central-1", "trails": {}, "trails_count": 0 }, "eu-central-1": { "id": "eu-central-1", "name": "eu-central-1", "region": "eu-central-1", "trails": {}, "trails_count": 0 }, "eu-north-1": { "id": "eu-north-1", "name": "eu-north-1", "region": "eu-north-1", "trails": {}, "trails_count": 0 }, "eu-west-1": { "id": "eu-west-1", "name": "eu-west-1", "region": "eu-west-1", "trails": {}, "trails_count": 0 }, "eu-west-2": { "id": "eu-west-2", "name": "eu-west-2", "region": "eu-west-2", "trails": {}, "trails_count": 0 }, "eu-west-3": { "id": "eu-west-3", "name": "eu-west-3", "region": "eu-west-3", "trails": {}, "trails_count": 0 }, "sa-east-1": { "id": "sa-east-1", "name": "sa-east-1", "region": "sa-east-1", "trails": {}, "trails_count": 0 }, "us-east-1": { "id": "us-east-1", "name": "us-east-1", "region": "us-east-1", "trails": {}, "trails_count": 0 }, "us-east-2": { "id": "us-east-2", "name": "us-east-2", "region": "us-east-2", "trails": {}, "trails_count": 0 }, "us-west-1": { "id": "us-west-1", "name": "us-west-1", "region": "us-west-1", "trails": {}, "trails_count": 0 }, "us-west-2": { "id": "us-west-2", "name": "us-west-2", "region": "us-west-2", "trails": {}, "trails_count": 0 } }, "regions_count": 16, "trails_count": 0 } } }
